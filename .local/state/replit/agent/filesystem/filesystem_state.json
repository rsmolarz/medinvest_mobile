{"file_contents":{"client/screens/PrivacyPolicyScreen.tsx":{"content":"/**\n * Privacy Policy Screen\n * Display app privacy policy\n */\n\nimport React from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Linking,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\n\nconst PRIVACY_POLICY_URL = 'https://medinvest.com/privacy';\nconst SUPPORT_EMAIL = 'privacy@medinvest.com';\n\nexport default function PrivacyPolicyScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n\n  const handleOpenWebsite = () => {\n    Linking.openURL(PRIVACY_POLICY_URL);\n  };\n\n  const handleContactPrivacy = () => {\n    Linking.openURL(`mailto:${SUPPORT_EMAIL}`);\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Privacy Policy</ThemedText>\n        <TouchableOpacity style={styles.webButton} onPress={handleOpenWebsite}>\n          <Ionicons name=\"open-outline\" size={20} color={Colors.primary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        <ThemedText style={[styles.lastUpdated, { color: appColors.textSecondary }]}>Last updated: January 2026</ThemedText>\n\n        <Section title=\"Introduction\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            MedInvest (\"we\", \"our\", or \"us\") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our mobile application.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"Information We Collect\">\n          <ThemedText style={[styles.subheading, { color: appColors.textPrimary }]}>Personal Information</ThemedText>\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            When you create an account, we collect:\n          </ThemedText>\n          <BulletList items={[\n            'Name and email address',\n            'Professional specialty and credentials',\n            'Profile photo (optional)',\n            'Account preferences',\n          ]} />\n\n          <ThemedText style={[styles.subheading, { color: appColors.textPrimary }]}>Usage Information</ThemedText>\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We automatically collect:\n          </ThemedText>\n          <BulletList items={[\n            'Device information (model, OS version)',\n            'App usage and interaction data',\n            'IP address and general location',\n            'Crash reports and performance data',\n          ]} />\n\n          <ThemedText style={[styles.subheading, { color: appColors.textPrimary }]}>User Content</ThemedText>\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            Content you create on the platform:\n          </ThemedText>\n          <BulletList items={[\n            'Posts, comments, and messages',\n            'Photos and videos you upload',\n            'Reactions and bookmarks',\n          ]} />\n        </Section>\n\n        <Section title=\"How We Use Your Information\">\n          <BulletList items={[\n            'Provide and maintain our services',\n            'Personalize your experience and content',\n            'Send notifications and updates',\n            'Analyze usage to improve our platform',\n            'Prevent fraud and ensure security',\n            'Comply with legal obligations',\n          ]} />\n        </Section>\n\n        <Section title=\"Sharing Your Information\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We do not sell your personal information. We may share data with:\n          </ThemedText>\n          <BulletList items={[\n            'Service providers (hosting, analytics, support)',\n            'Legal authorities when required by law',\n            'Business partners with your consent',\n          ]} />\n        </Section>\n\n        <Section title=\"Data Security\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We implement industry-standard security measures including encryption, secure data centers, and regular security audits. However, no method of transmission over the Internet is 100% secure.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"Your Rights\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            You have the right to:\n          </ThemedText>\n          <BulletList items={[\n            'Access your personal data',\n            'Correct inaccurate information',\n            'Delete your account and data',\n            'Export your data',\n            'Opt-out of marketing communications',\n            'Restrict certain data processing',\n          ]} />\n        </Section>\n\n        <Section title=\"Data Retention\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We retain your data for as long as your account is active or as needed to provide services. You can request deletion at any time through account settings.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"Children's Privacy\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            Our service is not intended for users under 18 years of age. We do not knowingly collect information from children.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"Changes to This Policy\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We may update this policy periodically. We will notify you of significant changes through the app or via email.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"Contact Us\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            For privacy-related questions or requests:\n          </ThemedText>\n          <TouchableOpacity style={styles.contactButton} onPress={handleContactPrivacy}>\n            <Ionicons name=\"mail-outline\" size={20} color={Colors.primary} />\n            <ThemedText style={styles.contactText}>{SUPPORT_EMAIL}</ThemedText>\n          </TouchableOpacity>\n        </Section>\n\n        <View style={styles.bottomPadding} />\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nfunction Section({ title, children }: { title: string; children: React.ReactNode }) {\n  const appColors = useAppColors();\n  return (\n    <View style={styles.section}>\n      <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>{title}</ThemedText>\n      {children}\n    </View>\n  );\n}\n\nfunction BulletList({ items }: { items: string[] }) {\n  const appColors = useAppColors();\n  return (\n    <View style={styles.bulletList}>\n      {items.map((item, index) => (\n        <View key={index} style={styles.bulletItem}>\n          <View style={styles.bullet} />\n          <ThemedText style={[styles.bulletText, { color: appColors.textSecondary }]}>{item}</ThemedText>\n        </View>\n      ))}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  webButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: Spacing.lg,\n  },\n  lastUpdated: {\n    ...Typography.small,\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.md,\n  },\n  subheading: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginTop: Spacing.md,\n    marginBottom: Spacing.sm,\n  },\n  paragraph: {\n    ...Typography.body,\n    lineHeight: 24,\n    marginBottom: Spacing.md,\n  },\n  bulletList: {\n    marginLeft: Spacing.sm,\n  },\n  bulletItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.sm,\n  },\n  bullet: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n    backgroundColor: Colors.primary,\n    marginTop: 8,\n    marginRight: Spacing.md,\n  },\n  bulletText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  contactButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.primary + '10',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.md,\n  },\n  contactText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  bottomPadding: {\n    height: Spacing['3xl'],\n  },\n});\n","path":null,"size_bytes":9525,"size_tokens":null},"client/screens/DealsScreen.tsx":{"content":"/**\n * Deals Screen\n * Browse and invest in healthcare deals\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  Dimensions,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { dealsApi, Deal } from '@/lib/api';\nimport { formatCurrency, formatNumber } from '@/lib/utils';\n\nconst { width } = Dimensions.get('window');\n\nconst CATEGORIES = [\n  { id: 'all', name: 'All', icon: 'üåê' },\n  { id: 'biotech', name: 'Biotech', icon: 'üß¨' },\n  { id: 'medtech', name: 'MedTech', icon: 'üè•' },\n  { id: 'pharma', name: 'Pharma', icon: 'üíä' },\n  { id: 'digital-health', name: 'Digital Health', icon: 'üì±' },\n  { id: 'diagnostics', name: 'Diagnostics', icon: 'üî¨' },\n];\n\nexport default function DealsScreen() {\n  const navigation = useNavigation<any>();\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const appColors = useAppColors();\n\n  const {\n    data: dealsData,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['/api/deals', selectedCategory],\n    queryFn: async () => {\n      const response = await dealsApi.getDeals(\n        selectedCategory === 'all' ? undefined : selectedCategory\n      );\n      return response.data;\n    },\n  });\n\n  const deals = dealsData?.deals || [];\n\n  const handleDealPress = useCallback((dealId: number) => {\n    navigation.navigate('DealDetail', { dealId });\n  }, [navigation]);\n\n  const renderCategoryFilter = () => (\n    <FlatList\n      horizontal\n      data={CATEGORIES}\n      showsHorizontalScrollIndicator={false}\n      contentContainerStyle={styles.categoriesContainer}\n      renderItem={({ item }) => (\n        <TouchableOpacity\n          style={[\n            styles.categoryChip,\n            selectedCategory === item.id && styles.categoryChipActive,\n          ]}\n          onPress={() => setSelectedCategory(item.id)}\n        >\n          <ThemedText style={styles.categoryIcon}>{item.icon}</ThemedText>\n          <ThemedText\n            style={[\n              styles.categoryName,\n              { color: appColors.textSecondary },\n              selectedCategory === item.id && styles.categoryNameActive,\n            ]}\n          >\n            {item.name}\n          </ThemedText>\n        </TouchableOpacity>\n      )}\n      keyExtractor={(item) => item.id}\n    />\n  );\n\n  const renderDealCard = ({ item }: { item: Deal }) => {\n    const fundingProgress = (item.raised / item.target_raise) * 100;\n    const daysLeft = Math.ceil(\n      (new Date(item.deadline).getTime() - Date.now()) / (1000 * 60 * 60 * 24)\n    );\n\n    return (\n      <TouchableOpacity\n        style={[styles.dealCard, { backgroundColor: appColors.surface }]}\n        onPress={() => handleDealPress(item.id)}\n      >\n        {/* Header */}\n        <View style={styles.dealHeader}>\n          {item.company_logo ? (\n            <Image source={{ uri: item.company_logo }} style={styles.companyLogo} />\n          ) : (\n            <View style={[styles.companyLogo, styles.companyLogoPlaceholder]}>\n              <ThemedText style={styles.companyLogoText}>\n                {item.company_name.charAt(0)}\n              </ThemedText>\n            </View>\n          )}\n          <View style={styles.dealInfo}>\n            <ThemedText style={[styles.companyName, { color: appColors.textSecondary }]}>{item.company_name}</ThemedText>\n            <ThemedText style={[styles.dealTitle, { color: appColors.textPrimary }]} numberOfLines={1}>\n              {item.title}\n            </ThemedText>\n          </View>\n          <View style={[\n            styles.statusBadge,\n            item.status === 'active' ? styles.statusActive : styles.statusClosed,\n          ]}>\n            <ThemedText style={styles.statusText}>\n              {item.status === 'active' ? 'Active' : 'Closed'}\n            </ThemedText>\n          </View>\n        </View>\n\n        {/* Description */}\n        <ThemedText style={[styles.dealDescription, { color: appColors.textSecondary }]} numberOfLines={2}>\n          {item.description}\n        </ThemedText>\n\n        {/* Highlights */}\n        {item.highlights && item.highlights.length > 0 && (\n          <View style={styles.highlights}>\n            {item.highlights.slice(0, 2).map((highlight, index) => (\n              <View key={index} style={styles.highlightItem}>\n                <Ionicons name=\"checkmark-circle\" size={14} color={Colors.secondary} />\n                <ThemedText style={[styles.highlightText, { color: appColors.textPrimary }]} numberOfLines={1}>\n                  {highlight}\n                </ThemedText>\n              </View>\n            ))}\n          </View>\n        )}\n\n        {/* Progress Bar */}\n        <View style={styles.progressContainer}>\n          <View style={styles.progressBar}>\n            <LinearGradient\n              colors={[Colors.primary, Colors.secondary]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 0 }}\n              style={[styles.progressFill, { width: `${Math.min(fundingProgress, 100)}%` }]}\n            />\n          </View>\n          <View style={styles.progressStats}>\n            <ThemedText style={[styles.progressAmount, { color: appColors.textPrimary }]}>\n              {formatCurrency(item.raised)} raised\n            </ThemedText>\n            <ThemedText style={styles.progressPercent}>\n              {fundingProgress.toFixed(0)}%\n            </ThemedText>\n          </View>\n        </View>\n\n        {/* Footer */}\n        <View style={[styles.dealFooter, { borderTopColor: appColors.border }]}>\n          <View style={styles.footerItem}>\n            <Ionicons name=\"flag-outline\" size={16} color={appColors.textSecondary} />\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>\n              {formatCurrency(item.target_raise)} goal\n            </ThemedText>\n          </View>\n          <View style={styles.footerItem}>\n            <Ionicons name=\"cash-outline\" size={16} color={appColors.textSecondary} />\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>\n              {formatCurrency(item.minimum_investment)} min\n            </ThemedText>\n          </View>\n          <View style={styles.footerItem}>\n            <Ionicons name=\"people-outline\" size={16} color={appColors.textSecondary} />\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>\n              {formatNumber(item.investors_count)}\n            </ThemedText>\n          </View>\n          <View style={styles.footerItem}>\n            <Ionicons name=\"time-outline\" size={16} color={daysLeft <= 7 ? appColors.error : appColors.textSecondary} />\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }, daysLeft <= 7 && { color: appColors.error, fontWeight: '600' }]}>\n              {daysLeft > 0 ? `${daysLeft}d left` : 'Ended'}\n            </ThemedText>\n          </View>\n        </View>\n      </TouchableOpacity>\n    );\n  };\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <MaterialCommunityIcons name=\"chart-line\" size={64} color={appColors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No deals available</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        Check back later for new investment opportunities\n      </ThemedText>\n    </View>\n  );\n\n  const renderHeader = () => (\n    <View style={[styles.headerSection, { backgroundColor: appColors.surface }]}>\n      <View style={styles.statsRow}>\n        <View style={styles.statCard}>\n          <ThemedText style={styles.statValue}>{deals?.length || 0}</ThemedText>\n          <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Active Deals</ThemedText>\n        </View>\n        <View style={styles.statCard}>\n          <ThemedText style={styles.statValue}>\n            {formatCurrency(\n              deals?.reduce((sum, d) => sum + (d.raised || 0), 0) || 0\n            )}\n          </ThemedText>\n          <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Total Raised</ThemedText>\n        </View>\n      </View>\n      {renderCategoryFilter()}\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Investment Deals</ThemedText>\n        <TouchableOpacity style={styles.filterButton}>\n          <Ionicons name=\"options-outline\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      {/* Deals List */}\n      <FlatList\n        data={deals}\n        renderItem={renderDealCard}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={styles.listContent}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  title: {\n    ...Typography.title,\n  },\n  filterButton: {\n    padding: Spacing.sm,\n  },\n  listContent: {\n    paddingBottom: Spacing.xl,\n  },\n  headerSection: {\n    paddingBottom: Spacing.md,\n    marginBottom: Spacing.md,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    gap: Spacing.md,\n  },\n  statCard: {\n    flex: 1,\n    backgroundColor: Colors.primary + '10',\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    alignItems: 'center',\n  },\n  statValue: {\n    ...Typography.heading,\n    color: Colors.primary,\n    fontWeight: '700',\n  },\n  statLabel: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  categoriesContainer: {\n    paddingHorizontal: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  categoryChip: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n    marginRight: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  categoryChipActive: {\n    backgroundColor: Colors.primary + '15',\n  },\n  categoryIcon: {\n    fontSize: 14,\n  },\n  categoryName: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  categoryNameActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  dealCard: {\n    marginHorizontal: Spacing.lg,\n    marginBottom: Spacing.md,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    ...Shadows.card,\n  },\n  dealHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  companyLogo: {\n    width: 48,\n    height: 48,\n    borderRadius: BorderRadius.sm,\n    marginRight: Spacing.md,\n  },\n  companyLogoPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  companyLogoText: {\n    ...Typography.heading,\n    color: Colors.primary,\n  },\n  dealInfo: {\n    flex: 1,\n  },\n  companyName: {\n    ...Typography.small,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  dealTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginTop: 2,\n  },\n  statusBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n  },\n  statusActive: {\n    backgroundColor: Colors.secondary + '20',\n  },\n  statusClosed: {\n    backgroundColor: Colors.light.textSecondary + '20',\n  },\n  statusText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  dealDescription: {\n    ...Typography.body,\n    lineHeight: 20,\n  },\n  highlights: {\n    marginTop: Spacing.md,\n    gap: Spacing.xs,\n  },\n  highlightItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  highlightText: {\n    ...Typography.small,\n    flex: 1,\n  },\n  progressContainer: {\n    marginTop: Spacing.lg,\n  },\n  progressBar: {\n    height: 8,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: 4,\n    overflow: 'hidden',\n  },\n  progressFill: {\n    height: '100%',\n    borderRadius: 4,\n  },\n  progressStats: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginTop: Spacing.xs,\n  },\n  progressAmount: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  progressPercent: {\n    ...Typography.caption,\n    color: Colors.secondary,\n    fontWeight: '600',\n  },\n  dealFooter: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    paddingTop: Spacing.md,\n    borderTopWidth: 1,\n  },\n  footerItem: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  footerText: {\n    ...Typography.small,\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":14016,"size_tokens":null},"client/screens/settings/SettingsScreen.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Pressable } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport default function SettingsScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Settings</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        <Text style={styles.comingSoon}>Settings options coming soon</Text>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  content: {\n    flex: 1,\n    padding: spacing.lg,\n  },\n  comingSoon: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n    marginTop: spacing['3xl'],\n  },\n});\n","path":null,"size_bytes":1852,"size_tokens":null},"client/screens/settings/SupportScreen.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Pressable, Linking } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport default function SupportScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n\n  const supportOptions = [\n    { id: '1', icon: 'message-circle', title: 'Chat with Us', subtitle: 'Get help from our team' },\n    { id: '2', icon: 'mail', title: 'Email Support', subtitle: 'support@medinvest.app' },\n    { id: '3', icon: 'phone', title: 'Call Us', subtitle: '+1 (800) 123-4567' },\n    { id: '4', icon: 'book-open', title: 'Help Center', subtitle: 'Browse FAQs and guides' },\n  ];\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Support</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        {supportOptions.map((option) => (\n          <Pressable key={option.id} style={styles.optionItem}>\n            <View style={styles.optionIcon}>\n              <Feather\n                name={option.icon as any}\n                size={20}\n                color={colors.primary.main}\n              />\n            </View>\n            <View style={styles.optionInfo}>\n              <Text style={styles.optionTitle}>{option.title}</Text>\n              <Text style={styles.optionSubtitle}>{option.subtitle}</Text>\n            </View>\n            <Feather name=\"chevron-right\" size={20} color={colors.text.tertiary} />\n          </Pressable>\n        ))}\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  content: {\n    flex: 1,\n    padding: spacing.lg,\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  optionIcon: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  optionInfo: {\n    flex: 1,\n  },\n  optionTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  optionSubtitle: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n});\n","path":null,"size_bytes":3381,"size_tokens":null},"client/index.js":{"content":"import { registerRootComponent } from \"expo\";\n\nimport App from \"@/App\";\n\nregisterRootComponent(App);\n","path":null,"size_bytes":101,"size_tokens":null},"client/components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n} from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Fonts } from \"@/constants/theme\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const { theme } = useTheme();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              backgroundColor: theme.backgroundDefault,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <ThemedText type=\"h1\" style={styles.title}>\n          Something went wrong\n        </ThemedText>\n\n        <ThemedText type=\"body\" style={styles.message}>\n          Please reload the app to continue.\n        </ThemedText>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.link,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[styles.buttonText, { color: theme.buttonText }]}\n          >\n            Try Again\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <ThemedView style={styles.modalContainer}>\n              <View style={styles.modalHeader}>\n                <ThemedText type=\"h2\" style={styles.modalTitle}>\n                  Error Details\n                </ThemedText>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={styles.modalScrollContent}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundDefault },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: Fonts?.mono || \"monospace\",\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </ThemedView>\n          </View>\n        </Modal>\n      ) : null}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.lg,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  title: {\n    textAlign: \"center\",\n    lineHeight: 40,\n  },\n  message: {\n    textAlign: \"center\",\n    opacity: 0.7,\n    lineHeight: 24,\n  },\n  topButton: {\n    position: \"absolute\",\n    top: Spacing[\"2xl\"] + Spacing.lg,\n    right: Spacing.lg,\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.md,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing[\"2xl\"],\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  modalTitle: {\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: Spacing.lg,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    padding: Spacing.lg,\n  },\n  errorText: {\n    fontSize: 12,\n    lineHeight: 18,\n    width: \"100%\",\n  },\n});\n","path":null,"size_bytes":6194,"size_tokens":null},"client/screens/RoomsScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport { View, StyleSheet, FlatList, Pressable, TextInput, RefreshControl, ActivityIndicator } from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Animated, { FadeInDown } from \"react-native-reanimated\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { roomsApi, Room } from \"@/lib/api\";\n\nexport default function RoomsScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<any>();\n  const { theme } = useTheme();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: roomsData, isLoading, isRefetching, refetch } = useQuery({\n    queryKey: ['/api/rooms'],\n  });\n\n  const rooms = roomsData?.rooms || [];\n\n  const joinMutation = useMutation({\n    mutationFn: async ({ slug, isJoined }: { slug: string; isJoined: boolean }) => {\n      if (isJoined) {\n        return roomsApi.leaveRoom(slug);\n      } else {\n        return roomsApi.joinRoom(slug);\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rooms'] });\n    },\n  });\n\n  const filteredRooms = rooms.filter((room: Room) =>\n    room.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    room.description.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const handleJoinRoom = useCallback((slug: string, isJoined: boolean) => {\n    joinMutation.mutate({ slug, isJoined });\n  }, [joinMutation]);\n\n  const handleRoomPress = useCallback((slug: string) => {\n    navigation.navigate('RoomDetail', { roomSlug: slug });\n  }, [navigation]);\n\n  const renderRoom = ({ item, index }: { item: Room; index: number }) => {\n    const isJoined = item.is_member;\n    const iconName = getFeatherIconName(item.icon);\n\n    return (\n      <Animated.View entering={FadeInDown.delay(index * 50).springify()}>\n        <Pressable \n          style={[styles.roomCard, { backgroundColor: theme.backgroundDefault }, Shadows.card]}\n          onPress={() => handleRoomPress(item.slug)}\n        >\n          <View style={[styles.roomIcon, { backgroundColor: item.color + \"20\" }]}>\n            <Feather name={iconName} size={24} color={item.color} />\n          </View>\n\n          <View style={styles.roomContent}>\n            <ThemedText type=\"heading\">{item.name}</ThemedText>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }} numberOfLines={1}>\n              {item.description}\n            </ThemedText>\n            <View style={styles.statsRow}>\n              <View style={styles.memberRow}>\n                <Feather name=\"users\" size={14} color={theme.textSecondary} />\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                  {item.members_count?.toLocaleString() || 0} members\n                </ThemedText>\n              </View>\n              <View style={styles.memberRow}>\n                <Feather name=\"message-square\" size={14} color={theme.textSecondary} />\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                  {item.posts_count?.toLocaleString() || 0} posts\n                </ThemedText>\n              </View>\n            </View>\n          </View>\n\n          <Pressable\n            onPress={(e) => {\n              e.stopPropagation();\n              handleJoinRoom(item.slug, isJoined);\n            }}\n            style={[\n              styles.joinButton,\n              {\n                backgroundColor: isJoined ? theme.backgroundSecondary : Colors.primary,\n              },\n            ]}\n            disabled={joinMutation.isPending}\n          >\n            {joinMutation.isPending && joinMutation.variables?.slug === item.slug ? (\n              <ActivityIndicator size=\"small\" color={isJoined ? theme.textSecondary : \"#FFFFFF\"} />\n            ) : (\n              <ThemedText\n                type=\"body\"\n                style={{\n                  color: isJoined ? theme.textSecondary : \"#FFFFFF\",\n                  fontWeight: \"600\",\n                }}\n              >\n                {isJoined ? \"Joined\" : \"Join\"}\n              </ThemedText>\n            )}\n          </Pressable>\n        </Pressable>\n      </Animated.View>\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <View style={[styles.container, styles.centered, { backgroundColor: theme.backgroundRoot }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </View>\n    );\n  }\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <View style={[styles.header, { paddingTop: insets.top + Spacing.lg }]}>\n        <ThemedText type=\"title\">Healthcare Rooms</ThemedText>\n        <ThemedText type=\"body\" style={{ color: theme.textSecondary, marginTop: Spacing.xs }}>\n          Join specialty communities to discuss investments\n        </ThemedText>\n      </View>\n\n      <View style={styles.searchSection}>\n        <View style={[styles.searchContainer, { backgroundColor: theme.backgroundSecondary }]}>\n          <Feather name=\"search\" size={20} color={theme.textSecondary} />\n          <TextInput\n            style={[styles.searchInput, { color: theme.text }]}\n            placeholder=\"Search specialties...\"\n            placeholderTextColor={theme.textSecondary}\n            value={searchQuery}\n            onChangeText={setSearchQuery}\n          />\n          {searchQuery.length > 0 ? (\n            <Pressable onPress={() => setSearchQuery(\"\")}>\n              <Feather name=\"x\" size={20} color={theme.textSecondary} />\n            </Pressable>\n          ) : null}\n        </View>\n      </View>\n\n      <FlatList\n        data={filteredRooms}\n        renderItem={renderRoom}\n        keyExtractor={(item) => item.id.toString()}\n        contentContainerStyle={styles.list}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        ListEmptyComponent={\n          <View style={styles.emptyState}>\n            <Feather name=\"search\" size={48} color={theme.textSecondary} />\n            <ThemedText type=\"heading\" style={{ marginTop: Spacing.lg }}>\n              No rooms found\n            </ThemedText>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              Try a different search term\n            </ThemedText>\n          </View>\n        }\n      />\n    </View>\n  );\n}\n\nfunction getFeatherIconName(icon: string): keyof typeof Feather.glyphMap {\n  const iconMap: Record<string, keyof typeof Feather.glyphMap> = {\n    heart: 'heart',\n    activity: 'activity',\n    cpu: 'cpu',\n    smartphone: 'smartphone',\n    'flask-conical': 'droplet',\n    stethoscope: 'thermometer',\n    pill: 'disc',\n    brain: 'zap',\n  };\n  return iconMap[icon] || 'folder';\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  centered: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  header: {\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.lg,\n  },\n  searchSection: {\n    paddingHorizontal: Spacing.xl,\n    marginBottom: Spacing.lg,\n  },\n  searchContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: 16,\n    paddingVertical: Spacing.xs,\n  },\n  list: {\n    paddingHorizontal: Spacing.xl,\n    gap: Spacing.md,\n    paddingBottom: Spacing.xl,\n  },\n  roomCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n    gap: Spacing.md,\n    marginBottom: Spacing.sm,\n  },\n  roomIcon: {\n    width: 52,\n    height: 52,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  roomContent: {\n    flex: 1,\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.xs,\n    gap: Spacing.md,\n  },\n  memberRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  joinButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    minWidth: 80,\n    alignItems: 'center',\n  },\n  emptyState: {\n    alignItems: \"center\",\n    paddingTop: 80,\n  },\n});\n","path":null,"size_bytes":8709,"size_tokens":null},"client/components/ImageCropper.tsx":{"content":"/**\n * Image Cropper Component\n * Crop images before uploading (profile photos, posts)\n */\n\nimport React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Modal,\n  TouchableOpacity,\n  Image,\n  Dimensions,\n  ActivityIndicator,\n  PanResponder,\n  Animated,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as ImageManipulator from 'expo-image-manipulator';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\ninterface ImageCropperProps {\n  visible: boolean;\n  imageUri: string;\n  aspectRatio?: number; // width/height, e.g., 1 for square, 16/9 for landscape\n  cropShape?: 'rectangle' | 'circle';\n  onCropComplete: (croppedUri: string) => void;\n  onCancel: () => void;\n}\n\nexport default function ImageCropper({\n  visible,\n  imageUri,\n  aspectRatio = 1,\n  cropShape = 'rectangle',\n  onCropComplete,\n  onCancel,\n}: ImageCropperProps) {\n  const [imageSize, setImageSize] = useState({ width: 0, height: 0 });\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const [isProcessing, setIsProcessing] = useState(false);\n  \n  // Animation values for pan and zoom\n  const pan = useRef(new Animated.ValueXY()).current;\n  const scale = useRef(new Animated.Value(1)).current;\n  const lastScale = useRef(1);\n  const lastOffset = useRef({ x: 0, y: 0 });\n\n  // Calculate crop area dimensions\n  const getCropAreaSize = useCallback(() => {\n    const maxWidth = SCREEN_WIDTH - 48;\n    const maxHeight = SCREEN_HEIGHT * 0.5;\n    \n    let cropWidth = maxWidth;\n    let cropHeight = cropWidth / aspectRatio;\n    \n    if (cropHeight > maxHeight) {\n      cropHeight = maxHeight;\n      cropWidth = cropHeight * aspectRatio;\n    }\n    \n    return { width: cropWidth, height: cropHeight };\n  }, [aspectRatio]);\n\n  const cropArea = getCropAreaSize();\n\n  // Load image dimensions\n  React.useEffect(() => {\n    if (imageUri) {\n      Image.getSize(imageUri, (width, height) => {\n        setImageSize({ width, height });\n      });\n    }\n  }, [imageUri]);\n\n  // Calculate initial image scale to fill crop area\n  const getInitialScale = useCallback(() => {\n    if (imageSize.width === 0 || imageSize.height === 0) return 1;\n    \n    const scaleX = cropArea.width / imageSize.width;\n    const scaleY = cropArea.height / imageSize.height;\n    \n    // Use the larger scale to ensure image fills the crop area\n    return Math.max(scaleX, scaleY);\n  }, [imageSize, cropArea]);\n\n  const initialScale = getInitialScale();\n\n  // Pan responder for drag and pinch gestures\n  const panResponder = useRef(\n    PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onMoveShouldSetPanResponder: () => true,\n      \n      onPanResponderGrant: () => {\n        pan.setOffset({\n          x: lastOffset.current.x,\n          y: lastOffset.current.y,\n        });\n        pan.setValue({ x: 0, y: 0 });\n      },\n      \n      onPanResponderMove: (evt, gestureState) => {\n        // Handle pinch zoom with two fingers\n        if (evt.nativeEvent.touches.length === 2) {\n          // Simple pinch detection\n          const touch1 = evt.nativeEvent.touches[0];\n          const touch2 = evt.nativeEvent.touches[1];\n          const distance = Math.sqrt(\n            Math.pow(touch2.pageX - touch1.pageX, 2) +\n            Math.pow(touch2.pageY - touch1.pageY, 2)\n          );\n          \n          // This is a simplified pinch - in production, use react-native-gesture-handler\n        }\n        \n        // Pan movement\n        Animated.event(\n          [null, { dx: pan.x, dy: pan.y }],\n          { useNativeDriver: false }\n        )(evt, gestureState);\n      },\n      \n      onPanResponderRelease: () => {\n        pan.flattenOffset();\n        lastOffset.current = {\n          x: (pan.x as any)._value,\n          y: (pan.y as any)._value,\n        };\n      },\n    })\n  ).current;\n\n  // Handle zoom buttons\n  const handleZoomIn = () => {\n    const newScale = Math.min(lastScale.current * 1.2, 5);\n    lastScale.current = newScale;\n    Animated.spring(scale, {\n      toValue: newScale,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  const handleZoomOut = () => {\n    const minScale = initialScale;\n    const newScale = Math.max(lastScale.current / 1.2, minScale);\n    lastScale.current = newScale;\n    Animated.spring(scale, {\n      toValue: newScale,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  const handleReset = () => {\n    lastScale.current = initialScale;\n    lastOffset.current = { x: 0, y: 0 };\n    Animated.parallel([\n      Animated.spring(scale, { toValue: initialScale, useNativeDriver: false }),\n      Animated.spring(pan, { toValue: { x: 0, y: 0 }, useNativeDriver: false }),\n    ]).start();\n  };\n\n  // Crop the image\n  const handleCrop = async () => {\n    setIsProcessing(true);\n    \n    try {\n      // Calculate crop region based on current pan and scale\n      const currentScale = lastScale.current || initialScale;\n      const offsetX = lastOffset.current.x;\n      const offsetY = lastOffset.current.y;\n      \n      // Calculate the visible portion of the image\n      const scaledWidth = imageSize.width * currentScale;\n      const scaledHeight = imageSize.height * currentScale;\n      \n      // Center of crop area in image coordinates\n      const centerX = (scaledWidth / 2 - offsetX) / currentScale;\n      const centerY = (scaledHeight / 2 - offsetY) / currentScale;\n      \n      // Crop dimensions in original image coordinates\n      const cropWidthInImage = cropArea.width / currentScale;\n      const cropHeightInImage = cropArea.height / currentScale;\n      \n      // Origin of crop\n      const originX = Math.max(0, centerX - cropWidthInImage / 2);\n      const originY = Math.max(0, centerY - cropHeightInImage / 2);\n      \n      // Ensure crop is within bounds\n      const finalWidth = Math.min(cropWidthInImage, imageSize.width - originX);\n      const finalHeight = Math.min(cropHeightInImage, imageSize.height - originY);\n      \n      // Perform the crop\n      const result = await ImageManipulator.manipulateAsync(\n        imageUri,\n        [\n          {\n            crop: {\n              originX: Math.round(originX),\n              originY: Math.round(originY),\n              width: Math.round(finalWidth),\n              height: Math.round(finalHeight),\n            },\n          },\n        ],\n        { compress: 0.9, format: ImageManipulator.SaveFormat.JPEG }\n      );\n      \n      onCropComplete(result.uri);\n    } catch (error) {\n      console.error('Error cropping image:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const displayedImageWidth = imageSize.width * initialScale;\n  const displayedImageHeight = imageSize.height * initialScale;\n\n  return (\n    <Modal\n      visible={visible}\n      animationType=\"slide\"\n      presentationStyle=\"fullScreen\"\n      onRequestClose={onCancel}\n    >\n      <SafeAreaView style={styles.container}>\n        {/* Header */}\n        <View style={styles.header}>\n          <TouchableOpacity style={styles.headerButton} onPress={onCancel}>\n            <Ionicons name=\"close\" size={28} color=\"white\" />\n          </TouchableOpacity>\n          <ThemedText style={styles.headerTitle}>Crop Image</ThemedText>\n          <TouchableOpacity \n            style={[styles.headerButton, styles.doneButton]} \n            onPress={handleCrop}\n            disabled={isProcessing}\n          >\n            {isProcessing ? (\n              <ActivityIndicator color=\"white\" size=\"small\" />\n            ) : (\n              <ThemedText style={styles.doneText}>Done</ThemedText>\n            )}\n          </TouchableOpacity>\n        </View>\n\n        {/* Crop Area */}\n        <View \n          style={styles.cropContainer}\n          onLayout={(e) => setContainerSize({\n            width: e.nativeEvent.layout.width,\n            height: e.nativeEvent.layout.height,\n          })}\n        >\n          {/* Image */}\n          <Animated.View\n            {...panResponder.panHandlers}\n            style={[\n              styles.imageContainer,\n              {\n                transform: [\n                  { translateX: pan.x },\n                  { translateY: pan.y },\n                  { scale: scale },\n                ],\n              },\n            ]}\n          >\n            <Image\n              source={{ uri: imageUri }}\n              style={{\n                width: displayedImageWidth,\n                height: displayedImageHeight,\n              }}\n              resizeMode=\"contain\"\n            />\n          </Animated.View>\n\n          {/* Crop Overlay */}\n          <View style={styles.overlayContainer} pointerEvents=\"none\">\n            {/* Top overlay */}\n            <View style={[styles.overlay, { height: (containerSize.height - cropArea.height) / 2 }]} />\n            \n            {/* Middle row */}\n            <View style={styles.middleRow}>\n              {/* Left overlay */}\n              <View style={[styles.overlay, { width: (containerSize.width - cropArea.width) / 2 }]} />\n              \n              {/* Crop window */}\n              <View \n                style={[\n                  styles.cropWindow,\n                  {\n                    width: cropArea.width,\n                    height: cropArea.height,\n                    borderRadius: cropShape === 'circle' ? cropArea.width / 2 : BorderRadius.sm,\n                  },\n                ]}\n              >\n                {/* Corner guides */}\n                <View style={[styles.cornerGuide, styles.topLeft]} />\n                <View style={[styles.cornerGuide, styles.topRight]} />\n                <View style={[styles.cornerGuide, styles.bottomLeft]} />\n                <View style={[styles.cornerGuide, styles.bottomRight]} />\n              </View>\n              \n              {/* Right overlay */}\n              <View style={[styles.overlay, { width: (containerSize.width - cropArea.width) / 2 }]} />\n            </View>\n            \n            {/* Bottom overlay */}\n            <View style={[styles.overlay, { height: (containerSize.height - cropArea.height) / 2 }]} />\n          </View>\n        </View>\n\n        {/* Controls */}\n        <View style={styles.controls}>\n          <TouchableOpacity style={styles.controlButton} onPress={handleZoomOut}>\n            <Ionicons name=\"remove\" size={24} color=\"white\" />\n          </TouchableOpacity>\n          \n          <TouchableOpacity style={styles.controlButton} onPress={handleReset}>\n            <Ionicons name=\"refresh\" size={24} color=\"white\" />\n          </TouchableOpacity>\n          \n          <TouchableOpacity style={styles.controlButton} onPress={handleZoomIn}>\n            <Ionicons name=\"add\" size={24} color=\"white\" />\n          </TouchableOpacity>\n        </View>\n\n        {/* Instructions */}\n        <ThemedText style={styles.instructions}>\n          Drag to reposition ‚Ä¢ Use buttons to zoom\n        </ThemedText>\n      </SafeAreaView>\n    </Modal>\n  );\n}\n\n// Preset cropper for profile photos\nexport function ProfilePhotoCropper({\n  visible,\n  imageUri,\n  onCropComplete,\n  onCancel,\n}: Omit<ImageCropperProps, 'aspectRatio' | 'cropShape'>) {\n  return (\n    <ImageCropper\n      visible={visible}\n      imageUri={imageUri}\n      aspectRatio={1}\n      cropShape=\"circle\"\n      onCropComplete={onCropComplete}\n      onCancel={onCancel}\n    />\n  );\n}\n\n// Preset cropper for post images\nexport function PostImageCropper({\n  visible,\n  imageUri,\n  aspectRatio = 4/3,\n  onCropComplete,\n  onCancel,\n}: Omit<ImageCropperProps, 'cropShape'>) {\n  return (\n    <ImageCropper\n      visible={visible}\n      imageUri={imageUri}\n      aspectRatio={aspectRatio}\n      cropShape=\"rectangle\"\n      onCropComplete={onCropComplete}\n      onCancel={onCancel}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#000',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n  },\n  headerButton: {\n    padding: Spacing.sm,\n    minWidth: 60,\n  },\n  headerTitle: {\n    ...Typography.heading,\n    color: 'white',\n  },\n  doneButton: {\n    alignItems: 'flex-end',\n  },\n  doneText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  cropContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    overflow: 'hidden',\n  },\n  imageContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  overlayContainer: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  overlay: {\n    backgroundColor: 'rgba(0, 0, 0, 0.6)',\n  },\n  middleRow: {\n    flexDirection: 'row',\n  },\n  cropWindow: {\n    borderWidth: 2,\n    borderColor: 'white',\n    position: 'relative',\n  },\n  cornerGuide: {\n    position: 'absolute',\n    width: 20,\n    height: 20,\n    borderColor: 'white',\n    borderWidth: 3,\n  },\n  topLeft: {\n    top: -2,\n    left: -2,\n    borderRightWidth: 0,\n    borderBottomWidth: 0,\n  },\n  topRight: {\n    top: -2,\n    right: -2,\n    borderLeftWidth: 0,\n    borderBottomWidth: 0,\n  },\n  bottomLeft: {\n    bottom: -2,\n    left: -2,\n    borderRightWidth: 0,\n    borderTopWidth: 0,\n  },\n  bottomRight: {\n    bottom: -2,\n    right: -2,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n  },\n  controls: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    gap: Spacing.xl,\n  },\n  controlButton: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  instructions: {\n    ...Typography.small,\n    color: 'rgba(255, 255, 255, 0.6)',\n    textAlign: 'center',\n    paddingBottom: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":13854,"size_tokens":null},"client/hooks/useAppColors.ts":{"content":"import { Colors } from \"@/constants/theme\";\nimport { useThemeContext } from \"@/contexts/ThemeContext\";\n\nexport function useAppColors() {\n  const { isDark, colors: themeColors } = useThemeContext();\n  const palette = Colors[isDark ? \"dark\" : \"light\"];\n\n  return {\n    primary: Colors.primary,\n    secondary: Colors.secondary,\n    gradient: Colors.gradient,\n    error: isDark ? '#E57373' : Colors.error,\n    warning: isDark ? '#FFD54F' : Colors.warning,\n\n    background: palette.backgroundRoot,\n    surface: palette.backgroundDefault,\n    surfaceSecondary: palette.backgroundSecondary,\n    surfaceTertiary: palette.backgroundTertiary,\n    textPrimary: palette.text,\n    textSecondary: palette.textSecondary,\n    border: isDark ? '#3D3D3D' : Colors.border,\n    borderLight: isDark ? '#2D2D2D' : '#F0F2F4',\n    divider: isDark ? '#3D3D3D' : '#E8EAED',\n    card: palette.backgroundDefault,\n    overlay: isDark ? 'rgba(0, 0, 0, 0.7)' : 'rgba(0, 0, 0, 0.5)',\n    tabBar: palette.backgroundDefault,\n    input: isDark ? '#2D2D2D' : '#F5F7FA',\n    inputFocused: isDark ? '#3D3D3D' : '#FFFFFF',\n\n    isDark,\n  };\n}\n","path":null,"size_bytes":1104,"size_tokens":null},"server/replit_integrations/chat/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport OpenAI from \"openai\";\nimport { chatStorage } from \"./storage\";\n\nconst openai = new OpenAI({\n  apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY,\n  baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n});\n\nexport function registerChatRoutes(app: Express): void {\n  // Get all conversations\n  app.get(\"/api/conversations\", async (req: Request, res: Response) => {\n    try {\n      const conversations = await chatStorage.getAllConversations();\n      res.json(conversations);\n    } catch (error) {\n      console.error(\"Error fetching conversations:\", error);\n      res.status(500).json({ error: \"Failed to fetch conversations\" });\n    }\n  });\n\n  // Get single conversation with messages\n  app.get(\"/api/conversations/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      const conversation = await chatStorage.getConversation(id);\n      if (!conversation) {\n        return res.status(404).json({ error: \"Conversation not found\" });\n      }\n      const messages = await chatStorage.getMessagesByConversation(id);\n      res.json({ ...conversation, messages });\n    } catch (error) {\n      console.error(\"Error fetching conversation:\", error);\n      res.status(500).json({ error: \"Failed to fetch conversation\" });\n    }\n  });\n\n  // Create new conversation\n  app.post(\"/api/conversations\", async (req: Request, res: Response) => {\n    try {\n      const { title } = req.body;\n      const conversation = await chatStorage.createConversation(title || \"New Chat\");\n      res.status(201).json(conversation);\n    } catch (error) {\n      console.error(\"Error creating conversation:\", error);\n      res.status(500).json({ error: \"Failed to create conversation\" });\n    }\n  });\n\n  // Delete conversation\n  app.delete(\"/api/conversations/:id\", async (req: Request, res: Response) => {\n    try {\n      const id = parseInt(req.params.id);\n      await chatStorage.deleteConversation(id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting conversation:\", error);\n      res.status(500).json({ error: \"Failed to delete conversation\" });\n    }\n  });\n\n  // Send message and get AI response (streaming)\n  app.post(\"/api/conversations/:id/messages\", async (req: Request, res: Response) => {\n    try {\n      const conversationId = parseInt(req.params.id);\n      const { content } = req.body;\n\n      // Save user message\n      await chatStorage.createMessage(conversationId, \"user\", content);\n\n      // Get conversation history for context\n      const messages = await chatStorage.getMessagesByConversation(conversationId);\n      const chatMessages = messages.map((m) => ({\n        role: m.role as \"user\" | \"assistant\",\n        content: m.content,\n      }));\n\n      // Set up SSE\n      res.setHeader(\"Content-Type\", \"text/event-stream\");\n      res.setHeader(\"Cache-Control\", \"no-cache\");\n      res.setHeader(\"Connection\", \"keep-alive\");\n\n      // Stream response from OpenAI\n      const stream = await openai.chat.completions.create({\n        model: \"gpt-5.1\",\n        messages: chatMessages,\n        stream: true,\n        max_completion_tokens: 2048,\n      });\n\n      let fullResponse = \"\";\n\n      for await (const chunk of stream) {\n        const content = chunk.choices[0]?.delta?.content || \"\";\n        if (content) {\n          fullResponse += content;\n          res.write(`data: ${JSON.stringify({ content })}\\n\\n`);\n        }\n      }\n\n      // Save assistant message\n      await chatStorage.createMessage(conversationId, \"assistant\", fullResponse);\n\n      res.write(`data: ${JSON.stringify({ done: true })}\\n\\n`);\n      res.end();\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      // Check if headers already sent (SSE streaming started)\n      if (res.headersSent) {\n        res.write(`data: ${JSON.stringify({ error: \"Failed to send message\" })}\\n\\n`);\n        res.end();\n      } else {\n        res.status(500).json({ error: \"Failed to send message\" });\n      }\n    }\n  });\n}\n\n","path":null,"size_bytes":4044,"size_tokens":null},"server/replit_integrations/image/index.ts":{"content":"export { registerImageRoutes } from \"./routes\";\nexport { openai, generateImageBuffer, editImages } from \"./client\";\n\n","path":null,"size_bytes":117,"size_tokens":null},"packages/shared/src/types/index.ts":{"content":"/**\n * @medinvest/shared - Types\n * \n * All TypeScript types shared between web and mobile apps.\n * This is the SINGLE SOURCE OF TRUTH for data structures.\n */\n\n// =============================================================================\n// USER TYPES\n// =============================================================================\n\nexport interface User {\n  id: number;\n  email: string;\n  full_name: string;\n  username?: string;\n  avatar_url?: string;\n  bio?: string;\n  specialty?: string;\n  credentials?: string;\n  location?: string;\n  website?: string;\n  is_verified: boolean;\n  is_premium: boolean;\n  is_admin: boolean;\n  followers_count: number;\n  following_count: number;\n  posts_count: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface UserProfile extends User {\n  is_following: boolean;\n  is_blocked: boolean;\n  is_muted: boolean;\n  mutual_followers_count: number;\n}\n\nexport interface UserPreview {\n  id: number;\n  full_name: string;\n  username?: string;\n  avatar_url?: string;\n  specialty?: string;\n  is_verified: boolean;\n}\n\n// =============================================================================\n// POST TYPES\n// =============================================================================\n\nexport interface Post {\n  id: number;\n  author: UserPreview;\n  content: string;\n  room?: Room;\n  is_anonymous: boolean;\n  images?: string[];\n  video_url?: string;\n  poll?: Poll;\n  likes_count: number;\n  comments_count: number;\n  shares_count: number;\n  views_count: number;\n  is_liked: boolean;\n  is_bookmarked: boolean;\n  is_pinned: boolean;\n  reactions: ReactionCount[];\n  user_reaction?: ReactionType;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface PostCreate {\n  content: string;\n  room_id?: number;\n  is_anonymous?: boolean;\n  images?: string[];\n  video_url?: string;\n  poll?: PollCreate;\n}\n\nexport interface PostUpdate {\n  content?: string;\n}\n\n// =============================================================================\n// COMMENT TYPES\n// =============================================================================\n\nexport interface Comment {\n  id: number;\n  post_id: number;\n  author: UserPreview;\n  content: string;\n  parent_id?: number;\n  replies?: Comment[];\n  likes_count: number;\n  replies_count: number;\n  is_liked: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface CommentCreate {\n  content: string;\n  parent_id?: number;\n}\n\n// =============================================================================\n// REACTION TYPES\n// =============================================================================\n\nexport const REACTION_TYPES = [\n  'like',\n  'love',\n  'laugh',\n  'wow',\n  'sad',\n  'fire',\n  'thinking',\n  'clap',\n] as const;\n\nexport type ReactionType = (typeof REACTION_TYPES)[number];\n\nexport interface ReactionCount {\n  type: ReactionType;\n  count: number;\n}\n\nexport const REACTION_EMOJIS: Record<ReactionType, string> = {\n  like: 'üëç',\n  love: '‚ù§Ô∏è',\n  laugh: 'üòÇ',\n  wow: 'üòÆ',\n  sad: 'üò¢',\n  fire: 'üî•',\n  thinking: 'ü§î',\n  clap: 'üëè',\n};\n\n// =============================================================================\n// POLL TYPES\n// =============================================================================\n\nexport interface Poll {\n  id: string;\n  question: string;\n  options: PollOption[];\n  total_votes: number;\n  ends_at?: string;\n  has_voted: boolean;\n  user_vote?: string;\n  allow_multiple: boolean;\n  is_anonymous: boolean;\n}\n\nexport interface PollOption {\n  id: string;\n  text: string;\n  votes: number;\n  percentage?: number;\n}\n\nexport interface PollCreate {\n  question: string;\n  options: string[];\n  duration?: PollDuration;\n  allow_multiple?: boolean;\n  is_anonymous?: boolean;\n}\n\nexport type PollDuration = '1day' | '3days' | '7days' | 'none';\n\n// =============================================================================\n// ROOM TYPES\n// =============================================================================\n\nexport interface Room {\n  id: number;\n  name: string;\n  slug: string;\n  description?: string;\n  icon?: string;\n  color?: string;\n  members_count: number;\n  posts_count: number;\n  is_joined: boolean;\n  created_at: string;\n}\n\nexport const ROOM_SPECIALTIES = [\n  'Cardiology',\n  'Dermatology',\n  'Emergency Medicine',\n  'Endocrinology',\n  'Family Medicine',\n  'Gastroenterology',\n  'General Surgery',\n  'Hematology',\n  'Infectious Disease',\n  'Internal Medicine',\n  'Nephrology',\n  'Neurology',\n  'Obstetrics & Gynecology',\n  'Oncology',\n  'Ophthalmology',\n  'Orthopedics',\n  'Pediatrics',\n  'Psychiatry',\n  'Pulmonology',\n  'Radiology',\n  'Rheumatology',\n  'Urology',\n] as const;\n\nexport type RoomSpecialty = (typeof ROOM_SPECIALTIES)[number];\n\n// =============================================================================\n// MESSAGE TYPES\n// =============================================================================\n\nexport interface Conversation {\n  id: number;\n  participants: UserPreview[];\n  last_message?: Message;\n  unread_count: number;\n  is_muted: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface Message {\n  id: number;\n  conversation_id: number;\n  sender: UserPreview;\n  content: string;\n  attachments?: Attachment[];\n  status: MessageStatus;\n  read_at?: string;\n  created_at: string;\n}\n\nexport type MessageStatus = 'sending' | 'sent' | 'delivered' | 'read' | 'failed';\n\nexport interface Attachment {\n  id: string;\n  type: AttachmentType;\n  url: string;\n  thumbnail_url?: string;\n  filename?: string;\n  size?: number;\n}\n\nexport type AttachmentType = 'image' | 'video' | 'file';\n\nexport interface MessageCreate {\n  content: string;\n  attachments?: string[];\n}\n\n// =============================================================================\n// NOTIFICATION TYPES\n// =============================================================================\n\nexport interface Notification {\n  id: number;\n  type: NotificationType;\n  title: string;\n  body: string;\n  data?: NotificationData;\n  is_read: boolean;\n  created_at: string;\n}\n\nexport type NotificationType =\n  | 'like'\n  | 'comment'\n  | 'reply'\n  | 'mention'\n  | 'follow'\n  | 'message'\n  | 'deal_update'\n  | 'system'\n  | 'achievement';\n\nexport interface NotificationData {\n  post_id?: number;\n  comment_id?: number;\n  user_id?: number;\n  deal_id?: number;\n  url?: string;\n}\n\n// =============================================================================\n// DEAL TYPES\n// =============================================================================\n\nexport interface Deal {\n  id: number;\n  title: string;\n  company_name: string;\n  description: string;\n  sector: string;\n  stage: DealStage;\n  minimum_investment: number;\n  target_raise: number;\n  current_raise: number;\n  valuation?: number;\n  logo_url?: string;\n  cover_image_url?: string;\n  documents?: DealDocument[];\n  deadline?: string;\n  is_featured: boolean;\n  is_watching: boolean;\n  investors_count: number;\n  created_at: string;\n}\n\nexport type DealStage =\n  | 'seed'\n  | 'series_a'\n  | 'series_b'\n  | 'series_c'\n  | 'growth'\n  | 'pre_ipo';\n\nexport const DEAL_STAGES: DealStage[] = [\n  'seed',\n  'series_a',\n  'series_b',\n  'series_c',\n  'growth',\n  'pre_ipo',\n];\n\nexport const DEAL_STAGE_LABELS: Record<DealStage, string> = {\n  seed: 'Seed',\n  series_a: 'Series A',\n  series_b: 'Series B',\n  series_c: 'Series C',\n  growth: 'Growth',\n  pre_ipo: 'Pre-IPO',\n};\n\nexport interface DealDocument {\n  id: string;\n  name: string;\n  type: string;\n  url: string;\n}\n\nexport const DEAL_SECTORS = [\n  'Biotech',\n  'Digital Health',\n  'Medical Devices',\n  'Healthcare Services',\n  'Pharmaceuticals',\n  'Health IT',\n  'Diagnostics',\n  'Telehealth',\n] as const;\n\nexport type DealSector = (typeof DEAL_SECTORS)[number];\n\n// =============================================================================\n// SEARCH TYPES\n// =============================================================================\n\nexport interface SearchResults {\n  posts: Post[];\n  users: UserPreview[];\n  rooms: Room[];\n  deals: Deal[];\n  hashtags: HashtagResult[];\n  has_more: boolean;\n}\n\nexport interface HashtagResult {\n  tag: string;\n  post_count: number;\n}\n\nexport interface SearchFilters {\n  type?: SearchType;\n  room_id?: number;\n  date_from?: string;\n  date_to?: string;\n  sort_by?: SearchSort;\n}\n\nexport type SearchType = 'all' | 'posts' | 'users' | 'rooms' | 'deals';\nexport type SearchSort = 'relevance' | 'recent' | 'popular';\n\n// =============================================================================\n// PAGINATION\n// =============================================================================\n\nexport interface PaginatedResponse<T> {\n  data: T[];\n  pagination: PaginationMeta;\n}\n\nexport interface PaginationMeta {\n  page: number;\n  limit: number;\n  total: number;\n  has_more: boolean;\n}\n\nexport interface PaginationParams {\n  page?: number;\n  limit?: number;\n}\n\n// =============================================================================\n// API RESPONSE TYPES\n// =============================================================================\n\nexport interface ApiResponse<T> {\n  success: true;\n  data: T;\n  message?: string;\n}\n\nexport interface ApiError {\n  success: false;\n  error: {\n    code: string;\n    message: string;\n    details?: Record<string, string[]>;\n  };\n}\n\nexport type ApiResult<T> = ApiResponse<T> | ApiError;\n\n// =============================================================================\n// AUTH TYPES\n// =============================================================================\n\nexport interface LoginRequest {\n  email: string;\n  password: string;\n}\n\nexport interface LoginResponse {\n  token: string;\n  refresh_token: string;\n  user: User;\n}\n\nexport interface RegisterRequest {\n  email: string;\n  password: string;\n  full_name: string;\n  specialty?: string;\n}\n\nexport interface RegisterResponse {\n  user: User;\n  message: string;\n}\n\nexport interface RefreshTokenRequest {\n  refresh_token: string;\n}\n\nexport interface RefreshTokenResponse {\n  token: string;\n  refresh_token: string;\n}\n\n// =============================================================================\n// SETTINGS TYPES\n// =============================================================================\n\nexport interface NotificationSettings {\n  enabled: boolean;\n  likes: boolean;\n  comments: boolean;\n  mentions: boolean;\n  follows: boolean;\n  direct_messages: boolean;\n  message_requests: boolean;\n  new_posts: boolean;\n  trending_posts: boolean;\n  room_activity: boolean;\n  new_deals: boolean;\n  deal_updates: boolean;\n  investment_alerts: boolean;\n  announcements: boolean;\n  security_alerts: boolean;\n  weekly_digest: boolean;\n  quiet_hours_enabled: boolean;\n  quiet_hours_start: string;\n  quiet_hours_end: string;\n}\n\nexport interface ContentPreferences {\n  hide_nsfw: boolean;\n  blur_sensitive_images: boolean;\n  hide_spoilers: boolean;\n  show_trending_posts: boolean;\n  show_suggested_users: boolean;\n  show_promoted_content: boolean;\n  autoplay_videos: AutoplayOption;\n  reduce_animations: boolean;\n  compact_mode: boolean;\n  content_languages: string[];\n  translate_posts: boolean;\n  muted_keywords: string[];\n  show_post_metrics: boolean;\n  show_user_badges: boolean;\n  confirm_before_posting: boolean;\n}\n\nexport type AutoplayOption = 'always' | 'wifi' | 'never';\n\nexport interface PrivacySettings {\n  profile_visibility: ProfileVisibility;\n  allow_messages_from: MessagePermission;\n  show_online_status: boolean;\n  show_read_receipts: boolean;\n  allow_tagging: boolean;\n  allow_mentions: boolean;\n}\n\nexport type ProfileVisibility = 'public' | 'followers' | 'private';\nexport type MessagePermission = 'everyone' | 'followers' | 'none';\n\n// =============================================================================\n// WEBSOCKET EVENT TYPES\n// =============================================================================\n\nexport type WebSocketEvent =\n  | { type: 'message'; data: Message }\n  | { type: 'typing'; data: TypingEvent }\n  | { type: 'message_read'; data: MessageReadEvent }\n  | { type: 'notification'; data: Notification }\n  | { type: 'user_online'; data: { user_id: number } }\n  | { type: 'user_offline'; data: { user_id: number } }\n  | { type: 'post_updated'; data: { post_id: number; updates: Partial<Post> } }\n  | { type: 'post_deleted'; data: { post_id: number } };\n\nexport interface TypingEvent {\n  conversation_id: number;\n  user_id: number;\n  is_typing: boolean;\n}\n\nexport interface MessageReadEvent {\n  conversation_id: number;\n  message_id: number;\n  user_id: number;\n}\n\n// =============================================================================\n// REPORT TYPES\n// =============================================================================\n\nexport interface Report {\n  id: number;\n  type: ReportTargetType;\n  target_id: number;\n  reporter_id: number;\n  reason: ReportReason;\n  details?: string;\n  status: ReportStatus;\n  created_at: string;\n}\n\nexport type ReportTargetType = 'user' | 'post' | 'comment' | 'message';\n\nexport type ReportReason =\n  | 'spam'\n  | 'harassment'\n  | 'hate_speech'\n  | 'misinformation'\n  | 'inappropriate'\n  | 'violence'\n  | 'self_harm'\n  | 'other';\n\nexport type ReportStatus = 'pending' | 'reviewed' | 'resolved' | 'dismissed';\n\nexport const REPORT_REASONS: { value: ReportReason; label: string }[] = [\n  { value: 'spam', label: 'Spam or misleading' },\n  { value: 'harassment', label: 'Harassment or bullying' },\n  { value: 'hate_speech', label: 'Hate speech' },\n  { value: 'misinformation', label: 'Misinformation' },\n  { value: 'inappropriate', label: 'Inappropriate content' },\n  { value: 'violence', label: 'Violence or threats' },\n  { value: 'self_harm', label: 'Self-harm or suicide' },\n  { value: 'other', label: 'Other' },\n];\n\n// =============================================================================\n// MUTE TYPES\n// =============================================================================\n\nexport interface MuteSettings {\n  user_id: number;\n  mute_posts: boolean;\n  mute_comments: boolean;\n  mute_messages: boolean;\n  mute_notifications: boolean;\n  duration: MuteDuration;\n  expires_at?: string;\n}\n\nexport type MuteDuration = '1hour' | '8hours' | '24hours' | '7days' | '30days' | 'forever';\n\nexport const MUTE_DURATIONS: { value: MuteDuration; label: string }[] = [\n  { value: '1hour', label: '1 hour' },\n  { value: '8hours', label: '8 hours' },\n  { value: '24hours', label: '24 hours' },\n  { value: '7days', label: '7 days' },\n  { value: '30days', label: '30 days' },\n  { value: 'forever', label: 'Forever' },\n];\n","path":null,"size_bytes":14493,"size_tokens":null},"client/screens/InvestModalScreen.tsx":{"content":"import React, { useState, useLayoutEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  Platform,\n  Alert,\n} from \"react-native\";\nimport { useRoute, useNavigation, RouteProp } from \"@react-navigation/native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport * as Haptics from \"expo-haptics\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  withSequence,\n  withTiming,\n} from \"react-native-reanimated\";\n\nimport { KeyboardAwareScrollViewCompat } from \"@/components/KeyboardAwareScrollViewCompat\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows, Typography } from \"@/constants/theme\";\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { investmentOpportunities } from \"@/lib/mockData\";\nimport { storage } from \"@/lib/storage\";\nimport { RootStackParamList } from \"@/navigation/RootStackNavigator\";\n\ntype RouteParams = RouteProp<RootStackParamList, \"InvestModal\">;\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nconst presetAmounts = [1000, 2500, 5000, 10000];\n\nexport default function InvestModalScreen() {\n  const route = useRoute<RouteParams>();\n  const navigation = useNavigation();\n  const insets = useSafeAreaInsets();\n  const { theme } = useTheme();\n  const appColors = useAppColors();\n\n  const [amount, setAmount] = useState(\"\");\n  const [riskAcknowledged, setRiskAcknowledged] = useState(false);\n  const [termsAccepted, setTermsAccepted] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n\n  const buttonScale = useSharedValue(1);\n  const successScale = useSharedValue(0);\n  const successOpacity = useSharedValue(0);\n\n  const opportunity = route.params?.opportunityId\n    ? investmentOpportunities.find((opp) => opp.id === route.params.opportunityId)\n    : investmentOpportunities[0];\n\n  const amountValue = parseFloat(amount.replace(/,/g, \"\")) || 0;\n  const isValid = amountValue >= 1000 && riskAcknowledged && termsAccepted;\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerLeft: () => (\n        <Pressable onPress={() => navigation.goBack()} hitSlop={8}>\n          <ThemedText type=\"body\" style={{ color: Colors.primary }}>\n            Cancel\n          </ThemedText>\n        </Pressable>\n      ),\n    });\n  }, [navigation]);\n\n  const handleAmountChange = (text: string) => {\n    const cleaned = text.replace(/[^0-9]/g, \"\");\n    if (cleaned) {\n      setAmount(parseInt(cleaned, 10).toLocaleString());\n    } else {\n      setAmount(\"\");\n    }\n  };\n\n  const handlePresetAmount = (value: number) => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    setAmount(value.toLocaleString());\n  };\n\n  const handleSubmit = async () => {\n    if (!isValid || !opportunity) return;\n\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    setIsSubmitting(true);\n\n    await storage.saveInvestment({\n      id: `inv-${Date.now()}`,\n      opportunityId: opportunity.id,\n      amount: amountValue,\n      date: new Date().toISOString(),\n      status: \"active\",\n    });\n\n    setShowSuccess(true);\n    successScale.value = withSpring(1, { damping: 10, stiffness: 100 });\n    successOpacity.value = withTiming(1, { duration: 300 });\n\n    if (Platform.OS !== \"web\") {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n\n    setTimeout(() => {\n      navigation.goBack();\n    }, 1500);\n  };\n\n  const buttonAnimatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: buttonScale.value }],\n  }));\n\n  const successAnimatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: successScale.value }],\n    opacity: successOpacity.value,\n  }));\n\n  const handlePressIn = () => {\n    if (isValid) {\n      buttonScale.value = withSpring(0.98, { damping: 15, stiffness: 150 });\n    }\n  };\n\n  const handlePressOut = () => {\n    buttonScale.value = withSpring(1, { damping: 15, stiffness: 150 });\n  };\n\n  if (showSuccess) {\n    return (\n      <View style={[styles.successContainer, { backgroundColor: theme.backgroundRoot }]}>\n        <Animated.View style={[styles.successContent, successAnimatedStyle]}>\n          <View style={styles.successIcon}>\n            <LinearGradient\n              colors={[Colors.gradient.start, Colors.gradient.end]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.successIconGradient}\n            >\n              <Feather name=\"check\" size={48} color=\"#FFFFFF\" />\n            </LinearGradient>\n          </View>\n          <ThemedText type=\"title\" style={styles.successTitle}>\n            Investment Submitted\n          </ThemedText>\n          <ThemedText\n            type=\"body\"\n            style={[styles.successText, { color: theme.textSecondary }]}\n          >\n            Your ${amountValue.toLocaleString()} investment in{\" \"}\n            {opportunity?.title} has been submitted successfully.\n          </ThemedText>\n        </Animated.View>\n      </View>\n    );\n  }\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <KeyboardAwareScrollViewCompat\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.content,\n          { paddingBottom: insets.bottom + 100 },\n        ]}\n      >\n        {opportunity ? (\n          <View\n            style={[\n              styles.opportunityCard,\n              { backgroundColor: theme.backgroundDefault },\n              Shadows.card,\n            ]}\n          >\n            <ThemedText type=\"heading\">{opportunity.title}</ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              by {opportunity.company}\n            </ThemedText>\n            <View style={styles.opportunityMeta}>\n              <View style={styles.metaItem}>\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                  Expected ROI\n                </ThemedText>\n                <ThemedText type=\"body\" style={{ color: Colors.secondary, fontWeight: \"600\" }}>\n                  {opportunity.expectedROI}\n                </ThemedText>\n              </View>\n              <View style={styles.metaItem}>\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                  Risk Level\n                </ThemedText>\n                <ThemedText\n                  type=\"body\"\n                  style={{\n                    color:\n                      opportunity.riskLevel === \"high\"\n                        ? appColors.error\n                        : opportunity.riskLevel === \"medium\"\n                        ? appColors.warning\n                        : Colors.secondary,\n                    fontWeight: \"600\",\n                    textTransform: \"capitalize\",\n                  }}\n                >\n                  {opportunity.riskLevel}\n                </ThemedText>\n              </View>\n            </View>\n          </View>\n        ) : null}\n\n        <View style={styles.section}>\n          <ThemedText type=\"heading\" style={styles.sectionTitle}>\n            Investment Amount\n          </ThemedText>\n          <View\n            style={[\n              styles.amountInput,\n              { backgroundColor: theme.backgroundDefault, borderColor: appColors.border },\n            ]}\n          >\n            <ThemedText type=\"title\" style={{ color: theme.textSecondary }}>\n              $\n            </ThemedText>\n            <TextInput\n              style={[styles.amountTextInput, { color: theme.text }]}\n              value={amount}\n              onChangeText={handleAmountChange}\n              placeholder=\"0\"\n              placeholderTextColor={theme.textSecondary}\n              keyboardType=\"number-pad\"\n            />\n          </View>\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n            Minimum investment: $1,000\n          </ThemedText>\n\n          <View style={styles.presetAmounts}>\n            {presetAmounts.map((preset) => (\n              <Pressable\n                key={preset}\n                onPress={() => handlePresetAmount(preset)}\n                style={[\n                  styles.presetButton,\n                  {\n                    backgroundColor:\n                      amountValue === preset\n                        ? Colors.primary\n                        : theme.backgroundSecondary,\n                  },\n                ]}\n              >\n                <ThemedText\n                  type=\"caption\"\n                  style={{\n                    color: amountValue === preset ? \"#FFFFFF\" : theme.text,\n                    fontWeight: \"500\",\n                  }}\n                >\n                  ${preset.toLocaleString()}\n                </ThemedText>\n              </Pressable>\n            ))}\n          </View>\n        </View>\n\n        <View style={styles.section}>\n          <ThemedText type=\"heading\" style={styles.sectionTitle}>\n            Payment Method\n          </ThemedText>\n          <Pressable\n            style={[\n              styles.paymentMethod,\n              { backgroundColor: theme.backgroundDefault },\n              Shadows.card,\n            ]}\n          >\n            <View style={[styles.paymentIcon, { backgroundColor: Colors.primary + \"15\" }]}>\n              <Feather name=\"credit-card\" size={20} color={Colors.primary} />\n            </View>\n            <View style={styles.paymentInfo}>\n              <ThemedText type=\"body\">Bank Account</ThemedText>\n              <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                **** 4242\n              </ThemedText>\n            </View>\n            <Feather name=\"check\" size={20} color={Colors.primary} />\n          </Pressable>\n        </View>\n\n        <View style={styles.section}>\n          <ThemedText type=\"heading\" style={styles.sectionTitle}>\n            Acknowledgments\n          </ThemedText>\n\n          <Pressable\n            onPress={() => setRiskAcknowledged(!riskAcknowledged)}\n            style={styles.checkboxRow}\n          >\n            <View\n              style={[\n                styles.checkbox,\n                {\n                  backgroundColor: riskAcknowledged\n                    ? Colors.primary\n                    : \"transparent\",\n                  borderColor: riskAcknowledged ? Colors.primary : appColors.border,\n                },\n              ]}\n            >\n              {riskAcknowledged ? (\n                <Feather name=\"check\" size={14} color=\"#FFFFFF\" />\n              ) : null}\n            </View>\n            <ThemedText type=\"caption\" style={styles.checkboxLabel}>\n              I understand that this investment carries risks and I may lose some\n              or all of my investment.\n            </ThemedText>\n          </Pressable>\n\n          <Pressable\n            onPress={() => setTermsAccepted(!termsAccepted)}\n            style={styles.checkboxRow}\n          >\n            <View\n              style={[\n                styles.checkbox,\n                {\n                  backgroundColor: termsAccepted\n                    ? Colors.primary\n                    : \"transparent\",\n                  borderColor: termsAccepted ? Colors.primary : appColors.border,\n                },\n              ]}\n            >\n              {termsAccepted ? (\n                <Feather name=\"check\" size={14} color=\"#FFFFFF\" />\n              ) : null}\n            </View>\n            <ThemedText type=\"caption\" style={styles.checkboxLabel}>\n              I agree to the Terms of Service and Privacy Policy.\n            </ThemedText>\n          </Pressable>\n        </View>\n      </KeyboardAwareScrollViewCompat>\n\n      <View\n        style={[\n          styles.bottomBar,\n          {\n            backgroundColor: theme.backgroundDefault,\n            paddingBottom: insets.bottom + Spacing.lg,\n            borderTopColor: appColors.border,\n          },\n        ]}\n      >\n        <View style={styles.summaryRow}>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            Total Investment\n          </ThemedText>\n          <ThemedText type=\"title\">${amountValue.toLocaleString()}</ThemedText>\n        </View>\n\n        <AnimatedPressable\n          onPress={handleSubmit}\n          onPressIn={handlePressIn}\n          onPressOut={handlePressOut}\n          disabled={!isValid || isSubmitting}\n          style={[styles.submitButton, buttonAnimatedStyle, !isValid && { opacity: 0.5 }]}\n        >\n          <LinearGradient\n            colors={[Colors.gradient.start, Colors.gradient.end]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={styles.submitButtonGradient}\n          >\n            <ThemedText type=\"body\" style={styles.submitButtonText}>\n              {isSubmitting ? \"Processing...\" : \"Confirm Investment\"}\n            </ThemedText>\n          </LinearGradient>\n        </AnimatedPressable>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  content: {\n    padding: Spacing.xl,\n  },\n  opportunityCard: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.xl,\n  },\n  opportunityMeta: {\n    flexDirection: \"row\",\n    marginTop: Spacing.md,\n    gap: Spacing.xl,\n  },\n  metaItem: {\n    gap: Spacing.xs,\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    marginBottom: Spacing.md,\n  },\n  amountInput: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    marginBottom: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  amountTextInput: {\n    flex: 1,\n    ...Typography.title,\n  },\n  presetAmounts: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n    marginTop: Spacing.md,\n  },\n  presetButton: {\n    flex: 1,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    alignItems: \"center\",\n  },\n  paymentMethod: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.md,\n  },\n  paymentIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.xs,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  paymentInfo: {\n    flex: 1,\n  },\n  checkboxRow: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.md,\n    gap: Spacing.md,\n  },\n  checkbox: {\n    width: 22,\n    height: 22,\n    borderRadius: 6,\n    borderWidth: 2,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: 2,\n  },\n  checkboxLabel: {\n    flex: 1,\n  },\n  bottomBar: {\n    padding: Spacing.lg,\n    paddingTop: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  summaryRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: Spacing.md,\n  },\n  submitButton: {\n    borderRadius: BorderRadius.full,\n    overflow: \"hidden\",\n  },\n  submitButtonGradient: {\n    height: Spacing.buttonHeight,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  submitButtonText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n  successContainer: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing.xl,\n  },\n  successContent: {\n    alignItems: \"center\",\n  },\n  successIcon: {\n    marginBottom: Spacing.xl,\n  },\n  successIconGradient: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  successTitle: {\n    marginBottom: Spacing.sm,\n    textAlign: \"center\",\n  },\n  successText: {\n    textAlign: \"center\",\n  },\n});\n","path":null,"size_bytes":15873,"size_tokens":null},"client/lib/deep-linking.ts":{"content":"/**\n * Deep Linking Configuration\n * Handle app links and universal links\n */\n\nimport { LinkingOptions } from '@react-navigation/native';\nimport * as Linking from 'expo-linking';\nimport { RootStackParamList } from '@/types';\n\n// URL scheme prefixes\nconst SCHEME = 'medinvest';\nconst UNIVERSAL_LINK_DOMAINS = ['app.medinvest.com', 'medinvest.com'];\n\n/**\n * Deep linking configuration for React Navigation\n */\nexport const linkingConfig: LinkingOptions<RootStackParamList> = {\n  prefixes: [\n    Linking.createURL('/'),\n    `${SCHEME}://`,\n    ...UNIVERSAL_LINK_DOMAINS.map(domain => `https://${domain}`),\n  ],\n  \n  config: {\n    screens: {\n      // Auth screens\n      Auth: {\n        screens: {\n          Login: 'login',\n          Register: 'register',\n          ForgotPassword: 'forgot-password',\n          VerifyEmail: 'verify-email/:token',\n          ResetPassword: 'reset-password/:token',\n        },\n      },\n      \n      // Main tabs\n      Main: {\n        screens: {\n          Home: 'feed',\n          Discover: 'deals',\n          Messages: 'messages',\n          Profile: 'profile',\n        },\n      },\n      \n      // Content screens\n      PostDetail: 'post/:postId',\n      UserProfile: 'user/:userId',\n      RoomDetail: 'room/:roomSlug',\n      Hashtag: 'hashtag/:tag',\n      DealDetail: 'deal/:dealId',\n      AMADetail: 'ama/:amaId',\n      CourseDetail: 'course/:courseId',\n      EventDetail: 'event/:eventId',\n      \n      // Messaging\n      Conversation: 'conversation/:userId',\n      NewConversation: 'new-conversation',\n      \n      // Profile & Settings\n      EditProfile: 'edit-profile',\n      Followers: 'user/:userId/followers',\n      Following: 'user/:userId/following',\n      Bookmarks: 'bookmarks',\n      Settings: 'settings',\n      Premium: 'premium',\n      \n      // Gamification\n      Leaderboard: 'leaderboard',\n      Achievements: 'achievements',\n      \n      // AI Chat\n      AIChat: 'ai-chat',\n      \n      // Other\n      Notifications: 'notifications',\n      Search: 'search',\n      CreatePost: 'create-post',\n    },\n  },\n\n  // Custom URL parsing\n  getStateFromPath: (path, options) => {\n    // Handle special URL patterns\n    if (path.startsWith('/invite/')) {\n      const code = path.replace('/invite/', '');\n      return {\n        routes: [\n          {\n            name: 'Auth',\n            state: {\n              routes: [\n                {\n                  name: 'Register',\n                  params: { referralCode: code },\n                },\n              ],\n            },\n          },\n        ],\n      };\n    }\n\n    // Handle shared post URLs\n    if (path.match(/^\\/p\\/[a-zA-Z0-9]+$/)) {\n      const postId = path.replace('/p/', '');\n      return {\n        routes: [\n          {\n            name: 'Main',\n            state: {\n              routes: [{ name: 'Home' }],\n            },\n          },\n          {\n            name: 'PostDetail',\n            params: { postId },\n          },\n        ],\n      };\n    }\n\n    // Use default parsing\n    return undefined;\n  },\n};\n\n/**\n * Handle incoming deep links\n */\nexport async function handleDeepLink(url: string): Promise<{\n  screen: string;\n  params?: Record<string, unknown>;\n} | null> {\n  const parsed = Linking.parse(url);\n  \n  if (!parsed.path) return null;\n\n  // Parse path segments\n  const segments = parsed.path.split('/').filter(Boolean);\n  \n  if (segments.length === 0) return null;\n\n  const [first, second, third] = segments;\n\n  switch (first) {\n    case 'post':\n      return { screen: 'PostDetail', params: { postId: parseInt(second, 10) } };\n    case 'user':\n      if (third === 'followers') {\n        return { screen: 'Followers', params: { userId: parseInt(second, 10), type: 'followers' } };\n      }\n      if (third === 'following') {\n        return { screen: 'Followers', params: { userId: parseInt(second, 10), type: 'following' } };\n      }\n      return { screen: 'UserProfile', params: { userId: parseInt(second, 10) } };\n    case 'room':\n      return { screen: 'RoomDetail', params: { roomSlug: second } };\n    case 'deal':\n      return { screen: 'DealDetail', params: { dealId: parseInt(second, 10) } };\n    case 'ama':\n      return { screen: 'AMADetail', params: { amaId: parseInt(second, 10) } };\n    case 'hashtag':\n      return { screen: 'Hashtag', params: { tag: second } };\n    case 'conversation':\n      return { screen: 'Conversation', params: { userId: parseInt(second, 10) } };\n    case 'invite':\n      return { screen: 'Register', params: { referralCode: second } };\n    case 'verify-email':\n      return { screen: 'VerifyEmail', params: { token: second } };\n    case 'reset-password':\n      return { screen: 'ResetPassword', params: { token: second } };\n    case 'auth':\n      return { screen: 'OAuthCallback', params: { token: parsed.queryParams?.token, error: parsed.queryParams?.error } };\n    default:\n      return null;\n  }\n}\n\n/**\n * Generate shareable deep link URL\n */\nexport function generateDeepLink(\n  type: 'post' | 'user' | 'room' | 'deal' | 'ama' | 'hashtag' | 'invite',\n  id: string | number\n): string {\n  const baseUrl = `https://${UNIVERSAL_LINK_DOMAINS[0]}`;\n  \n  switch (type) {\n    case 'post':\n      return `${baseUrl}/post/${id}`;\n    case 'user':\n      return `${baseUrl}/user/${id}`;\n    case 'room':\n      return `${baseUrl}/room/${id}`;\n    case 'deal':\n      return `${baseUrl}/deal/${id}`;\n    case 'ama':\n      return `${baseUrl}/ama/${id}`;\n    case 'hashtag':\n      return `${baseUrl}/hashtag/${id}`;\n    case 'invite':\n      return `${baseUrl}/invite/${id}`;\n    default:\n      return baseUrl;\n  }\n}\n\n/**\n * Generate app-specific deep link (for internal use)\n */\nexport function generateAppLink(\n  type: 'post' | 'user' | 'room' | 'deal',\n  id: string | number\n): string {\n  return `${SCHEME}://${type}/${id}`;\n}\n\n/**\n * Check if URL is a valid deep link\n */\nexport function isValidDeepLink(url: string): boolean {\n  try {\n    const parsed = Linking.parse(url);\n    const isScheme = url.startsWith(`${SCHEME}://`);\n    const isUniversal = UNIVERSAL_LINK_DOMAINS.some(domain => \n      url.includes(domain)\n    );\n    return isScheme || isUniversal;\n  } catch {\n    return false;\n  }\n}\n","path":null,"size_bytes":6128,"size_tokens":null},"client/lib/haptics.ts":{"content":"/**\n * Haptic Feedback Service\n * Centralized haptic feedback for native feel\n */\n\nimport { Platform } from 'react-native';\nimport * as Haptics from 'expo-haptics';\n\nexport type HapticType = \n  | 'light'\n  | 'medium'\n  | 'heavy'\n  | 'success'\n  | 'warning'\n  | 'error'\n  | 'selection';\n\nclass HapticService {\n  private enabled: boolean = true;\n\n  setEnabled(enabled: boolean) {\n    this.enabled = enabled;\n  }\n\n  isEnabled(): boolean {\n    return this.enabled;\n  }\n\n  async trigger(type: HapticType = 'medium'): Promise<void> {\n    if (!this.enabled || Platform.OS === 'web') return;\n\n    try {\n      switch (type) {\n        case 'light':\n          await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n          break;\n        case 'medium':\n          await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n          break;\n        case 'heavy':\n          await Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n          break;\n        case 'success':\n          await Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n          break;\n        case 'warning':\n          await Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);\n          break;\n        case 'error':\n          await Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n          break;\n        case 'selection':\n          await Haptics.selectionAsync();\n          break;\n      }\n    } catch (error) {\n      console.debug('[Haptics] Failed to trigger:', error);\n    }\n  }\n\n  buttonPress() {\n    return this.trigger('light');\n  }\n\n  tabChange() {\n    return this.trigger('selection');\n  }\n\n  toggle() {\n    return this.trigger('medium');\n  }\n\n  pullToRefresh() {\n    return this.trigger('medium');\n  }\n\n  success() {\n    return this.trigger('success');\n  }\n\n  error() {\n    return this.trigger('error');\n  }\n\n  warning() {\n    return this.trigger('warning');\n  }\n\n  selection() {\n    return this.trigger('selection');\n  }\n\n  longPress() {\n    return this.trigger('heavy');\n  }\n\n  swipeAction() {\n    return this.trigger('medium');\n  }\n\n  like() {\n    return this.trigger('light');\n  }\n\n  modalOpen() {\n    return this.trigger('light');\n  }\n\n  modalClose() {\n    return this.trigger('light');\n  }\n\n  navigate() {\n    return this.trigger('selection');\n  }\n\n  refreshComplete() {\n    return this.trigger('success');\n  }\n\n  delete() {\n    return this.trigger('warning');\n  }\n\n  undo() {\n    return this.trigger('medium');\n  }\n}\n\nexport const haptics = new HapticService();\n\nexport { Haptics };\n","path":null,"size_bytes":2528,"size_tokens":null},"IMPLEMENTATION_GUIDE.md":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"client/lib/realtime-messaging.ts":{"content":"/**\n * Real-time Messaging Service\n * WebSocket-based typing indicators and message sync\n */\n\nimport { useEffect, useCallback, useRef, useState } from 'react';\nimport { AppState, AppStateStatus } from 'react-native';\n\nexport interface TypingUser {\n  id: number;\n  full_name: string;\n}\n\nexport interface TypingEvent {\n  conversationId: number;\n  user: TypingUser;\n  isTyping: boolean;\n}\n\nexport interface MessageReadEvent {\n  conversationId: number;\n  messageId: number;\n  userId: number;\n  readAt: string;\n}\n\nexport interface NewMessageEvent {\n  conversationId: number;\n  message: {\n    id: number;\n    content: string;\n    sender_id: number;\n    created_at: string;\n  };\n}\n\ntype EventType = 'typing' | 'message_read' | 'new_message' | 'user_online' | 'user_offline';\n\ninterface WebSocketMessage {\n  type: EventType | 'ping';\n  data: any;\n}\n\ntype TypingCallback = (event: TypingEvent) => void;\ntype MessageReadCallback = (event: MessageReadEvent) => void;\ntype NewMessageCallback = (event: NewMessageEvent) => void;\ntype ConnectionCallback = (connected: boolean) => void;\n\nclass RealtimeMessagingService {\n  private ws: WebSocket | null = null;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 5;\n  private reconnectDelay = 1000;\n  private heartbeatInterval: NodeJS.Timeout | null = null;\n  private typingCallbacks: Map<number, TypingCallback[]> = new Map();\n  private messageReadCallbacks: Map<number, MessageReadCallback[]> = new Map();\n  private newMessageCallbacks: NewMessageCallback[] = [];\n  private connectionCallbacks: ConnectionCallback[] = [];\n  private currentUserId: number | null = null;\n  private authToken: string | null = null;\n\n  initialize(userId: number, token: string) {\n    this.currentUserId = userId;\n    this.authToken = token;\n  }\n\n  connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      if (!this.authToken) {\n        reject(new Error('Not authenticated'));\n        return;\n      }\n\n      try {\n        this.simulateConnection();\n        resolve();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  private simulateConnection() {\n    console.log('[RealtimeMessaging] Simulating WebSocket connection');\n    this.notifyConnectionChange(true);\n    this.startHeartbeat();\n  }\n\n  disconnect() {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n    }\n    this.stopHeartbeat();\n    this.notifyConnectionChange(false);\n  }\n\n  private startHeartbeat() {\n    this.heartbeatInterval = setInterval(() => {\n      this.send({ type: 'ping', data: {} });\n    }, 30000);\n  }\n\n  private stopHeartbeat() {\n    if (this.heartbeatInterval) {\n      clearInterval(this.heartbeatInterval);\n      this.heartbeatInterval = null;\n    }\n  }\n\n  private send(message: WebSocketMessage) {\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify(message));\n    }\n  }\n\n  sendTyping(conversationId: number, isTyping: boolean) {\n    this.send({\n      type: 'typing',\n      data: { conversationId, isTyping },\n    });\n  }\n\n  sendMessageRead(conversationId: number, messageId: number) {\n    this.send({\n      type: 'message_read',\n      data: { conversationId, messageId },\n    });\n  }\n\n  subscribeToTyping(conversationId: number, callback: TypingCallback): () => void {\n    const callbacks = this.typingCallbacks.get(conversationId) || [];\n    callbacks.push(callback);\n    this.typingCallbacks.set(conversationId, callbacks);\n\n    return () => {\n      const updated = this.typingCallbacks.get(conversationId)?.filter(cb => cb !== callback) || [];\n      this.typingCallbacks.set(conversationId, updated);\n    };\n  }\n\n  subscribeToMessageRead(conversationId: number, callback: MessageReadCallback): () => void {\n    const callbacks = this.messageReadCallbacks.get(conversationId) || [];\n    callbacks.push(callback);\n    this.messageReadCallbacks.set(conversationId, callbacks);\n\n    return () => {\n      const updated = this.messageReadCallbacks.get(conversationId)?.filter(cb => cb !== callback) || [];\n      this.messageReadCallbacks.set(conversationId, updated);\n    };\n  }\n\n  subscribeToNewMessages(callback: NewMessageCallback): () => void {\n    this.newMessageCallbacks.push(callback);\n\n    return () => {\n      this.newMessageCallbacks = this.newMessageCallbacks.filter(cb => cb !== callback);\n    };\n  }\n\n  subscribeToConnection(callback: ConnectionCallback): () => void {\n    this.connectionCallbacks.push(callback);\n\n    return () => {\n      this.connectionCallbacks = this.connectionCallbacks.filter(cb => cb !== callback);\n    };\n  }\n\n  private notifyConnectionChange(connected: boolean) {\n    this.connectionCallbacks.forEach(cb => cb(connected));\n  }\n}\n\nexport const realtimeMessaging = new RealtimeMessagingService();\n\nexport function useTypingIndicator(conversationId: number) {\n  const [typingUsers, setTypingUsers] = useState<TypingUser[]>([]);\n  const typingTimeoutRef = useRef<Map<number, NodeJS.Timeout>>(new Map());\n\n  useEffect(() => {\n    const unsubscribe = realtimeMessaging.subscribeToTyping(conversationId, (event) => {\n      if (event.isTyping) {\n        setTypingUsers(prev => {\n          if (prev.some(u => u.id === event.user.id)) return prev;\n          return [...prev, event.user];\n        });\n\n        const existingTimeout = typingTimeoutRef.current.get(event.user.id);\n        if (existingTimeout) clearTimeout(existingTimeout);\n\n        const timeout = setTimeout(() => {\n          setTypingUsers(prev => prev.filter(u => u.id !== event.user.id));\n          typingTimeoutRef.current.delete(event.user.id);\n        }, 3000);\n\n        typingTimeoutRef.current.set(event.user.id, timeout);\n      } else {\n        setTypingUsers(prev => prev.filter(u => u.id !== event.user.id));\n        const timeout = typingTimeoutRef.current.get(event.user.id);\n        if (timeout) {\n          clearTimeout(timeout);\n          typingTimeoutRef.current.delete(event.user.id);\n        }\n      }\n    });\n\n    return () => {\n      unsubscribe();\n      typingTimeoutRef.current.forEach(timeout => clearTimeout(timeout));\n      typingTimeoutRef.current.clear();\n    };\n  }, [conversationId]);\n\n  const sendTyping = useCallback((isTyping: boolean) => {\n    realtimeMessaging.sendTyping(conversationId, isTyping);\n  }, [conversationId]);\n\n  return { typingUsers, sendTyping };\n}\n\nexport function useReadReceipts(conversationId: number) {\n  const [readReceipts, setReadReceipts] = useState<Map<number, MessageReadEvent>>(new Map());\n\n  useEffect(() => {\n    const unsubscribe = realtimeMessaging.subscribeToMessageRead(conversationId, (event) => {\n      setReadReceipts(prev => new Map(prev).set(event.messageId, event));\n    });\n\n    return unsubscribe;\n  }, [conversationId]);\n\n  const markAsRead = useCallback((messageId: number) => {\n    realtimeMessaging.sendMessageRead(conversationId, messageId);\n  }, [conversationId]);\n\n  const getReadStatus = useCallback((messageId: number) => {\n    return readReceipts.get(messageId);\n  }, [readReceipts]);\n\n  return { readReceipts, markAsRead, getReadStatus };\n}\n\nexport function useRealtimeConnection(userId: number | null, token: string | null) {\n  const [isConnected, setIsConnected] = useState(false);\n\n  useEffect(() => {\n    if (!userId || !token) return;\n\n    realtimeMessaging.initialize(userId, token);\n    realtimeMessaging.connect();\n\n    const unsubscribe = realtimeMessaging.subscribeToConnection(setIsConnected);\n\n    const handleAppStateChange = (state: AppStateStatus) => {\n      if (state === 'active') {\n        realtimeMessaging.connect();\n      } else if (state === 'background') {\n        realtimeMessaging.disconnect();\n      }\n    };\n\n    const subscription = AppState.addEventListener('change', handleAppStateChange);\n\n    return () => {\n      unsubscribe();\n      subscription.remove();\n      realtimeMessaging.disconnect();\n    };\n  }, [userId, token]);\n\n  return { isConnected };\n}\n","path":null,"size_bytes":7874,"size_tokens":null},"client/lib/widgets.ts":{"content":"/**\n * iOS Widgets Configuration\n * Home screen widgets for portfolio stats, notifications, and quick actions\n * \n * Note: This file provides the React Native side configuration.\n * Actual widget implementation requires native Swift code in the iOS project.\n */\n\nimport { Platform, NativeModules } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\n// Widget data types\nexport interface PortfolioWidgetData {\n  totalValue: number;\n  totalReturn: number;\n  returnPercentage: number;\n  topHolding?: {\n    name: string;\n    value: number;\n    change: number;\n  };\n  lastUpdated: string;\n}\n\nexport interface NotificationsWidgetData {\n  unreadCount: number;\n  recentNotifications: Array<{\n    id: string;\n    type: string;\n    title: string;\n    body: string;\n    timestamp: string;\n  }>;\n  lastUpdated: string;\n}\n\nexport interface QuickStatsWidgetData {\n  postsToday: number;\n  newFollowers: number;\n  unreadMessages: number;\n  pendingDeals: number;\n  lastUpdated: string;\n}\n\nexport interface TrendingWidgetData {\n  topics: Array<{\n    tag: string;\n    postCount: number;\n  }>;\n  lastUpdated: string;\n}\n\n// Widget identifiers\nexport const WIDGET_KINDS = {\n  PORTFOLIO_SMALL: 'PortfolioWidgetSmall',\n  PORTFOLIO_MEDIUM: 'PortfolioWidgetMedium',\n  NOTIFICATIONS: 'NotificationsWidget',\n  QUICK_STATS: 'QuickStatsWidget',\n  TRENDING: 'TrendingWidget',\n} as const;\n\n// Storage keys for widget data\nconst WIDGET_DATA_KEYS = {\n  PORTFOLIO: 'widget_data_portfolio',\n  NOTIFICATIONS: 'widget_data_notifications',\n  QUICK_STATS: 'widget_data_quick_stats',\n  TRENDING: 'widget_data_trending',\n};\n\n// App Group identifier for sharing data with widgets\nconst APP_GROUP_ID = 'group.com.medinvest.app';\n\n/**\n * iOS Widgets Service\n * Manages data sharing between the app and iOS widgets\n */\nclass WidgetsService {\n  private isIOS = Platform.OS === 'ios';\n\n  /**\n   * Update portfolio widget data\n   */\n  async updatePortfolioWidget(data: PortfolioWidgetData): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      const widgetData = {\n        ...data,\n        lastUpdated: new Date().toISOString(),\n      };\n\n      // Store in AsyncStorage for app use\n      await AsyncStorage.setItem(\n        WIDGET_DATA_KEYS.PORTFOLIO,\n        JSON.stringify(widgetData)\n      );\n\n      // Store in shared App Group for widget access\n      await this.writeToAppGroup('portfolio', widgetData);\n\n      // Request widget refresh\n      await this.reloadWidgets([WIDGET_KINDS.PORTFOLIO_SMALL, WIDGET_KINDS.PORTFOLIO_MEDIUM]);\n    } catch (error) {\n      console.error('[Widgets] Error updating portfolio widget:', error);\n    }\n  }\n\n  /**\n   * Update notifications widget data\n   */\n  async updateNotificationsWidget(data: NotificationsWidgetData): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      const widgetData = {\n        ...data,\n        lastUpdated: new Date().toISOString(),\n      };\n\n      await AsyncStorage.setItem(\n        WIDGET_DATA_KEYS.NOTIFICATIONS,\n        JSON.stringify(widgetData)\n      );\n\n      await this.writeToAppGroup('notifications', widgetData);\n      await this.reloadWidgets([WIDGET_KINDS.NOTIFICATIONS]);\n    } catch (error) {\n      console.error('[Widgets] Error updating notifications widget:', error);\n    }\n  }\n\n  /**\n   * Update quick stats widget data\n   */\n  async updateQuickStatsWidget(data: QuickStatsWidgetData): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      const widgetData = {\n        ...data,\n        lastUpdated: new Date().toISOString(),\n      };\n\n      await AsyncStorage.setItem(\n        WIDGET_DATA_KEYS.QUICK_STATS,\n        JSON.stringify(widgetData)\n      );\n\n      await this.writeToAppGroup('quickStats', widgetData);\n      await this.reloadWidgets([WIDGET_KINDS.QUICK_STATS]);\n    } catch (error) {\n      console.error('[Widgets] Error updating quick stats widget:', error);\n    }\n  }\n\n  /**\n   * Update trending widget data\n   */\n  async updateTrendingWidget(data: TrendingWidgetData): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      const widgetData = {\n        ...data,\n        lastUpdated: new Date().toISOString(),\n      };\n\n      await AsyncStorage.setItem(\n        WIDGET_DATA_KEYS.TRENDING,\n        JSON.stringify(widgetData)\n      );\n\n      await this.writeToAppGroup('trending', widgetData);\n      await this.reloadWidgets([WIDGET_KINDS.TRENDING]);\n    } catch (error) {\n      console.error('[Widgets] Error updating trending widget:', error);\n    }\n  }\n\n  /**\n   * Update all widgets at once\n   */\n  async updateAllWidgets(data: {\n    portfolio?: PortfolioWidgetData;\n    notifications?: NotificationsWidgetData;\n    quickStats?: QuickStatsWidgetData;\n    trending?: TrendingWidgetData;\n  }): Promise<void> {\n    const updates: Promise<void>[] = [];\n\n    if (data.portfolio) {\n      updates.push(this.updatePortfolioWidget(data.portfolio));\n    }\n    if (data.notifications) {\n      updates.push(this.updateNotificationsWidget(data.notifications));\n    }\n    if (data.quickStats) {\n      updates.push(this.updateQuickStatsWidget(data.quickStats));\n    }\n    if (data.trending) {\n      updates.push(this.updateTrendingWidget(data.trending));\n    }\n\n    await Promise.all(updates);\n  }\n\n  /**\n   * Write data to shared App Group container\n   * This allows iOS widgets to access the data\n   */\n  private async writeToAppGroup(key: string, data: any): Promise<void> {\n    try {\n      // Use native module to write to App Group\n      if (NativeModules.WidgetKit) {\n        await NativeModules.WidgetKit.setItem(key, JSON.stringify(data), APP_GROUP_ID);\n      }\n    } catch (error) {\n      // Fallback: Native module not available\n      console.log('[Widgets] WidgetKit native module not available');\n    }\n  }\n\n  /**\n   * Request iOS to reload specific widgets\n   */\n  private async reloadWidgets(kinds: string[]): Promise<void> {\n    try {\n      if (NativeModules.WidgetKit) {\n        await NativeModules.WidgetKit.reloadTimelines(kinds);\n      }\n    } catch (error) {\n      console.log('[Widgets] Could not reload widgets');\n    }\n  }\n\n  /**\n   * Reload all widgets\n   */\n  async reloadAllWidgets(): Promise<void> {\n    try {\n      if (NativeModules.WidgetKit) {\n        await NativeModules.WidgetKit.reloadAllTimelines();\n      }\n    } catch (error) {\n      console.log('[Widgets] Could not reload all widgets');\n    }\n  }\n\n  /**\n   * Get cached widget data\n   */\n  async getCachedPortfolioData(): Promise<PortfolioWidgetData | null> {\n    try {\n      const data = await AsyncStorage.getItem(WIDGET_DATA_KEYS.PORTFOLIO);\n      return data ? JSON.parse(data) : null;\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Clear all widget data (e.g., on logout)\n   */\n  async clearAllWidgetData(): Promise<void> {\n    try {\n      await Promise.all([\n        AsyncStorage.removeItem(WIDGET_DATA_KEYS.PORTFOLIO),\n        AsyncStorage.removeItem(WIDGET_DATA_KEYS.NOTIFICATIONS),\n        AsyncStorage.removeItem(WIDGET_DATA_KEYS.QUICK_STATS),\n        AsyncStorage.removeItem(WIDGET_DATA_KEYS.TRENDING),\n      ]);\n\n      // Clear App Group data\n      if (NativeModules.WidgetKit) {\n        await NativeModules.WidgetKit.clearAllData(APP_GROUP_ID);\n      }\n\n      // Reload widgets to show empty/logged out state\n      await this.reloadAllWidgets();\n    } catch (error) {\n      console.error('[Widgets] Error clearing widget data:', error);\n    }\n  }\n}\n\nexport const widgetsService = new WidgetsService();\n\n/**\n * Hook to sync widget data when app data changes\n */\nexport function useWidgetSync() {\n  const syncPortfolio = async (portfolioData: any) => {\n    if (!portfolioData) return;\n\n    await widgetsService.updatePortfolioWidget({\n      totalValue: portfolioData.totalValue || 0,\n      totalReturn: portfolioData.totalReturn || 0,\n      returnPercentage: portfolioData.returnPercentage || 0,\n      topHolding: portfolioData.holdings?.[0],\n      lastUpdated: new Date().toISOString(),\n    });\n  };\n\n  const syncNotifications = async (notifications: any[], unreadCount: number) => {\n    await widgetsService.updateNotificationsWidget({\n      unreadCount,\n      recentNotifications: notifications.slice(0, 5).map(n => ({\n        id: n.id,\n        type: n.type,\n        title: n.title || '',\n        body: n.body || '',\n        timestamp: n.created_at,\n      })),\n      lastUpdated: new Date().toISOString(),\n    });\n  };\n\n  const syncQuickStats = async (stats: {\n    postsToday?: number;\n    newFollowers?: number;\n    unreadMessages?: number;\n    pendingDeals?: number;\n  }) => {\n    await widgetsService.updateQuickStatsWidget({\n      postsToday: stats.postsToday || 0,\n      newFollowers: stats.newFollowers || 0,\n      unreadMessages: stats.unreadMessages || 0,\n      pendingDeals: stats.pendingDeals || 0,\n      lastUpdated: new Date().toISOString(),\n    });\n  };\n\n  const clearOnLogout = async () => {\n    await widgetsService.clearAllWidgetData();\n  };\n\n  return {\n    syncPortfolio,\n    syncNotifications,\n    syncQuickStats,\n    clearOnLogout,\n    reloadAll: () => widgetsService.reloadAllWidgets(),\n  };\n}\n\n// Widget deep link handlers\nexport const WIDGET_DEEP_LINKS = {\n  PORTFOLIO: 'medinvest://portfolio',\n  NOTIFICATIONS: 'medinvest://notifications',\n  NEW_POST: 'medinvest://post/new',\n  MESSAGES: 'medinvest://messages',\n  SEARCH: 'medinvest://search',\n  TRENDING: 'medinvest://trending',\n};\n","path":null,"size_bytes":9325,"size_tokens":null},"server/services/socialAuth.ts":{"content":"import jwt from 'jsonwebtoken';\nimport jwksClient from 'jwks-rsa';\n\n// ============================================\n// Facebook Sign In Verification\n// ============================================\n\ninterface FacebookUserPayload {\n  sub: string;\n  email?: string;\n  name?: string;\n  picture?: string;\n  first_name?: string;\n  last_name?: string;\n}\n\n/**\n * Verify Facebook access token and get user info\n */\nexport async function verifyFacebookToken(\n  accessToken: string\n): Promise<FacebookUserPayload | null> {\n  try {\n    // Fetch user info from Facebook Graph API\n    const userResponse = await fetch(\n      `https://graph.facebook.com/me?fields=id,name,email,first_name,last_name,picture.type(large)&access_token=${accessToken}`\n    );\n\n    if (!userResponse.ok) {\n      console.error('Facebook user fetch failed:', userResponse.status);\n      return null;\n    }\n\n    const userData = await userResponse.json();\n\n    return {\n      sub: userData.id,\n      email: userData.email,\n      name: userData.name,\n      picture: userData.picture?.data?.url,\n      first_name: userData.first_name,\n      last_name: userData.last_name,\n    };\n  } catch (error) {\n    console.error('Facebook token verification failed:', error);\n    return null;\n  }\n}\n\n// ============================================\n// GitHub Sign In Verification\n// ============================================\n\ninterface GitHubUserPayload {\n  sub: string;\n  email?: string;\n  name?: string;\n  picture?: string;\n  login: string;\n}\n\n/**\n * Exchange GitHub OAuth code for access token and get user info\n */\nexport async function verifyGithubToken(\n  accessToken: string\n): Promise<GitHubUserPayload | null> {\n  try {\n    // Fetch user info from GitHub\n    const userResponse = await fetch('https://api.github.com/user', {\n      headers: {\n        Authorization: `Bearer ${accessToken}`,\n        Accept: 'application/vnd.github.v3+json',\n      },\n    });\n\n    if (!userResponse.ok) {\n      console.error('GitHub user fetch failed:', userResponse.status);\n      return null;\n    }\n\n    const userData = await userResponse.json();\n\n    // Fetch primary email if not public\n    let email = userData.email;\n    if (!email) {\n      const emailResponse = await fetch('https://api.github.com/user/emails', {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n          Accept: 'application/vnd.github.v3+json',\n        },\n      });\n\n      if (emailResponse.ok) {\n        const emails = await emailResponse.json();\n        const primaryEmail = emails.find(\n          (e: any) => e.primary && e.verified\n        );\n        email = primaryEmail?.email;\n      }\n    }\n\n    return {\n      sub: String(userData.id),\n      email,\n      name: userData.name,\n      picture: userData.avatar_url,\n      login: userData.login,\n    };\n  } catch (error) {\n    console.error('GitHub token verification failed:', error);\n    return null;\n  }\n}\n\n// ============================================\n// Apple Sign In Verification\n// ============================================\n\nconst appleJwksClient = jwksClient({\n  jwksUri: 'https://appleid.apple.com/auth/keys',\n  cache: true,\n  cacheMaxAge: 86400000, // 1 day\n});\n\ninterface AppleTokenPayload {\n  iss: string;\n  sub: string;\n  aud: string;\n  exp: number;\n  iat: number;\n  email?: string;\n  email_verified?: string;\n  is_private_email?: string;\n  auth_time: number;\n  nonce_supported: boolean;\n}\n\n/**\n * Verify Apple Sign In identity token\n */\nexport async function verifyAppleToken(\n  identityToken: string\n): Promise<AppleTokenPayload | null> {\n  try {\n    // Decode the token header to get the key id\n    const decodedHeader = jwt.decode(identityToken, { complete: true });\n    \n    if (!decodedHeader || typeof decodedHeader === 'string') {\n      return null;\n    }\n\n    const kid = decodedHeader.header.kid;\n\n    // Get the signing key from Apple\n    const signingKey = await appleJwksClient.getSigningKey(kid);\n    const publicKey = signingKey.getPublicKey();\n\n    const audiences = [\n      process.env.APPLE_CLIENT_ID,\n      'com.medinvest.app',\n      'host.exp.Exponent',\n    ].filter(Boolean) as string[];\n\n    const payload = jwt.verify(identityToken, publicKey, {\n      algorithms: ['RS256'],\n      issuer: 'https://appleid.apple.com',\n    }) as AppleTokenPayload;\n\n    if (!audiences.includes(payload.aud)) {\n      console.error('Apple token audience mismatch. Got:', payload.aud, 'Expected one of:', audiences);\n      return null;\n    }\n\n    return payload;\n  } catch (error) {\n    console.error('Apple token verification failed:', error);\n    return null;\n  }\n}\n\n// ============================================\n// Google Sign In Verification\n// ============================================\n\ninterface GoogleTokenPayload {\n  iss: string;\n  azp: string;\n  aud: string;\n  sub: string;\n  email?: string;\n  email_verified?: boolean;\n  name?: string;\n  picture?: string;\n  given_name?: string;\n  family_name?: string;\n  locale?: string;\n  iat: number;\n  exp: number;\n}\n\n/**\n * Verify Google Sign In access token\n */\nexport async function verifyGoogleToken(\n  accessToken: string\n): Promise<GoogleTokenPayload | null> {\n  try {\n    // Fetch user info from Google\n    const response = await fetch(\n      `https://www.googleapis.com/oauth2/v3/userinfo`,\n      {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n        },\n      }\n    );\n\n    if (!response.ok) {\n      console.error('Google token verification failed:', response.status);\n      return null;\n    }\n\n    const userInfo = await response.json();\n\n    return {\n      iss: 'https://accounts.google.com',\n      azp: '',\n      aud: '',\n      sub: userInfo.sub,\n      email: userInfo.email,\n      email_verified: userInfo.email_verified,\n      name: userInfo.name,\n      picture: userInfo.picture,\n      given_name: userInfo.given_name,\n      family_name: userInfo.family_name,\n      locale: userInfo.locale,\n      iat: Math.floor(Date.now() / 1000),\n      exp: Math.floor(Date.now() / 1000) + 3600,\n    };\n  } catch (error) {\n    console.error('Google token verification failed:', error);\n    return null;\n  }\n}\n\n/**\n * Alternative: Verify Google ID token (for web/native clients that provide id_token)\n */\nexport async function verifyGoogleIdToken(\n  idToken: string\n): Promise<GoogleTokenPayload | null> {\n  try {\n    const response = await fetch(\n      `https://oauth2.googleapis.com/tokeninfo?id_token=${idToken}`\n    );\n\n    if (!response.ok) {\n      return null;\n    }\n\n    const payload = await response.json();\n\n    // Verify audience matches our client ID\n    const validClientIds = [\n      process.env.GOOGLE_WEB_CLIENT_ID,\n      process.env.GOOGLE_IOS_CLIENT_ID,\n      process.env.GOOGLE_ANDROID_CLIENT_ID,\n    ].filter(Boolean);\n\n    if (!validClientIds.includes(payload.aud)) {\n      console.error('Google token has invalid audience');\n      return null;\n    }\n\n    return payload;\n  } catch (error) {\n    console.error('Google ID token verification failed:', error);\n    return null;\n  }\n}\n","path":null,"size_bytes":6987,"size_tokens":null},"client/components/ImageViewer.tsx":{"content":"/**\n * Image Viewer Modal\n * Full-screen image gallery with zoom and swipe\n */\n\nimport React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Modal,\n  TouchableOpacity,\n  Dimensions,\n  FlatList,\n  Image,\n  StatusBar,\n  Animated,\n  PanResponder,\n  Share,\n  Alert,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as MediaLibrary from 'expo-media-library';\nimport * as FileSystem from 'expo-file-system';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, Typography } from '@/constants/theme';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\ninterface ImageViewerProps {\n  visible: boolean;\n  images: string[];\n  initialIndex?: number;\n  onClose: () => void;\n}\n\nexport default function ImageViewer({\n  visible,\n  images,\n  initialIndex = 0,\n  onClose,\n}: ImageViewerProps) {\n  const [currentIndex, setCurrentIndex] = useState(initialIndex);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const flatListRef = useRef<FlatList>(null);\n  const opacity = useRef(new Animated.Value(1)).current;\n  const translateY = useRef(new Animated.Value(0)).current;\n\n  // Pan responder for swipe-to-dismiss\n  const panResponder = useRef(\n    PanResponder.create({\n      onMoveShouldSetPanResponder: (_, gestureState) => {\n        return !isZoomed && Math.abs(gestureState.dy) > 10;\n      },\n      onPanResponderMove: (_, gestureState) => {\n        translateY.setValue(gestureState.dy);\n        const newOpacity = 1 - Math.abs(gestureState.dy) / 300;\n        opacity.setValue(Math.max(0.5, newOpacity));\n      },\n      onPanResponderRelease: (_, gestureState) => {\n        if (Math.abs(gestureState.dy) > 100) {\n          Animated.parallel([\n            Animated.timing(translateY, {\n              toValue: gestureState.dy > 0 ? SCREEN_HEIGHT : -SCREEN_HEIGHT,\n              duration: 200,\n              useNativeDriver: true,\n            }),\n            Animated.timing(opacity, {\n              toValue: 0,\n              duration: 200,\n              useNativeDriver: true,\n            }),\n          ]).start(() => {\n            handleClose();\n          });\n        } else {\n          Animated.parallel([\n            Animated.spring(translateY, {\n              toValue: 0,\n              useNativeDriver: true,\n            }),\n            Animated.spring(opacity, {\n              toValue: 1,\n              useNativeDriver: true,\n            }),\n          ]).start();\n        }\n      },\n    })\n  ).current;\n\n  const handleClose = useCallback(() => {\n    translateY.setValue(0);\n    opacity.setValue(1);\n    onClose();\n  }, [onClose]);\n\n  const handleViewableItemsChanged = useCallback(\n    ({ viewableItems }: { viewableItems: Array<{ index: number | null }> }) => {\n      if (viewableItems.length > 0 && viewableItems[0].index !== null) {\n        setCurrentIndex(viewableItems[0].index);\n      }\n    },\n    []\n  );\n\n  const handleShare = useCallback(async () => {\n    try {\n      await Share.share({\n        url: images[currentIndex],\n        message: 'Check out this image!',\n      });\n    } catch (error) {\n      console.error('Share error:', error);\n    }\n  }, [images, currentIndex]);\n\n  const handleDownload = useCallback(async () => {\n    try {\n      const { status } = await MediaLibrary.requestPermissionsAsync();\n      if (status !== 'granted') {\n        Alert.alert('Permission needed', 'Please grant access to save images');\n        return;\n      }\n\n      const imageUrl = images[currentIndex];\n      const filename = `medinvest_${Date.now()}.jpg`;\n      const fileUri = `${FileSystem.documentDirectory}${filename}`;\n\n      const { uri } = await FileSystem.downloadAsync(imageUrl, fileUri);\n      await MediaLibrary.saveToLibraryAsync(uri);\n      \n      Alert.alert('Saved', 'Image saved to your gallery');\n    } catch (error) {\n      Alert.alert('Error', 'Failed to save image');\n      console.error('Download error:', error);\n    }\n  }, [images, currentIndex]);\n\n  const renderImage = ({ item }: { item: string }) => (\n    <View style={styles.imageContainer}>\n      <Image\n        source={{ uri: item }}\n        style={styles.image}\n        resizeMode=\"contain\"\n      />\n    </View>\n  );\n\n  return (\n    <Modal\n      visible={visible}\n      animationType=\"fade\"\n      transparent\n      onRequestClose={handleClose}\n      statusBarTranslucent\n    >\n      <StatusBar barStyle=\"light-content\" backgroundColor=\"black\" />\n      \n      <Animated.View\n        style={[\n          styles.container,\n          {\n            opacity,\n            backgroundColor: opacity.interpolate({\n              inputRange: [0, 1],\n              outputRange: ['rgba(0,0,0,0)', 'rgba(0,0,0,1)'],\n            }),\n          },\n        ]}\n      >\n        {/* Header */}\n        <View style={styles.header}>\n          <TouchableOpacity style={styles.headerButton} onPress={handleClose}>\n            <Ionicons name=\"close\" size={28} color=\"white\" />\n          </TouchableOpacity>\n          \n          {images.length > 1 && (\n            <ThemedText style={styles.counter}>\n              {currentIndex + 1} / {images.length}\n            </ThemedText>\n          )}\n          \n          <View style={styles.headerActions}>\n            <TouchableOpacity style={styles.headerButton} onPress={handleShare}>\n              <Ionicons name=\"share-outline\" size={24} color=\"white\" />\n            </TouchableOpacity>\n            <TouchableOpacity style={styles.headerButton} onPress={handleDownload}>\n              <Ionicons name=\"download-outline\" size={24} color=\"white\" />\n            </TouchableOpacity>\n          </View>\n        </View>\n\n        {/* Image Gallery */}\n        <Animated.View\n          style={[\n            styles.galleryContainer,\n            { transform: [{ translateY }] },\n          ]}\n          {...panResponder.panHandlers}\n        >\n          <FlatList\n            ref={flatListRef}\n            data={images}\n            renderItem={renderImage}\n            keyExtractor={(_, index) => index.toString()}\n            horizontal\n            pagingEnabled\n            showsHorizontalScrollIndicator={false}\n            initialScrollIndex={initialIndex}\n            getItemLayout={(_, index) => ({\n              length: SCREEN_WIDTH,\n              offset: SCREEN_WIDTH * index,\n              index,\n            })}\n            onViewableItemsChanged={handleViewableItemsChanged}\n            viewabilityConfig={{\n              itemVisiblePercentThreshold: 50,\n            }}\n          />\n        </Animated.View>\n\n        {/* Dots Indicator */}\n        {images.length > 1 && images.length <= 10 && (\n          <View style={styles.dotsContainer}>\n            {images.map((_, index) => (\n              <View\n                key={index}\n                style={[\n                  styles.dot,\n                  index === currentIndex && styles.dotActive,\n                ]}\n              />\n            ))}\n          </View>\n        )}\n      </Animated.View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'black',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingTop: Spacing['3xl'],\n    paddingBottom: Spacing.md,\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    zIndex: 10,\n    backgroundColor: 'rgba(0,0,0,0.5)',\n  },\n  headerButton: {\n    width: 44,\n    height: 44,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerActions: {\n    flexDirection: 'row',\n  },\n  counter: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  galleryContainer: {\n    flex: 1,\n  },\n  imageContainer: {\n    width: SCREEN_WIDTH,\n    height: SCREEN_HEIGHT,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  image: {\n    width: SCREEN_WIDTH,\n    height: SCREEN_HEIGHT - 100,\n  },\n  dotsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingBottom: Spacing['3xl'],\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n  },\n  dot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: 'rgba(255,255,255,0.4)',\n    marginHorizontal: 4,\n  },\n  dotActive: {\n    backgroundColor: 'white',\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n  },\n});\n","path":null,"size_bytes":8348,"size_tokens":null},"client/navigation/MainTabNavigator.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Pressable } from \"react-native\";\nimport { createBottomTabNavigator } from \"@react-navigation/bottom-tabs\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { BlurView } from \"expo-blur\";\nimport { Platform } from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\n\nimport DiscoverStackNavigator from \"@/navigation/DiscoverStackNavigator\";\nimport PortfolioStackNavigator from \"@/navigation/PortfolioStackNavigator\";\nimport ResearchStackNavigator from \"@/navigation/ResearchStackNavigator\";\nimport ProfileStackNavigator from \"@/navigation/ProfileStackNavigator\";\nimport NotificationsStackNavigator from \"@/navigation/NotificationsStackNavigator\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Shadows, Spacing } from \"@/constants/theme\";\nimport { RootStackParamList } from \"@/navigation/RootStackNavigator\";\n\nexport type MainTabParamList = {\n  DiscoverTab: undefined;\n  PortfolioTab: undefined;\n  NotificationsTab: undefined;\n  ResearchTab: undefined;\n  ProfileTab: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nfunction FloatingActionButton() {\n  const navigation =\n    useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const insets = useSafeAreaInsets();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.92, { damping: 15, stiffness: 150 });\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, { damping: 15, stiffness: 150 });\n  };\n\n  const handlePress = () => {\n    navigation.navigate(\"InvestModal\", { opportunityId: undefined });\n  };\n\n  const tabBarHeight = 49 + insets.bottom;\n\n  return (\n    <AnimatedPressable\n      onPress={handlePress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={[\n        styles.fab,\n        { bottom: tabBarHeight + Spacing.lg },\n        Shadows.fab,\n        animatedStyle,\n      ]}\n    >\n      <LinearGradient\n        colors={[Colors.gradient.start, Colors.gradient.end]}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={styles.fabGradient}\n      >\n        <Feather name=\"plus\" size={28} color=\"#FFFFFF\" />\n      </LinearGradient>\n    </AnimatedPressable>\n  );\n}\n\nexport default function MainTabNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <View style={styles.container}>\n      <Tab.Navigator\n        initialRouteName=\"DiscoverTab\"\n        screenOptions={{\n          tabBarActiveTintColor: Colors.primary,\n          tabBarInactiveTintColor: theme.tabIconDefault,\n          tabBarStyle: {\n            position: \"absolute\",\n            backgroundColor: Platform.select({\n              ios: \"transparent\",\n              android: theme.backgroundDefault,\n            }),\n            borderTopWidth: 0,\n            elevation: 0,\n          },\n          tabBarBackground: () =>\n            Platform.OS === \"ios\" ? (\n              <BlurView\n                intensity={100}\n                tint={isDark ? \"dark\" : \"light\"}\n                style={StyleSheet.absoluteFill}\n              />\n            ) : null,\n          headerShown: false,\n        }}\n      >\n        <Tab.Screen\n          name=\"DiscoverTab\"\n          component={DiscoverStackNavigator}\n          options={{\n            title: \"Discover\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"compass\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"PortfolioTab\"\n          component={PortfolioStackNavigator}\n          options={{\n            title: \"Portfolio\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"pie-chart\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"NotificationsTab\"\n          component={NotificationsStackNavigator}\n          options={{\n            title: \"Alerts\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"bell\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"ResearchTab\"\n          component={ResearchStackNavigator}\n          options={{\n            title: \"Research\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"book-open\" size={size} color={color} />\n            ),\n          }}\n        />\n        <Tab.Screen\n          name=\"ProfileTab\"\n          component={ProfileStackNavigator}\n          options={{\n            title: \"Profile\",\n            tabBarIcon: ({ color, size }) => (\n              <Feather name=\"user\" size={size} color={color} />\n            ),\n          }}\n        />\n      </Tab.Navigator>\n      <FloatingActionButton />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  fab: {\n    position: \"absolute\",\n    right: Spacing.xl,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    overflow: \"hidden\",\n  },\n  fabGradient: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":5528,"size_tokens":null},"server/routes/index.ts":{"content":"import type { Express } from 'express';\nimport { createServer, type Server } from 'node:http';\n\nimport authRoutes from './auth';\nimport investmentsRoutes from './investments';\nimport portfolioRoutes from './portfolio';\nimport articlesRoutes from './articles';\nimport usersRoutes from './users';\nimport messagesRoutes from './messages';\nimport postsRoutes from './posts';\nimport roomsRoutes from './rooms';\nimport dealsRoutes from './deals';\nimport notificationsRoutes from './notifications';\nimport aiRoutes from './ai';\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Health check\n  app.get('/api/health', (req, res) => {\n    res.json({ status: 'ok', timestamp: new Date().toISOString() });\n  });\n\n  // API routes\n  app.use('/api/auth', authRoutes);\n  app.use('/api/investments', investmentsRoutes);\n  app.use('/api/portfolio', portfolioRoutes);\n  app.use('/api/articles', articlesRoutes);\n  app.use('/api/users', usersRoutes);\n  app.use('/api/messages', messagesRoutes);\n  app.use('/api/posts', postsRoutes);\n  app.use('/api/feed', postsRoutes);\n  app.use('/api/rooms', roomsRoutes);\n  app.use('/api/deals', dealsRoutes);\n  app.use('/api/notifications', notificationsRoutes);\n  app.use('/api/ai', aiRoutes);\n\n  // 404 handler for API routes\n  app.use('/api/*', (req, res) => {\n    res.status(404).json({ message: 'Endpoint not found' });\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":1438,"size_tokens":null},"client/api/hooks.ts":{"content":"import {\n  useQuery,\n  useMutation,\n  useInfiniteQuery,\n  useQueryClient,\n  type UseQueryOptions,\n  type UseMutationOptions,\n} from '@tanstack/react-query';\nimport { apiClient } from './client';\nimport type {\n  Investment,\n  PortfolioInvestment,\n  PortfolioSummary,\n  Article,\n  User,\n  Transaction,\n  PaginatedResponse,\n  InvestmentFilters,\n  ArticleFilters,\n} from '@/types';\n\n// ============================================\n// Query Keys\n// ============================================\n\nexport const queryKeys = {\n  // Investments\n  investments: ['investments'] as const,\n  investmentsList: (filters?: InvestmentFilters) => \n    [...queryKeys.investments, 'list', filters] as const,\n  investmentDetail: (id: string) => \n    [...queryKeys.investments, 'detail', id] as const,\n  \n  // Portfolio\n  portfolio: ['portfolio'] as const,\n  portfolioSummary: () => [...queryKeys.portfolio, 'summary'] as const,\n  portfolioInvestments: () => [...queryKeys.portfolio, 'investments'] as const,\n  transactions: (type?: string) => [...queryKeys.portfolio, 'transactions', type] as const,\n  \n  // Articles\n  articles: ['articles'] as const,\n  articlesList: (filters?: ArticleFilters) => \n    [...queryKeys.articles, 'list', filters] as const,\n  articleDetail: (id: string) => \n    [...queryKeys.articles, 'detail', id] as const,\n  bookmarkedArticles: () => [...queryKeys.articles, 'bookmarked'] as const,\n  \n  // User\n  user: ['user'] as const,\n  userProfile: () => [...queryKeys.user, 'profile'] as const,\n};\n\n// ============================================\n// Investment Hooks\n// ============================================\n\n/**\n * Fetch investments with infinite scroll pagination\n */\nexport function useInvestments(filters?: InvestmentFilters) {\n  return useInfiniteQuery({\n    queryKey: queryKeys.investmentsList(filters),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<Investment>>(\n        '/investments',\n        {\n          params: {\n            page: pageParam,\n            limit: 10,\n            ...filters,\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n  });\n}\n\n/**\n * Fetch single investment detail\n */\nexport function useInvestmentDetail(\n  id: string,\n  options?: Omit<UseQueryOptions<Investment>, 'queryKey' | 'queryFn'>\n) {\n  return useQuery({\n    queryKey: queryKeys.investmentDetail(id),\n    queryFn: async () => {\n      const response = await apiClient.get<Investment>(`/investments/${id}`);\n      return response.data;\n    },\n    enabled: !!id,\n    ...options,\n  });\n}\n\n/**\n * Search investments with debounced query\n */\nexport function useSearchInvestments(\n  query: string,\n  filters?: Omit<InvestmentFilters, 'search'>\n) {\n  return useInfiniteQuery({\n    queryKey: queryKeys.investmentsList({ search: query, ...filters }),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<Investment>>(\n        '/investments/search',\n        {\n          params: {\n            q: query,\n            page: pageParam,\n            limit: 10,\n            ...filters,\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n    enabled: query.length >= 2,\n  });\n}\n\n// ============================================\n// Portfolio Hooks\n// ============================================\n\n/**\n * Fetch portfolio summary\n */\nexport function usePortfolioSummary() {\n  return useQuery({\n    queryKey: queryKeys.portfolioSummary(),\n    queryFn: async () => {\n      const response = await apiClient.get<PortfolioSummary>('/portfolio/summary');\n      return response.data;\n    },\n  });\n}\n\n/**\n * Fetch portfolio investments with pagination\n */\nexport function usePortfolioInvestments() {\n  return useInfiniteQuery({\n    queryKey: queryKeys.portfolioInvestments(),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<PortfolioInvestment>>(\n        '/portfolio/investments',\n        {\n          params: {\n            page: pageParam,\n            limit: 20,\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n  });\n}\n\n/**\n * Create new investment\n */\nexport function useCreateInvestment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: {\n      investmentId: string;\n      amount: number;\n      paymentMethodId: string;\n    }) => {\n      const response = await apiClient.post('/portfolio/invest', data);\n      return response.data;\n    },\n    onSuccess: () => {\n      // Invalidate portfolio queries\n      queryClient.invalidateQueries({ queryKey: queryKeys.portfolio });\n      // Invalidate investment detail to update funding progress\n      queryClient.invalidateQueries({ queryKey: queryKeys.investments });\n    },\n  });\n}\n\n/**\n * Fetch transaction history with infinite scroll\n */\nexport function useTransactions(type?: string) {\n  return useInfiniteQuery({\n    queryKey: queryKeys.transactions(type),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<Transaction>>(\n        '/portfolio/transactions',\n        {\n          params: {\n            page: pageParam,\n            limit: 20,\n            ...(type ? { type } : {}),\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n  });\n}\n\n// ============================================\n// Article Hooks\n// ============================================\n\n/**\n * Fetch articles with infinite scroll\n */\nexport function useArticles(filters?: ArticleFilters) {\n  return useInfiniteQuery({\n    queryKey: queryKeys.articlesList(filters),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<Article>>(\n        '/articles',\n        {\n          params: {\n            page: pageParam,\n            limit: 15,\n            ...filters,\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n  });\n}\n\n/**\n * Fetch single article detail\n */\nexport function useArticleDetail(id: string) {\n  return useQuery({\n    queryKey: queryKeys.articleDetail(id),\n    queryFn: async () => {\n      const response = await apiClient.get<Article>(`/articles/${id}`);\n      return response.data;\n    },\n    enabled: !!id,\n  });\n}\n\n/**\n * Fetch bookmarked articles\n */\nexport function useBookmarkedArticles() {\n  return useInfiniteQuery({\n    queryKey: queryKeys.bookmarkedArticles(),\n    queryFn: async ({ pageParam = 1 }) => {\n      const response = await apiClient.get<PaginatedResponse<Article>>(\n        '/articles/bookmarked',\n        {\n          params: {\n            page: pageParam,\n            limit: 15,\n          },\n        }\n      );\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => {\n      if (lastPage.page < lastPage.totalPages) {\n        return lastPage.page + 1;\n      }\n      return undefined;\n    },\n    initialPageParam: 1,\n  });\n}\n\n/**\n * Toggle article bookmark\n */\nexport function useToggleBookmark() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (articleId: string) => {\n      const response = await apiClient.post(`/articles/${articleId}/bookmark`);\n      return response.data;\n    },\n    onMutate: async (articleId) => {\n      // Cancel outgoing refetches\n      await queryClient.cancelQueries({ queryKey: queryKeys.articles });\n\n      // Snapshot previous value\n      const previousArticles = queryClient.getQueriesData({\n        queryKey: queryKeys.articles,\n      });\n\n      // Optimistically update\n      queryClient.setQueriesData(\n        { queryKey: queryKeys.articles },\n        (old: any) => {\n          if (!old) return old;\n          return {\n            ...old,\n            pages: old.pages.map((page: any) => ({\n              ...page,\n              data: page.data.map((article: Article) =>\n                article.id === articleId\n                  ? { ...article, isBookmarked: !article.isBookmarked }\n                  : article\n              ),\n            })),\n          };\n        }\n      );\n\n      return { previousArticles };\n    },\n    onError: (_err, _articleId, context) => {\n      // Rollback on error\n      if (context?.previousArticles) {\n        context.previousArticles.forEach(([queryKey, data]) => {\n          queryClient.setQueryData(queryKey, data);\n        });\n      }\n    },\n    onSettled: () => {\n      queryClient.invalidateQueries({ queryKey: queryKeys.bookmarkedArticles() });\n    },\n  });\n}\n\n// ============================================\n// User Hooks\n// ============================================\n\n/**\n * Fetch user profile\n */\nexport function useUserProfile() {\n  return useQuery({\n    queryKey: queryKeys.userProfile(),\n    queryFn: async () => {\n      const response = await apiClient.get<User>('/users/me');\n      return response.data;\n    },\n  });\n}\n\n/**\n * Update user profile\n */\nexport function useUpdateProfile() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: { firstName?: string; lastName?: string; phone?: string }) => {\n      const response = await apiClient.patch<User>('/users/me', data);\n      return response.data;\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: queryKeys.userProfile() });\n    },\n  });\n}\n\n/**\n * Upload avatar\n */\nexport function useUploadAvatar() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (imageUri: string) => {\n      const formData = new FormData();\n      formData.append('avatar', {\n        uri: imageUri,\n        type: 'image/jpeg',\n        name: 'avatar.jpg',\n      } as any);\n\n      const response = await apiClient.post<{ avatarUrl: string }>('/users/me/avatar', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n      return response.data;\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: queryKeys.userProfile() });\n    },\n  });\n}\n","path":null,"size_bytes":10848,"size_tokens":null},"client/screens/ChangePasswordScreen.tsx":{"content":"/**\n * ChangePassword Screen\n * Change password from settings\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  ActivityIndicator,\n  Alert,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { authApi } from '@/lib/api';\n\ninterface PasswordRequirement {\n  label: string;\n  check: (password: string) => boolean;\n}\n\nconst PASSWORD_REQUIREMENTS: PasswordRequirement[] = [\n  { label: 'At least 8 characters', check: (p) => p.length >= 8 },\n  { label: 'One uppercase letter', check: (p) => /[A-Z]/.test(p) },\n  { label: 'One lowercase letter', check: (p) => /[a-z]/.test(p) },\n  { label: 'One number', check: (p) => /\\d/.test(p) },\n  { label: 'One special character', check: (p) => /[!@#$%^&*(),.?\":{}|<>]/.test(p) },\n];\n\nexport default function ChangePasswordScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n\n  const [currentPassword, setCurrentPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n\n  const changePasswordMutation = useMutation({\n    mutationFn: async () => {\n      const response = await authApi.changePassword({\n        current_password: currentPassword,\n        new_password: newPassword,\n      });\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to change password');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      Alert.alert(\n        'Password Changed',\n        'Your password has been updated successfully.',\n        [{ text: 'OK', onPress: () => navigation.goBack() }]\n      );\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const passwordsMatch = newPassword === confirmPassword && confirmPassword.length > 0;\n  const allRequirementsMet = PASSWORD_REQUIREMENTS.every((req) => req.check(newPassword));\n  const canSubmit = currentPassword.length > 0 && allRequirementsMet && passwordsMatch;\n\n  const handleChangePassword = useCallback(() => {\n    if (!canSubmit) return;\n    changePasswordMutation.mutate();\n  }, [canSubmit, changePasswordMutation]);\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        {/* Header */}\n        <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n          <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Change Password</ThemedText>\n          <View style={styles.backButton} />\n        </View>\n\n        <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n          {/* Current Password */}\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Current Password</ThemedText>\n            <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n              <TextInput\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder=\"Enter current password\"\n                placeholderTextColor={appColors.textSecondary}\n                value={currentPassword}\n                onChangeText={setCurrentPassword}\n                secureTextEntry={!showCurrentPassword}\n                autoCapitalize=\"none\"\n                autoComplete=\"password\"\n              />\n              <TouchableOpacity\n                style={styles.eyeButton}\n                onPress={() => setShowCurrentPassword(!showCurrentPassword)}\n              >\n                <Ionicons\n                  name={showCurrentPassword ? 'eye-off-outline' : 'eye-outline'}\n                  size={20}\n                  color={appColors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n          </View>\n\n          {/* New Password */}\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>New Password</ThemedText>\n            <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n              <TextInput\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder=\"Enter new password\"\n                placeholderTextColor={appColors.textSecondary}\n                value={newPassword}\n                onChangeText={setNewPassword}\n                secureTextEntry={!showNewPassword}\n                autoCapitalize=\"none\"\n                autoComplete=\"new-password\"\n              />\n              <TouchableOpacity\n                style={styles.eyeButton}\n                onPress={() => setShowNewPassword(!showNewPassword)}\n              >\n                <Ionicons\n                  name={showNewPassword ? 'eye-off-outline' : 'eye-outline'}\n                  size={20}\n                  color={appColors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n\n            <View style={styles.requirementsContainer}>\n              {PASSWORD_REQUIREMENTS.map((req, index) => {\n                const isMet = req.check(newPassword);\n                return (\n                  <View key={index} style={styles.requirementItem}>\n                    <Ionicons\n                      name={isMet ? 'checkmark-circle' : 'ellipse-outline'}\n                      size={16}\n                      color={isMet ? Colors.secondary : appColors.textSecondary}\n                    />\n                    <ThemedText\n                      style={[\n                        styles.requirementText,\n                        { color: appColors.textSecondary },\n                        isMet && styles.requirementMet,\n                      ]}\n                    >\n                      {req.label}\n                    </ThemedText>\n                  </View>\n                );\n              })}\n            </View>\n          </View>\n\n          {/* Confirm Password */}\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Confirm New Password</ThemedText>\n            <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n              <TextInput\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder=\"Confirm new password\"\n                placeholderTextColor={appColors.textSecondary}\n                value={confirmPassword}\n                onChangeText={setConfirmPassword}\n                secureTextEntry={!showConfirmPassword}\n                autoCapitalize=\"none\"\n                autoComplete=\"new-password\"\n              />\n              <TouchableOpacity\n                style={styles.eyeButton}\n                onPress={() => setShowConfirmPassword(!showConfirmPassword)}\n              >\n                <Ionicons\n                  name={showConfirmPassword ? 'eye-off-outline' : 'eye-outline'}\n                  size={20}\n                  color={appColors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n            {confirmPassword.length > 0 && (\n              <View style={styles.matchIndicator}>\n                <Ionicons\n                  name={passwordsMatch ? 'checkmark-circle' : 'close-circle'}\n                  size={16}\n                  color={passwordsMatch ? Colors.secondary : appColors.error}\n                />\n                <ThemedText\n                  style={[\n                    styles.matchText,\n                    { color: passwordsMatch ? Colors.secondary : appColors.error },\n                  ]}\n                >\n                  {passwordsMatch ? 'Passwords match' : 'Passwords do not match'}\n                </ThemedText>\n              </View>\n            )}\n          </View>\n\n          {/* Submit Button */}\n          <TouchableOpacity\n            style={[styles.submitButton, !canSubmit && [styles.submitButtonDisabled, { backgroundColor: appColors.textSecondary }]]}\n            onPress={handleChangePassword}\n            disabled={!canSubmit || changePasswordMutation.isPending}\n          >\n            {changePasswordMutation.isPending ? (\n              <ActivityIndicator color=\"white\" />\n            ) : (\n              <ThemedText style={styles.submitButtonText}>Update Password</ThemedText>\n            )}\n          </TouchableOpacity>\n\n          {/* Security Note */}\n          <View style={styles.securityNote}>\n            <Ionicons name=\"shield-checkmark-outline\" size={20} color={appColors.textSecondary} />\n            <ThemedText style={[styles.securityNoteText, { color: appColors.textSecondary }]}>\n              For your security, you'll be logged out of all other devices after changing your password.\n            </ThemedText>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  content: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  inputGroup: {\n    marginBottom: Spacing.xl,\n  },\n  label: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.sm,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    padding: Spacing.md,\n  },\n  eyeButton: {\n    padding: Spacing.md,\n  },\n  requirementsContainer: {\n    marginTop: Spacing.md,\n    gap: Spacing.sm,\n  },\n  requirementItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  requirementText: {\n    ...Typography.small,\n  },\n  requirementMet: {\n    color: Colors.secondary,\n  },\n  matchIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  matchText: {\n    ...Typography.small,\n  },\n  submitButton: {\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    marginTop: Spacing.md,\n  },\n  submitButtonDisabled: {\n    opacity: 0.5,\n  },\n  submitButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  securityNote: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginTop: Spacing.xl,\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  securityNoteText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":12074,"size_tokens":null},"client/components/SkeletonLoaders.tsx":{"content":"/**\n * Skeleton Loader Components\n * Placeholder loading states for better perceived performance\n */\n\nimport React, { useEffect, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  Dimensions,\n  ViewStyle,\n} from 'react-native';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { Colors, Spacing, BorderRadius } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useThemeContext } from '@/contexts/ThemeContext';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\n\n// Base skeleton component with shimmer animation\ninterface SkeletonProps {\n  width?: number | string;\n  height?: number;\n  borderRadius?: number;\n  style?: ViewStyle;\n}\n\nexport function Skeleton({\n  width = '100%',\n  height = 16,\n  borderRadius = BorderRadius.sm,\n  style,\n}: SkeletonProps) {\n  const { colors, isDark } = useThemeContext();\n  const shimmerAnim = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    const animation = Animated.loop(\n      Animated.timing(shimmerAnim, {\n        toValue: 1,\n        duration: 1500,\n        useNativeDriver: true,\n      })\n    );\n    animation.start();\n    return () => animation.stop();\n  }, []);\n\n  const translateX = shimmerAnim.interpolate({\n    inputRange: [0, 1],\n    outputRange: [-SCREEN_WIDTH, SCREEN_WIDTH],\n  });\n\n  const backgroundColor = isDark ? colors.backgroundSecondary : '#E8EAED';\n  const shimmerColors = isDark \n    ? ['transparent', 'rgba(255,255,255,0.05)', 'transparent']\n    : ['transparent', 'rgba(255,255,255,0.5)', 'transparent'];\n\n  return (\n    <View\n      style={[\n        styles.skeleton,\n        {\n          width,\n          height,\n          borderRadius,\n          backgroundColor,\n        },\n        style,\n      ]}\n    >\n      <Animated.View\n        style={[\n          styles.shimmer,\n          { transform: [{ translateX }] },\n        ]}\n      >\n        <LinearGradient\n          colors={shimmerColors}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 0 }}\n          style={StyleSheet.absoluteFill}\n        />\n      </Animated.View>\n    </View>\n  );\n}\n\n// Circle skeleton (for avatars)\ninterface CircleSkeletonProps {\n  size?: number;\n  style?: ViewStyle;\n}\n\nexport function CircleSkeleton({ size = 48, style }: CircleSkeletonProps) {\n  return (\n    <Skeleton\n      width={size}\n      height={size}\n      borderRadius={size / 2}\n      style={style}\n    />\n  );\n}\n\n// Post card skeleton\nexport function PostCardSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.postCard, { backgroundColor: colors.surface }]}>\n      {/* Header */}\n      <View style={styles.postHeader}>\n        <CircleSkeleton size={44} />\n        <View style={styles.postHeaderText}>\n          <Skeleton width={120} height={14} />\n          <Skeleton width={80} height={12} style={{ marginTop: 6 }} />\n        </View>\n      </View>\n\n      {/* Content */}\n      <View style={styles.postContent}>\n        <Skeleton width=\"100%\" height={14} />\n        <Skeleton width=\"90%\" height={14} style={{ marginTop: 8 }} />\n        <Skeleton width=\"75%\" height={14} style={{ marginTop: 8 }} />\n      </View>\n\n      {/* Actions */}\n      <View style={styles.postActions}>\n        <Skeleton width={60} height={24} borderRadius={12} />\n        <Skeleton width={60} height={24} borderRadius={12} />\n        <Skeleton width={60} height={24} borderRadius={12} />\n      </View>\n    </View>\n  );\n}\n\n// Feed skeleton (multiple posts)\ninterface FeedSkeletonProps {\n  count?: number;\n}\n\nexport function FeedSkeleton({ count = 3 }: FeedSkeletonProps) {\n  return (\n    <View>\n      {Array.from({ length: count }).map((_, index) => (\n        <PostCardSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// User list item skeleton\nexport function UserListItemSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.userListItem, { borderBottomColor: colors.border }]}>\n      <CircleSkeleton size={48} />\n      <View style={styles.userListContent}>\n        <Skeleton width={140} height={14} />\n        <Skeleton width={100} height={12} style={{ marginTop: 6 }} />\n      </View>\n      <Skeleton width={70} height={32} borderRadius={16} />\n    </View>\n  );\n}\n\n// User list skeleton\ninterface UserListSkeletonProps {\n  count?: number;\n}\n\nexport function UserListSkeleton({ count = 5 }: UserListSkeletonProps) {\n  return (\n    <View>\n      {Array.from({ length: count }).map((_, index) => (\n        <UserListItemSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// Message/conversation skeleton\nexport function ConversationItemSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.conversationItem, { borderBottomColor: colors.border }]}>\n      <CircleSkeleton size={52} />\n      <View style={styles.conversationContent}>\n        <View style={styles.conversationHeader}>\n          <Skeleton width={120} height={14} />\n          <Skeleton width={40} height={12} />\n        </View>\n        <Skeleton width=\"80%\" height={12} style={{ marginTop: 6 }} />\n      </View>\n    </View>\n  );\n}\n\n// Messages list skeleton\nexport function MessagesListSkeleton({ count = 6 }: { count?: number }) {\n  return (\n    <View>\n      {Array.from({ length: count }).map((_, index) => (\n        <ConversationItemSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// Notification item skeleton\nexport function NotificationItemSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.notificationItem, { backgroundColor: colors.surface }]}>\n      <Skeleton width={40} height={40} borderRadius={20} />\n      <View style={styles.notificationContent}>\n        <Skeleton width=\"90%\" height={14} />\n        <Skeleton width=\"60%\" height={12} style={{ marginTop: 6 }} />\n        <Skeleton width={60} height={10} style={{ marginTop: 8 }} />\n      </View>\n    </View>\n  );\n}\n\n// Notifications list skeleton\nexport function NotificationsListSkeleton({ count = 5 }: { count?: number }) {\n  return (\n    <View>\n      {Array.from({ length: count }).map((_, index) => (\n        <NotificationItemSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// Deal card skeleton\nexport function DealCardSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.dealCard, { backgroundColor: colors.surface }]}>\n      <Skeleton width=\"100%\" height={120} borderRadius={BorderRadius.md} />\n      <View style={styles.dealContent}>\n        <Skeleton width=\"70%\" height={16} style={{ marginTop: Spacing.md }} />\n        <Skeleton width=\"50%\" height={12} style={{ marginTop: 6 }} />\n        <View style={styles.dealMeta}>\n          <Skeleton width={80} height={24} borderRadius={12} />\n          <Skeleton width={60} height={24} borderRadius={12} />\n        </View>\n        {/* Progress bar */}\n        <Skeleton width=\"100%\" height={8} borderRadius={4} style={{ marginTop: Spacing.md }} />\n      </View>\n    </View>\n  );\n}\n\n// Deals list skeleton\nexport function DealsListSkeleton({ count = 3 }: { count?: number }) {\n  return (\n    <View style={styles.dealsList}>\n      {Array.from({ length: count }).map((_, index) => (\n        <DealCardSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// Profile header skeleton\nexport function ProfileHeaderSkeleton() {\n  const { colors } = useThemeContext();\n  const appColors = useAppColors();\n  \n  return (\n    <View style={[styles.profileHeader, { backgroundColor: colors.surface }]}>\n      {/* Cover */}\n      <Skeleton width=\"100%\" height={120} borderRadius={0} />\n      \n      {/* Avatar */}\n      <View style={styles.profileAvatarContainer}>\n        <CircleSkeleton size={100} style={[styles.profileAvatar, { borderColor: appColors.surface }]} />\n      </View>\n      \n      {/* Info */}\n      <View style={styles.profileInfo}>\n        <Skeleton width={150} height={20} />\n        <Skeleton width={100} height={14} style={{ marginTop: 8 }} />\n        <Skeleton width={200} height={12} style={{ marginTop: 12 }} />\n        \n        {/* Stats */}\n        <View style={styles.profileStats}>\n          <View style={styles.profileStat}>\n            <Skeleton width={40} height={18} />\n            <Skeleton width={60} height={12} style={{ marginTop: 4 }} />\n          </View>\n          <View style={styles.profileStat}>\n            <Skeleton width={40} height={18} />\n            <Skeleton width={60} height={12} style={{ marginTop: 4 }} />\n          </View>\n          <View style={styles.profileStat}>\n            <Skeleton width={40} height={18} />\n            <Skeleton width={60} height={12} style={{ marginTop: 4 }} />\n          </View>\n        </View>\n      </View>\n    </View>\n  );\n}\n\n// Comment skeleton\nexport function CommentSkeleton() {\n  return (\n    <View style={styles.comment}>\n      <CircleSkeleton size={36} />\n      <View style={styles.commentContent}>\n        <View style={styles.commentHeader}>\n          <Skeleton width={100} height={12} />\n          <Skeleton width={50} height={10} />\n        </View>\n        <Skeleton width=\"100%\" height={12} style={{ marginTop: 6 }} />\n        <Skeleton width=\"70%\" height={12} style={{ marginTop: 4 }} />\n      </View>\n    </View>\n  );\n}\n\n// Comments list skeleton\nexport function CommentsListSkeleton({ count = 4 }: { count?: number }) {\n  return (\n    <View>\n      {Array.from({ length: count }).map((_, index) => (\n        <CommentSkeleton key={index} />\n      ))}\n    </View>\n  );\n}\n\n// Room/hashtag item skeleton\nexport function RoomItemSkeleton() {\n  const { colors } = useThemeContext();\n  \n  return (\n    <View style={[styles.roomItem, { borderBottomColor: colors.border }]}>\n      <Skeleton width={48} height={48} borderRadius={12} />\n      <View style={styles.roomContent}>\n        <Skeleton width={120} height={14} />\n        <Skeleton width={180} height={12} style={{ marginTop: 6 }} />\n        <Skeleton width={80} height={10} style={{ marginTop: 6 }} />\n      </View>\n    </View>\n  );\n}\n\n// Search results skeleton\nexport function SearchResultsSkeleton() {\n  return (\n    <View>\n      <View style={styles.searchSection}>\n        <Skeleton width={80} height={12} style={{ marginBottom: Spacing.md }} />\n        <UserListSkeleton count={3} />\n      </View>\n      <View style={styles.searchSection}>\n        <Skeleton width={80} height={12} style={{ marginBottom: Spacing.md }} />\n        <FeedSkeleton count={2} />\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  skeleton: {\n    overflow: 'hidden',\n  },\n  shimmer: {\n    ...StyleSheet.absoluteFillObject,\n  },\n\n  // Post card\n  postCard: {\n    padding: Spacing.lg,\n    marginBottom: Spacing.sm,\n  },\n  postHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  postHeaderText: {\n    marginLeft: Spacing.md,\n    flex: 1,\n  },\n  postContent: {\n    marginTop: Spacing.lg,\n  },\n  postActions: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.md,\n  },\n\n  // User list item\n  userListItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  userListContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n\n  // Conversation item\n  conversationItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  conversationContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  conversationHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n\n  // Notification item\n  notificationItem: {\n    flexDirection: 'row',\n    padding: Spacing.lg,\n  },\n  notificationContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n\n  // Deal card\n  dealCard: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    marginBottom: Spacing.md,\n  },\n  dealContent: {\n    padding: Spacing.md,\n  },\n  dealMeta: {\n    flexDirection: 'row',\n    gap: Spacing.sm,\n    marginTop: Spacing.md,\n  },\n  dealsList: {\n    padding: Spacing.lg,\n  },\n\n  // Profile header\n  profileHeader: {\n    paddingBottom: Spacing.xl,\n  },\n  profileAvatarContainer: {\n    alignItems: 'center',\n    marginTop: -50,\n  },\n  profileAvatar: {\n    borderWidth: 4,\n  },\n  profileInfo: {\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    marginTop: Spacing.md,\n  },\n  profileStats: {\n    flexDirection: 'row',\n    marginTop: Spacing.xl,\n    gap: Spacing.xl,\n  },\n  profileStat: {\n    alignItems: 'center',\n  },\n\n  // Comment\n  comment: {\n    flexDirection: 'row',\n    padding: Spacing.md,\n  },\n  commentContent: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  commentHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n\n  // Room item\n  roomItem: {\n    flexDirection: 'row',\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  roomContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n\n  // Search\n  searchSection: {\n    padding: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":12872,"size_tokens":null},"client/lib/query-client.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\nimport Constants from \"expo-constants\";\n\n/**\n * Gets the base URL for the Express API server (e.g., \"http://localhost:3000\")\n * @returns {string} The API base URL\n */\nexport function getApiUrl(): string {\n  const extraApiBaseUrl = Constants.expoConfig?.extra?.apiBaseUrl;\n  if (extraApiBaseUrl) {\n    let url = extraApiBaseUrl;\n    try {\n      const parsed = new URL(url);\n      if (parsed.hostname !== 'localhost' && parsed.hostname !== '127.0.0.1') {\n        parsed.port = '';\n        url = parsed.href;\n      }\n    } catch {}\n    return url.endsWith('/') ? url : `${url}/`;\n  }\n  \n  if (typeof window !== 'undefined' && window.location) {\n    return window.location.origin.endsWith('/') ? window.location.origin : `${window.location.origin}/`;\n  }\n\n  let host = process.env.EXPO_PUBLIC_DOMAIN;\n\n  if (!host) {\n    console.warn('[API] No API base URL configured, using localhost fallback');\n    return 'http://localhost:5000/';\n  }\n\n  host = host.replace(/:5000$/, '');\n  let url = new URL(`https://${host}`);\n\n  return url.href;\n}\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  route: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const baseUrl = getApiUrl();\n  const url = new URL(route, baseUrl);\n\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const baseUrl = getApiUrl();\n    const url = new URL(queryKey.join(\"/\") as string, baseUrl);\n\n    const res = await fetch(url, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":2563,"size_tokens":null},"client/screens/main/PortfolioScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport Animated, {\n  FadeIn,\n  FadeInDown,\n  Layout,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { RootStackParamList } from '@/navigation/types';\n\n// Types\ninterface PortfolioInvestment {\n  id: string;\n  name: string;\n  category: string;\n  amountInvested: number;\n  currentValue: number;\n  gainLossPercent: number;\n  status: 'active' | 'completed' | 'pending';\n}\n\ninterface PortfolioSummary {\n  totalValue: number;\n  totalInvested: number;\n  totalGainLoss: number;\n  gainLossPercent: number;\n  activeInvestments: number;\n}\n\n// Mock data\nconst MOCK_SUMMARY: PortfolioSummary = {\n  totalValue: 125750,\n  totalInvested: 100000,\n  totalGainLoss: 25750,\n  gainLossPercent: 25.75,\n  activeInvestments: 5,\n};\n\nconst MOCK_INVESTMENTS: PortfolioInvestment[] = [\n  {\n    id: '1',\n    name: 'NeuroLink Diagnostics',\n    category: 'Digital Health',\n    amountInvested: 25000,\n    currentValue: 32500,\n    gainLossPercent: 30.0,\n    status: 'active',\n  },\n  {\n    id: '2',\n    name: 'CardioSense Implant',\n    category: 'Medical Devices',\n    amountInvested: 35000,\n    currentValue: 42000,\n    gainLossPercent: 20.0,\n    status: 'active',\n  },\n  {\n    id: '3',\n    name: 'GeneCure Therapeutics',\n    category: 'Biotech',\n    amountInvested: 20000,\n    currentValue: 27000,\n    gainLossPercent: 35.0,\n    status: 'active',\n  },\n  {\n    id: '4',\n    name: 'MindWell App',\n    category: 'Digital Health',\n    amountInvested: 10000,\n    currentValue: 12250,\n    gainLossPercent: 22.5,\n    status: 'active',\n  },\n  {\n    id: '5',\n    name: 'PharmaTech Solutions',\n    category: 'Pharmaceuticals',\n    amountInvested: 10000,\n    currentValue: 12000,\n    gainLossPercent: 20.0,\n    status: 'pending',\n  },\n];\n\n/**\n * Portfolio Screen\n * Track investments and returns\n */\nexport default function PortfolioScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  \n  const [refreshing, setRefreshing] = useState(false);\n  const [summary] = useState<PortfolioSummary>(MOCK_SUMMARY);\n  const [investments] = useState<PortfolioInvestment[]>(MOCK_INVESTMENTS);\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    setRefreshing(false);\n  }, []);\n\n  const handleInvestmentPress = useCallback(\n    (investment: PortfolioInvestment) => {\n      navigation.navigate('InvestmentDetail', { investmentId: investment.id });\n    },\n    [navigation]\n  );\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(value);\n  };\n\n  const renderHeader = () => (\n    <View style={styles.headerContent}>\n      {/* Total Value Card */}\n      <Animated.View entering={FadeInDown.duration(600).delay(100)}>\n        <LinearGradient\n          colors={colors.gradient.colors as unknown as string[]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.summaryCard}\n        >\n          <View style={styles.summaryHeader}>\n            <Text style={styles.summaryLabel}>Total Portfolio Value</Text>\n            <Pressable style={styles.notificationButton}>\n              <Feather name=\"bell\" size={20} color={colors.text.inverse} />\n            </Pressable>\n          </View>\n\n          <Text style={styles.summaryValue}>\n            {formatCurrency(summary.totalValue)}\n          </Text>\n\n          <View style={styles.summaryStats}>\n            <View style={styles.summaryStat}>\n              <View\n                style={[\n                  styles.gainLossBadge,\n                  summary.gainLossPercent >= 0\n                    ? styles.gainBadge\n                    : styles.lossBadge,\n                ]}\n              >\n                <Feather\n                  name={summary.gainLossPercent >= 0 ? 'trending-up' : 'trending-down'}\n                  size={14}\n                  color={colors.text.inverse}\n                />\n                <Text style={styles.gainLossText}>\n                  {summary.gainLossPercent >= 0 ? '+' : ''}\n                  {summary.gainLossPercent.toFixed(2)}%\n                </Text>\n              </View>\n              <Text style={styles.statLabel}>All Time</Text>\n            </View>\n\n            <View style={styles.statDivider} />\n\n            <View style={styles.summaryStat}>\n              <Text style={styles.statValue}>\n                {formatCurrency(summary.totalGainLoss)}\n              </Text>\n              <Text style={styles.statLabel}>Total Returns</Text>\n            </View>\n\n            <View style={styles.statDivider} />\n\n            <View style={styles.summaryStat}>\n              <Text style={styles.statValue}>{summary.activeInvestments}</Text>\n              <Text style={styles.statLabel}>Active</Text>\n            </View>\n          </View>\n        </LinearGradient>\n      </Animated.View>\n\n      {/* Section Header */}\n      <Animated.View\n        entering={FadeInDown.duration(600).delay(200)}\n        style={styles.sectionHeader}\n      >\n        <Text style={styles.sectionTitle}>Your Investments</Text>\n        <Pressable>\n          <Text style={styles.seeAllLink}>See All</Text>\n        </Pressable>\n      </Animated.View>\n    </View>\n  );\n\n  const renderInvestmentItem = ({\n    item,\n    index,\n  }: {\n    item: PortfolioInvestment;\n    index: number;\n  }) => {\n    const isPositive = item.gainLossPercent >= 0;\n\n    return (\n      <Animated.View\n        entering={FadeInDown.duration(400).delay(300 + index * 80)}\n        layout={Layout.springify()}\n      >\n        <Pressable\n          style={styles.investmentItem}\n          onPress={() => handleInvestmentPress(item)}\n        >\n          <View style={styles.investmentLeft}>\n            <View style={styles.investmentIcon}>\n              <Feather\n                name=\"activity\"\n                size={20}\n                color={colors.primary.main}\n              />\n            </View>\n            <View style={styles.investmentInfo}>\n              <Text style={styles.investmentName}>{item.name}</Text>\n              <Text style={styles.investmentCategory}>{item.category}</Text>\n            </View>\n          </View>\n\n          <View style={styles.investmentRight}>\n            <Text style={styles.investmentValue}>\n              {formatCurrency(item.currentValue)}\n            </Text>\n            <View style={styles.gainLossRow}>\n              <Feather\n                name={isPositive ? 'arrow-up-right' : 'arrow-down-right'}\n                size={14}\n                color={\n                  isPositive\n                    ? colors.semantic.success\n                    : colors.semantic.error\n                }\n              />\n              <Text\n                style={[\n                  styles.gainLossPercent,\n                  isPositive ? styles.positive : styles.negative,\n                ]}\n              >\n                {isPositive ? '+' : ''}\n                {item.gainLossPercent.toFixed(1)}%\n              </Text>\n            </View>\n          </View>\n        </Pressable>\n      </Animated.View>\n    );\n  };\n\n  const renderEmptyState = () => (\n    <Animated.View entering={FadeIn.duration(400)} style={styles.emptyState}>\n      <View style={styles.emptyIcon}>\n        <Feather name=\"bar-chart-2\" size={64} color={colors.text.tertiary} />\n      </View>\n      <Text style={styles.emptyTitle}>No investments yet</Text>\n      <Text style={styles.emptyDescription}>\n        Start building your portfolio by exploring investment opportunities.\n      </Text>\n      <Pressable style={styles.emptyButton}>\n        <LinearGradient\n          colors={colors.gradient.colors as unknown as string[]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 0 }}\n          style={styles.emptyButtonGradient}\n        >\n          <Text style={styles.emptyButtonText}>Explore Investments</Text>\n        </LinearGradient>\n      </Pressable>\n    </Animated.View>\n  );\n\n  return (\n    <View style={styles.container}>\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Text style={styles.screenTitle}>Portfolio</Text>\n      </View>\n\n      {/* Content */}\n      <FlatList\n        data={investments}\n        keyExtractor={(item) => item.id}\n        renderItem={renderInvestmentItem}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmptyState}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: layout.tabBarHeight + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={handleRefresh}\n            tintColor={colors.primary.main}\n          />\n        }\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Header\n  header: {\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    backgroundColor: colors.background.primary,\n  },\n  screenTitle: {\n    ...typography.title,\n    color: colors.text.primary,\n  },\n\n  // Header Content\n  headerContent: {\n    paddingBottom: spacing.md,\n  },\n\n  // Summary Card\n  summaryCard: {\n    marginHorizontal: spacing.lg,\n    padding: spacing.xl,\n    borderRadius: layout.radiusXLarge,\n    ...shadows.elevated,\n  },\n  summaryHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: spacing.sm,\n  },\n  summaryLabel: {\n    ...typography.caption,\n    color: colors.transparent.white50,\n  },\n  notificationButton: {\n    padding: spacing.xs,\n  },\n  summaryValue: {\n    ...typography.hero,\n    fontSize: 40,\n    color: colors.text.inverse,\n    marginBottom: spacing.lg,\n  },\n  summaryStats: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  summaryStat: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  statDivider: {\n    width: 1,\n    height: 32,\n    backgroundColor: colors.transparent.white20,\n  },\n  gainLossBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusSmall,\n    marginBottom: spacing.xs,\n  },\n  gainBadge: {\n    backgroundColor: 'rgba(0, 168, 107, 0.3)',\n  },\n  lossBadge: {\n    backgroundColor: 'rgba(220, 38, 38, 0.3)',\n  },\n  gainLossText: {\n    ...typography.captionMedium,\n    color: colors.text.inverse,\n  },\n  statValue: {\n    ...typography.heading,\n    color: colors.text.inverse,\n    marginBottom: spacing.xs,\n  },\n  statLabel: {\n    ...typography.small,\n    color: colors.transparent.white50,\n  },\n\n  // Section Header\n  sectionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.xl,\n    paddingBottom: spacing.md,\n  },\n  sectionTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  seeAllLink: {\n    ...typography.captionMedium,\n    color: colors.primary.main,\n  },\n\n  // List\n  listContent: {\n    paddingTop: spacing.md,\n  },\n\n  // Investment Item\n  investmentItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    marginHorizontal: spacing.lg,\n    marginBottom: spacing.sm,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  investmentLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  investmentIcon: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  investmentInfo: {\n    flex: 1,\n  },\n  investmentName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  investmentCategory: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  investmentRight: {\n    alignItems: 'flex-end',\n  },\n  investmentValue: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  gainLossRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n  },\n  gainLossPercent: {\n    ...typography.captionMedium,\n  },\n  positive: {\n    color: colors.semantic.success,\n  },\n  negative: {\n    color: colors.semantic.error,\n  },\n\n  // Empty State\n  emptyState: {\n    alignItems: 'center',\n    paddingVertical: spacing['3xl'],\n    paddingHorizontal: spacing.xl,\n  },\n  emptyIcon: {\n    marginBottom: spacing.lg,\n  },\n  emptyTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  emptyDescription: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n    marginBottom: spacing.xl,\n  },\n  emptyButton: {\n    borderRadius: layout.radiusMedium,\n    overflow: 'hidden',\n  },\n  emptyButtonGradient: {\n    paddingHorizontal: spacing.xl,\n    paddingVertical: spacing.md,\n  },\n  emptyButtonText: {\n    ...typography.button.medium,\n    color: colors.text.inverse,\n  },\n});\n","path":null,"size_bytes":13810,"size_tokens":null},"client/screens/DataExportScreen.tsx":{"content":"/**\n * Data Export Screen\n * GDPR compliance - export user data\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n  Share,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as FileSystem from 'expo-file-system';\nimport * as Sharing from 'expo-sharing';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { api } from '@/lib/api';\n\n// Data categories that can be exported\ninterface DataCategory {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  selected: boolean;\n  estimatedSize?: string;\n}\n\nconst DATA_CATEGORIES: DataCategory[] = [\n  {\n    id: 'profile',\n    name: 'Profile Information',\n    description: 'Your name, email, bio, avatar, and account settings',\n    icon: 'person-outline',\n    selected: true,\n    estimatedSize: '< 1 MB',\n  },\n  {\n    id: 'posts',\n    name: 'Posts & Comments',\n    description: 'All posts you\\'ve created and comments you\\'ve made',\n    icon: 'document-text-outline',\n    selected: true,\n    estimatedSize: '1-10 MB',\n  },\n  {\n    id: 'messages',\n    name: 'Messages',\n    description: 'Your direct message conversations',\n    icon: 'mail-outline',\n    selected: true,\n    estimatedSize: '1-50 MB',\n  },\n  {\n    id: 'connections',\n    name: 'Connections',\n    description: 'Users you follow and who follow you',\n    icon: 'people-outline',\n    selected: true,\n    estimatedSize: '< 1 MB',\n  },\n  {\n    id: 'activity',\n    name: 'Activity Log',\n    description: 'Your likes, bookmarks, and interactions',\n    icon: 'pulse-outline',\n    selected: true,\n    estimatedSize: '1-5 MB',\n  },\n  {\n    id: 'investments',\n    name: 'Investment Data',\n    description: 'Your investment history and portfolio data',\n    icon: 'trending-up-outline',\n    selected: true,\n    estimatedSize: '< 1 MB',\n  },\n  {\n    id: 'media',\n    name: 'Media Files',\n    description: 'Photos and videos you\\'ve uploaded',\n    icon: 'images-outline',\n    selected: false,\n    estimatedSize: '10-500 MB',\n  },\n];\n\ntype ExportFormat = 'json' | 'csv' | 'html';\ntype ExportStatus = 'idle' | 'preparing' | 'processing' | 'ready' | 'error';\n\nexport default function DataExportScreen() {\n  const navigation = useNavigation<any>();\n  const { colors } = useThemeContext();\n  const { user } = useAuth();\n  \n  const [categories, setCategories] = useState<DataCategory[]>(DATA_CATEGORIES);\n  const [format, setFormat] = useState<ExportFormat>('json');\n  const [status, setStatus] = useState<ExportStatus>('idle');\n  const [progress, setProgress] = useState(0);\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const [exportId, setExportId] = useState<string | null>(null);\n\n  const toggleCategory = useCallback((id: string) => {\n    haptics.selection();\n    setCategories(prev => \n      prev.map(cat => \n        cat.id === id ? { ...cat, selected: !cat.selected } : cat\n      )\n    );\n  }, []);\n\n  const selectAll = useCallback(() => {\n    haptics.buttonPress();\n    setCategories(prev => prev.map(cat => ({ ...cat, selected: true })));\n  }, []);\n\n  const deselectAll = useCallback(() => {\n    haptics.buttonPress();\n    setCategories(prev => prev.map(cat => ({ ...cat, selected: false })));\n  }, []);\n\n  const requestExport = useCallback(async () => {\n    const selectedCategories = categories.filter(c => c.selected);\n    \n    if (selectedCategories.length === 0) {\n      Alert.alert('No Data Selected', 'Please select at least one category to export.');\n      return;\n    }\n\n    haptics.buttonPress();\n    setStatus('preparing');\n    setProgress(0);\n\n    try {\n      // Request export from backend\n      const response = await api.post('/account/export', {\n        categories: selectedCategories.map(c => c.id),\n        format,\n      });\n\n      if (response.data?.exportId) {\n        setExportId(response.data.exportId);\n        setStatus('processing');\n        \n        // Poll for completion\n        pollExportStatus(response.data.exportId);\n      } else {\n        throw new Error('No export ID received');\n      }\n    } catch (error) {\n      console.error('[DataExport] Error requesting export:', error);\n      setStatus('error');\n      haptics.error();\n      Alert.alert(\n        'Export Failed',\n        'Unable to start data export. Please try again later.'\n      );\n    }\n  }, [categories, format]);\n\n  const pollExportStatus = useCallback(async (id: string) => {\n    const maxAttempts = 60; // 5 minutes max\n    let attempts = 0;\n\n    const poll = async () => {\n      try {\n        const response = await api.get(`/account/export/${id}/status`);\n        const { status: exportStatus, progress: exportProgress, downloadUrl: url } = response.data;\n\n        setProgress(exportProgress || 0);\n\n        if (exportStatus === 'completed' && url) {\n          setStatus('ready');\n          setDownloadUrl(url);\n          haptics.success();\n        } else if (exportStatus === 'failed') {\n          setStatus('error');\n          haptics.error();\n          Alert.alert('Export Failed', 'The export process encountered an error.');\n        } else if (attempts < maxAttempts) {\n          attempts++;\n          setTimeout(poll, 5000); // Poll every 5 seconds\n        } else {\n          setStatus('error');\n          Alert.alert('Export Timeout', 'The export is taking too long. Please try again.');\n        }\n      } catch (error) {\n        setStatus('error');\n        haptics.error();\n      }\n    };\n\n    poll();\n  }, []);\n\n  const downloadExport = useCallback(async () => {\n    if (!downloadUrl) return;\n\n    haptics.buttonPress();\n\n    try {\n      // Check if sharing is available\n      const isAvailable = await Sharing.isAvailableAsync();\n      \n      if (isAvailable) {\n        // Download file\n        const filename = `medinvest_data_export_${new Date().toISOString().split('T')[0]}.${format === 'json' ? 'json' : format === 'csv' ? 'zip' : 'html'}`;\n        const fileUri = FileSystem.documentDirectory + filename;\n        \n        const download = await FileSystem.downloadAsync(downloadUrl, fileUri);\n        \n        // Share the file\n        await Sharing.shareAsync(download.uri, {\n          mimeType: format === 'json' ? 'application/json' : format === 'csv' ? 'application/zip' : 'text/html',\n          dialogTitle: 'Save your data export',\n        });\n      } else {\n        // Fallback to opening in browser\n        Alert.alert(\n          'Download Ready',\n          'Your data export is ready. Would you like to open it in your browser?',\n          [\n            { text: 'Cancel', style: 'cancel' },\n            { text: 'Open', onPress: () => {/* Linking.openURL(downloadUrl) */} },\n          ]\n        );\n      }\n    } catch (error) {\n      console.error('[DataExport] Error downloading:', error);\n      Alert.alert('Download Failed', 'Unable to download the export file.');\n    }\n  }, [downloadUrl, format]);\n\n  const resetExport = useCallback(() => {\n    setStatus('idle');\n    setProgress(0);\n    setDownloadUrl(null);\n    setExportId(null);\n  }, []);\n\n  const renderCategory = (category: DataCategory) => (\n    <TouchableOpacity\n      key={category.id}\n      style={[\n        styles.categoryItem,\n        { \n          backgroundColor: colors.surface,\n          borderColor: category.selected ? colors.primary : colors.border,\n        },\n      ]}\n      onPress={() => toggleCategory(category.id)}\n      disabled={status !== 'idle'}\n    >\n      <View style={[styles.categoryIcon, { backgroundColor: colors.primary + '15' }]}>\n        <Ionicons name={category.icon as any} size={22} color={colors.primary} />\n      </View>\n      <View style={styles.categoryInfo}>\n        <ThemedText style={[styles.categoryName, { color: colors.textPrimary }]}>\n          {category.name}\n        </ThemedText>\n        <ThemedText style={[styles.categoryDescription, { color: colors.textSecondary }]}>\n          {category.description}\n        </ThemedText>\n        {category.estimatedSize && (\n          <ThemedText style={[styles.categorySize, { color: colors.textSecondary }]}>\n            ~{category.estimatedSize}\n          </ThemedText>\n        )}\n      </View>\n      <Ionicons\n        name={category.selected ? 'checkbox' : 'square-outline'}\n        size={24}\n        color={category.selected ? colors.primary : colors.textSecondary}\n      />\n    </TouchableOpacity>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Export Your Data\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Info banner */}\n        <View style={[styles.infoBanner, { backgroundColor: colors.primary + '15' }]}>\n          <Ionicons name=\"shield-checkmark-outline\" size={24} color={colors.primary} />\n          <View style={styles.infoContent}>\n            <ThemedText style={[styles.infoTitle, { color: colors.textPrimary }]}>\n              Your data, your control\n            </ThemedText>\n            <ThemedText style={[styles.infoText, { color: colors.textSecondary }]}>\n              Download a copy of your MedInvest data. This may take a few minutes depending on how much data you have.\n            </ThemedText>\n          </View>\n        </View>\n\n        {status === 'idle' && (\n          <>\n            {/* Category selection */}\n            <View style={styles.sectionHeader}>\n              <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                SELECT DATA TO EXPORT\n              </ThemedText>\n              <View style={styles.selectButtons}>\n                <TouchableOpacity onPress={selectAll}>\n                  <ThemedText style={[styles.selectButton, { color: colors.primary }]}>\n                    Select All\n                  </ThemedText>\n                </TouchableOpacity>\n                <ThemedText style={[styles.selectDivider, { color: colors.textSecondary }]}>|</ThemedText>\n                <TouchableOpacity onPress={deselectAll}>\n                  <ThemedText style={[styles.selectButton, { color: colors.primary }]}>\n                    Deselect All\n                  </ThemedText>\n                </TouchableOpacity>\n              </View>\n            </View>\n\n            <View style={styles.categoriesList}>\n              {categories.map(renderCategory)}\n            </View>\n\n            {/* Format selection */}\n            <View style={styles.sectionHeader}>\n              <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                EXPORT FORMAT\n              </ThemedText>\n            </View>\n            <View style={[styles.formatSection, { backgroundColor: colors.surface }]}>\n              {(['json', 'csv', 'html'] as ExportFormat[]).map((f) => (\n                <TouchableOpacity\n                  key={f}\n                  style={[\n                    styles.formatOption,\n                    format === f && { backgroundColor: colors.primary + '15' },\n                  ]}\n                  onPress={() => {\n                    haptics.selection();\n                    setFormat(f);\n                  }}\n                >\n                  <Ionicons\n                    name={format === f ? 'radio-button-on' : 'radio-button-off'}\n                    size={20}\n                    color={format === f ? colors.primary : colors.textSecondary}\n                  />\n                  <View style={styles.formatInfo}>\n                    <ThemedText style={[styles.formatName, { color: colors.textPrimary }]}>\n                      {f.toUpperCase()}\n                    </ThemedText>\n                    <ThemedText style={[styles.formatDescription, { color: colors.textSecondary }]}>\n                      {f === 'json' && 'Machine-readable format'}\n                      {f === 'csv' && 'Spreadsheet-compatible'}\n                      {f === 'html' && 'Human-readable report'}\n                    </ThemedText>\n                  </View>\n                </TouchableOpacity>\n              ))}\n            </View>\n\n            {/* Export button */}\n            <TouchableOpacity\n              style={[styles.exportButton, { backgroundColor: colors.primary }]}\n              onPress={requestExport}\n            >\n              <Ionicons name=\"download-outline\" size={20} color=\"white\" />\n              <ThemedText style={styles.exportButtonText}>\n                Request Data Export\n              </ThemedText>\n            </TouchableOpacity>\n          </>\n        )}\n\n        {/* Processing state */}\n        {(status === 'preparing' || status === 'processing') && (\n          <View style={styles.processingContainer}>\n            <ActivityIndicator size=\"large\" color={colors.primary} />\n            <ThemedText style={[styles.processingTitle, { color: colors.textPrimary }]}>\n              {status === 'preparing' ? 'Preparing export...' : 'Processing your data...'}\n            </ThemedText>\n            <ThemedText style={[styles.processingText, { color: colors.textSecondary }]}>\n              This may take a few minutes. You can leave this screen and we'll notify you when it's ready.\n            </ThemedText>\n            \n            {/* Progress bar */}\n            <View style={[styles.progressBar, { backgroundColor: colors.border }]}>\n              <View\n                style={[\n                  styles.progressFill,\n                  { backgroundColor: colors.primary, width: `${progress}%` },\n                ]}\n              />\n            </View>\n            <ThemedText style={[styles.progressText, { color: colors.textSecondary }]}>\n              {progress}% complete\n            </ThemedText>\n          </View>\n        )}\n\n        {/* Ready state */}\n        {status === 'ready' && (\n          <View style={styles.readyContainer}>\n            <View style={[styles.successIcon, { backgroundColor: colors.success + '20' }]}>\n              <Ionicons name=\"checkmark-circle\" size={64} color={colors.success} />\n            </View>\n            <ThemedText style={[styles.readyTitle, { color: colors.textPrimary }]}>\n              Your export is ready!\n            </ThemedText>\n            <ThemedText style={[styles.readyText, { color: colors.textSecondary }]}>\n              Your data has been compiled and is ready to download. The download link will expire in 24 hours.\n            </ThemedText>\n\n            <TouchableOpacity\n              style={[styles.downloadButton, { backgroundColor: colors.primary }]}\n              onPress={downloadExport}\n            >\n              <Ionicons name=\"cloud-download-outline\" size={20} color=\"white\" />\n              <ThemedText style={styles.downloadButtonText}>\n                Download Export\n              </ThemedText>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={[styles.newExportButton, { borderColor: colors.border }]}\n              onPress={resetExport}\n            >\n              <ThemedText style={[styles.newExportButtonText, { color: colors.textPrimary }]}>\n                Request New Export\n              </ThemedText>\n            </TouchableOpacity>\n          </View>\n        )}\n\n        {/* Error state */}\n        {status === 'error' && (\n          <View style={styles.errorContainer}>\n            <Ionicons name=\"alert-circle\" size={64} color={colors.error} />\n            <ThemedText style={[styles.errorTitle, { color: colors.textPrimary }]}>\n              Export Failed\n            </ThemedText>\n            <ThemedText style={[styles.errorText, { color: colors.textSecondary }]}>\n              Something went wrong while preparing your data export. Please try again.\n            </ThemedText>\n\n            <TouchableOpacity\n              style={[styles.retryButton, { backgroundColor: colors.primary }]}\n              onPress={resetExport}\n            >\n              <ThemedText style={styles.retryButtonText}>Try Again</ThemedText>\n            </TouchableOpacity>\n          </View>\n        )}\n\n        {/* Legal info */}\n        <View style={styles.legalSection}>\n          <ThemedText style={[styles.legalText, { color: colors.textSecondary }]}>\n            Your data export includes personal information as defined under GDPR and other privacy regulations. \n            Please store this data securely and be mindful of sharing it.\n          </ThemedText>\n        </View>\n\n        <View style={{ height: 40 }} />\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  content: {\n    flex: 1,\n  },\n  infoBanner: {\n    flexDirection: 'row',\n    margin: Spacing.lg,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.md,\n  },\n  infoContent: {\n    flex: 1,\n  },\n  infoTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: 4,\n  },\n  infoText: {\n    ...Typography.small,\n    lineHeight: 18,\n  },\n  sectionHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.sm,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    letterSpacing: 0.5,\n  },\n  selectButtons: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  selectButton: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  selectDivider: {\n    ...Typography.small,\n  },\n  categoriesList: {\n    paddingHorizontal: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  categoryItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    gap: Spacing.md,\n    ...Shadows.card,\n  },\n  categoryIcon: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  categoryInfo: {\n    flex: 1,\n  },\n  categoryName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  categoryDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  categorySize: {\n    ...Typography.small,\n    marginTop: 4,\n    fontStyle: 'italic',\n  },\n  formatSection: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  formatOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  formatInfo: {\n    flex: 1,\n  },\n  formatName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  formatDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  exportButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    margin: Spacing.lg,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  exportButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  processingContainer: {\n    alignItems: 'center',\n    padding: Spacing.xl,\n  },\n  processingTitle: {\n    ...Typography.title,\n    marginTop: Spacing.lg,\n  },\n  processingText: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  progressBar: {\n    width: '100%',\n    height: 8,\n    borderRadius: 4,\n    marginTop: Spacing.xl,\n    overflow: 'hidden',\n  },\n  progressFill: {\n    height: '100%',\n    borderRadius: 4,\n  },\n  progressText: {\n    ...Typography.small,\n    marginTop: Spacing.sm,\n  },\n  readyContainer: {\n    alignItems: 'center',\n    padding: Spacing.xl,\n  },\n  successIcon: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  readyTitle: {\n    ...Typography.title,\n    marginTop: Spacing.lg,\n  },\n  readyText: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  downloadButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '100%',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginTop: Spacing.xl,\n    gap: Spacing.sm,\n  },\n  downloadButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  newExportButton: {\n    width: '100%',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    alignItems: 'center',\n    marginTop: Spacing.md,\n  },\n  newExportButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  errorContainer: {\n    alignItems: 'center',\n    padding: Spacing.xl,\n  },\n  errorTitle: {\n    ...Typography.title,\n    marginTop: Spacing.lg,\n  },\n  errorText: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  retryButton: {\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginTop: Spacing.xl,\n  },\n  retryButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  legalSection: {\n    padding: Spacing.lg,\n    marginTop: Spacing.lg,\n  },\n  legalText: {\n    ...Typography.small,\n    lineHeight: 18,\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":22113,"size_tokens":null},"client/components/Card.tsx":{"content":"import React from 'react';\nimport {\n  View,\n  Pressable,\n  StyleSheet,\n  type ViewProps,\n  type StyleProp,\n  type ViewStyle,\n} from 'react-native';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from 'react-native-reanimated';\n\nimport { colors, spacing, layout, shadows } from '@/theme';\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport type CardVariant = 'default' | 'elevated' | 'outlined' | 'gradient' | 'flat';\n\nexport interface CardProps extends ViewProps {\n  /** Visual variant */\n  variant?: CardVariant;\n  /** Make card pressable */\n  onPress?: () => void;\n  /** Disable press interaction */\n  disabled?: boolean;\n  /** Card padding size */\n  padding?: 'none' | 'sm' | 'md' | 'lg';\n  /** Border radius size */\n  radius?: 'sm' | 'md' | 'lg' | 'xl';\n  /** Gradient colors (for gradient variant) */\n  gradientColors?: string[];\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n  /** Content */\n  children: React.ReactNode;\n}\n\nconst PADDING = {\n  none: 0,\n  sm: spacing.sm,\n  md: spacing.md,\n  lg: spacing.lg,\n};\n\nconst RADIUS = {\n  sm: layout.radiusSmall,\n  md: layout.radiusMedium,\n  lg: layout.radiusLarge,\n  xl: layout.radiusXLarge,\n};\n\nexport function Card({\n  variant = 'default',\n  onPress,\n  disabled = false,\n  padding = 'md',\n  radius = 'lg',\n  gradientColors,\n  style,\n  children,\n  ...props\n}: CardProps) {\n  const scale = useSharedValue(1);\n  const isInteractive = !!onPress && !disabled;\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (isInteractive) {\n      scale.value = withSpring(0.98, { damping: 15, stiffness: 400 });\n    }\n  };\n\n  const handlePressOut = () => {\n    if (isInteractive) {\n      scale.value = withSpring(1, { damping: 15, stiffness: 400 });\n    }\n  };\n\n  const getVariantStyles = (): StyleProp<ViewStyle> => {\n    switch (variant) {\n      case 'elevated':\n        return [styles.baseCard, styles.elevatedCard, shadows.elevated];\n      case 'outlined':\n        return [styles.baseCard, styles.outlinedCard];\n      case 'flat':\n        return [styles.baseCard, styles.flatCard];\n      case 'gradient':\n        return [styles.baseCard];\n      case 'default':\n      default:\n        return [styles.baseCard, styles.defaultCard, shadows.card];\n    }\n  };\n\n  const cardStyle = [\n    getVariantStyles(),\n    { padding: PADDING[padding], borderRadius: RADIUS[radius] },\n    style,\n  ];\n\n  // Gradient variant\n  if (variant === 'gradient') {\n    const gradientColorsToUse = gradientColors || (colors.gradient.colors as unknown as string[]);\n\n    if (isInteractive) {\n      return (\n        <AnimatedPressable\n          style={animatedStyle}\n          onPress={onPress}\n          onPressIn={handlePressIn}\n          onPressOut={handlePressOut}\n          disabled={disabled}\n        >\n          <LinearGradient\n            colors={gradientColorsToUse}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={[\n              cardStyle,\n              styles.gradientCard,\n              { borderRadius: RADIUS[radius] },\n            ]}\n            {...props}\n          >\n            {children}\n          </LinearGradient>\n        </AnimatedPressable>\n      );\n    }\n\n    return (\n      <LinearGradient\n        colors={gradientColorsToUse}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={[cardStyle, styles.gradientCard, { borderRadius: RADIUS[radius] }]}\n        {...props}\n      >\n        {children}\n      </LinearGradient>\n    );\n  }\n\n  // Interactive card\n  if (isInteractive) {\n    return (\n      <AnimatedPressable\n        style={[animatedStyle, cardStyle]}\n        onPress={onPress}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        disabled={disabled}\n        {...props}\n      >\n        {children}\n      </AnimatedPressable>\n    );\n  }\n\n  // Static card\n  return (\n    <View style={cardStyle} {...props}>\n      {children}\n    </View>\n  );\n}\n\n// Card Header component\nexport interface CardHeaderProps extends ViewProps {\n  children: React.ReactNode;\n}\n\nexport function CardHeader({ children, style, ...props }: CardHeaderProps) {\n  return (\n    <View style={[styles.cardHeader, style]} {...props}>\n      {children}\n    </View>\n  );\n}\n\n// Card Content component\nexport interface CardContentProps extends ViewProps {\n  children: React.ReactNode;\n}\n\nexport function CardContent({ children, style, ...props }: CardContentProps) {\n  return (\n    <View style={[styles.cardContent, style]} {...props}>\n      {children}\n    </View>\n  );\n}\n\n// Card Footer component\nexport interface CardFooterProps extends ViewProps {\n  children: React.ReactNode;\n}\n\nexport function CardFooter({ children, style, ...props }: CardFooterProps) {\n  return (\n    <View style={[styles.cardFooter, style]} {...props}>\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  baseCard: {\n    overflow: 'hidden',\n  },\n  defaultCard: {\n    backgroundColor: colors.surface.primary,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  elevatedCard: {\n    backgroundColor: colors.surface.primary,\n  },\n  outlinedCard: {\n    backgroundColor: 'transparent',\n    borderWidth: 1,\n    borderColor: colors.border.medium,\n  },\n  flatCard: {\n    backgroundColor: colors.background.secondary,\n  },\n  gradientCard: {\n    overflow: 'hidden',\n  },\n\n  // Sub-components\n  cardHeader: {\n    paddingBottom: spacing.sm,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n    marginBottom: spacing.md,\n  },\n  cardContent: {\n    // Default content area\n  },\n  cardFooter: {\n    paddingTop: spacing.sm,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n    marginTop: spacing.md,\n  },\n});\n\nexport default Card;\n","path":null,"size_bytes":5854,"size_tokens":null},"client/navigation/ProfileStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport ProfileScreen from \"@/screens/ProfileScreen\";\n\nexport type ProfileStackParamList = {\n  Profile: undefined;\n};\n\nconst Stack = createNativeStackNavigator<ProfileStackParamList>();\n\nexport default function ProfileStackNavigator() {\n  const screenOptions = useScreenOptions();\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      <Stack.Screen\n        name=\"Profile\"\n        component={ProfileScreen}\n        options={{ headerShown: false }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":666,"size_tokens":null},"client/screens/PortfolioScreen.tsx":{"content":"import React, { useState, useCallback, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  RefreshControl,\n  Image,\n  Pressable,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport Animated, { FadeInDown } from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows, Typography } from \"@/constants/theme\";\nimport { storage, Investment } from \"@/lib/storage\";\nimport { investmentOpportunities } from \"@/lib/mockData\";\n\ninterface PortfolioItem extends Investment {\n  title: string;\n  company: string;\n  currentValue: number;\n  gainLoss: number;\n  gainLossPercent: number;\n}\n\nexport default function PortfolioScreen() {\n  const insets = useSafeAreaInsets();\n  const { theme } = useTheme();\n  const [refreshing, setRefreshing] = useState(false);\n  const [investments, setInvestments] = useState<PortfolioItem[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const loadInvestments = useCallback(async () => {\n    try {\n      const savedInvestments = await storage.getInvestments();\n      const portfolioItems: PortfolioItem[] = savedInvestments.map((inv) => {\n        const opportunity = investmentOpportunities.find(\n          (opp) => opp.id === inv.opportunityId\n        );\n        const roiMatch = opportunity?.expectedROI?.match(/(\\d+)/);\n        const baseROI = roiMatch ? parseInt(roiMatch[1], 10) : 10;\n        const investmentDate = new Date(inv.date);\n        const daysSinceInvestment = Math.floor(\n          (Date.now() - investmentDate.getTime()) / (1000 * 60 * 60 * 24)\n        );\n        const dailyGrowth = baseROI / 365;\n        const gainLossPercent = Math.min(daysSinceInvestment * dailyGrowth, baseROI * 0.8);\n        const currentValue = inv.amount * (1 + gainLossPercent / 100);\n        return {\n          ...inv,\n          title: opportunity?.title || \"Unknown Investment\",\n          company: opportunity?.company || \"Unknown\",\n          currentValue,\n          gainLoss: currentValue - inv.amount,\n          gainLossPercent,\n        };\n      });\n      setInvestments(portfolioItems);\n    } catch (error) {\n      console.error(\"Failed to load investments:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    loadInvestments();\n  }, [loadInvestments]);\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await loadInvestments();\n    setRefreshing(false);\n  }, [loadInvestments]);\n\n  const totalValue = investments.reduce((sum, inv) => sum + inv.currentValue, 0);\n  const totalInvested = investments.reduce((sum, inv) => sum + inv.amount, 0);\n  const totalGainLoss = totalValue - totalInvested;\n  const totalGainLossPercent =\n    totalInvested > 0 ? (totalGainLoss / totalInvested) * 100 : 0;\n\n  const renderItem = useCallback(\n    ({ item, index }: { item: PortfolioItem; index: number }) => (\n      <Animated.View\n        entering={FadeInDown.delay(index * 80).springify()}\n        style={[styles.investmentCard, { backgroundColor: theme.backgroundDefault }, Shadows.card]}\n      >\n        <View style={styles.investmentHeader}>\n          <View style={styles.investmentInfo}>\n            <ThemedText type=\"heading\" numberOfLines={1}>\n              {item.title}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              {item.company}\n            </ThemedText>\n          </View>\n          <View\n            style={[\n              styles.statusBadge,\n              {\n                backgroundColor:\n                  item.status === \"active\"\n                    ? Colors.secondary + \"15\"\n                    : Colors.warning + \"15\",\n              },\n            ]}\n          >\n            <ThemedText\n              type=\"small\"\n              style={{\n                color: item.status === \"active\" ? Colors.secondary : Colors.warning,\n                fontWeight: \"600\",\n              }}\n            >\n              {item.status.toUpperCase()}\n            </ThemedText>\n          </View>\n        </View>\n\n        <View style={styles.investmentMetrics}>\n          <View>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              Invested\n            </ThemedText>\n            <ThemedText type=\"body\" style={{ fontWeight: \"600\" }}>\n              ${item.amount.toLocaleString()}\n            </ThemedText>\n          </View>\n          <View>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              Current Value\n            </ThemedText>\n            <ThemedText type=\"body\" style={{ fontWeight: \"600\" }}>\n              ${item.currentValue.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n            </ThemedText>\n          </View>\n          <View style={styles.gainLossContainer}>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              Gain/Loss\n            </ThemedText>\n            <View style={styles.gainLossRow}>\n              <Feather\n                name={item.gainLossPercent >= 0 ? \"trending-up\" : \"trending-down\"}\n                size={14}\n                color={item.gainLossPercent >= 0 ? Colors.secondary : Colors.error}\n              />\n              <ThemedText\n                type=\"body\"\n                style={{\n                  color: item.gainLossPercent >= 0 ? Colors.secondary : Colors.error,\n                  fontWeight: \"600\",\n                }}\n              >\n                {item.gainLossPercent >= 0 ? \"+\" : \"\"}\n                {item.gainLossPercent.toFixed(1)}%\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n      </Animated.View>\n    ),\n    [theme]\n  );\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyContainer}>\n      <Image\n        source={require(\"../../assets/images/empty-portfolio.png\")}\n        style={styles.emptyImage}\n        resizeMode=\"contain\"\n      />\n      <ThemedText type=\"heading\" style={styles.emptyTitle}>\n        Start Your Journey\n      </ThemedText>\n      <ThemedText\n        type=\"body\"\n        style={[styles.emptyText, { color: theme.textSecondary }]}\n      >\n        Your investment portfolio is empty. Discover promising healthcare\n        ventures and make your first investment.\n      </ThemedText>\n    </View>\n  );\n\n  const renderHeader = () => (\n    <View style={styles.headerSection}>\n      <LinearGradient\n        colors={[Colors.gradient.start, Colors.gradient.end]}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={[styles.summaryCard, Shadows.card]}\n      >\n        <View style={styles.summaryRow}>\n          <View>\n            <ThemedText type=\"body\" style={styles.summaryLabel}>\n              Total Portfolio Value\n            </ThemedText>\n            <ThemedText type=\"hero\" style={styles.summaryValue}>\n              ${totalValue.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n            </ThemedText>\n          </View>\n          <View style={styles.performanceContainer}>\n            <View\n              style={[\n                styles.performanceBadge,\n                {\n                  backgroundColor:\n                    totalGainLossPercent >= 0\n                      ? \"rgba(255,255,255,0.2)\"\n                      : \"rgba(220,38,38,0.3)\",\n                },\n              ]}\n            >\n              <Feather\n                name={totalGainLossPercent >= 0 ? \"trending-up\" : \"trending-down\"}\n                size={16}\n                color=\"#FFFFFF\"\n              />\n              <ThemedText type=\"body\" style={styles.performanceText}>\n                {totalGainLossPercent >= 0 ? \"+\" : \"\"}\n                {totalGainLossPercent.toFixed(1)}%\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n\n        <View style={styles.summaryStats}>\n          <View style={styles.statItem}>\n            <ThemedText type=\"small\" style={styles.statLabel}>\n              Total Invested\n            </ThemedText>\n            <ThemedText type=\"heading\" style={styles.statValue}>\n              ${totalInvested.toLocaleString()}\n            </ThemedText>\n          </View>\n          <View style={styles.statDivider} />\n          <View style={styles.statItem}>\n            <ThemedText type=\"small\" style={styles.statLabel}>\n              Total Gain/Loss\n            </ThemedText>\n            <ThemedText type=\"heading\" style={styles.statValue}>\n              {totalGainLoss >= 0 ? \"+\" : \"\"}$\n              {Math.abs(totalGainLoss).toLocaleString(undefined, { maximumFractionDigits: 0 })}\n            </ThemedText>\n          </View>\n          <View style={styles.statDivider} />\n          <View style={styles.statItem}>\n            <ThemedText type=\"small\" style={styles.statLabel}>\n              Investments\n            </ThemedText>\n            <ThemedText type=\"heading\" style={styles.statValue}>\n              {investments.length}\n            </ThemedText>\n          </View>\n        </View>\n      </LinearGradient>\n\n      {investments.length > 0 ? (\n        <ThemedText type=\"heading\" style={styles.sectionTitle}>\n          Your Investments\n        </ThemedText>\n      ) : null}\n    </View>\n  );\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <View\n        style={[\n          styles.screenHeader,\n          { paddingTop: insets.top + Spacing.lg },\n        ]}\n      >\n        <ThemedText type=\"title\">Portfolio</ThemedText>\n        <Pressable hitSlop={8}>\n          <Feather name=\"bell\" size={22} color={theme.text} />\n        </Pressable>\n      </View>\n\n      <FlatList\n        data={investments}\n        renderItem={renderItem}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: insets.bottom + 100 },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n        }\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={!isLoading ? renderEmptyState : null}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  screenHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.lg,\n  },\n  listContent: {\n    padding: Spacing.xl,\n    paddingTop: 0,\n  },\n  headerSection: {\n    marginBottom: Spacing.lg,\n  },\n  summaryCard: {\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.xl,\n  },\n  summaryRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.xl,\n  },\n  summaryLabel: {\n    color: \"rgba(255,255,255,0.8)\",\n    marginBottom: Spacing.xs,\n  },\n  summaryValue: {\n    color: \"#FFFFFF\",\n  },\n  performanceContainer: {\n    alignItems: \"flex-end\",\n  },\n  performanceBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  performanceText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n  summaryStats: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  statItem: {\n    flex: 1,\n    alignItems: \"center\",\n  },\n  statDivider: {\n    width: 1,\n    backgroundColor: \"rgba(255,255,255,0.2)\",\n  },\n  statLabel: {\n    color: \"rgba(255,255,255,0.7)\",\n    marginBottom: Spacing.xs,\n  },\n  statValue: {\n    color: \"#FFFFFF\",\n  },\n  sectionTitle: {\n    marginBottom: Spacing.md,\n  },\n  investmentCard: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.md,\n  },\n  investmentHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.md,\n  },\n  investmentInfo: {\n    flex: 1,\n    marginRight: Spacing.md,\n  },\n  statusBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  investmentMetrics: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  gainLossContainer: {\n    alignItems: \"flex-end\",\n  },\n  gainLossRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  emptyContainer: {\n    alignItems: \"center\",\n    paddingVertical: Spacing[\"3xl\"],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyImage: {\n    width: 200,\n    height: 200,\n    marginBottom: Spacing.xl,\n  },\n  emptyTitle: {\n    marginBottom: Spacing.sm,\n    textAlign: \"center\",\n  },\n  emptyText: {\n    textAlign: \"center\",\n  },\n});\n","path":null,"size_bytes":12814,"size_tokens":null},"client/screens/main/ResearchScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n  Image,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  FadeIn,\n  FadeInDown,\n  Layout,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\n\n// Types\ninterface Article {\n  id: string;\n  title: string;\n  summary: string;\n  source: string;\n  publishedAt: string;\n  readTime: number;\n  imageUrl?: string;\n  category: string;\n  isFeatured?: boolean;\n  isBookmarked?: boolean;\n}\n\n// Mock data\nconst MOCK_ARTICLES: Article[] = [\n  {\n    id: '1',\n    title: 'The Future of AI in Medical Diagnostics: A $50B Opportunity',\n    summary: 'Artificial intelligence is revolutionizing how doctors diagnose diseases, with the market expected to grow exponentially over the next decade.',\n    source: 'MedTech Insights',\n    publishedAt: '2 hours ago',\n    readTime: 8,\n    category: 'AI & Healthcare',\n    isFeatured: true,\n  },\n  {\n    id: '2',\n    title: 'Gene Therapy Breakthroughs: What Investors Need to Know',\n    summary: 'Recent FDA approvals have opened new doors for gene therapy investments.',\n    source: 'BioPharma Weekly',\n    publishedAt: '5 hours ago',\n    readTime: 5,\n    category: 'Biotech',\n  },\n  {\n    id: '3',\n    title: 'Digital Health Startups Raised Record $15B in 2024',\n    summary: 'Venture capital continues to flow into healthcare technology companies.',\n    source: 'Healthcare Finance',\n    publishedAt: '1 day ago',\n    readTime: 4,\n    category: 'Market Trends',\n    isBookmarked: true,\n  },\n  {\n    id: '4',\n    title: 'Medical Device Innovation: Top Trends for 2025',\n    summary: 'From wearables to surgical robots, here are the technologies shaping the industry.',\n    source: 'Device Magazine',\n    publishedAt: '2 days ago',\n    readTime: 6,\n    category: 'Medical Devices',\n  },\n  {\n    id: '5',\n    title: 'Telemedicine After COVID: Sustainable Growth or Bubble?',\n    summary: 'Analysis of the telehealth sector two years after the pandemic boom.',\n    source: 'Digital Health Today',\n    publishedAt: '3 days ago',\n    readTime: 7,\n    category: 'Digital Health',\n  },\n];\n\n/**\n * Research Screen\n * Healthcare news and insights\n */\nexport default function ResearchScreen() {\n  const insets = useSafeAreaInsets();\n  \n  const [refreshing, setRefreshing] = useState(false);\n  const [articles] = useState<Article[]>(MOCK_ARTICLES);\n  const [bookmarkedIds, setBookmarkedIds] = useState<Set<string>>(\n    new Set(MOCK_ARTICLES.filter((a) => a.isBookmarked).map((a) => a.id))\n  );\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    setRefreshing(false);\n  }, []);\n\n  const handleArticlePress = useCallback((article: Article) => {\n    // TODO: Navigate to article detail\n    console.log('Open article:', article.id);\n  }, []);\n\n  const handleBookmarkPress = useCallback((articleId: string) => {\n    setBookmarkedIds((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(articleId)) {\n        newSet.delete(articleId);\n      } else {\n        newSet.add(articleId);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const featuredArticle = articles.find((a) => a.isFeatured);\n  const regularArticles = articles.filter((a) => !a.isFeatured);\n\n  const renderHeader = () => (\n    <View style={styles.headerContent}>\n      {/* Featured Article */}\n      {featuredArticle && (\n        <Animated.View entering={FadeInDown.duration(600).delay(100)}>\n          <Pressable\n            style={styles.featuredCard}\n            onPress={() => handleArticlePress(featuredArticle)}\n          >\n            <View style={styles.featuredImagePlaceholder}>\n              <Feather name=\"book-open\" size={48} color={colors.primary.main} />\n            </View>\n            <View style={styles.featuredContent}>\n              <View style={styles.featuredMeta}>\n                <View style={styles.categoryBadge}>\n                  <Text style={styles.categoryBadgeText}>\n                    {featuredArticle.category}\n                  </Text>\n                </View>\n                <Pressable\n                  onPress={() => handleBookmarkPress(featuredArticle.id)}\n                  hitSlop={8}\n                >\n                  <Feather\n                    name={bookmarkedIds.has(featuredArticle.id) ? 'bookmark' : 'bookmark'}\n                    size={20}\n                    color={\n                      bookmarkedIds.has(featuredArticle.id)\n                        ? colors.primary.main\n                        : colors.text.tertiary\n                    }\n                  />\n                </Pressable>\n              </View>\n              <Text style={styles.featuredTitle} numberOfLines={3}>\n                {featuredArticle.title}\n              </Text>\n              <Text style={styles.featuredSummary} numberOfLines={2}>\n                {featuredArticle.summary}\n              </Text>\n              <View style={styles.featuredFooter}>\n                <Text style={styles.sourceText}>{featuredArticle.source}</Text>\n                <View style={styles.readTimeContainer}>\n                  <Feather\n                    name=\"clock\"\n                    size={12}\n                    color={colors.text.tertiary}\n                  />\n                  <Text style={styles.readTimeText}>\n                    {featuredArticle.readTime} min read\n                  </Text>\n                </View>\n              </View>\n            </View>\n          </Pressable>\n        </Animated.View>\n      )}\n\n      {/* Section Header */}\n      <Animated.View\n        entering={FadeInDown.duration(600).delay(200)}\n        style={styles.sectionHeader}\n      >\n        <Text style={styles.sectionTitle}>Latest Articles</Text>\n        <Pressable>\n          <Feather name=\"filter\" size={20} color={colors.text.secondary} />\n        </Pressable>\n      </Animated.View>\n    </View>\n  );\n\n  const renderArticleItem = ({\n    item,\n    index,\n  }: {\n    item: Article;\n    index: number;\n  }) => {\n    const isBookmarked = bookmarkedIds.has(item.id);\n\n    return (\n      <Animated.View\n        entering={FadeInDown.duration(400).delay(300 + index * 80)}\n        layout={Layout.springify()}\n      >\n        <Pressable\n          style={styles.articleItem}\n          onPress={() => handleArticlePress(item)}\n        >\n          {/* Thumbnail */}\n          <View style={styles.articleThumbnail}>\n            <Feather name=\"file-text\" size={24} color={colors.primary.main} />\n          </View>\n\n          {/* Content */}\n          <View style={styles.articleContent}>\n            <View style={styles.articleMeta}>\n              <Text style={styles.articleCategory}>{item.category}</Text>\n              <Text style={styles.articleDot}>‚Ä¢</Text>\n              <Text style={styles.articleTime}>{item.publishedAt}</Text>\n            </View>\n            <Text style={styles.articleTitle} numberOfLines={2}>\n              {item.title}\n            </Text>\n            <View style={styles.articleFooter}>\n              <Text style={styles.articleSource}>{item.source}</Text>\n              <View style={styles.articleActions}>\n                <View style={styles.readTimeContainer}>\n                  <Feather\n                    name=\"clock\"\n                    size={12}\n                    color={colors.text.tertiary}\n                  />\n                  <Text style={styles.readTimeText}>{item.readTime} min</Text>\n                </View>\n                <Pressable\n                  onPress={() => handleBookmarkPress(item.id)}\n                  hitSlop={8}\n                >\n                  <Feather\n                    name=\"bookmark\"\n                    size={16}\n                    color={\n                      isBookmarked ? colors.primary.main : colors.text.tertiary\n                    }\n                  />\n                </Pressable>\n              </View>\n            </View>\n          </View>\n        </Pressable>\n      </Animated.View>\n    );\n  };\n\n  const renderEmptyState = () => (\n    <Animated.View entering={FadeIn.duration(400)} style={styles.emptyState}>\n      <View style={styles.emptyIcon}>\n        <Feather name=\"book-open\" size={64} color={colors.text.tertiary} />\n      </View>\n      <Text style={styles.emptyTitle}>No articles yet</Text>\n      <Text style={styles.emptyDescription}>\n        Check back later for healthcare news and investment insights.\n      </Text>\n    </Animated.View>\n  );\n\n  return (\n    <View style={styles.container}>\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Text style={styles.screenTitle}>Research</Text>\n        <Pressable style={styles.headerButton}>\n          <Feather name=\"bookmark\" size={24} color={colors.text.primary} />\n        </Pressable>\n      </View>\n\n      {/* Content */}\n      <FlatList\n        data={regularArticles}\n        keyExtractor={(item) => item.id}\n        renderItem={renderArticleItem}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmptyState}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: layout.tabBarHeight + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={handleRefresh}\n            tintColor={colors.primary.main}\n          />\n        }\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Header\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    backgroundColor: colors.background.primary,\n  },\n  screenTitle: {\n    ...typography.title,\n    color: colors.text.primary,\n  },\n  headerButton: {\n    padding: spacing.xs,\n  },\n\n  // Header Content\n  headerContent: {\n    paddingBottom: spacing.md,\n  },\n\n  // Featured Card\n  featuredCard: {\n    marginHorizontal: spacing.lg,\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusLarge,\n    overflow: 'hidden',\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    ...shadows.card,\n  },\n  featuredImagePlaceholder: {\n    height: 160,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  featuredContent: {\n    padding: spacing.lg,\n  },\n  featuredMeta: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: spacing.sm,\n  },\n  categoryBadge: {\n    backgroundColor: colors.transparent.primary10,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusSmall,\n  },\n  categoryBadgeText: {\n    ...typography.small,\n    color: colors.primary.main,\n  },\n  featuredTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  featuredSummary: {\n    ...typography.body,\n    color: colors.text.secondary,\n    marginBottom: spacing.md,\n  },\n  featuredFooter: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  sourceText: {\n    ...typography.caption,\n    color: colors.text.tertiary,\n  },\n  readTimeContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n  },\n  readTimeText: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n\n  // Section Header\n  sectionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.xl,\n    paddingBottom: spacing.md,\n  },\n  sectionTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n\n  // List\n  listContent: {\n    paddingTop: spacing.md,\n  },\n\n  // Article Item\n  articleItem: {\n    flexDirection: 'row',\n    backgroundColor: colors.surface.primary,\n    marginHorizontal: spacing.lg,\n    marginBottom: spacing.sm,\n    padding: spacing.md,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  articleThumbnail: {\n    width: 72,\n    height: 72,\n    borderRadius: layout.radiusMedium,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  articleContent: {\n    flex: 1,\n    justifyContent: 'space-between',\n  },\n  articleMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: spacing.xs,\n  },\n  articleCategory: {\n    ...typography.small,\n    color: colors.primary.main,\n  },\n  articleDot: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    marginHorizontal: spacing.xs,\n  },\n  articleTime: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  articleTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  articleFooter: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  articleSource: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  articleActions: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.md,\n  },\n\n  // Empty State\n  emptyState: {\n    alignItems: 'center',\n    paddingVertical: spacing['3xl'],\n    paddingHorizontal: spacing.xl,\n  },\n  emptyIcon: {\n    marginBottom: spacing.lg,\n  },\n  emptyTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  emptyDescription: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":13835,"size_tokens":null},"client/components/HeaderMenu.tsx":{"content":"/**\n * Header Menu Dropdown Component\n * Navigation menu matching web version functionality\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Modal,\n  Pressable,\n  Dimensions,\n  Image,\n  ScrollView,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useAuth } from '@/contexts/AuthContext';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\ninterface HeaderMenuProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\ninterface MenuItem {\n  icon: string;\n  iconType: 'ionicons' | 'material';\n  label: string;\n  route?: string;\n  action?: () => void;\n}\n\nexport default function HeaderMenu({ visible, onClose }: HeaderMenuProps) {\n  const appColors = useAppColors();\n  const navigation = useNavigation<any>();\n  const { user, signOut } = useAuth();\n\n  const handleNavigate = useCallback((route: string, params?: any) => {\n    onClose();\n    navigation.navigate(route, params);\n  }, [navigation, onClose]);\n\n  const handleLogout = useCallback(async () => {\n    onClose();\n    await signOut();\n  }, [signOut, onClose]);\n\n  const mainMenuItems: MenuItem[] = [\n    { icon: 'home', iconType: 'ionicons', label: 'Feed', route: 'Main' },\n    { icon: 'videocam', iconType: 'ionicons', label: 'AMAs', route: 'AMADetail' },\n    { icon: 'newspaper', iconType: 'ionicons', label: 'News', route: 'Search' },\n    { icon: 'globe', iconType: 'ionicons', label: 'Network', route: 'Followers' },\n    { icon: 'robot', iconType: 'material', label: 'AI Assistant', route: 'AIChat' },\n  ];\n\n  const accountItems: MenuItem[] = [\n    { icon: 'person', iconType: 'ionicons', label: 'Profile', route: 'Main', action: () => handleNavigate('Main', { screen: 'Profile' }) },\n    { icon: 'bookmark', iconType: 'ionicons', label: 'Bookmarks', route: 'Bookmarks' },\n    { icon: 'trophy', iconType: 'ionicons', label: 'Achievements', route: 'Achievements' },\n    { icon: 'star', iconType: 'ionicons', label: 'Premium', route: 'Premium' },\n    { icon: 'settings', iconType: 'ionicons', label: 'Settings', route: 'Settings' },\n  ];\n\n  const renderMenuItem = (item: MenuItem, index: number) => {\n    const handlePress = () => {\n      if (item.action) {\n        item.action();\n      } else if (item.route) {\n        handleNavigate(item.route);\n      }\n    };\n\n    return (\n      <TouchableOpacity\n        key={`${item.label}-${index}`}\n        style={styles.menuItem}\n        onPress={handlePress}\n      >\n        {item.iconType === 'ionicons' ? (\n          <Ionicons name={item.icon as any} size={22} color={appColors.textPrimary} />\n        ) : (\n          <MaterialCommunityIcons name={item.icon as any} size={22} color={appColors.textPrimary} />\n        )}\n        <ThemedText style={[styles.menuItemText, { color: appColors.textPrimary }]}>{item.label}</ThemedText>\n      </TouchableOpacity>\n    );\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n    >\n      <Pressable style={styles.overlay} onPress={onClose}>\n        <Pressable \n          style={[styles.menuContainer, { backgroundColor: appColors.surface }]}\n          onPress={(e) => e.stopPropagation()}\n        >\n          <ScrollView bounces={false} showsVerticalScrollIndicator={false}>\n            {/* User Profile Section */}\n            <TouchableOpacity \n              style={[styles.userSection, { borderBottomColor: appColors.border }]}\n              onPress={() => handleNavigate('Main', { screen: 'Profile' })}\n            >\n              <View style={styles.userAvatar}>\n                {user?.avatar_url ? (\n                  <Image source={{ uri: user.avatar_url }} style={styles.avatarImage} />\n                ) : (\n                  <View style={styles.avatarPlaceholder}>\n                    <ThemedText style={styles.avatarText}>\n                      {user?.first_name?.[0] || user?.email?.[0]?.toUpperCase() || 'U'}\n                    </ThemedText>\n                  </View>\n                )}\n              </View>\n              <View style={styles.userInfo}>\n                <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>\n                  {user?.first_name ? `${user.first_name} ${user.last_name || ''}`.trim() : user?.email?.split('@')[0] || 'User'}\n                </ThemedText>\n                <ThemedText style={[styles.userHandle, { color: appColors.textSecondary }]}>\n                  {user?.email || 'user@email.com'}\n                </ThemedText>\n              </View>\n              <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n            </TouchableOpacity>\n\n            {/* Main Navigation */}\n            <View style={[styles.menuSection, { borderBottomColor: appColors.border }]}>\n              <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Navigation</ThemedText>\n              {mainMenuItems.map(renderMenuItem)}\n            </View>\n\n            {/* Account */}\n            <View style={[styles.menuSection, { borderBottomColor: appColors.border }]}>\n              <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Account</ThemedText>\n              {accountItems.map(renderMenuItem)}\n            </View>\n\n            {/* Sign Out */}\n            <TouchableOpacity style={styles.logoutButton} onPress={handleLogout} testID=\"button-sign-out\">\n              <Ionicons name=\"log-out-outline\" size={22} color={appColors.error} />\n              <ThemedText style={[styles.logoutText, { color: appColors.error }]}>Sign Out</ThemedText>\n            </TouchableOpacity>\n          </ScrollView>\n        </Pressable>\n      </Pressable>\n    </Modal>\n  );\n}\n\n// Menu Button for Header\ninterface MenuButtonProps {\n  onPress: () => void;\n}\n\nexport function MenuButton({ onPress }: MenuButtonProps) {\n  const appColors = useAppColors();\n  return (\n    <TouchableOpacity style={styles.menuButton} onPress={onPress}>\n      <Ionicons name=\"menu\" size={26} color={appColors.textPrimary} />\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.4)',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-end',\n  },\n  menuContainer: {\n    width: Math.min(SCREEN_WIDTH * 0.85, 320),\n    maxHeight: SCREEN_HEIGHT * 0.9,\n    borderTopLeftRadius: BorderRadius.xl,\n    borderBottomLeftRadius: BorderRadius.xl,\n    marginTop: 60,\n    ...Shadows.card,\n    shadowOpacity: 0.25,\n    elevation: 10,\n  },\n  userSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderTopLeftRadius: BorderRadius.xl,\n  },\n  userAvatar: {\n    marginRight: Spacing.md,\n  },\n  avatarImage: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n  },\n  avatarPlaceholder: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.heading,\n    color: 'white',\n    fontWeight: '600',\n  },\n  userInfo: {\n    flex: 1,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userHandle: {\n    ...Typography.small,\n  },\n  menuSection: {\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.xs,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.lg,\n  },\n  menuItemText: {\n    ...Typography.body,\n    marginLeft: Spacing.md,\n  },\n  logoutButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.lg,\n    paddingHorizontal: Spacing.lg,\n    marginTop: Spacing.sm,\n  },\n  logoutText: {\n    ...Typography.body,\n    marginLeft: Spacing.md,\n    fontWeight: '500',\n  },\n  menuButton: {\n    padding: Spacing.xs,\n  },\n});\n","path":null,"size_bytes":8361,"size_tokens":null},"client/components/MessageStatus.tsx":{"content":"/**\n * Message Status Components\n * Read receipts and typing indicators for messaging\n */\n\nimport React, { useEffect, useRef, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  Easing,\n  Image,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useThemeContext } from '@/contexts/ThemeContext';\n\n// =============================================================================\n// READ RECEIPTS\n// =============================================================================\n\nexport type MessageStatus = 'sending' | 'sent' | 'delivered' | 'read' | 'failed';\n\ninterface ReadReceiptProps {\n  status: MessageStatus;\n  readAt?: string;\n  size?: number;\n}\n\nexport const ReadReceipt = memo(function ReadReceipt({\n  status,\n  readAt,\n  size = 16,\n}: ReadReceiptProps) {\n  const { colors } = useThemeContext();\n\n  const getIcon = () => {\n    switch (status) {\n      case 'sending':\n        return { name: 'time-outline', color: colors.textSecondary };\n      case 'sent':\n        return { name: 'checkmark', color: colors.textSecondary };\n      case 'delivered':\n        return { name: 'checkmark-done', color: colors.textSecondary };\n      case 'read':\n        return { name: 'checkmark-done', color: colors.primary };\n      case 'failed':\n        return { name: 'alert-circle', color: colors.error };\n      default:\n        return { name: 'checkmark', color: colors.textSecondary };\n    }\n  };\n\n  const icon = getIcon();\n\n  return (\n    <View style={styles.readReceipt}>\n      <Ionicons name={icon.name as any} size={size} color={icon.color} />\n    </View>\n  );\n});\n\n// Read receipt with avatars (for group chats or detailed view)\ninterface ReadReceiptWithAvatarsProps {\n  readBy: Array<{\n    id: number;\n    full_name: string;\n    avatar_url?: string;\n    read_at: string;\n  }>;\n  totalRecipients: number;\n  maxAvatars?: number;\n}\n\nexport const ReadReceiptWithAvatars = memo(function ReadReceiptWithAvatars({\n  readBy,\n  totalRecipients,\n  maxAvatars = 3,\n}: ReadReceiptWithAvatarsProps) {\n  const { colors } = useThemeContext();\n  const appColors = useAppColors();\n  const displayedAvatars = readBy.slice(0, maxAvatars);\n  const remainingCount = readBy.length - maxAvatars;\n\n  if (readBy.length === 0) {\n    return (\n      <View style={styles.avatarReceipts}>\n        <Ionicons name=\"checkmark-done\" size={14} color={colors.textSecondary} />\n        <ThemedText style={[styles.receiptText, { color: colors.textSecondary }]}>\n          Delivered\n        </ThemedText>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.avatarReceipts}>\n      <ThemedText style={[styles.receiptText, { color: colors.textSecondary }]}>\n        Seen by\n      </ThemedText>\n      <View style={styles.avatarStack}>\n        {displayedAvatars.map((user, index) => (\n          <View\n            key={user.id}\n            style={[\n              styles.stackedAvatar,\n              { marginLeft: index > 0 ? -8 : 0, zIndex: maxAvatars - index },\n            ]}\n          >\n            {user.avatar_url ? (\n              <Image source={{ uri: user.avatar_url }} style={[styles.miniAvatar, { borderColor: appColors.surface }]} />\n            ) : (\n              <View style={[styles.miniAvatar, styles.miniAvatarPlaceholder, { backgroundColor: colors.primary }]}>\n                <ThemedText style={styles.miniAvatarText}>\n                  {user.full_name[0]}\n                </ThemedText>\n              </View>\n            )}\n          </View>\n        ))}\n        {remainingCount > 0 && (\n          <View style={[styles.stackedAvatar, styles.remainingBadge, { marginLeft: -8, backgroundColor: colors.backgroundSecondary }]}>\n            <ThemedText style={[styles.remainingText, { color: colors.textSecondary }]}>\n              +{remainingCount}\n            </ThemedText>\n          </View>\n        )}\n      </View>\n      {readBy.length === totalRecipients && totalRecipients > 1 && (\n        <ThemedText style={[styles.allReadText, { color: colors.textSecondary }]}>\n          All\n        </ThemedText>\n      )}\n    </View>\n  );\n});\n\n// =============================================================================\n// TYPING INDICATORS\n// =============================================================================\n\ninterface TypingIndicatorProps {\n  users?: Array<{ id: number; full_name: string }>;\n  isTyping?: boolean;\n}\n\nexport const TypingIndicator = memo(function TypingIndicator({\n  users = [],\n  isTyping = false,\n}: TypingIndicatorProps) {\n  const { colors } = useThemeContext();\n\n  if (!isTyping && users.length === 0) return null;\n\n  const getTypingText = () => {\n    if (users.length === 0) return 'typing';\n    if (users.length === 1) return `${users[0].full_name.split(' ')[0]} is typing`;\n    if (users.length === 2) {\n      return `${users[0].full_name.split(' ')[0]} and ${users[1].full_name.split(' ')[0]} are typing`;\n    }\n    return `${users.length} people are typing`;\n  };\n\n  return (\n    <View style={styles.typingContainer}>\n      <TypingDots />\n      <ThemedText style={[styles.typingText, { color: colors.textSecondary }]}>\n        {getTypingText()}\n      </ThemedText>\n    </View>\n  );\n});\n\n// Animated typing dots\nexport const TypingDots = memo(function TypingDots() {\n  const { colors } = useThemeContext();\n  const dot1 = useRef(new Animated.Value(0)).current;\n  const dot2 = useRef(new Animated.Value(0)).current;\n  const dot3 = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    const createDotAnimation = (dot: Animated.Value, delay: number) => {\n      return Animated.loop(\n        Animated.sequence([\n          Animated.delay(delay),\n          Animated.timing(dot, {\n            toValue: 1,\n            duration: 300,\n            easing: Easing.ease,\n            useNativeDriver: true,\n          }),\n          Animated.timing(dot, {\n            toValue: 0,\n            duration: 300,\n            easing: Easing.ease,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n    };\n\n    const animation = Animated.parallel([\n      createDotAnimation(dot1, 0),\n      createDotAnimation(dot2, 150),\n      createDotAnimation(dot3, 300),\n    ]);\n\n    animation.start();\n    return () => animation.stop();\n  }, []);\n\n  const animatedStyle = (dot: Animated.Value) => ({\n    transform: [\n      {\n        translateY: dot.interpolate({\n          inputRange: [0, 1],\n          outputRange: [0, -4],\n        }),\n      },\n    ],\n  });\n\n  return (\n    <View style={styles.dotsContainer}>\n      <Animated.View\n        style={[styles.dot, { backgroundColor: colors.textSecondary }, animatedStyle(dot1)]}\n      />\n      <Animated.View\n        style={[styles.dot, { backgroundColor: colors.textSecondary }, animatedStyle(dot2)]}\n      />\n      <Animated.View\n        style={[styles.dot, { backgroundColor: colors.textSecondary }, animatedStyle(dot3)]}\n      />\n    </View>\n  );\n});\n\n// Typing indicator bubble (for chat list)\ninterface TypingBubbleProps {\n  size?: 'small' | 'medium';\n}\n\nexport const TypingBubble = memo(function TypingBubble({\n  size = 'medium',\n}: TypingBubbleProps) {\n  const { colors } = useThemeContext();\n  const dotSize = size === 'small' ? 4 : 6;\n  const containerPadding = size === 'small' ? Spacing.xs : Spacing.sm;\n\n  return (\n    <View \n      style={[\n        styles.typingBubble, \n        { \n          backgroundColor: colors.backgroundSecondary,\n          paddingHorizontal: containerPadding * 2,\n          paddingVertical: containerPadding,\n        }\n      ]}\n    >\n      <TypingDotsSimple dotSize={dotSize} color={colors.textSecondary} />\n    </View>\n  );\n});\n\n// Simple typing dots (no vertical animation, just opacity)\nconst TypingDotsSimple = memo(function TypingDotsSimple({\n  dotSize = 6,\n  color,\n}: {\n  dotSize?: number;\n  color?: string;\n}) {\n  const appColors = useAppColors();\n  const dotColor = color ?? appColors.textSecondary;\n  const opacity1 = useRef(new Animated.Value(0.3)).current;\n  const opacity2 = useRef(new Animated.Value(0.3)).current;\n  const opacity3 = useRef(new Animated.Value(0.3)).current;\n\n  useEffect(() => {\n    const createAnimation = (value: Animated.Value, delay: number) => {\n      return Animated.loop(\n        Animated.sequence([\n          Animated.delay(delay),\n          Animated.timing(value, {\n            toValue: 1,\n            duration: 400,\n            useNativeDriver: true,\n          }),\n          Animated.timing(value, {\n            toValue: 0.3,\n            duration: 400,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n    };\n\n    const animation = Animated.parallel([\n      createAnimation(opacity1, 0),\n      createAnimation(opacity2, 200),\n      createAnimation(opacity3, 400),\n    ]);\n\n    animation.start();\n    return () => animation.stop();\n  }, []);\n\n  return (\n    <View style={styles.simpleDotsContainer}>\n      <Animated.View\n        style={[\n          styles.simpleDot,\n          { width: dotSize, height: dotSize, backgroundColor: dotColor, opacity: opacity1 },\n        ]}\n      />\n      <Animated.View\n        style={[\n          styles.simpleDot,\n          { width: dotSize, height: dotSize, backgroundColor: dotColor, opacity: opacity2 },\n        ]}\n      />\n      <Animated.View\n        style={[\n          styles.simpleDot,\n          { width: dotSize, height: dotSize, backgroundColor: dotColor, opacity: opacity3 },\n        ]}\n      />\n    </View>\n  );\n});\n\n// =============================================================================\n// MESSAGE TIMESTAMP WITH STATUS\n// =============================================================================\n\ninterface MessageTimestampProps {\n  timestamp: string;\n  status?: MessageStatus;\n  isOwn?: boolean;\n}\n\nexport const MessageTimestamp = memo(function MessageTimestamp({\n  timestamp,\n  status,\n  isOwn = false,\n}: MessageTimestampProps) {\n  const { colors } = useThemeContext();\n\n  const formatTime = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  return (\n    <View style={styles.timestampContainer}>\n      <ThemedText style={[styles.timestamp, { color: colors.textSecondary }]}>\n        {formatTime(timestamp)}\n      </ThemedText>\n      {isOwn && status && <ReadReceipt status={status} size={14} />}\n    </View>\n  );\n});\n\n// =============================================================================\n// ONLINE STATUS INDICATOR\n// =============================================================================\n\ninterface OnlineStatusProps {\n  isOnline: boolean;\n  lastSeen?: string;\n  size?: number;\n  showBorder?: boolean;\n}\n\nexport const OnlineStatus = memo(function OnlineStatus({\n  isOnline,\n  lastSeen,\n  size = 12,\n  showBorder = true,\n}: OnlineStatusProps) {\n  const { colors } = useThemeContext();\n\n  return (\n    <View\n      style={[\n        styles.onlineIndicator,\n        {\n          width: size,\n          height: size,\n          borderRadius: size / 2,\n          backgroundColor: isOnline ? Colors.secondary : colors.textSecondary,\n          borderWidth: showBorder ? 2 : 0,\n          borderColor: colors.surface,\n        },\n      ]}\n    />\n  );\n});\n\n// Last seen text\ninterface LastSeenTextProps {\n  isOnline: boolean;\n  lastSeen?: string;\n}\n\nexport const LastSeenText = memo(function LastSeenText({\n  isOnline,\n  lastSeen,\n}: LastSeenTextProps) {\n  const { colors } = useThemeContext();\n\n  if (isOnline) {\n    return (\n      <ThemedText style={[styles.lastSeenText, { color: Colors.secondary }]}>\n        Online\n      </ThemedText>\n    );\n  }\n\n  if (!lastSeen) return null;\n\n  const formatLastSeen = (dateString: string) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMins / 60);\n    const diffDays = Math.floor(diffHours / 24);\n\n    if (diffMins < 1) return 'Just now';\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffHours < 24) return `${diffHours}h ago`;\n    if (diffDays < 7) return `${diffDays}d ago`;\n    return date.toLocaleDateString();\n  };\n\n  return (\n    <ThemedText style={[styles.lastSeenText, { color: colors.textSecondary }]}>\n      Last seen {formatLastSeen(lastSeen)}\n    </ThemedText>\n  );\n});\n\nconst styles = StyleSheet.create({\n  // Read receipts\n  readReceipt: {\n    marginLeft: 4,\n  },\n  avatarReceipts: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  receiptText: {\n    ...Typography.small,\n  },\n  avatarStack: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  stackedAvatar: {\n    borderRadius: 10,\n    overflow: 'hidden',\n  },\n  miniAvatar: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    borderWidth: 1,\n  },\n  miniAvatarPlaceholder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  miniAvatarText: {\n    ...Typography.small,\n    fontSize: 10,\n    color: 'white',\n    fontWeight: '600',\n  },\n  remainingBadge: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  remainingText: {\n    ...Typography.small,\n    fontSize: 10,\n    fontWeight: '600',\n  },\n  allReadText: {\n    ...Typography.small,\n  },\n\n  // Typing indicator\n  typingContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    gap: Spacing.sm,\n  },\n  typingText: {\n    ...Typography.small,\n    fontStyle: 'italic',\n  },\n  dotsContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 3,\n  },\n  dot: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n  },\n  typingBubble: {\n    borderRadius: 16,\n    alignSelf: 'flex-start',\n  },\n  simpleDotsContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 3,\n  },\n  simpleDot: {\n    borderRadius: 100,\n  },\n\n  // Timestamp\n  timestampContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 2,\n  },\n  timestamp: {\n    ...Typography.small,\n    fontSize: 11,\n  },\n\n  // Online status\n  onlineIndicator: {},\n  lastSeenText: {\n    ...Typography.small,\n  },\n});\n","path":null,"size_bytes":14268,"size_tokens":null},"client/lib/media-picker.ts":{"content":"/**\n * Media Picker Utility\n * Handle photo and video selection/capture\n */\n\nimport * as ImagePicker from 'expo-image-picker';\nimport * as FileSystem from 'expo-file-system';\nimport { Alert, Platform } from 'react-native';\n\nexport interface MediaAsset {\n  uri: string;\n  type: 'image' | 'video';\n  width?: number;\n  height?: number;\n  duration?: number; // Video duration in ms\n  fileName?: string;\n  fileSize?: number;\n  mimeType?: string;\n}\n\nexport interface MediaPickerOptions {\n  mediaTypes?: 'images' | 'videos' | 'all';\n  allowsMultipleSelection?: boolean;\n  maxSelection?: number;\n  quality?: number;\n  maxDuration?: number; // Max video duration in seconds\n  maxFileSize?: number; // Max file size in bytes\n}\n\nconst DEFAULT_OPTIONS: MediaPickerOptions = {\n  mediaTypes: 'all',\n  allowsMultipleSelection: true,\n  maxSelection: 10,\n  quality: 0.8,\n  maxDuration: 60, // 60 seconds\n  maxFileSize: 50 * 1024 * 1024, // 50MB\n};\n\n/**\n * Request media library permissions\n */\nexport async function requestMediaPermissions(): Promise<boolean> {\n  const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n  if (status !== 'granted') {\n    Alert.alert(\n      'Permission Required',\n      'Please grant access to your photo library to upload media.',\n      [{ text: 'OK' }]\n    );\n    return false;\n  }\n  return true;\n}\n\n/**\n * Request camera permissions\n */\nexport async function requestCameraPermissions(): Promise<boolean> {\n  const { status } = await ImagePicker.requestCameraPermissionsAsync();\n  if (status !== 'granted') {\n    Alert.alert(\n      'Permission Required',\n      'Please grant camera access to take photos and videos.',\n      [{ text: 'OK' }]\n    );\n    return false;\n  }\n  return true;\n}\n\n/**\n * Get media type from ImagePicker\n */\nfunction getMediaType(asset: ImagePicker.ImagePickerAsset): 'image' | 'video' {\n  if (asset.type === 'video') return 'video';\n  // Check file extension as fallback\n  const uri = asset.uri.toLowerCase();\n  if (uri.endsWith('.mp4') || uri.endsWith('.mov') || uri.endsWith('.avi') || uri.endsWith('.webm')) {\n    return 'video';\n  }\n  return 'image';\n}\n\n/**\n * Get file info\n */\nasync function getFileInfo(uri: string): Promise<{ size: number; exists: boolean }> {\n  try {\n    const info = await FileSystem.getInfoAsync(uri);\n    return {\n      size: info.exists && 'size' in info ? info.size : 0,\n      exists: info.exists,\n    };\n  } catch {\n    return { size: 0, exists: false };\n  }\n}\n\n/**\n * Convert ImagePicker asset to MediaAsset\n */\nasync function convertToMediaAsset(asset: ImagePicker.ImagePickerAsset): Promise<MediaAsset> {\n  const fileInfo = await getFileInfo(asset.uri);\n  const type = getMediaType(asset);\n  \n  return {\n    uri: asset.uri,\n    type,\n    width: asset.width,\n    height: asset.height,\n    duration: asset.duration ? asset.duration * 1000 : undefined,\n    fileName: asset.fileName || `media_${Date.now()}.${type === 'video' ? 'mp4' : 'jpg'}`,\n    fileSize: fileInfo.size,\n    mimeType: type === 'video' ? 'video/mp4' : 'image/jpeg',\n  };\n}\n\n/**\n * Validate media asset against options\n */\nfunction validateAsset(asset: MediaAsset, options: MediaPickerOptions): string | null {\n  // Check file size\n  if (options.maxFileSize && asset.fileSize && asset.fileSize > options.maxFileSize) {\n    const maxMB = Math.round(options.maxFileSize / (1024 * 1024));\n    return `File size exceeds ${maxMB}MB limit`;\n  }\n\n  // Check video duration\n  if (asset.type === 'video' && options.maxDuration && asset.duration) {\n    const durationSeconds = asset.duration / 1000;\n    if (durationSeconds > options.maxDuration) {\n      return `Video exceeds ${options.maxDuration} seconds limit`;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Pick media from library\n */\nexport async function pickMedia(options: MediaPickerOptions = {}): Promise<MediaAsset[]> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n\n  // Request permissions\n  const hasPermission = await requestMediaPermissions();\n  if (!hasPermission) return [];\n\n  // Determine media types\n  let mediaTypes: ImagePicker.MediaTypeOptions;\n  switch (opts.mediaTypes) {\n    case 'images':\n      mediaTypes = ImagePicker.MediaTypeOptions.Images;\n      break;\n    case 'videos':\n      mediaTypes = ImagePicker.MediaTypeOptions.Videos;\n      break;\n    default:\n      mediaTypes = ImagePicker.MediaTypeOptions.All;\n  }\n\n  try {\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes,\n      allowsMultipleSelection: opts.allowsMultipleSelection,\n      selectionLimit: opts.maxSelection,\n      quality: opts.quality,\n      videoQuality: ImagePicker.UIImagePickerControllerQualityType.Medium,\n      videoMaxDuration: opts.maxDuration,\n    });\n\n    if (result.canceled || !result.assets) return [];\n\n    // Convert and validate assets\n    const mediaAssets: MediaAsset[] = [];\n    const errors: string[] = [];\n\n    for (const asset of result.assets) {\n      const mediaAsset = await convertToMediaAsset(asset);\n      const error = validateAsset(mediaAsset, opts);\n      \n      if (error) {\n        errors.push(error);\n      } else {\n        mediaAssets.push(mediaAsset);\n      }\n    }\n\n    // Show validation errors\n    if (errors.length > 0) {\n      Alert.alert('Some files skipped', errors.join('\\n'));\n    }\n\n    return mediaAssets;\n  } catch (error) {\n    console.error('Error picking media:', error);\n    Alert.alert('Error', 'Failed to select media');\n    return [];\n  }\n}\n\n/**\n * Capture photo or video with camera\n */\nexport async function captureMedia(\n  type: 'photo' | 'video',\n  options: MediaPickerOptions = {}\n): Promise<MediaAsset | null> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n\n  // Request permissions\n  const hasPermission = await requestCameraPermissions();\n  if (!hasPermission) return null;\n\n  try {\n    const result = await ImagePicker.launchCameraAsync({\n      mediaTypes: type === 'photo' \n        ? ImagePicker.MediaTypeOptions.Images \n        : ImagePicker.MediaTypeOptions.Videos,\n      quality: opts.quality,\n      videoQuality: ImagePicker.UIImagePickerControllerQualityType.Medium,\n      videoMaxDuration: opts.maxDuration,\n      allowsEditing: true,\n    });\n\n    if (result.canceled || !result.assets?.[0]) return null;\n\n    const mediaAsset = await convertToMediaAsset(result.assets[0]);\n    const error = validateAsset(mediaAsset, opts);\n\n    if (error) {\n      Alert.alert('Error', error);\n      return null;\n    }\n\n    return mediaAsset;\n  } catch (error) {\n    console.error('Error capturing media:', error);\n    Alert.alert('Error', 'Failed to capture media');\n    return null;\n  }\n}\n\n/**\n * Show media picker action sheet\n */\nexport function showMediaPickerOptions(\n  onPickFromLibrary: () => void,\n  onTakePhoto: () => void,\n  onTakeVideo: () => void\n): void {\n  Alert.alert(\n    'Add Media',\n    'Choose an option',\n    [\n      { text: 'Photo Library', onPress: onPickFromLibrary },\n      { text: 'Take Photo', onPress: onTakePhoto },\n      { text: 'Record Video', onPress: onTakeVideo },\n      { text: 'Cancel', style: 'cancel' },\n    ],\n    { cancelable: true }\n  );\n}\n\n/**\n * Generate thumbnail from video (placeholder - would need native module)\n */\nexport async function generateVideoThumbnail(videoUri: string): Promise<string | null> {\n  // In a real app, you'd use a library like expo-video-thumbnails\n  // For now, return null (use first frame or poster)\n  return null;\n}\n\n/**\n * Compress video before upload (placeholder - would need native module)\n */\nexport async function compressVideo(\n  videoUri: string,\n  quality: 'low' | 'medium' | 'high' = 'medium'\n): Promise<string> {\n  // In a real app, you'd use a library like react-native-video-processing\n  // For now, return original URI\n  return videoUri;\n}\n\n/**\n * Upload media to server\n */\nexport async function uploadMedia(\n  asset: MediaAsset,\n  uploadUrl: string,\n  onProgress?: (progress: number) => void\n): Promise<{ url: string; thumbnailUrl?: string } | null> {\n  try {\n    const formData = new FormData();\n    \n    formData.append('file', {\n      uri: asset.uri,\n      type: asset.mimeType || (asset.type === 'video' ? 'video/mp4' : 'image/jpeg'),\n      name: asset.fileName || `upload_${Date.now()}`,\n    } as any);\n\n    formData.append('type', asset.type);\n\n    const response = await fetch(uploadUrl, {\n      method: 'POST',\n      body: formData,\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Upload failed');\n    }\n\n    const data = await response.json();\n    return {\n      url: data.url,\n      thumbnailUrl: data.thumbnail_url,\n    };\n  } catch (error) {\n    console.error('Upload error:', error);\n    return null;\n  }\n}\n","path":null,"size_bytes":8677,"size_tokens":null},"server/index.ts":{"content":"import express from \"express\";\nimport type { Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst app = express();\nconst log = console.log;\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\nfunction setupCors(app: express.Application) {\n  app.use((req, res, next) => {\n    const origins = new Set<string>();\n\n    if (process.env.REPLIT_DEV_DOMAIN) {\n      origins.add(`https://${process.env.REPLIT_DEV_DOMAIN}`);\n      origins.add(`https://${process.env.REPLIT_DEV_DOMAIN}:5000`);\n      origins.add(`https://${process.env.REPLIT_DEV_DOMAIN}:8081`);\n    }\n\n    if (process.env.REPLIT_DOMAINS) {\n      process.env.REPLIT_DOMAINS.split(\",\").forEach((d) => {\n        const domain = d.trim();\n        origins.add(`https://${domain}`);\n        origins.add(`https://${domain}:5000`);\n      });\n    }\n\n    const origin = req.header(\"origin\");\n\n    // Allow localhost origins for Expo web development (any port)\n    const isLocalhost =\n      origin?.startsWith(\"http://localhost:\") ||\n      origin?.startsWith(\"http://127.0.0.1:\");\n    \n    // Allow any Replit dev domain origin (handles various port configurations)\n    const isReplitDev = origin?.includes(\".picard.replit.dev\") || \n                        origin?.includes(\".repl.co\") ||\n                        origin?.includes(\".replit.app\") ||\n                        origin?.includes(\".replit.dev\");\n\n    if (origin && (origins.has(origin) || isLocalhost || isReplitDev)) {\n      res.header(\"Access-Control-Allow-Origin\", origin);\n      res.header(\n        \"Access-Control-Allow-Methods\",\n        \"GET, POST, PUT, DELETE, OPTIONS, PATCH\",\n      );\n      res.header(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization, expo-platform\");\n      res.header(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n\n    if (req.method === \"OPTIONS\") {\n      return res.sendStatus(200);\n    }\n\n    next();\n  });\n}\n\nfunction setupBodyParsing(app: express.Application) {\n  app.use(\n    express.json({\n      verify: (req, _res, buf) => {\n        req.rawBody = buf;\n      },\n    }),\n  );\n\n  app.use(express.urlencoded({ extended: false }));\n}\n\nfunction setupRequestLogging(app: express.Application) {\n  app.use((req, res, next) => {\n    const start = Date.now();\n    const path = req.path;\n    let capturedJsonResponse: Record<string, unknown> | undefined = undefined;\n\n    const originalResJson = res.json;\n    res.json = function (bodyJson, ...args) {\n      capturedJsonResponse = bodyJson;\n      return originalResJson.apply(res, [bodyJson, ...args]);\n    };\n\n    res.on(\"finish\", () => {\n      if (!path.startsWith(\"/api\")) return;\n\n      const duration = Date.now() - start;\n\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"‚Ä¶\";\n      }\n\n      log(logLine);\n    });\n\n    next();\n  });\n}\n\nfunction getAppName(): string {\n  try {\n    const appJsonPath = path.resolve(process.cwd(), \"app.json\");\n    const appJsonContent = fs.readFileSync(appJsonPath, \"utf-8\");\n    const appJson = JSON.parse(appJsonContent);\n    return appJson.expo?.name || \"App Landing Page\";\n  } catch {\n    return \"App Landing Page\";\n  }\n}\n\nfunction serveExpoManifest(platform: string, res: Response) {\n  const manifestPath = path.resolve(\n    process.cwd(),\n    \"static-build\",\n    platform,\n    \"manifest.json\",\n  );\n\n  if (!fs.existsSync(manifestPath)) {\n    return res\n      .status(404)\n      .json({ error: `Manifest not found for platform: ${platform}` });\n  }\n\n  res.setHeader(\"expo-protocol-version\", \"1\");\n  res.setHeader(\"expo-sfv-version\", \"0\");\n  res.setHeader(\"content-type\", \"application/json\");\n\n  const manifest = fs.readFileSync(manifestPath, \"utf-8\");\n  res.send(manifest);\n}\n\nfunction serveLandingPage({\n  req,\n  res,\n  landingPageTemplate,\n  appName,\n}: {\n  req: Request;\n  res: Response;\n  landingPageTemplate: string;\n  appName: string;\n}) {\n  const forwardedProto = req.header(\"x-forwarded-proto\");\n  const protocol = forwardedProto || req.protocol || \"https\";\n  const forwardedHost = req.header(\"x-forwarded-host\");\n  const host = forwardedHost || req.get(\"host\");\n  const baseUrl = `${protocol}://${host}`;\n  const expsUrl = `${host}`;\n\n  log(`baseUrl`, baseUrl);\n  log(`expsUrl`, expsUrl);\n\n  const html = landingPageTemplate\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl)\n    .replace(/APP_NAME_PLACEHOLDER/g, appName);\n\n  res.setHeader(\"Content-Type\", \"text/html; charset=utf-8\");\n  res.status(200).send(html);\n}\n\nfunction configureExpoAndLanding(app: express.Application) {\n  const templatePath = path.resolve(\n    process.cwd(),\n    \"server\",\n    \"templates\",\n    \"landing-page.html\",\n  );\n  const landingPageTemplate = fs.readFileSync(templatePath, \"utf-8\");\n  const privacyPath = path.resolve(process.cwd(), \"server\", \"templates\", \"privacy.html\");\n  const termsPath = path.resolve(process.cwd(), \"server\", \"templates\", \"terms.html\");\n  const appName = getAppName();\n\n  log(\"Serving static Expo files with dynamic manifest routing\");\n\n  app.get(\"/privacy\", (_req: Request, res: Response) => {\n    res.sendFile(privacyPath);\n  });\n\n  app.get(\"/terms\", (_req: Request, res: Response) => {\n    res.sendFile(termsPath);\n  });\n\n  app.use((req: Request, res: Response, next: NextFunction) => {\n    if (req.path.startsWith(\"/api\")) {\n      return next();\n    }\n\n    if (req.path !== \"/\" && req.path !== \"/manifest\") {\n      return next();\n    }\n\n    const platform = req.header(\"expo-platform\");\n    if (platform && (platform === \"ios\" || platform === \"android\")) {\n      return serveExpoManifest(platform, res);\n    }\n\n    if (req.path === \"/\" && req.query.code && req.query.state) {\n      log(`OAuth callback detected at root, internally forwarding to /api/auth/callback`);\n      const qs = new URLSearchParams(req.query as Record<string, string>).toString();\n      req.url = `/api/auth/callback?${qs}`;\n      return next();\n    }\n\n    if (req.path === \"/\") {\n      return serveLandingPage({\n        req,\n        res,\n        landingPageTemplate,\n        appName,\n      });\n    }\n\n    next();\n  });\n\n  app.use(\"/assets\", express.static(path.resolve(process.cwd(), \"assets\")));\n  app.use(\"/uploads\", express.static(path.resolve(process.cwd(), \"uploads\")));\n  app.use(express.static(path.resolve(process.cwd(), \"static-build\")));\n\n  log(\"Expo routing: Checking expo-platform header on / and /manifest\");\n}\n\nfunction setupErrorHandler(app: express.Application) {\n  app.use((err: unknown, _req: Request, res: Response, _next: NextFunction) => {\n    const error = err as {\n      status?: number;\n      statusCode?: number;\n      message?: string;\n    };\n\n    const status = error.status || error.statusCode || 500;\n    const message = error.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n\n    throw err;\n  });\n}\n\n(async () => {\n  setupCors(app);\n  setupBodyParsing(app);\n  setupRequestLogging(app);\n\n  configureExpoAndLanding(app);\n\n  const server = await registerRoutes(app);\n\n  setupErrorHandler(app);\n\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`express server serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":7501,"size_tokens":null},"client/lib/api-error-handler.ts":{"content":"/**\n * API Error Handler\n * Centralized error handling with rate limiting support\n */\n\nimport { Alert } from 'react-native';\n\n// Error types\nexport enum ApiErrorType {\n  NETWORK = 'NETWORK',\n  RATE_LIMIT = 'RATE_LIMIT',\n  UNAUTHORIZED = 'UNAUTHORIZED',\n  FORBIDDEN = 'FORBIDDEN',\n  NOT_FOUND = 'NOT_FOUND',\n  VALIDATION = 'VALIDATION',\n  SERVER = 'SERVER',\n  UNKNOWN = 'UNKNOWN',\n}\n\nexport interface ApiErrorDetails {\n  type: ApiErrorType;\n  message: string;\n  status?: number;\n  retryAfter?: number; // seconds until retry allowed\n  field?: string; // for validation errors\n  originalError?: Error;\n}\n\nexport class ApiError extends Error {\n  type: ApiErrorType;\n  status?: number;\n  retryAfter?: number;\n  field?: string;\n\n  constructor(details: ApiErrorDetails) {\n    super(details.message);\n    this.name = 'ApiError';\n    this.type = details.type;\n    this.status = details.status;\n    this.retryAfter = details.retryAfter;\n    this.field = details.field;\n  }\n\n  /**\n   * Check if error is due to rate limiting\n   */\n  isRateLimited(): boolean {\n    return this.type === ApiErrorType.RATE_LIMIT;\n  }\n\n  /**\n   * Check if error is due to network issues\n   */\n  isNetworkError(): boolean {\n    return this.type === ApiErrorType.NETWORK;\n  }\n\n  /**\n   * Check if error requires re-authentication\n   */\n  requiresAuth(): boolean {\n    return this.type === ApiErrorType.UNAUTHORIZED;\n  }\n\n  /**\n   * Get user-friendly error message\n   */\n  getUserMessage(): string {\n    switch (this.type) {\n      case ApiErrorType.NETWORK:\n        return 'Unable to connect. Please check your internet connection.';\n      case ApiErrorType.RATE_LIMIT:\n        return `Too many requests. Please wait ${this.retryAfter || 60} seconds.`;\n      case ApiErrorType.UNAUTHORIZED:\n        return 'Your session has expired. Please sign in again.';\n      case ApiErrorType.FORBIDDEN:\n        return 'You don\\'t have permission to perform this action.';\n      case ApiErrorType.NOT_FOUND:\n        return 'The requested content could not be found.';\n      case ApiErrorType.VALIDATION:\n        return this.message || 'Please check your input and try again.';\n      case ApiErrorType.SERVER:\n        return 'Something went wrong on our end. Please try again later.';\n      default:\n        return this.message || 'An unexpected error occurred.';\n    }\n  }\n}\n\n/**\n * Parse API response errors\n */\nexport function parseApiError(response: Response, data?: any): ApiError {\n  const status = response.status;\n\n  // Rate limiting\n  if (status === 429) {\n    const retryAfter = parseInt(response.headers.get('Retry-After') || '60', 10);\n    return new ApiError({\n      type: ApiErrorType.RATE_LIMIT,\n      message: data?.error?.message || 'Rate limit exceeded',\n      status,\n      retryAfter,\n    });\n  }\n\n  // Authentication\n  if (status === 401) {\n    return new ApiError({\n      type: ApiErrorType.UNAUTHORIZED,\n      message: data?.error?.message || 'Authentication required',\n      status,\n    });\n  }\n\n  // Forbidden\n  if (status === 403) {\n    return new ApiError({\n      type: ApiErrorType.FORBIDDEN,\n      message: data?.error?.message || 'Access denied',\n      status,\n    });\n  }\n\n  // Not found\n  if (status === 404) {\n    return new ApiError({\n      type: ApiErrorType.NOT_FOUND,\n      message: data?.error?.message || 'Resource not found',\n      status,\n    });\n  }\n\n  // Validation errors\n  if (status === 400 || status === 422) {\n    return new ApiError({\n      type: ApiErrorType.VALIDATION,\n      message: data?.error?.message || 'Validation failed',\n      status,\n      field: data?.error?.field,\n    });\n  }\n\n  // Server errors\n  if (status >= 500) {\n    return new ApiError({\n      type: ApiErrorType.SERVER,\n      message: data?.error?.message || 'Server error',\n      status,\n    });\n  }\n\n  // Unknown error\n  return new ApiError({\n    type: ApiErrorType.UNKNOWN,\n    message: data?.error?.message || 'An error occurred',\n    status,\n  });\n}\n\n/**\n * Parse network/fetch errors\n */\nexport function parseNetworkError(error: Error): ApiError {\n  // Check for common network error patterns\n  const message = error.message.toLowerCase();\n  \n  if (\n    message.includes('network') ||\n    message.includes('fetch') ||\n    message.includes('timeout') ||\n    message.includes('abort') ||\n    message.includes('connection')\n  ) {\n    return new ApiError({\n      type: ApiErrorType.NETWORK,\n      message: 'Network error',\n      originalError: error,\n    });\n  }\n\n  return new ApiError({\n    type: ApiErrorType.UNKNOWN,\n    message: error.message,\n    originalError: error,\n  });\n}\n\n/**\n * Handle API error with appropriate UI feedback\n */\nexport function handleApiError(\n  error: ApiError | Error,\n  options?: {\n    showAlert?: boolean;\n    onUnauthorized?: () => void;\n    onRateLimit?: (retryAfter: number) => void;\n    onNetworkError?: () => void;\n  }\n): void {\n  const apiError = error instanceof ApiError ? error : parseNetworkError(error);\n  const { showAlert = true, onUnauthorized, onRateLimit, onNetworkError } = options || {};\n\n  // Handle specific error types\n  switch (apiError.type) {\n    case ApiErrorType.UNAUTHORIZED:\n      if (onUnauthorized) {\n        onUnauthorized();\n      } else if (showAlert) {\n        Alert.alert('Session Expired', apiError.getUserMessage(), [\n          { text: 'OK' }\n        ]);\n      }\n      break;\n\n    case ApiErrorType.RATE_LIMIT:\n      if (onRateLimit) {\n        onRateLimit(apiError.retryAfter || 60);\n      } else if (showAlert) {\n        Alert.alert('Slow Down', apiError.getUserMessage(), [\n          { text: 'OK' }\n        ]);\n      }\n      break;\n\n    case ApiErrorType.NETWORK:\n      if (onNetworkError) {\n        onNetworkError();\n      } else if (showAlert) {\n        Alert.alert('Connection Error', apiError.getUserMessage(), [\n          { text: 'OK' }\n        ]);\n      }\n      break;\n\n    default:\n      if (showAlert) {\n        Alert.alert('Error', apiError.getUserMessage(), [\n          { text: 'OK' }\n        ]);\n      }\n  }\n}\n\n/**\n * React Query error handler\n */\nexport function createQueryErrorHandler(options?: {\n  onUnauthorized?: () => void;\n}) {\n  return (error: Error) => {\n    const apiError = error instanceof ApiError ? error : parseNetworkError(error);\n    \n    // Don't show alerts for all errors in React Query\n    // Let components handle their own error states\n    if (apiError.type === ApiErrorType.UNAUTHORIZED && options?.onUnauthorized) {\n      options.onUnauthorized();\n    }\n  };\n}\n\n/**\n * Retry configuration for rate-limited requests\n */\nexport interface RetryConfig {\n  maxRetries: number;\n  baseDelay: number;\n  maxDelay: number;\n}\n\nconst DEFAULT_RETRY_CONFIG: RetryConfig = {\n  maxRetries: 3,\n  baseDelay: 1000,\n  maxDelay: 30000,\n};\n\n/**\n * Calculate delay for retry with exponential backoff\n */\nexport function calculateRetryDelay(\n  attempt: number,\n  config: RetryConfig = DEFAULT_RETRY_CONFIG,\n  retryAfter?: number\n): number {\n  // If server specified retry-after, use that\n  if (retryAfter) {\n    return retryAfter * 1000;\n  }\n\n  // Exponential backoff with jitter\n  const exponentialDelay = config.baseDelay * Math.pow(2, attempt);\n  const jitter = Math.random() * 1000;\n  const delay = Math.min(exponentialDelay + jitter, config.maxDelay);\n  \n  return delay;\n}\n\n/**\n * Should retry the request?\n */\nexport function shouldRetry(\n  error: ApiError | Error,\n  attempt: number,\n  config: RetryConfig = DEFAULT_RETRY_CONFIG\n): boolean {\n  if (attempt >= config.maxRetries) {\n    return false;\n  }\n\n  const apiError = error instanceof ApiError ? error : parseNetworkError(error);\n\n  // Retry on network errors\n  if (apiError.type === ApiErrorType.NETWORK) {\n    return true;\n  }\n\n  // Retry on rate limit (after waiting)\n  if (apiError.type === ApiErrorType.RATE_LIMIT) {\n    return true;\n  }\n\n  // Retry on server errors\n  if (apiError.type === ApiErrorType.SERVER) {\n    return true;\n  }\n\n  // Don't retry on client errors\n  return false;\n}\n\n/**\n * Wrapper for fetch with automatic retry\n */\nexport async function fetchWithRetry(\n  url: string,\n  options?: RequestInit,\n  retryConfig: RetryConfig = DEFAULT_RETRY_CONFIG\n): Promise<Response> {\n  let lastError: Error | null = null;\n\n  for (let attempt = 0; attempt <= retryConfig.maxRetries; attempt++) {\n    try {\n      const response = await fetch(url, options);\n      \n      // Check for rate limiting\n      if (response.status === 429) {\n        const retryAfter = parseInt(response.headers.get('Retry-After') || '60', 10);\n        const error = new ApiError({\n          type: ApiErrorType.RATE_LIMIT,\n          message: 'Rate limit exceeded',\n          status: 429,\n          retryAfter,\n        });\n\n        if (shouldRetry(error, attempt, retryConfig)) {\n          const delay = calculateRetryDelay(attempt, retryConfig, retryAfter);\n          await new Promise(resolve => setTimeout(resolve, delay));\n          continue;\n        }\n        \n        throw error;\n      }\n\n      return response;\n    } catch (error) {\n      lastError = error as Error;\n      \n      if (shouldRetry(error as Error, attempt, retryConfig)) {\n        const delay = calculateRetryDelay(attempt, retryConfig);\n        await new Promise(resolve => setTimeout(resolve, delay));\n        continue;\n      }\n      \n      throw error;\n    }\n  }\n\n  throw lastError || new Error('Max retries exceeded');\n}\n","path":null,"size_bytes":9302,"size_tokens":null},"server/routes/messages.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { db, users, dmConversations, directMessages } from '../db';\nimport { authMiddleware } from '../middleware/auth';\nimport { eq, or, and, desc } from 'drizzle-orm';\nimport { sql } from 'drizzle-orm';\n\nconst router = Router();\n\nrouter.use(authMiddleware);\n\nfunction formatUserForResponse(user: {\n  id: string;\n  email: string;\n  firstName: string | null;\n  lastName: string | null;\n  avatarUrl: string | null;\n  isVerified: boolean;\n}) {\n  return {\n    id: user.id,\n    email: user.email,\n    first_name: user.firstName || '',\n    last_name: user.lastName || '',\n    full_name: [user.firstName, user.lastName].filter(Boolean).join(' ') || user.email,\n    avatar_url: user.avatarUrl,\n    is_verified: user.isVerified,\n  };\n}\n\nrouter.get('/', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n\n    const conversations = await db\n      .select()\n      .from(dmConversations)\n      .where(or(eq(dmConversations.user1Id, userId), eq(dmConversations.user2Id, userId)))\n      .orderBy(desc(dmConversations.lastMessageAt));\n\n    const formattedConversations = await Promise.all(\n      conversations.map(async (conv) => {\n        const otherUserId = conv.user1Id === userId ? conv.user2Id : conv.user1Id;\n        const unreadCount = conv.user1Id === userId ? conv.user1Unread : conv.user2Unread;\n        const isMuted = conv.user1Id === userId ? conv.user1Muted : conv.user2Muted;\n\n        const [otherUser] = await db\n          .select({\n            id: users.id,\n            email: users.email,\n            firstName: users.firstName,\n            lastName: users.lastName,\n            avatarUrl: users.avatarUrl,\n            isVerified: users.isVerified,\n          })\n          .from(users)\n          .where(eq(users.id, otherUserId))\n          .limit(1);\n\n        if (!otherUser) return null;\n\n        return {\n          id: conv.id,\n          other_user: formatUserForResponse(otherUser),\n          last_message: conv.lastMessage,\n          last_message_at: conv.lastMessageAt?.toISOString(),\n          unread_count: unreadCount,\n          is_muted: isMuted,\n        };\n      })\n    );\n\n    res.json({ conversations: formattedConversations.filter(Boolean) });\n  } catch (error) {\n    console.error('Error fetching conversations:', error);\n    res.status(500).json({ message: 'Failed to fetch conversations' });\n  }\n});\n\nrouter.get('/unread-count', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n\n    const conversations = await db\n      .select({\n        user1Id: dmConversations.user1Id,\n        user1Unread: dmConversations.user1Unread,\n        user2Unread: dmConversations.user2Unread,\n      })\n      .from(dmConversations)\n      .where(or(eq(dmConversations.user1Id, userId), eq(dmConversations.user2Id, userId)));\n\n    let totalUnread = 0;\n    for (const conv of conversations) {\n      totalUnread += conv.user1Id === userId ? conv.user1Unread : conv.user2Unread;\n    }\n\n    res.json({ count: totalUnread });\n  } catch (error) {\n    console.error('Error fetching unread count:', error);\n    res.status(500).json({ message: 'Failed to fetch unread count' });\n  }\n});\n\nrouter.get('/:userId', async (req: Request, res: Response) => {\n  try {\n    const currentUserId = req.user!.id;\n    const otherUserId = req.params.userId;\n\n    const [otherUser] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        isVerified: users.isVerified,\n      })\n      .from(users)\n      .where(eq(users.id, otherUserId))\n      .limit(1);\n\n    if (!otherUser) {\n      res.status(404).json({ message: 'User not found' });\n      return;\n    }\n\n    let [conversation] = await db\n      .select()\n      .from(dmConversations)\n      .where(\n        or(\n          and(eq(dmConversations.user1Id, currentUserId), eq(dmConversations.user2Id, otherUserId)),\n          and(eq(dmConversations.user1Id, otherUserId), eq(dmConversations.user2Id, currentUserId))\n        )\n      )\n      .limit(1);\n\n    let messages: any[] = [];\n\n    if (conversation) {\n      const rawMessages = await db\n        .select({\n          id: directMessages.id,\n          conversationId: directMessages.conversationId,\n          content: directMessages.content,\n          senderId: directMessages.senderId,\n          isRead: directMessages.isRead,\n          readAt: directMessages.readAt,\n          createdAt: directMessages.createdAt,\n        })\n        .from(directMessages)\n        .where(eq(directMessages.conversationId, conversation.id))\n        .orderBy(directMessages.createdAt);\n\n      messages = await Promise.all(\n        rawMessages.map(async (msg) => {\n          const [sender] = await db\n            .select({\n              id: users.id,\n              email: users.email,\n              firstName: users.firstName,\n              lastName: users.lastName,\n              avatarUrl: users.avatarUrl,\n              isVerified: users.isVerified,\n            })\n            .from(users)\n            .where(eq(users.id, msg.senderId))\n            .limit(1);\n\n          return {\n            id: msg.id,\n            conversation_id: msg.conversationId,\n            content: msg.content,\n            sender: sender ? formatUserForResponse(sender) : null,\n            is_read: msg.isRead,\n            read_at: msg.readAt?.toISOString(),\n            created_at: msg.createdAt.toISOString(),\n          };\n        })\n      );\n\n      const isUser1 = conversation.user1Id === currentUserId;\n      if (isUser1 && conversation.user1Unread > 0) {\n        await db\n          .update(dmConversations)\n          .set({ user1Unread: 0, updatedAt: new Date() })\n          .where(eq(dmConversations.id, conversation.id));\n      } else if (!isUser1 && conversation.user2Unread > 0) {\n        await db\n          .update(dmConversations)\n          .set({ user2Unread: 0, updatedAt: new Date() })\n          .where(eq(dmConversations.id, conversation.id));\n      }\n\n      await db\n        .update(directMessages)\n        .set({ isRead: true, readAt: new Date() })\n        .where(\n          and(\n            eq(directMessages.conversationId, conversation.id),\n            eq(directMessages.senderId, otherUserId),\n            eq(directMessages.isRead, false)\n          )\n        );\n    }\n\n    res.json({\n      messages,\n      other_user: formatUserForResponse(otherUser),\n    });\n  } catch (error) {\n    console.error('Error fetching conversation:', error);\n    res.status(500).json({ message: 'Failed to fetch conversation' });\n  }\n});\n\nrouter.post('/:userId', async (req: Request, res: Response) => {\n  try {\n    const currentUserId = req.user!.id;\n    const otherUserId = req.params.userId;\n    const { content } = req.body;\n\n    if (!content || content.trim().length === 0) {\n      res.status(400).json({ message: 'Message content is required' });\n      return;\n    }\n\n    const [otherUser] = await db\n      .select({ id: users.id })\n      .from(users)\n      .where(eq(users.id, otherUserId))\n      .limit(1);\n\n    if (!otherUser) {\n      res.status(404).json({ message: 'User not found' });\n      return;\n    }\n\n    let [conversation] = await db\n      .select()\n      .from(dmConversations)\n      .where(\n        or(\n          and(eq(dmConversations.user1Id, currentUserId), eq(dmConversations.user2Id, otherUserId)),\n          and(eq(dmConversations.user1Id, otherUserId), eq(dmConversations.user2Id, currentUserId))\n        )\n      )\n      .limit(1);\n\n    if (!conversation) {\n      const [newConv] = await db\n        .insert(dmConversations)\n        .values({\n          user1Id: currentUserId,\n          user2Id: otherUserId,\n        })\n        .returning();\n      conversation = newConv;\n    }\n\n    const [message] = await db\n      .insert(directMessages)\n      .values({\n        conversationId: conversation.id,\n        senderId: currentUserId,\n        content: content.trim(),\n      })\n      .returning();\n\n    const isUser1 = conversation.user1Id === currentUserId;\n    await db\n      .update(dmConversations)\n      .set({\n        lastMessage: content.trim().substring(0, 100),\n        lastMessageAt: new Date(),\n        updatedAt: new Date(),\n        ...(isUser1 ? { user2Unread: sql`user2_unread + 1` } : { user1Unread: sql`user1_unread + 1` }),\n      })\n      .where(eq(dmConversations.id, conversation.id));\n\n    const [sender] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        isVerified: users.isVerified,\n      })\n      .from(users)\n      .where(eq(users.id, currentUserId))\n      .limit(1);\n\n    res.status(201).json({\n      id: message.id,\n      conversation_id: message.conversationId,\n      content: message.content,\n      sender: sender ? formatUserForResponse(sender) : null,\n      is_read: message.isRead,\n      created_at: message.createdAt.toISOString(),\n    });\n  } catch (error) {\n    console.error('Error sending message:', error);\n    res.status(500).json({ message: 'Failed to send message' });\n  }\n});\n\nrouter.delete('/:userId', async (req: Request, res: Response) => {\n  try {\n    const currentUserId = req.user!.id;\n    const otherUserId = req.params.userId;\n\n    const [conversation] = await db\n      .select()\n      .from(dmConversations)\n      .where(\n        or(\n          and(eq(dmConversations.user1Id, currentUserId), eq(dmConversations.user2Id, otherUserId)),\n          and(eq(dmConversations.user1Id, otherUserId), eq(dmConversations.user2Id, currentUserId))\n        )\n      )\n      .limit(1);\n\n    if (conversation) {\n      await db.delete(dmConversations).where(eq(dmConversations.id, conversation.id));\n    }\n\n    res.status(204).send();\n  } catch (error) {\n    console.error('Error deleting conversation:', error);\n    res.status(500).json({ message: 'Failed to delete conversation' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":9990,"size_tokens":null},"packages/shared/src/validators/index.ts":{"content":"/**\n * @medinvest/shared - Validators\n * \n * Zod schemas for validating data on both web and mobile.\n * Use these for form validation and API request/response validation.\n */\n\nimport { z } from 'zod';\nimport { REACTION_TYPES, DEAL_STAGES, ROOM_SPECIALTIES } from '../types';\n\n// =============================================================================\n// AUTH VALIDATORS\n// =============================================================================\n\nexport const emailSchema = z\n  .string()\n  .min(1, 'Email is required')\n  .email('Invalid email address');\n\nexport const passwordSchema = z\n  .string()\n  .min(8, 'Password must be at least 8 characters')\n  .regex(/[A-Z]/, 'Password must contain at least one uppercase letter')\n  .regex(/[a-z]/, 'Password must contain at least one lowercase letter')\n  .regex(/[0-9]/, 'Password must contain at least one number');\n\nexport const loginSchema = z.object({\n  email: emailSchema,\n  password: z.string().min(1, 'Password is required'),\n});\n\nexport const registerSchema = z.object({\n  email: emailSchema,\n  password: passwordSchema,\n  full_name: z\n    .string()\n    .min(2, 'Name must be at least 2 characters')\n    .max(100, 'Name must be less than 100 characters'),\n  specialty: z.string().optional(),\n});\n\nexport const forgotPasswordSchema = z.object({\n  email: emailSchema,\n});\n\nexport const resetPasswordSchema = z.object({\n  token: z.string().min(1, 'Token is required'),\n  password: passwordSchema,\n  confirm_password: z.string(),\n}).refine((data) => data.password === data.confirm_password, {\n  message: 'Passwords do not match',\n  path: ['confirm_password'],\n});\n\nexport const changePasswordSchema = z.object({\n  current_password: z.string().min(1, 'Current password is required'),\n  new_password: passwordSchema,\n  confirm_password: z.string(),\n}).refine((data) => data.new_password === data.confirm_password, {\n  message: 'Passwords do not match',\n  path: ['confirm_password'],\n});\n\n// =============================================================================\n// USER VALIDATORS\n// =============================================================================\n\nexport const usernameSchema = z\n  .string()\n  .min(3, 'Username must be at least 3 characters')\n  .max(30, 'Username must be less than 30 characters')\n  .regex(/^[a-zA-Z0-9_]+$/, 'Username can only contain letters, numbers, and underscores');\n\nexport const updateProfileSchema = z.object({\n  full_name: z\n    .string()\n    .min(2, 'Name must be at least 2 characters')\n    .max(100, 'Name must be less than 100 characters')\n    .optional(),\n  username: usernameSchema.optional(),\n  bio: z.string().max(500, 'Bio must be less than 500 characters').optional(),\n  specialty: z.string().optional(),\n  credentials: z.string().max(200).optional(),\n  location: z.string().max(100).optional(),\n  website: z.string().url('Invalid URL').optional().or(z.literal('')),\n});\n\n// =============================================================================\n// POST VALIDATORS\n// =============================================================================\n\nexport const postContentSchema = z\n  .string()\n  .min(1, 'Post content is required')\n  .max(5000, 'Post must be less than 5000 characters');\n\nexport const createPostSchema = z.object({\n  content: postContentSchema,\n  room_id: z.number().positive().optional(),\n  is_anonymous: z.boolean().optional(),\n  images: z.array(z.string().url()).max(10, 'Maximum 10 images allowed').optional(),\n  video_url: z.string().url().optional(),\n  poll: z.object({\n    question: z.string().min(1).max(150),\n    options: z.array(z.string().min(1).max(50)).min(2).max(6),\n    duration: z.enum(['1day', '3days', '7days', 'none']).optional(),\n    allow_multiple: z.boolean().optional(),\n    is_anonymous: z.boolean().optional(),\n  }).optional(),\n});\n\nexport const updatePostSchema = z.object({\n  content: postContentSchema.optional(),\n});\n\n// =============================================================================\n// COMMENT VALIDATORS\n// =============================================================================\n\nexport const commentContentSchema = z\n  .string()\n  .min(1, 'Comment cannot be empty')\n  .max(2000, 'Comment must be less than 2000 characters');\n\nexport const createCommentSchema = z.object({\n  content: commentContentSchema,\n  parent_id: z.number().positive().optional(),\n});\n\n// =============================================================================\n// MESSAGE VALIDATORS\n// =============================================================================\n\nexport const messageContentSchema = z\n  .string()\n  .min(1, 'Message cannot be empty')\n  .max(5000, 'Message must be less than 5000 characters');\n\nexport const sendMessageSchema = z.object({\n  content: messageContentSchema,\n  attachments: z.array(z.string().url()).max(5).optional(),\n});\n\n// =============================================================================\n// REACTION VALIDATORS\n// =============================================================================\n\nexport const reactionTypeSchema = z.enum(REACTION_TYPES);\n\nexport const reactSchema = z.object({\n  type: reactionTypeSchema,\n});\n\n// =============================================================================\n// POLL VALIDATORS\n// =============================================================================\n\nexport const pollVoteSchema = z.object({\n  option_ids: z.array(z.string()).min(1, 'Select at least one option'),\n});\n\n// =============================================================================\n// SEARCH VALIDATORS\n// =============================================================================\n\nexport const searchSchema = z.object({\n  query: z.string().min(1, 'Search query is required').max(200),\n  type: z.enum(['all', 'posts', 'users', 'rooms', 'deals']).optional(),\n  room_id: z.number().positive().optional(),\n  date_from: z.string().optional(),\n  date_to: z.string().optional(),\n  sort_by: z.enum(['relevance', 'recent', 'popular']).optional(),\n  page: z.number().positive().optional(),\n  limit: z.number().positive().max(100).optional(),\n});\n\n// =============================================================================\n// REPORT VALIDATORS\n// =============================================================================\n\nexport const reportReasonSchema = z.enum([\n  'spam',\n  'harassment',\n  'hate_speech',\n  'misinformation',\n  'inappropriate',\n  'violence',\n  'self_harm',\n  'other',\n]);\n\nexport const createReportSchema = z.object({\n  type: z.enum(['user', 'post', 'comment', 'message']),\n  target_id: z.number().positive(),\n  reason: reportReasonSchema,\n  details: z.string().max(1000).optional(),\n});\n\n// =============================================================================\n// MUTE VALIDATORS\n// =============================================================================\n\nexport const muteDurationSchema = z.enum([\n  '1hour',\n  '8hours',\n  '24hours',\n  '7days',\n  '30days',\n  'forever',\n]);\n\nexport const muteUserSchema = z.object({\n  mute_posts: z.boolean().optional(),\n  mute_comments: z.boolean().optional(),\n  mute_messages: z.boolean().optional(),\n  mute_notifications: z.boolean().optional(),\n  duration: muteDurationSchema,\n});\n\n// =============================================================================\n// SETTINGS VALIDATORS\n// =============================================================================\n\nexport const notificationSettingsSchema = z.object({\n  enabled: z.boolean(),\n  likes: z.boolean(),\n  comments: z.boolean(),\n  mentions: z.boolean(),\n  follows: z.boolean(),\n  direct_messages: z.boolean(),\n  message_requests: z.boolean(),\n  new_posts: z.boolean(),\n  trending_posts: z.boolean(),\n  room_activity: z.boolean(),\n  new_deals: z.boolean(),\n  deal_updates: z.boolean(),\n  investment_alerts: z.boolean(),\n  announcements: z.boolean(),\n  security_alerts: z.boolean(),\n  weekly_digest: z.boolean(),\n  quiet_hours_enabled: z.boolean(),\n  quiet_hours_start: z.string(),\n  quiet_hours_end: z.string(),\n});\n\nexport const contentPreferencesSchema = z.object({\n  hide_nsfw: z.boolean(),\n  blur_sensitive_images: z.boolean(),\n  hide_spoilers: z.boolean(),\n  show_trending_posts: z.boolean(),\n  show_suggested_users: z.boolean(),\n  show_promoted_content: z.boolean(),\n  autoplay_videos: z.enum(['always', 'wifi', 'never']),\n  reduce_animations: z.boolean(),\n  compact_mode: z.boolean(),\n  content_languages: z.array(z.string()),\n  translate_posts: z.boolean(),\n  muted_keywords: z.array(z.string()),\n  show_post_metrics: z.boolean(),\n  show_user_badges: z.boolean(),\n  confirm_before_posting: z.boolean(),\n});\n\nexport const privacySettingsSchema = z.object({\n  profile_visibility: z.enum(['public', 'followers', 'private']),\n  allow_messages_from: z.enum(['everyone', 'followers', 'none']),\n  show_online_status: z.boolean(),\n  show_read_receipts: z.boolean(),\n  allow_tagging: z.boolean(),\n  allow_mentions: z.boolean(),\n});\n\n// =============================================================================\n// DEAL VALIDATORS\n// =============================================================================\n\nexport const dealStageSchema = z.enum(DEAL_STAGES as unknown as [string, ...string[]]);\n\nexport const dealFilterSchema = z.object({\n  stage: dealStageSchema.optional(),\n  sector: z.string().optional(),\n  min_investment: z.number().positive().optional(),\n  max_investment: z.number().positive().optional(),\n  sort_by: z.enum(['recent', 'popular', 'deadline', 'amount']).optional(),\n});\n\nexport const expressInterestSchema = z.object({\n  amount: z.number().positive().optional(),\n  message: z.string().max(1000).optional(),\n});\n\n// =============================================================================\n// EXPORT INFERRED TYPES\n// =============================================================================\n\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type ForgotPasswordInput = z.infer<typeof forgotPasswordSchema>;\nexport type ResetPasswordInput = z.infer<typeof resetPasswordSchema>;\nexport type ChangePasswordInput = z.infer<typeof changePasswordSchema>;\nexport type UpdateProfileInput = z.infer<typeof updateProfileSchema>;\nexport type CreatePostInput = z.infer<typeof createPostSchema>;\nexport type UpdatePostInput = z.infer<typeof updatePostSchema>;\nexport type CreateCommentInput = z.infer<typeof createCommentSchema>;\nexport type SendMessageInput = z.infer<typeof sendMessageSchema>;\nexport type ReactInput = z.infer<typeof reactSchema>;\nexport type PollVoteInput = z.infer<typeof pollVoteSchema>;\nexport type SearchInput = z.infer<typeof searchSchema>;\nexport type CreateReportInput = z.infer<typeof createReportSchema>;\nexport type MuteUserInput = z.infer<typeof muteUserSchema>;\nexport type DealFilterInput = z.infer<typeof dealFilterSchema>;\nexport type ExpressInterestInput = z.infer<typeof expressInterestSchema>;\n","path":null,"size_bytes":10904,"size_tokens":null},"client/components/Poll.tsx":{"content":"/**\n * Polls Component\n * Create and vote on polls in posts\n */\n\nimport React, { useState, useCallback, memo, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  Animated,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { postsApi } from '@/lib/api';\n\n// Types\nexport interface PollOption {\n  id: string;\n  text: string;\n  votes: number;\n  percentage?: number;\n}\n\nexport interface Poll {\n  id: string;\n  question: string;\n  options: PollOption[];\n  totalVotes: number;\n  endsAt?: string;\n  hasVoted: boolean;\n  userVote?: string; // option id\n  allowMultiple: boolean;\n  isAnonymous: boolean;\n}\n\ninterface PollDisplayProps {\n  poll: Poll;\n  postId: number;\n  onVote?: (optionId: string) => void;\n}\n\ninterface PollCreatorProps {\n  onPollChange: (poll: Partial<Poll> | null) => void;\n  initialPoll?: Partial<Poll>;\n}\n\n// =============================================================================\n// POLL DISPLAY (Voting UI)\n// =============================================================================\n\nexport const PollDisplay = memo(function PollDisplay({\n  poll,\n  postId,\n  onVote,\n}: PollDisplayProps) {\n  const { colors } = useThemeContext();\n  const queryClient = useQueryClient();\n  const [selectedOptions, setSelectedOptions] = useState<Set<string>>(\n    poll.userVote ? new Set([poll.userVote]) : new Set()\n  );\n  const [hasVoted, setHasVoted] = useState(poll.hasVoted);\n  const [animatedWidths] = useState(() => \n    poll.options.map(() => new Animated.Value(0))\n  );\n\n  // Check if poll has ended\n  const isPollEnded = poll.endsAt ? new Date(poll.endsAt) < new Date() : false;\n  const showResults = hasVoted || isPollEnded;\n\n  // Animate results\n  useEffect(() => {\n    if (showResults) {\n      poll.options.forEach((option, index) => {\n        Animated.timing(animatedWidths[index], {\n          toValue: option.percentage || 0,\n          duration: 500,\n          useNativeDriver: false,\n        }).start();\n      });\n    }\n  }, [showResults, poll.options]);\n\n  // Vote mutation\n  const voteMutation = useMutation({\n    mutationFn: async (optionIds: string[]) => {\n      return postsApi.votePoll(postId, poll.id, optionIds);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['post', postId] });\n      haptics.success();\n    },\n    onError: () => {\n      haptics.error();\n      Alert.alert('Error', 'Failed to submit vote. Please try again.');\n    },\n  });\n\n  const handleOptionPress = useCallback((optionId: string) => {\n    if (hasVoted || isPollEnded) return;\n\n    haptics.selection();\n\n    if (poll.allowMultiple) {\n      setSelectedOptions(prev => {\n        const next = new Set(prev);\n        if (next.has(optionId)) {\n          next.delete(optionId);\n        } else {\n          next.add(optionId);\n        }\n        return next;\n      });\n    } else {\n      setSelectedOptions(new Set([optionId]));\n    }\n  }, [hasVoted, isPollEnded, poll.allowMultiple]);\n\n  const handleVote = useCallback(() => {\n    if (selectedOptions.size === 0) {\n      Alert.alert('Select an option', 'Please select at least one option to vote.');\n      return;\n    }\n\n    haptics.buttonPress();\n    setHasVoted(true);\n    voteMutation.mutate(Array.from(selectedOptions));\n    onVote?.(Array.from(selectedOptions)[0]);\n  }, [selectedOptions, voteMutation, onVote]);\n\n  const formatTimeRemaining = (endDate: string): string => {\n    const end = new Date(endDate);\n    const now = new Date();\n    const diff = end.getTime() - now.getTime();\n\n    if (diff <= 0) return 'Ended';\n\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const days = Math.floor(hours / 24);\n\n    if (days > 0) return `${days}d left`;\n    if (hours > 0) return `${hours}h left`;\n    \n    const minutes = Math.floor(diff / (1000 * 60));\n    return `${minutes}m left`;\n  };\n\n  return (\n    <View style={[styles.pollContainer, { backgroundColor: colors.backgroundSecondary }]}>\n      {/* Question */}\n      <ThemedText style={[styles.pollQuestion, { color: colors.textPrimary }]}>\n        {poll.question}\n      </ThemedText>\n\n      {/* Options */}\n      <View style={styles.optionsContainer}>\n        {poll.options.map((option, index) => {\n          const isSelected = selectedOptions.has(option.id);\n          const isWinner = showResults && option.percentage === Math.max(...poll.options.map(o => o.percentage || 0));\n\n          return (\n            <TouchableOpacity\n              key={option.id}\n              style={[\n                styles.optionButton,\n                {\n                  backgroundColor: colors.surface,\n                  borderColor: isSelected ? colors.primary : colors.border,\n                  borderWidth: isSelected ? 2 : 1,\n                },\n              ]}\n              onPress={() => handleOptionPress(option.id)}\n              disabled={hasVoted || isPollEnded}\n              activeOpacity={0.7}\n            >\n              {/* Progress bar (shown after voting) */}\n              {showResults && (\n                <Animated.View\n                  style={[\n                    styles.progressBar,\n                    {\n                      backgroundColor: isWinner ? colors.primary + '30' : colors.backgroundSecondary,\n                      width: animatedWidths[index].interpolate({\n                        inputRange: [0, 100],\n                        outputRange: ['0%', '100%'],\n                      }),\n                    },\n                  ]}\n                />\n              )}\n\n              {/* Option content */}\n              <View style={styles.optionContent}>\n                {/* Selection indicator */}\n                {!showResults && (\n                  <View\n                    style={[\n                      styles.checkbox,\n                      {\n                        borderColor: isSelected ? colors.primary : colors.textSecondary,\n                        backgroundColor: isSelected ? colors.primary : 'transparent',\n                      },\n                      poll.allowMultiple ? styles.checkboxSquare : styles.checkboxRound,\n                    ]}\n                  >\n                    {isSelected && (\n                      <Ionicons name=\"checkmark\" size={12} color=\"white\" />\n                    )}\n                  </View>\n                )}\n\n                {/* User's vote indicator */}\n                {showResults && poll.userVote === option.id && (\n                  <Ionicons\n                    name=\"checkmark-circle\"\n                    size={18}\n                    color={colors.primary}\n                    style={styles.votedIcon}\n                  />\n                )}\n\n                <ThemedText\n                  style={[\n                    styles.optionText,\n                    { color: colors.textPrimary },\n                    isWinner && { fontWeight: '600' },\n                  ]}\n                >\n                  {option.text}\n                </ThemedText>\n\n                {/* Percentage & votes */}\n                {showResults && (\n                  <ThemedText style={[styles.voteCount, { color: colors.textSecondary }]}>\n                    {option.percentage?.toFixed(0)}% ({option.votes})\n                  </ThemedText>\n                )}\n              </View>\n            </TouchableOpacity>\n          );\n        })}\n      </View>\n\n      {/* Vote button */}\n      {!hasVoted && !isPollEnded && (\n        <TouchableOpacity\n          style={[\n            styles.voteButton,\n            {\n              backgroundColor: selectedOptions.size > 0 ? colors.primary : colors.border,\n            },\n          ]}\n          onPress={handleVote}\n          disabled={selectedOptions.size === 0 || voteMutation.isPending}\n        >\n          <ThemedText\n            style={[\n              styles.voteButtonText,\n              { color: selectedOptions.size > 0 ? 'white' : colors.textSecondary },\n            ]}\n          >\n            {voteMutation.isPending ? 'Voting...' : 'Vote'}\n          </ThemedText>\n        </TouchableOpacity>\n      )}\n\n      {/* Meta info */}\n      <View style={styles.pollMeta}>\n        <ThemedText style={[styles.pollMetaText, { color: colors.textSecondary }]}>\n          {poll.totalVotes} vote{poll.totalVotes !== 1 ? 's' : ''}\n        </ThemedText>\n        {poll.endsAt && (\n          <>\n            <View style={[styles.metaDot, { backgroundColor: colors.textSecondary }]} />\n            <ThemedText style={[styles.pollMetaText, { color: colors.textSecondary }]}>\n              {formatTimeRemaining(poll.endsAt)}\n            </ThemedText>\n          </>\n        )}\n        {poll.isAnonymous && (\n          <>\n            <View style={[styles.metaDot, { backgroundColor: colors.textSecondary }]} />\n            <Ionicons name=\"eye-off-outline\" size={12} color={colors.textSecondary} />\n            <ThemedText style={[styles.pollMetaText, { color: colors.textSecondary, marginLeft: 2 }]}>\n              Anonymous\n            </ThemedText>\n          </>\n        )}\n      </View>\n    </View>\n  );\n});\n\n// =============================================================================\n// POLL CREATOR (For CreatePostScreen)\n// =============================================================================\n\nexport const PollCreator = memo(function PollCreator({\n  onPollChange,\n  initialPoll,\n}: PollCreatorProps) {\n  const { colors } = useThemeContext();\n  const [question, setQuestion] = useState(initialPoll?.question || '');\n  const [options, setOptions] = useState<string[]>(\n    initialPoll?.options?.map(o => o.text) || ['', '']\n  );\n  const [allowMultiple, setAllowMultiple] = useState(initialPoll?.allowMultiple || false);\n  const [isAnonymous, setIsAnonymous] = useState(initialPoll?.isAnonymous || false);\n  const [duration, setDuration] = useState<'1day' | '3days' | '7days' | 'none'>('1day');\n\n  // Update parent when poll changes\n  useEffect(() => {\n    const validOptions = options.filter(o => o.trim());\n    if (question.trim() && validOptions.length >= 2) {\n      onPollChange({\n        question: question.trim(),\n        options: validOptions.map((text, i) => ({\n          id: `opt_${i}`,\n          text: text.trim(),\n          votes: 0,\n        })),\n        allowMultiple,\n        isAnonymous,\n        endsAt: duration !== 'none' ? getEndDate(duration) : undefined,\n      });\n    } else {\n      onPollChange(null);\n    }\n  }, [question, options, allowMultiple, isAnonymous, duration]);\n\n  const getEndDate = (dur: string): string => {\n    const date = new Date();\n    switch (dur) {\n      case '1day':\n        date.setDate(date.getDate() + 1);\n        break;\n      case '3days':\n        date.setDate(date.getDate() + 3);\n        break;\n      case '7days':\n        date.setDate(date.getDate() + 7);\n        break;\n    }\n    return date.toISOString();\n  };\n\n  const handleAddOption = () => {\n    if (options.length >= 6) {\n      Alert.alert('Maximum Options', 'You can add up to 6 options.');\n      return;\n    }\n    haptics.buttonPress();\n    setOptions([...options, '']);\n  };\n\n  const handleRemoveOption = (index: number) => {\n    if (options.length <= 2) {\n      Alert.alert('Minimum Options', 'A poll must have at least 2 options.');\n      return;\n    }\n    haptics.buttonPress();\n    setOptions(options.filter((_, i) => i !== index));\n  };\n\n  const handleOptionChange = (index: number, value: string) => {\n    const newOptions = [...options];\n    newOptions[index] = value;\n    setOptions(newOptions);\n  };\n\n  return (\n    <View style={[styles.creatorContainer, { backgroundColor: colors.surface }]}>\n      {/* Header */}\n      <View style={styles.creatorHeader}>\n        <Ionicons name=\"stats-chart\" size={20} color={colors.primary} />\n        <ThemedText style={[styles.creatorTitle, { color: colors.textPrimary }]}>\n          Create Poll\n        </ThemedText>\n        <TouchableOpacity onPress={() => onPollChange(null)}>\n          <Ionicons name=\"close\" size={22} color={colors.textSecondary} />\n        </TouchableOpacity>\n      </View>\n\n      {/* Question */}\n      <TextInput\n        style={[styles.questionInput, { color: colors.textPrimary, borderColor: colors.border }]}\n        placeholder=\"Ask a question...\"\n        placeholderTextColor={colors.textSecondary}\n        value={question}\n        onChangeText={setQuestion}\n        maxLength={150}\n      />\n\n      {/* Options */}\n      <View style={styles.optionsList}>\n        {options.map((option, index) => (\n          <View key={index} style={styles.optionInputRow}>\n            <TextInput\n              style={[\n                styles.optionInput,\n                { color: colors.textPrimary, borderColor: colors.border },\n              ]}\n              placeholder={`Option ${index + 1}`}\n              placeholderTextColor={colors.textSecondary}\n              value={option}\n              onChangeText={(value) => handleOptionChange(index, value)}\n              maxLength={50}\n            />\n            {options.length > 2 && (\n              <TouchableOpacity\n                style={styles.removeOptionButton}\n                onPress={() => handleRemoveOption(index)}\n              >\n                <Ionicons name=\"close-circle\" size={22} color={colors.textSecondary} />\n              </TouchableOpacity>\n            )}\n          </View>\n        ))}\n      </View>\n\n      {/* Add option */}\n      {options.length < 6 && (\n        <TouchableOpacity style={styles.addOptionButton} onPress={handleAddOption}>\n          <Ionicons name=\"add-circle-outline\" size={20} color={colors.primary} />\n          <ThemedText style={[styles.addOptionText, { color: colors.primary }]}>\n            Add option\n          </ThemedText>\n        </TouchableOpacity>\n      )}\n\n      {/* Settings */}\n      <View style={[styles.settingsSection, { borderTopColor: colors.border }]}>\n        {/* Duration */}\n        <View style={styles.settingRow}>\n          <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n            Duration\n          </ThemedText>\n          <View style={styles.durationOptions}>\n            {[\n              { value: '1day', label: '1d' },\n              { value: '3days', label: '3d' },\n              { value: '7days', label: '7d' },\n              { value: 'none', label: '‚àû' },\n            ].map((opt) => (\n              <TouchableOpacity\n                key={opt.value}\n                style={[\n                  styles.durationButton,\n                  {\n                    backgroundColor: duration === opt.value ? colors.primary : colors.backgroundSecondary,\n                  },\n                ]}\n                onPress={() => {\n                  haptics.selection();\n                  setDuration(opt.value as any);\n                }}\n              >\n                <ThemedText\n                  style={[\n                    styles.durationText,\n                    { color: duration === opt.value ? 'white' : colors.textSecondary },\n                  ]}\n                >\n                  {opt.label}\n                </ThemedText>\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        {/* Multiple selection */}\n        <TouchableOpacity\n          style={styles.settingRow}\n          onPress={() => {\n            haptics.toggle();\n            setAllowMultiple(!allowMultiple);\n          }}\n        >\n          <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n            Allow multiple selections\n          </ThemedText>\n          <Ionicons\n            name={allowMultiple ? 'checkbox' : 'square-outline'}\n            size={22}\n            color={allowMultiple ? colors.primary : colors.textSecondary}\n          />\n        </TouchableOpacity>\n\n        {/* Anonymous */}\n        <TouchableOpacity\n          style={styles.settingRow}\n          onPress={() => {\n            haptics.toggle();\n            setIsAnonymous(!isAnonymous);\n          }}\n        >\n          <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n            Anonymous voting\n          </ThemedText>\n          <Ionicons\n            name={isAnonymous ? 'checkbox' : 'square-outline'}\n            size={22}\n            color={isAnonymous ? colors.primary : colors.textSecondary}\n          />\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n});\n\nconst styles = StyleSheet.create({\n  // Poll Display\n  pollContainer: {\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    marginTop: Spacing.md,\n  },\n  pollQuestion: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n  },\n  optionsContainer: {\n    gap: Spacing.sm,\n  },\n  optionButton: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    minHeight: 44,\n  },\n  progressBar: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n    borderRadius: BorderRadius.md,\n  },\n  optionContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n  },\n  checkbox: {\n    width: 20,\n    height: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 2,\n    marginRight: Spacing.sm,\n  },\n  checkboxRound: {\n    borderRadius: 10,\n  },\n  checkboxSquare: {\n    borderRadius: 4,\n  },\n  votedIcon: {\n    marginRight: Spacing.sm,\n  },\n  optionText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  voteCount: {\n    ...Typography.caption,\n    marginLeft: Spacing.sm,\n  },\n  voteButton: {\n    marginTop: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  voteButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  pollMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.md,\n  },\n  pollMetaText: {\n    ...Typography.small,\n  },\n  metaDot: {\n    width: 3,\n    height: 3,\n    borderRadius: 1.5,\n    marginHorizontal: Spacing.sm,\n  },\n\n  // Poll Creator\n  creatorContainer: {\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    ...Shadows.card,\n  },\n  creatorHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  creatorTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  questionInput: {\n    ...Typography.body,\n    borderWidth: 1,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    marginBottom: Spacing.md,\n  },\n  optionsList: {\n    gap: Spacing.sm,\n  },\n  optionInputRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  optionInput: {\n    ...Typography.body,\n    flex: 1,\n    borderWidth: 1,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n  },\n  removeOptionButton: {\n    padding: Spacing.sm,\n  },\n  addOptionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n  },\n  addOptionText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  settingsSection: {\n    marginTop: Spacing.md,\n    paddingTop: Spacing.md,\n    borderTopWidth: 1,\n  },\n  settingRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: Spacing.sm,\n  },\n  settingLabel: {\n    ...Typography.body,\n  },\n  durationOptions: {\n    flexDirection: 'row',\n    gap: Spacing.xs,\n  },\n  durationButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.sm,\n  },\n  durationText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":19668,"size_tokens":null},"client/components/TrendingSidebar.tsx":{"content":"/**\n * TrendingSidebar Component\n * Shows trending hashtags and topics as a modal/sidebar\n */\n\nimport React, { memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Modal,\n  FlatList,\n  Pressable,\n  Dimensions,\n} from 'react-native';\nimport { BlurView } from 'expo-blur';\nimport { Ionicons } from '@expo/vector-icons';\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { TrendingTopic } from '@/types';\nimport { formatNumber } from '@/lib/utils';\n\nconst { width, height } = Dimensions.get('window');\n\ninterface TrendingSidebarProps {\n  topics: TrendingTopic[];\n  onTopicPress: (tag: string) => void;\n  onClose: () => void;\n}\n\nfunction TrendingSidebar({ topics, onTopicPress, onClose }: TrendingSidebarProps) {\n  const appColors = useAppColors();\n\n  const renderTrendIcon = (trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return <Ionicons name=\"trending-up\" size={16} color={Colors.secondary} />;\n      case 'down':\n        return <Ionicons name=\"trending-down\" size={16} color={appColors.error} />;\n      default:\n        return <Ionicons name=\"remove\" size={16} color={appColors.textSecondary} />;\n    }\n  };\n\n  const renderTopic = ({ item, index }: { item: TrendingTopic; index: number }) => (\n    <TouchableOpacity\n      style={[styles.topicItem, { borderBottomColor: appColors.border }]}\n      onPress={() => {\n        onTopicPress(item.hashtag);\n        onClose();\n      }}\n    >\n      <View style={styles.topicRank}>\n        <ThemedText style={[styles.rankText, { color: appColors.textSecondary }]}>{index + 1}</ThemedText>\n      </View>\n      <View style={styles.topicInfo}>\n        <View style={styles.topicHeader}>\n          <ThemedText style={[styles.topicTag, { color: appColors.textPrimary }]}>#{item.hashtag}</ThemedText>\n          {renderTrendIcon(item.trend)}\n        </View>\n        <ThemedText style={[styles.topicCount, { color: appColors.textSecondary }]}>\n          {formatNumber(item.count)} posts\n        </ThemedText>\n      </View>\n      <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n    </TouchableOpacity>\n  );\n\n  return (\n    <Modal\n      visible={true}\n      transparent\n      animationType=\"slide\"\n      onRequestClose={onClose}\n    >\n      <Pressable style={styles.backdrop} onPress={onClose}>\n        <BlurView intensity={20} style={StyleSheet.absoluteFill} />\n      </Pressable>\n      \n      <View style={[styles.container, { backgroundColor: appColors.surface }]}>\n        <View style={[styles.header, { borderBottomColor: appColors.border }]}>\n          <View style={styles.headerLeft}>\n            <Ionicons name=\"trending-up\" size={24} color={Colors.primary} />\n            <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Trending</ThemedText>\n          </View>\n          <TouchableOpacity style={styles.closeButton} onPress={onClose}>\n            <Ionicons name=\"close\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        <FlatList\n          data={topics}\n          renderItem={renderTopic}\n          keyExtractor={(item) => item.hashtag}\n          showsVerticalScrollIndicator={false}\n          contentContainerStyle={styles.listContent}\n          ListEmptyComponent={\n            <View style={styles.emptyContainer}>\n              <Ionicons name=\"analytics-outline\" size={48} color={appColors.textSecondary} />\n              <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No trending topics yet</ThemedText>\n            </View>\n          }\n        />\n\n        <View style={[styles.footer, { borderTopColor: appColors.border }]}>\n          <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>\n            Updated every 15 minutes\n          </ThemedText>\n        </View>\n      </View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  backdrop: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  container: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n    maxHeight: height * 0.7,\n    ...Shadows.card,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  headerLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  listContent: {\n    padding: Spacing.lg,\n  },\n  topicItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  topicRank: {\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  rankText: {\n    ...Typography.caption,\n    fontWeight: '700',\n  },\n  topicInfo: {\n    flex: 1,\n  },\n  topicHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  topicTag: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  topicCount: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['3xl'],\n  },\n  emptyText: {\n    ...Typography.body,\n    marginTop: Spacing.md,\n  },\n  footer: {\n    padding: Spacing.md,\n    borderTopWidth: 1,\n    alignItems: 'center',\n  },\n  footerText: {\n    ...Typography.small,\n  },\n});\n\nexport default memo(TrendingSidebar);\n","path":null,"size_bytes":5843,"size_tokens":null},"server/replit_integrations/image/client.ts":{"content":"import fs from \"node:fs\";\nimport OpenAI, { toFile } from \"openai\";\nimport { Buffer } from \"node:buffer\";\n\nexport const openai = new OpenAI({\n  apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY,\n  baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n});\n\n/**\n * Generate an image and return as Buffer.\n * Uses gpt-image-1 model via Replit AI Integrations.\n */\nexport async function generateImageBuffer(\n  prompt: string,\n  size: \"1024x1024\" | \"512x512\" | \"256x256\" = \"1024x1024\"\n): Promise<Buffer> {\n  const response = await openai.images.generate({\n    model: \"gpt-image-1\",\n    prompt,\n    size,\n  });\n  const base64 = response.data?.[0]?.b64_json ?? \"\";\n  return Buffer.from(base64, \"base64\");\n}\n\n/**\n * Edit/combine multiple images into a composite.\n * Uses gpt-image-1 model via Replit AI Integrations.\n */\nexport async function editImages(\n  imageFiles: string[],\n  prompt: string,\n  outputPath?: string\n): Promise<Buffer> {\n  const images = await Promise.all(\n    imageFiles.map((file) =>\n      toFile(fs.createReadStream(file), file, {\n        type: \"image/png\",\n      })\n    )\n  );\n\n  const response = await openai.images.edit({\n    model: \"gpt-image-1\",\n    image: images,\n    prompt,\n  });\n\n  const imageBase64 = response.data?.[0]?.b64_json ?? \"\";\n  const imageBytes = Buffer.from(imageBase64, \"base64\");\n\n  if (outputPath) {\n    fs.writeFileSync(outputPath, imageBytes);\n  }\n\n  return imageBytes;\n}\n\n","path":null,"size_bytes":1414,"size_tokens":null},"design_guidelines.md":{"content":"# MedInvest Mobile App - Design Guidelines\n\n## Brand Identity\n\n**Purpose**: MedInvest enables users to invest in medical innovations, research, and healthcare ventures. The app bridges healthcare advancement with financial opportunity.\n\n**Aesthetic Direction**: **Refined/Trustworthy** - Professional yet approachable. Medical blue meets financial confidence. Clean typography, ample breathing room, subtle gradients that convey innovation without gimmicks. Think Bloomberg meets Apple Health.\n\n**Memorable Element**: Gradient accent cards that shift from medical blue to investment green, symbolizing the healthcare-finance bridge.\n\n## Navigation Architecture\n\n**Root Navigation**: Tab Bar (4 tabs + Floating Action)\n\n**Tabs**:\n1. **Discover** - Browse investment opportunities\n2. **Portfolio** - Track investments and returns\n3. **Research** - Healthcare news and insights\n4. **Profile** - Account settings and documents\n\n**Floating Action Button**: \"Invest\" - Primary action positioned above tab bar center\n\n**Auth Required**: Yes (SSO with Apple Sign-In and Google Sign-In)\n\n## Screen-by-Screen Specifications\n\n### Login/Signup Screens\n- **Stack**: Authentication (modal)\n- **Layout**: Centered content, logo at top, SSO buttons, links to privacy policy/terms\n- **Header**: None\n- **Content**: Non-scrollable, vertically centered\n- **Safe Area**: Top: insets.top + Spacing.xl, Bottom: insets.bottom + Spacing.xl\n\n### Discover Screen\n- **Stack**: Discover Tab\n- **Header**: Transparent, search bar, filter button (right)\n- **Content**: Scrollable list of investment opportunity cards\n- **Components**: Search bar, category chips (horizontal scroll), investment cards (gradient backgrounds, project name, funding goal, time remaining, expected ROI)\n- **Empty State**: empty-discover.png when no results\n- **Safe Area**: Top: headerHeight + Spacing.xl, Bottom: tabBarHeight + Spacing.xl\n\n### Investment Detail Screen\n- **Stack**: Discover Tab (pushed)\n- **Header**: Default with back button, share button (right)\n- **Content**: Scrollable\n- **Components**: Hero image, project title, funding progress bar, key metrics grid, description, risk assessment, document links, \"Invest Now\" button (floating at bottom)\n- **Safe Area**: Top: Spacing.xl, Bottom: insets.bottom + 60 (floating button height) + Spacing.xl\n\n### Portfolio Screen\n- **Stack**: Portfolio Tab\n- **Header**: Transparent, \"Portfolio\" title, notification bell (right)\n- **Content**: Scrollable with summary card at top, list of investments below\n- **Components**: Total value card (large, gradient), performance graph, investment list items (project name, amount invested, current value, gain/loss percentage)\n- **Empty State**: empty-portfolio.png (illustration of growing plant)\n- **Safe Area**: Top: headerHeight + Spacing.xl, Bottom: tabBarHeight + Spacing.xl\n\n### Research Screen\n- **Stack**: Research Tab\n- **Header**: Transparent, \"Research\" title, bookmark button (right)\n- **Content**: Scrollable list of articles\n- **Components**: Featured article card (large), article list items (thumbnail, headline, source, time)\n- **Safe Area**: Top: headerHeight + Spacing.xl, Bottom: tabBarHeight + Spacing.xl\n\n### Profile Screen\n- **Stack**: Profile Tab\n- **Header**: Transparent, settings gear icon (right)\n- **Content**: Scrollable\n- **Components**: Avatar, name, verification badge, menu items (Documents, Payment Methods, Notifications, Support, Legal, Log Out)\n- **Safe Area**: Top: headerHeight + Spacing.xl, Bottom: tabBarHeight + Spacing.xl\n\n### Investment Form (Modal)\n- **Triggered by**: Floating action button or \"Invest Now\" button\n- **Header**: Custom with \"Cancel\" (left), \"Review\" (right, disabled until valid)\n- **Content**: Scrollable form\n- **Components**: Project summary card, amount input, payment method selector, risk acknowledgment checkbox, terms checkbox\n- **Safe Area**: Top: headerHeight + Spacing.xl, Bottom: insets.bottom + Spacing.xl\n\n## Color Palette\n\n**Primary**: #0066CC (Medical Blue) - Main actions, active states\n**Secondary**: #00A86B (Investment Green) - Success, gains\n**Gradient**: Linear from #0066CC to #00A86B - Featured cards\n**Background**: #F8F9FA - Main background\n**Surface**: #FFFFFF - Cards, modals\n**Text Primary**: #1A1A1A\n**Text Secondary**: #6B7280\n**Error**: #DC2626 - Losses, validation errors\n**Warning**: #F59E0B - Risk indicators\n**Border**: #E5E7EB\n\n## Typography\n\n**Font**: System (SF Pro for iOS, Roboto for Android)\n**Scale**:\n- Hero: 32pt, Bold\n- Title: 24pt, Bold\n- Heading: 18pt, Semibold\n- Body: 16pt, Regular\n- Caption: 14pt, Regular\n- Small: 12pt, Regular\n\n## Visual Design\n\n- Cards have subtle border (1px, Border color) and 12pt corner radius\n- Floating action button: 56x56, Primary gradient, white icon, shadow (offset: 0,2 | opacity: 0.10 | radius: 2)\n- Investment cards use gradient backgrounds with white text\n- Progress bars: 8pt height, rounded, gradient fill\n- Tab bar icons: Feather icons at 24pt\n\n## Assets to Generate\n\n**icon.png** - App icon featuring abstract medical cross merging with upward arrow\n**splash-icon.png** - Simplified version of app icon for launch screen\n**empty-discover.png** - Illustration of telescope looking at medical symbols and growth charts (used in Discover screen when no results)\n**empty-portfolio.png** - Illustration of sprouting plant with medical leaf (used in Portfolio screen when no investments)\n**avatar-default.png** - Professional circular avatar placeholder with initials (used in Profile screen)\n**investment-hero-placeholder.png** - Abstract healthcare/science illustration (used in Investment Detail screen when no project image)","path":null,"size_bytes":5622,"size_tokens":null},"client/lib/index.ts":{"content":"// Query client and API utilities\nexport { \n  queryClient, \n  getApiUrl, \n  apiRequest, \n  getQueryFn,\n} from './query-client';\n\n// Validation schemas and helpers\nexport {\n  // Common validators\n  emailSchema,\n  passwordSchema,\n  phoneSchema,\n  nameSchema,\n  amountSchema,\n  urlSchema,\n  // Auth schemas\n  loginSchema,\n  signupSchema,\n  forgotPasswordSchema,\n  resetPasswordSchema,\n  type LoginFormData,\n  type SignupFormData,\n  type ForgotPasswordFormData,\n  type ResetPasswordFormData,\n  // Profile schemas\n  updateProfileSchema,\n  type UpdateProfileFormData,\n  // Investment schemas\n  investSchema,\n  createInvestSchema,\n  type InvestFormData,\n  // Payment schemas\n  bankAccountSchema,\n  cardSchema,\n  type BankAccountFormData,\n  type CardFormData,\n  // Support schemas\n  supportRequestSchema,\n  type SupportRequestFormData,\n  // Filter schemas\n  investmentFiltersSchema,\n  type InvestmentFiltersFormData,\n  // Helpers\n  validateForm,\n  getFieldError,\n  hasErrors,\n} from './validation';\n","path":null,"size_bytes":991,"size_tokens":null},"client/hooks/index.ts":{"content":"export {\n  useDebounce,\n  useDebouncedCallback,\n  useSearch,\n  useInfiniteScroll,\n  useRefresh,\n  useInfiniteList,\n  usePrevious,\n  useMounted,\n} from './useSearch';\n\nexport {\n  useForm,\n  useField,\n  type UseFormOptions,\n  type UseFormReturn,\n  type FieldState,\n  type FormState,\n  type UseFieldOptions,\n} from './useForm';\n","path":null,"size_bytes":325,"size_tokens":null},"client/screens/LessonPlayerScreen.tsx":{"content":"/**\n * LessonPlayer Screen\n * Play course lesson content (video, text, quiz)\n */\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport VideoPlayer from '@/components/VideoPlayer';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { coursesApi } from '@/lib/api';\nimport { formatDuration } from '@/lib/utils';\n\ntype LessonPlayerRouteParams = {\n  LessonPlayer: {\n    courseId: number;\n    lessonId: number;\n  };\n};\n\ninterface Lesson {\n  id: number;\n  title: string;\n  description?: string;\n  type: 'video' | 'text' | 'quiz';\n  duration?: number;\n  video_url?: string;\n  content?: string;\n  quiz?: QuizQuestion[];\n  is_completed: boolean;\n  order: number;\n}\n\ninterface QuizQuestion {\n  id: number;\n  question: string;\n  options: string[];\n  correct_index: number;\n}\n\nexport default function LessonPlayerScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const route = useRoute<RouteProp<LessonPlayerRouteParams, 'LessonPlayer'>>();\n  const { courseId, lessonId } = route.params;\n  const queryClient = useQueryClient();\n\n  const [currentQuizIndex, setCurrentQuizIndex] = useState(0);\n  const [selectedAnswers, setSelectedAnswers] = useState<number[]>([]);\n  const [showQuizResults, setShowQuizResults] = useState(false);\n  const [videoCompleted, setVideoCompleted] = useState(false);\n\n  const {\n    data: lesson,\n    isLoading,\n  } = useQuery({\n    queryKey: ['lesson', courseId, lessonId],\n    queryFn: async () => {\n      const response = await coursesApi.getLesson(courseId, lessonId);\n      return response.data as Lesson;\n    },\n  });\n\n  const { data: courseLessons } = useQuery({\n    queryKey: ['courseLessons', courseId],\n    queryFn: async () => {\n      const response = await coursesApi.getCourseLessons(courseId);\n      return response.data?.lessons || [];\n    },\n  });\n\n  const completeLessonMutation = useMutation({\n    mutationFn: async () => {\n      return coursesApi.completeLesson(courseId, lessonId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['lesson', courseId, lessonId] });\n      queryClient.invalidateQueries({ queryKey: ['course', courseId] });\n    },\n  });\n\n  const currentIndex = courseLessons?.findIndex((l: Lesson) => l.id === lessonId) ?? -1;\n  const prevLesson = currentIndex > 0 ? courseLessons?.[currentIndex - 1] : null;\n  const nextLesson = currentIndex < (courseLessons?.length ?? 0) - 1 \n    ? courseLessons?.[currentIndex + 1] \n    : null;\n\n  const handleMarkComplete = useCallback(() => {\n    if (!lesson?.is_completed) {\n      completeLessonMutation.mutate();\n    }\n  }, [lesson, completeLessonMutation]);\n\n  const handleVideoEnd = useCallback(() => {\n    setVideoCompleted(true);\n    handleMarkComplete();\n  }, [handleMarkComplete]);\n\n  const navigateToLesson = useCallback((nextLessonId: number) => {\n    navigation.replace('LessonPlayer', { courseId, lessonId: nextLessonId });\n  }, [navigation, courseId]);\n\n  const handleSelectAnswer = useCallback((optionIndex: number) => {\n    const newAnswers = [...selectedAnswers];\n    newAnswers[currentQuizIndex] = optionIndex;\n    setSelectedAnswers(newAnswers);\n  }, [currentQuizIndex, selectedAnswers]);\n\n  const handleNextQuestion = useCallback(() => {\n    if (lesson?.quiz && currentQuizIndex < lesson.quiz.length - 1) {\n      setCurrentQuizIndex(currentQuizIndex + 1);\n    } else {\n      setShowQuizResults(true);\n      handleMarkComplete();\n    }\n  }, [currentQuizIndex, lesson, handleMarkComplete]);\n\n  const handlePrevQuestion = useCallback(() => {\n    if (currentQuizIndex > 0) {\n      setCurrentQuizIndex(currentQuizIndex - 1);\n    }\n  }, [currentQuizIndex]);\n\n  const calculateQuizScore = useCallback(() => {\n    if (!lesson?.quiz) return 0;\n    let correct = 0;\n    lesson.quiz.forEach((q, i) => {\n      if (selectedAnswers[i] === q.correct_index) {\n        correct++;\n      }\n    });\n    return Math.round((correct / lesson.quiz.length) * 100);\n  }, [lesson, selectedAnswers]);\n\n  const handleRetakeQuiz = useCallback(() => {\n    setCurrentQuizIndex(0);\n    setSelectedAnswers([]);\n    setShowQuizResults(false);\n  }, []);\n\n  const renderVideoLesson = () => (\n    <View style={styles.videoContainer}>\n      <VideoPlayer\n        uri={lesson!.video_url!}\n        autoPlay\n        showControls\n        onClose={() => navigation.goBack()}\n        style={styles.videoPlayer}\n      />\n      \n      <View style={[styles.lessonInfo, { backgroundColor: appColors.surface }]}>\n        <ThemedText style={[styles.lessonTitle, { color: appColors.textPrimary }]}>{lesson!.title}</ThemedText>\n        {lesson!.description && (\n          <ThemedText style={[styles.lessonDescription, { color: appColors.textSecondary }]}>{lesson!.description}</ThemedText>\n        )}\n        \n        {(videoCompleted || lesson!.is_completed) && (\n          <View style={styles.completedBadge}>\n            <Ionicons name=\"checkmark-circle\" size={20} color={Colors.secondary} />\n            <ThemedText style={styles.completedText}>Completed</ThemedText>\n          </View>\n        )}\n      </View>\n    </View>\n  );\n\n  const renderTextLesson = () => (\n    <ScrollView style={styles.textContainer} showsVerticalScrollIndicator={false}>\n      <View style={[styles.lessonInfo, { backgroundColor: appColors.surface }]}>\n        <ThemedText style={[styles.lessonTitle, { color: appColors.textPrimary }]}>{lesson!.title}</ThemedText>\n        {lesson!.duration && (\n          <ThemedText style={[styles.readTime, { color: appColors.textSecondary }]}>\n            <Ionicons name=\"time-outline\" size={14} color={appColors.textSecondary} />\n            {' '}{Math.ceil(lesson!.duration / 60)} min read\n          </ThemedText>\n        )}\n      </View>\n      \n      <View style={[styles.textContent, { backgroundColor: appColors.surface }]}>\n        <ThemedText style={[styles.contentText, { color: appColors.textPrimary }]}>{lesson!.content}</ThemedText>\n      </View>\n\n      <TouchableOpacity\n        style={[styles.completeButton, lesson!.is_completed && styles.completedButton]}\n        onPress={handleMarkComplete}\n        disabled={lesson!.is_completed}\n      >\n        <Ionicons \n          name={lesson!.is_completed ? 'checkmark-circle' : 'checkmark-circle-outline'} \n          size={20} \n          color={lesson!.is_completed ? Colors.secondary : 'white'} \n        />\n        <ThemedText style={[\n          styles.completeButtonText,\n          lesson!.is_completed && styles.completedButtonText\n        ]}>\n          {lesson!.is_completed ? 'Completed' : 'Mark as Complete'}\n        </ThemedText>\n      </TouchableOpacity>\n    </ScrollView>\n  );\n\n  const renderQuizLesson = () => {\n    if (showQuizResults) {\n      const score = calculateQuizScore();\n      const passed = score >= 70;\n\n      return (\n        <View style={styles.quizResultsContainer}>\n          <View style={[styles.scoreCircle, passed ? styles.passedCircle : styles.failedCircle]}>\n            <ThemedText style={[styles.scoreText, { color: appColors.textPrimary }]}>{score}%</ThemedText>\n          </View>\n          \n          <ThemedText style={[styles.resultTitle, { color: appColors.textPrimary }]}>\n            {passed ? 'Congratulations!' : 'Keep Learning!'}\n          </ThemedText>\n          <ThemedText style={[styles.resultSubtitle, { color: appColors.textSecondary }]}>\n            {passed \n              ? 'You passed the quiz and completed this lesson.' \n              : 'You need 70% to pass. Review the material and try again.'}\n          </ThemedText>\n\n          <View style={styles.resultActions}>\n            {!passed && (\n              <TouchableOpacity style={styles.retakeButton} onPress={handleRetakeQuiz}>\n                <Ionicons name=\"refresh\" size={20} color={Colors.primary} />\n                <ThemedText style={styles.retakeButtonText}>Retake Quiz</ThemedText>\n              </TouchableOpacity>\n            )}\n            {nextLesson && passed && (\n              <TouchableOpacity \n                style={styles.nextLessonButton}\n                onPress={() => navigateToLesson(nextLesson.id)}\n              >\n                <ThemedText style={styles.nextLessonButtonText}>Next Lesson</ThemedText>\n                <Ionicons name=\"arrow-forward\" size={20} color=\"white\" />\n              </TouchableOpacity>\n            )}\n          </View>\n        </View>\n      );\n    }\n\n    const currentQuestion = lesson!.quiz![currentQuizIndex];\n    const totalQuestions = lesson!.quiz!.length;\n\n    return (\n      <View style={styles.quizContainer}>\n        <View style={styles.quizProgress}>\n          <View style={styles.progressBarBg}>\n            <View \n              style={[\n                styles.progressBarFill, \n                { width: `${((currentQuizIndex + 1) / totalQuestions) * 100}%` }\n              ]} \n            />\n          </View>\n          <ThemedText style={[styles.progressText, { color: appColors.textSecondary }]}>\n            {currentQuizIndex + 1} of {totalQuestions}\n          </ThemedText>\n        </View>\n\n        <ThemedText style={[styles.questionText, { color: appColors.textPrimary }]}>{currentQuestion.question}</ThemedText>\n\n        <View style={styles.optionsContainer}>\n          {currentQuestion.options.map((option, index) => (\n            <TouchableOpacity\n              key={index}\n              style={[\n                styles.optionButton,\n                { backgroundColor: appColors.surface, borderColor: appColors.border },\n                selectedAnswers[currentQuizIndex] === index && styles.optionSelected,\n              ]}\n              onPress={() => handleSelectAnswer(index)}\n            >\n              <View style={[\n                styles.optionRadio,\n                { borderColor: appColors.border },\n                selectedAnswers[currentQuizIndex] === index && styles.optionRadioSelected,\n              ]}>\n                {selectedAnswers[currentQuizIndex] === index && (\n                  <View style={styles.optionRadioInner} />\n                )}\n              </View>\n              <ThemedText style={[\n                styles.optionText,\n                { color: appColors.textPrimary },\n                selectedAnswers[currentQuizIndex] === index && styles.optionTextSelected,\n              ]}>\n                {option}\n              </ThemedText>\n            </TouchableOpacity>\n          ))}\n        </View>\n\n        <View style={styles.quizNavigation}>\n          <TouchableOpacity\n            style={[styles.quizNavButton, currentQuizIndex === 0 && styles.quizNavButtonDisabled]}\n            onPress={handlePrevQuestion}\n            disabled={currentQuizIndex === 0}\n          >\n            <Ionicons name=\"chevron-back\" size={20} color={currentQuizIndex === 0 ? appColors.textSecondary : Colors.primary} />\n            <ThemedText style={[styles.quizNavText, currentQuizIndex === 0 && { color: appColors.textSecondary }]}>\n              Previous\n            </ThemedText>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[\n              styles.quizNavButton,\n              styles.quizNextButton,\n              selectedAnswers[currentQuizIndex] === undefined && styles.quizNavButtonDisabled,\n            ]}\n            onPress={handleNextQuestion}\n            disabled={selectedAnswers[currentQuizIndex] === undefined}\n          >\n            <ThemedText style={styles.quizNextText}>\n              {currentQuizIndex === totalQuestions - 1 ? 'Submit' : 'Next'}\n            </ThemedText>\n            <Ionicons name=\"chevron-forward\" size={20} color=\"white\" />\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  if (!lesson) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ThemedText>Lesson not found</ThemedText>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <View style={styles.headerInfo}>\n          <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]} numberOfLines={1}>\n            {lesson.title}\n          </ThemedText>\n          <ThemedText style={[styles.headerSubtitle, { color: appColors.textSecondary }]}>\n            Lesson {currentIndex + 1} of {courseLessons?.length || 0}\n          </ThemedText>\n        </View>\n        <TouchableOpacity style={styles.closeButton} onPress={() => navigation.navigate('CourseDetail', { courseId })}>\n          <Ionicons name=\"close\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      <View style={styles.content}>\n        {lesson.type === 'video' && renderVideoLesson()}\n        {lesson.type === 'text' && renderTextLesson()}\n        {lesson.type === 'quiz' && renderQuizLesson()}\n      </View>\n\n      {lesson.type !== 'quiz' && (\n        <View style={[styles.bottomNav, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <TouchableOpacity\n            style={[styles.navButton, !prevLesson && styles.navButtonDisabled]}\n            onPress={() => prevLesson && navigateToLesson(prevLesson.id)}\n            disabled={!prevLesson}\n          >\n            <Ionicons name=\"chevron-back\" size={20} color={prevLesson ? appColors.textPrimary : appColors.textSecondary} />\n            <ThemedText style={[styles.navButtonText, { color: appColors.textPrimary }, !prevLesson && { color: appColors.textSecondary }]}>\n              Previous\n            </ThemedText>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={[styles.navButton, styles.navButtonNext, !nextLesson && styles.navButtonDisabled]}\n            onPress={() => nextLesson && navigateToLesson(nextLesson.id)}\n            disabled={!nextLesson}\n          >\n            <ThemedText style={[styles.navButtonText, styles.navButtonTextNext, !nextLesson && { color: appColors.textSecondary }]}>\n              Next\n            </ThemedText>\n            <Ionicons name=\"chevron-forward\" size={20} color={nextLesson ? 'white' : appColors.textSecondary} />\n          </TouchableOpacity>\n        </View>\n      )}\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerInfo: {\n    flex: 1,\n    marginHorizontal: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  headerSubtitle: {\n    ...Typography.small,\n  },\n  closeButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  videoContainer: {\n    flex: 1,\n  },\n  videoPlayer: {\n    width: '100%',\n  },\n  lessonInfo: {\n    padding: Spacing.lg,\n  },\n  lessonTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.sm,\n  },\n  lessonDescription: {\n    ...Typography.body,\n    lineHeight: 24,\n  },\n  completedBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.md,\n    gap: Spacing.xs,\n  },\n  completedText: {\n    ...Typography.caption,\n    color: Colors.secondary,\n    fontWeight: '600',\n  },\n  textContainer: {\n    flex: 1,\n  },\n  readTime: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  textContent: {\n    padding: Spacing.lg,\n  },\n  contentText: {\n    ...Typography.body,\n    lineHeight: 28,\n  },\n  completeButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary,\n    marginHorizontal: Spacing.lg,\n    marginVertical: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  completedButton: {\n    backgroundColor: Colors.secondary + '20',\n  },\n  completeButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  completedButtonText: {\n    color: Colors.secondary,\n  },\n  quizContainer: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  quizProgress: {\n    marginBottom: Spacing.xl,\n  },\n  progressBarBg: {\n    height: 6,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: 3,\n    marginBottom: Spacing.sm,\n  },\n  progressBarFill: {\n    height: '100%',\n    backgroundColor: Colors.primary,\n    borderRadius: 3,\n  },\n  progressText: {\n    ...Typography.small,\n    textAlign: 'center',\n  },\n  questionText: {\n    ...Typography.title,\n    marginBottom: Spacing.xl,\n  },\n  optionsContainer: {\n    gap: Spacing.md,\n  },\n  optionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 2,\n  },\n  optionSelected: {\n    borderColor: Colors.primary,\n    backgroundColor: Colors.primary + '08',\n  },\n  optionRadio: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 2,\n    marginRight: Spacing.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  optionRadioSelected: {\n    borderColor: Colors.primary,\n  },\n  optionRadioInner: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    backgroundColor: Colors.primary,\n  },\n  optionText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  optionTextSelected: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  quizNavigation: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginTop: 'auto',\n    paddingTop: Spacing.xl,\n  },\n  quizNavButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    gap: Spacing.xs,\n  },\n  quizNavButtonDisabled: {\n    opacity: 0.5,\n  },\n  quizNavText: {\n    ...Typography.body,\n    color: Colors.primary,\n  },\n  quizNextButton: {\n    backgroundColor: Colors.primary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.lg,\n  },\n  quizNextText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  quizResultsContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  scoreCircle: {\n    width: 120,\n    height: 120,\n    borderRadius: 60,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  passedCircle: {\n    backgroundColor: Colors.secondary + '20',\n  },\n  failedCircle: {\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  scoreText: {\n    fontSize: 36,\n    fontWeight: '700',\n  },\n  resultTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.sm,\n  },\n  resultSubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n  },\n  resultActions: {\n    gap: Spacing.md,\n    width: '100%',\n  },\n  retakeButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary + '15',\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  retakeButtonText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  nextLessonButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  nextLessonButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  bottomNav: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  navButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    gap: Spacing.xs,\n  },\n  navButtonNext: {\n    backgroundColor: Colors.primary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.lg,\n  },\n  navButtonDisabled: {\n    opacity: 0.5,\n  },\n  navButtonText: {\n    ...Typography.body,\n  },\n  navButtonTextNext: {\n    color: 'white',\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":21003,"size_tokens":null},"client/lib/drafts.ts":{"content":"/**\n * Draft Posts Service\n * Auto-save unfinished posts with local persistence\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useCallback, useEffect, useState, useRef } from 'react';\n\nexport interface PostDraft {\n  id: string;\n  content: string;\n  roomId?: string;\n  roomName?: string;\n  images?: string[];\n  videoUri?: string;\n  isAnonymous?: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\nconst DRAFTS_STORAGE_KEY = 'post_drafts';\nconst AUTO_SAVE_DELAY = 2000;\n\nclass DraftService {\n  private drafts: Map<string, PostDraft> = new Map();\n  private loaded: boolean = false;\n\n  async loadDrafts(): Promise<PostDraft[]> {\n    if (this.loaded) {\n      return Array.from(this.drafts.values());\n    }\n\n    try {\n      const stored = await AsyncStorage.getItem(DRAFTS_STORAGE_KEY);\n      if (stored) {\n        const parsed = JSON.parse(stored) as PostDraft[];\n        parsed.forEach(draft => this.drafts.set(draft.id, draft));\n      }\n      this.loaded = true;\n      return Array.from(this.drafts.values());\n    } catch (error) {\n      console.error('[Drafts] Error loading drafts:', error);\n      return [];\n    }\n  }\n\n  private async persistDrafts(): Promise<void> {\n    try {\n      const draftsArray = Array.from(this.drafts.values());\n      await AsyncStorage.setItem(DRAFTS_STORAGE_KEY, JSON.stringify(draftsArray));\n    } catch (error) {\n      console.error('[Drafts] Error saving drafts:', error);\n    }\n  }\n\n  generateDraftId(): string {\n    return `draft_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  async saveDraft(draft: Partial<PostDraft> & { id: string }): Promise<PostDraft> {\n    await this.loadDrafts();\n\n    const existing = this.drafts.get(draft.id);\n    const now = new Date().toISOString();\n\n    const updatedDraft: PostDraft = {\n      id: draft.id,\n      content: draft.content ?? existing?.content ?? '',\n      roomId: draft.roomId ?? existing?.roomId,\n      roomName: draft.roomName ?? existing?.roomName,\n      images: draft.images ?? existing?.images,\n      videoUri: draft.videoUri ?? existing?.videoUri,\n      isAnonymous: draft.isAnonymous ?? existing?.isAnonymous,\n      createdAt: existing?.createdAt ?? now,\n      updatedAt: now,\n    };\n\n    this.drafts.set(draft.id, updatedDraft);\n    await this.persistDrafts();\n\n    return updatedDraft;\n  }\n\n  async getDraft(id: string): Promise<PostDraft | null> {\n    await this.loadDrafts();\n    return this.drafts.get(id) || null;\n  }\n\n  async getAllDrafts(): Promise<PostDraft[]> {\n    await this.loadDrafts();\n    return Array.from(this.drafts.values())\n      .sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime());\n  }\n\n  async getDraftsForRoom(roomId: string): Promise<PostDraft[]> {\n    const allDrafts = await this.getAllDrafts();\n    return allDrafts.filter(d => d.roomId === roomId);\n  }\n\n  async deleteDraft(id: string): Promise<void> {\n    await this.loadDrafts();\n    this.drafts.delete(id);\n    await this.persistDrafts();\n  }\n\n  async deleteAllDrafts(): Promise<void> {\n    this.drafts.clear();\n    await AsyncStorage.removeItem(DRAFTS_STORAGE_KEY);\n  }\n\n  isDraftEmpty(draft: PostDraft): boolean {\n    return (\n      !draft.content.trim() &&\n      (!draft.images || draft.images.length === 0) &&\n      !draft.videoUri\n    );\n  }\n}\n\nexport const draftService = new DraftService();\n\nexport function useAutoSaveDraft(initialDraftId?: string) {\n  const [draftId, setDraftId] = useState<string>(\n    initialDraftId || draftService.generateDraftId()\n  );\n  const [draft, setDraft] = useState<PostDraft | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\n  const saveTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    const loadExisting = async () => {\n      if (initialDraftId) {\n        const existing = await draftService.getDraft(initialDraftId);\n        if (existing) setDraft(existing);\n      }\n    };\n    loadExisting();\n  }, [initialDraftId]);\n\n  const saveNow = useCallback(async (content: Partial<PostDraft>) => {\n    setIsSaving(true);\n    try {\n      const saved = await draftService.saveDraft({ id: draftId, ...content });\n      setDraft(saved);\n      setLastSaved(new Date());\n    } finally {\n      setIsSaving(false);\n    }\n  }, [draftId]);\n\n  const autoSave = useCallback((content: Partial<PostDraft>) => {\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n\n    saveTimeoutRef.current = setTimeout(() => {\n      saveNow(content);\n    }, AUTO_SAVE_DELAY);\n  }, [saveNow]);\n\n  const deleteDraft = useCallback(async () => {\n    await draftService.deleteDraft(draftId);\n    setDraft(null);\n  }, [draftId]);\n\n  useEffect(() => {\n    return () => {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  return {\n    draftId,\n    draft,\n    isSaving,\n    lastSaved,\n    autoSave,\n    saveNow,\n    deleteDraft,\n    setDraftId,\n  };\n}\n\nexport function useDraftList() {\n  const [drafts, setDrafts] = useState<PostDraft[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const loadDrafts = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const allDrafts = await draftService.getAllDrafts();\n      setDrafts(allDrafts.filter(d => !draftService.isDraftEmpty(d)));\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    loadDrafts();\n  }, [loadDrafts]);\n\n  const deleteDraft = useCallback(async (id: string) => {\n    await draftService.deleteDraft(id);\n    setDrafts(prev => prev.filter(d => d.id !== id));\n  }, []);\n\n  const deleteAllDrafts = useCallback(async () => {\n    await draftService.deleteAllDrafts();\n    setDrafts([]);\n  }, []);\n\n  return {\n    drafts,\n    isLoading,\n    refresh: loadDrafts,\n    deleteDraft,\n    deleteAllDrafts,\n  };\n}\n","path":null,"size_bytes":5872,"size_tokens":null},"client/screens/SavedSearchesScreen.tsx":{"content":"/**\n * Saved Searches\n * Quick access to frequent searches\n */\n\nimport React, { useState, useCallback, useEffect, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n  TextInput,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Swipeable } from 'react-native-gesture-handler';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\n// Types\nexport interface SavedSearch {\n  id: string;\n  query: string;\n  filters?: {\n    type?: string;\n    dateRange?: string;\n    roomId?: string;\n  };\n  createdAt: string;\n  lastUsedAt: string;\n  useCount: number;\n  notificationsEnabled: boolean;\n}\n\nexport interface RecentSearch {\n  query: string;\n  timestamp: string;\n}\n\nconst SAVED_SEARCHES_KEY = 'saved_searches';\nconst RECENT_SEARCHES_KEY = 'recent_searches';\nconst MAX_RECENT_SEARCHES = 20;\n\n// =============================================================================\n// SAVED SEARCHES SERVICE\n// =============================================================================\n\nclass SavedSearchesService {\n  private savedSearches: SavedSearch[] = [];\n  private recentSearches: RecentSearch[] = [];\n  private loaded: boolean = false;\n\n  async load(): Promise<void> {\n    if (this.loaded) return;\n\n    try {\n      const [savedData, recentData] = await Promise.all([\n        AsyncStorage.getItem(SAVED_SEARCHES_KEY),\n        AsyncStorage.getItem(RECENT_SEARCHES_KEY),\n      ]);\n\n      if (savedData) {\n        this.savedSearches = JSON.parse(savedData);\n      }\n      if (recentData) {\n        this.recentSearches = JSON.parse(recentData);\n      }\n      this.loaded = true;\n    } catch (error) {\n      console.error('[SavedSearches] Error loading:', error);\n    }\n  }\n\n  private async persistSaved(): Promise<void> {\n    try {\n      await AsyncStorage.setItem(SAVED_SEARCHES_KEY, JSON.stringify(this.savedSearches));\n    } catch (error) {\n      console.error('[SavedSearches] Error saving:', error);\n    }\n  }\n\n  private async persistRecent(): Promise<void> {\n    try {\n      await AsyncStorage.setItem(RECENT_SEARCHES_KEY, JSON.stringify(this.recentSearches));\n    } catch (error) {\n      console.error('[SavedSearches] Error saving recent:', error);\n    }\n  }\n\n  // Saved searches\n  async getSavedSearches(): Promise<SavedSearch[]> {\n    await this.load();\n    return [...this.savedSearches].sort((a, b) => \n      new Date(b.lastUsedAt).getTime() - new Date(a.lastUsedAt).getTime()\n    );\n  }\n\n  async saveSearch(query: string, filters?: SavedSearch['filters']): Promise<SavedSearch> {\n    await this.load();\n\n    // Check if already exists\n    const existing = this.savedSearches.find(s => \n      s.query.toLowerCase() === query.toLowerCase()\n    );\n\n    if (existing) {\n      existing.lastUsedAt = new Date().toISOString();\n      existing.useCount++;\n      await this.persistSaved();\n      return existing;\n    }\n\n    const newSearch: SavedSearch = {\n      id: `search_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      query,\n      filters,\n      createdAt: new Date().toISOString(),\n      lastUsedAt: new Date().toISOString(),\n      useCount: 1,\n      notificationsEnabled: false,\n    };\n\n    this.savedSearches.unshift(newSearch);\n    await this.persistSaved();\n    return newSearch;\n  }\n\n  async deleteSavedSearch(id: string): Promise<void> {\n    await this.load();\n    this.savedSearches = this.savedSearches.filter(s => s.id !== id);\n    await this.persistSaved();\n  }\n\n  async toggleNotifications(id: string): Promise<boolean> {\n    await this.load();\n    const search = this.savedSearches.find(s => s.id === id);\n    if (search) {\n      search.notificationsEnabled = !search.notificationsEnabled;\n      await this.persistSaved();\n      return search.notificationsEnabled;\n    }\n    return false;\n  }\n\n  async updateLastUsed(id: string): Promise<void> {\n    await this.load();\n    const search = this.savedSearches.find(s => s.id === id);\n    if (search) {\n      search.lastUsedAt = new Date().toISOString();\n      search.useCount++;\n      await this.persistSaved();\n    }\n  }\n\n  async isSearchSaved(query: string): Promise<boolean> {\n    await this.load();\n    return this.savedSearches.some(s => \n      s.query.toLowerCase() === query.toLowerCase()\n    );\n  }\n\n  // Recent searches\n  async getRecentSearches(): Promise<RecentSearch[]> {\n    await this.load();\n    return this.recentSearches;\n  }\n\n  async addRecentSearch(query: string): Promise<void> {\n    await this.load();\n\n    // Remove if exists\n    this.recentSearches = this.recentSearches.filter(\n      s => s.query.toLowerCase() !== query.toLowerCase()\n    );\n\n    // Add to front\n    this.recentSearches.unshift({\n      query,\n      timestamp: new Date().toISOString(),\n    });\n\n    // Trim to max\n    if (this.recentSearches.length > MAX_RECENT_SEARCHES) {\n      this.recentSearches = this.recentSearches.slice(0, MAX_RECENT_SEARCHES);\n    }\n\n    await this.persistRecent();\n  }\n\n  async removeRecentSearch(query: string): Promise<void> {\n    await this.load();\n    this.recentSearches = this.recentSearches.filter(\n      s => s.query.toLowerCase() !== query.toLowerCase()\n    );\n    await this.persistRecent();\n  }\n\n  async clearRecentSearches(): Promise<void> {\n    this.recentSearches = [];\n    await this.persistRecent();\n  }\n}\n\nexport const savedSearchesService = new SavedSearchesService();\n\n// =============================================================================\n// SAVED SEARCHES SCREEN\n// =============================================================================\n\nexport default function SavedSearchesScreen() {\n  const navigation = useNavigation<any>();\n  const { colors } = useThemeContext();\n  const [savedSearches, setSavedSearches] = useState<SavedSearch[]>([]);\n  const [recentSearches, setRecentSearches] = useState<RecentSearch[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState<'saved' | 'recent'>('saved');\n\n  useEffect(() => {\n    loadSearches();\n  }, []);\n\n  const loadSearches = async () => {\n    setIsLoading(true);\n    const [saved, recent] = await Promise.all([\n      savedSearchesService.getSavedSearches(),\n      savedSearchesService.getRecentSearches(),\n    ]);\n    setSavedSearches(saved);\n    setRecentSearches(recent);\n    setIsLoading(false);\n  };\n\n  const handleSearchPress = useCallback((query: string, searchId?: string) => {\n    haptics.selection();\n    if (searchId) {\n      savedSearchesService.updateLastUsed(searchId);\n    }\n    navigation.navigate('Search', { initialQuery: query });\n  }, [navigation]);\n\n  const handleDeleteSaved = useCallback((id: string) => {\n    Alert.alert(\n      'Delete Saved Search',\n      'Are you sure you want to delete this saved search?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Delete',\n          style: 'destructive',\n          onPress: async () => {\n            haptics.delete();\n            await savedSearchesService.deleteSavedSearch(id);\n            setSavedSearches(prev => prev.filter(s => s.id !== id));\n          },\n        },\n      ]\n    );\n  }, []);\n\n  const handleToggleNotifications = useCallback(async (id: string) => {\n    haptics.toggle();\n    const enabled = await savedSearchesService.toggleNotifications(id);\n    setSavedSearches(prev => \n      prev.map(s => s.id === id ? { ...s, notificationsEnabled: enabled } : s)\n    );\n  }, []);\n\n  const handleRemoveRecent = useCallback(async (query: string) => {\n    haptics.buttonPress();\n    await savedSearchesService.removeRecentSearch(query);\n    setRecentSearches(prev => prev.filter(s => s.query !== query));\n  }, []);\n\n  const handleClearRecent = useCallback(() => {\n    Alert.alert(\n      'Clear Recent Searches',\n      'Are you sure you want to clear all recent searches?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Clear',\n          style: 'destructive',\n          onPress: async () => {\n            haptics.delete();\n            await savedSearchesService.clearRecentSearches();\n            setRecentSearches([]);\n          },\n        },\n      ]\n    );\n  }, []);\n\n  const renderSavedSearch = ({ item }: { item: SavedSearch }) => (\n    <Swipeable\n      renderRightActions={() => (\n        <TouchableOpacity\n          style={[styles.deleteAction, { backgroundColor: colors.error }]}\n          onPress={() => handleDeleteSaved(item.id)}\n        >\n          <Ionicons name=\"trash-outline\" size={22} color=\"white\" />\n        </TouchableOpacity>\n      )}\n      overshootRight={false}\n    >\n      <TouchableOpacity\n        style={[styles.searchItem, { backgroundColor: colors.surface }]}\n        onPress={() => handleSearchPress(item.query, item.id)}\n      >\n        <View style={[styles.searchIcon, { backgroundColor: colors.primary + '15' }]}>\n          <Ionicons name=\"search\" size={18} color={colors.primary} />\n        </View>\n        <View style={styles.searchContent}>\n          <ThemedText style={[styles.searchQuery, { color: colors.textPrimary }]}>\n            {item.query}\n          </ThemedText>\n          <ThemedText style={[styles.searchMeta, { color: colors.textSecondary }]}>\n            Used {item.useCount} time{item.useCount !== 1 ? 's' : ''}\n          </ThemedText>\n        </View>\n        <TouchableOpacity\n          style={styles.notificationButton}\n          onPress={() => handleToggleNotifications(item.id)}\n        >\n          <Ionicons\n            name={item.notificationsEnabled ? 'notifications' : 'notifications-outline'}\n            size={20}\n            color={item.notificationsEnabled ? colors.primary : colors.textSecondary}\n          />\n        </TouchableOpacity>\n      </TouchableOpacity>\n    </Swipeable>\n  );\n\n  const renderRecentSearch = ({ item }: { item: RecentSearch }) => (\n    <TouchableOpacity\n      style={[styles.searchItem, { backgroundColor: colors.surface }]}\n      onPress={() => handleSearchPress(item.query)}\n    >\n      <View style={[styles.searchIcon, { backgroundColor: colors.backgroundSecondary }]}>\n        <Ionicons name=\"time-outline\" size={18} color={colors.textSecondary} />\n      </View>\n      <View style={styles.searchContent}>\n        <ThemedText style={[styles.searchQuery, { color: colors.textPrimary }]}>\n          {item.query}\n        </ThemedText>\n      </View>\n      <TouchableOpacity\n        style={styles.removeButton}\n        onPress={() => handleRemoveRecent(item.query)}\n      >\n        <Ionicons name=\"close\" size={18} color={colors.textSecondary} />\n      </TouchableOpacity>\n    </TouchableOpacity>\n  );\n\n  const renderEmptyState = (type: 'saved' | 'recent') => (\n    <View style={styles.emptyContainer}>\n      <Ionicons\n        name={type === 'saved' ? 'bookmark-outline' : 'time-outline'}\n        size={64}\n        color={colors.textSecondary}\n      />\n      <ThemedText style={[styles.emptyTitle, { color: colors.textPrimary }]}>\n        {type === 'saved' ? 'No saved searches' : 'No recent searches'}\n      </ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: colors.textSecondary }]}>\n        {type === 'saved'\n          ? 'Save searches to quickly access them later'\n          : 'Your recent searches will appear here'}\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={colors.primary} />\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Searches\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      {/* Tabs */}\n      <View style={[styles.tabsContainer, { backgroundColor: colors.backgroundSecondary }]}>\n        <TouchableOpacity\n          style={[\n            styles.tab,\n            activeTab === 'saved' && { backgroundColor: colors.surface },\n          ]}\n          onPress={() => {\n            haptics.selection();\n            setActiveTab('saved');\n          }}\n        >\n          <ThemedText\n            style={[\n              styles.tabText,\n              { color: activeTab === 'saved' ? colors.primary : colors.textSecondary },\n            ]}\n          >\n            Saved\n          </ThemedText>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[\n            styles.tab,\n            activeTab === 'recent' && { backgroundColor: colors.surface },\n          ]}\n          onPress={() => {\n            haptics.selection();\n            setActiveTab('recent');\n          }}\n        >\n          <ThemedText\n            style={[\n              styles.tabText,\n              { color: activeTab === 'recent' ? colors.primary : colors.textSecondary },\n            ]}\n          >\n            Recent\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n\n      {/* Clear button for recent */}\n      {activeTab === 'recent' && recentSearches.length > 0 && (\n        <TouchableOpacity\n          style={[styles.clearButton, { borderBottomColor: colors.border }]}\n          onPress={handleClearRecent}\n        >\n          <ThemedText style={[styles.clearButtonText, { color: colors.error }]}>\n            Clear All\n          </ThemedText>\n        </TouchableOpacity>\n      )}\n\n      {/* Lists */}\n      {activeTab === 'saved' ? (\n        <FlatList\n          data={savedSearches}\n          renderItem={renderSavedSearch}\n          keyExtractor={(item) => item.id}\n          contentContainerStyle={savedSearches.length === 0 ? styles.emptyList : styles.listContent}\n          ListEmptyComponent={() => renderEmptyState('saved')}\n          ItemSeparatorComponent={() => <View style={{ height: Spacing.sm }} />}\n        />\n      ) : (\n        <FlatList\n          data={recentSearches}\n          renderItem={renderRecentSearch}\n          keyExtractor={(item) => item.query}\n          contentContainerStyle={recentSearches.length === 0 ? styles.emptyList : styles.listContent}\n          ListEmptyComponent={() => renderEmptyState('recent')}\n          ItemSeparatorComponent={() => <View style={{ height: Spacing.sm }} />}\n        />\n      )}\n    </SafeAreaView>\n  );\n}\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function useSavedSearches() {\n  const [savedSearches, setSavedSearches] = useState<SavedSearch[]>([]);\n  const [recentSearches, setRecentSearches] = useState<RecentSearch[]>([]);\n\n  useEffect(() => {\n    loadSearches();\n  }, []);\n\n  const loadSearches = async () => {\n    const [saved, recent] = await Promise.all([\n      savedSearchesService.getSavedSearches(),\n      savedSearchesService.getRecentSearches(),\n    ]);\n    setSavedSearches(saved);\n    setRecentSearches(recent);\n  };\n\n  const saveSearch = useCallback(async (query: string, filters?: SavedSearch['filters']) => {\n    const search = await savedSearchesService.saveSearch(query, filters);\n    setSavedSearches(prev => [search, ...prev.filter(s => s.id !== search.id)]);\n    return search;\n  }, []);\n\n  const addRecentSearch = useCallback(async (query: string) => {\n    await savedSearchesService.addRecentSearch(query);\n    setRecentSearches(await savedSearchesService.getRecentSearches());\n  }, []);\n\n  const isSearchSaved = useCallback(async (query: string) => {\n    return savedSearchesService.isSearchSaved(query);\n  }, []);\n\n  return {\n    savedSearches,\n    recentSearches,\n    saveSearch,\n    addRecentSearch,\n    isSearchSaved,\n    refresh: loadSearches,\n  };\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    margin: Spacing.lg,\n    padding: 4,\n    borderRadius: BorderRadius.md,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: Spacing.sm,\n    alignItems: 'center',\n    borderRadius: BorderRadius.sm,\n  },\n  tabText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  clearButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n    alignItems: 'flex-end',\n  },\n  clearButtonText: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  listContent: {\n    padding: Spacing.lg,\n    paddingTop: Spacing.sm,\n  },\n  emptyList: {\n    flexGrow: 1,\n  },\n  searchItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  searchIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  searchContent: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  searchQuery: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  searchMeta: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  notificationButton: {\n    padding: Spacing.sm,\n  },\n  removeButton: {\n    padding: Spacing.sm,\n  },\n  deleteAction: {\n    width: 70,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: BorderRadius.md,\n    marginLeft: Spacing.sm,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n});\n","path":null,"size_bytes":18599,"size_tokens":null},"MOBILE_INTEGRATION_GUIDE.md":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"client/screens/settings/PaymentMethodsScreen.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Pressable } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport default function PaymentMethodsScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n\n  const paymentMethods = [\n    { id: '1', type: 'bank', name: 'Chase Checking', last4: '4567', isDefault: true },\n    { id: '2', type: 'card', name: 'Visa', last4: '1234', isDefault: false },\n  ];\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Payment Methods</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        {paymentMethods.map((method) => (\n          <Pressable key={method.id} style={styles.paymentItem}>\n            <View style={styles.paymentIcon}>\n              <Feather\n                name={method.type === 'bank' ? 'home' : 'credit-card'}\n                size={20}\n                color={colors.primary.main}\n              />\n            </View>\n            <View style={styles.paymentInfo}>\n              <Text style={styles.paymentName}>{method.name}</Text>\n              <Text style={styles.paymentLast4}>‚Ä¢‚Ä¢‚Ä¢‚Ä¢ {method.last4}</Text>\n            </View>\n            {method.isDefault && (\n              <View style={styles.defaultBadge}>\n                <Text style={styles.defaultText}>Default</Text>\n              </View>\n            )}\n            <Feather name=\"chevron-right\" size={20} color={colors.text.tertiary} />\n          </Pressable>\n        ))}\n\n        <Pressable style={styles.addButton}>\n          <Feather name=\"plus\" size={20} color={colors.primary.main} />\n          <Text style={styles.addButtonText}>Add Payment Method</Text>\n        </Pressable>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  content: {\n    flex: 1,\n    padding: spacing.lg,\n  },\n  paymentItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  paymentIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  paymentInfo: {\n    flex: 1,\n  },\n  paymentName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  paymentLast4: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  defaultBadge: {\n    backgroundColor: colors.transparent.primary10,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusSmall,\n    marginRight: spacing.sm,\n  },\n  defaultText: {\n    ...typography.small,\n    color: colors.primary.main,\n  },\n  addButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    paddingVertical: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.primary.main,\n    borderStyle: 'dashed',\n    marginTop: spacing.md,\n  },\n  addButtonText: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n});\n","path":null,"size_bytes":4303,"size_tokens":null},"client/navigation/ResearchStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport ResearchScreen from \"@/screens/ResearchScreen\";\n\nexport type ResearchStackParamList = {\n  Research: undefined;\n};\n\nconst Stack = createNativeStackNavigator<ResearchStackParamList>();\n\nexport default function ResearchStackNavigator() {\n  const screenOptions = useScreenOptions();\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      <Stack.Screen\n        name=\"Research\"\n        component={ResearchScreen}\n        options={{ headerShown: false }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":674,"size_tokens":null},"docs/PRODUCTION_SETUP.md":{"content":"# MedInvest Production Setup Guide\n\nThis guide covers the steps required to prepare MedInvest for publishing to the Apple App Store and Google Play Store.\n\n## Prerequisites\n\n### Required Accounts\n- **Apple Developer Program** ($99/year) - [developer.apple.com](https://developer.apple.com)\n- **Google Play Developer** ($25 one-time) - [play.google.com/console](https://play.google.com/console)\n- **Expo Account** (free) - [expo.dev](https://expo.dev)\n\n---\n\n## OAuth Provider Setup\n\n### 1. Google Sign-In\n\n**Google Cloud Console Setup:**\n1. Go to [Google Cloud Console](https://console.cloud.google.com/apis/credentials)\n2. Create a new project or select existing\n3. Enable \"Google Sign-In\" API\n4. Create OAuth 2.0 Client IDs for each platform:\n\n| Platform | Client Type | Configuration |\n|----------|-------------|---------------|\n| Web | Web application | Authorized redirect URI: `https://your-production-domain.com/` |\n| iOS | iOS | Bundle ID: `com.medinvest.app` |\n| Android | Android | Package name: `com.medinvest.app`, SHA-1 fingerprint required |\n| Expo Go (dev) | Web application | Redirect URI: `https://auth.expo.io/@your-expo-username/medinvest` |\n\n**Frontend Environment Variables:**\n```\nEXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID=your-web-client-id\nEXPO_PUBLIC_GOOGLE_IOS_CLIENT_ID=your-ios-client-id\nEXPO_PUBLIC_GOOGLE_ANDROID_CLIENT_ID=your-android-client-id\n```\n\n**Backend Environment Variables (for server-side token verification):**\n```\nGOOGLE_WEB_CLIENT_ID=your-web-client-id\nGOOGLE_WEB_CLIENT_SECRET=your-web-client-secret\n```\n\n> **Note:** The client secret is required for server-side token exchange. Store securely as a secret in Replit.\n\n### 2. GitHub Sign-In\n\n> **Important:** Web and mobile apps require **separate** GitHub OAuth apps because they use different redirect URIs.\n\n#### Web OAuth App (for browser-based login)\n\n**GitHub Developer Settings:**\n1. Go to [GitHub Developer Settings](https://github.com/settings/developers)\n2. Create a new OAuth App for **Web**\n3. Set Homepage URL: `https://your-production-domain.com`\n4. Set Authorization callback URL: `https://your-production-domain.com`\n\n**Web Environment Variables:**\n```\nEXPO_PUBLIC_GITHUB_CLIENT_ID=your-web-github-client-id\nGITHUB_CLIENT_ID=your-web-github-client-id\nGITHUB_CLIENT_SECRET=your-web-github-client-secret\n```\n\n#### Mobile OAuth App (for iOS/Android)\n\n**GitHub Developer Settings:**\n1. Go to [GitHub Developer Settings](https://github.com/settings/developers)\n2. Create a **second** OAuth App for **Mobile**\n3. Set Homepage URL: `https://your-production-domain.com`\n4. Set Authorization callback URL: `medinvest://` (deep link scheme)\n\n**Mobile Environment Variables:**\n```\nEXPO_PUBLIC_GITHUB_MOBILE_CLIENT_ID=your-mobile-github-client-id\nGITHUB_MOBILE_CLIENT_ID=your-mobile-github-client-id\nGITHUB_MOBILE_CLIENT_SECRET=your-mobile-github-client-secret\n```\n\n> **Why separate apps?** GitHub OAuth only allows one callback URL per app. Web uses `https://domain.com` while mobile uses the `medinvest://` deep link scheme. Using the same credentials causes authentication failures.\n\n### 3. Apple Sign-In\n\n**Apple Developer Portal Setup:**\n1. Go to [Apple Developer Portal](https://developer.apple.com/account)\n2. Navigate to Certificates, Identifiers & Profiles\n3. Create an App ID with \"Sign In with Apple\" capability\n4. Bundle ID must match: `com.medinvest.app`\n\n**Server-Side Configuration (for web and token verification):**\n1. Create a Services ID in Apple Developer Portal\n2. Generate a private key for Sign In with Apple\n3. Download the .p8 key file\n\n**Backend Environment Variables:**\n```\nAPPLE_TEAM_ID=your-team-id\nAPPLE_SERVICE_ID=your-service-id (for web sign-in)\nAPPLE_KEY_ID=your-key-id\nAPPLE_PRIVATE_KEY=contents-of-p8-file (base64 encoded)\n```\n\n> **Note:** The private key is used for server-side token generation and validation. Store the .p8 file contents as a secret.\n\n### 4. Facebook Sign-In\n\n**Meta for Developers:**\n1. Go to [Meta for Developers](https://developers.facebook.com)\n2. Create a new app or select existing\n3. Add Facebook Login product\n4. Configure iOS and Android platforms with bundle ID/package name\n\n**Frontend Environment Variables:**\n```\nEXPO_PUBLIC_FACEBOOK_APP_ID=your-facebook-app-id\n```\n\n**Backend Environment Variables:**\n```\nFACEBOOK_APP_ID=your-facebook-app-id\nFACEBOOK_APP_SECRET=your-facebook-app-secret\n```\n\n> **Note:** The app secret is required for server-side token verification. Never expose the app secret in client code.\n\n---\n\n## App Store Requirements\n\n### iOS (Apple App Store)\n\n**Required Assets:**\n- [ ] App Icon: 1024x1024 PNG (no transparency)\n- [ ] Screenshots: Various sizes for different devices\n  - iPhone 6.7\" (1290x2796)\n  - iPhone 6.5\" (1284x2778)\n  - iPhone 5.5\" (1242x2208)\n  - iPad Pro 12.9\" (2048x2732) - if supporting tablets\n\n**Required Information:**\n- [ ] App Name: MedInvest\n- [ ] Bundle ID: com.medinvest.app\n- [ ] Privacy Policy URL (required)\n- [ ] App Description (4000 characters max)\n- [ ] Keywords (100 characters max)\n- [ ] Primary Category: Finance\n- [ ] Secondary Category: Health & Fitness\n\n**Privacy Questionnaire:**\nApple requires disclosure of data collection practices. MedInvest collects:\n- Contact info (email, name)\n- User content (posts, messages)\n- Usage data (analytics)\n- Identifiers (user ID)\n\n### Android (Google Play Store)\n\n**Required Assets:**\n- [ ] App Icon: 512x512 PNG\n- [ ] Feature Graphic: 1024x500\n- [ ] Screenshots: At least 2 (max 8 per device type)\n  - Phone screenshots\n  - 7-inch tablet (optional)\n  - 10-inch tablet (optional)\n\n**Required Information:**\n- [ ] App Name: MedInvest\n- [ ] Package Name: com.medinvest.app\n- [ ] Short Description (80 characters max)\n- [ ] Full Description (4000 characters max)\n- [ ] Privacy Policy URL (required)\n- [ ] Category: Finance\n- [ ] Content Rating (complete questionnaire)\n\n---\n\n## Push Notifications Setup\n\nPush notifications require Expo Application Services (EAS) configuration.\n\n### Step 1: Initialize EAS Project\n```bash\nnpx eas project:init\n```\nThis creates a project on Expo's servers and adds your project ID to app.json.\n\n### Step 2: Verify Configuration\nAfter running the command above, your app.json will have:\n```json\n{\n  \"expo\": {\n    \"extra\": {\n      \"eas\": {\n        \"projectId\": \"your-project-id\"\n      }\n    }\n  }\n}\n```\n\n### Step 3: Configure Credentials (for Production)\n\n**iOS:**\n- Push notifications work automatically with EAS Build\n- For bare workflow: Configure APNs key in Apple Developer Portal\n\n**Android:**\n- Push notifications work automatically with EAS Build\n- For bare workflow: Configure FCM in Firebase Console\n\n### How Push Notifications Work\n1. User grants notification permission on device\n2. App receives Expo Push Token from Expo's servers\n3. Token is registered with MedInvest backend\n4. Backend sends notifications via Expo Push API (`https://exp.host/--/api/v2/push/send`)\n5. Expo routes notifications to Apple/Google\n\n### Testing Push Notifications\n- Push notifications only work on physical devices\n- They do NOT work in simulators, emulators, or web browsers\n- Use Expo Go app on a physical device to test\n\n---\n\n## Database & Backend\n\n### Production Database\n- Ensure production PostgreSQL database is set up\n- Run all migrations before launch\n- Set up database backups\n\n### Environment Variables (Production)\n```\nDATABASE_URL=your-production-database-url\nSESSION_SECRET=your-secure-session-secret\nNODE_ENV=production\n```\n\n---\n\n## Security Checklist\n\n- [ ] All OAuth secrets are stored securely (not in code)\n- [ ] HTTPS enforced on all endpoints\n- [ ] Rate limiting configured\n- [ ] Input validation on all endpoints\n- [ ] Session tokens are secure\n- [ ] Sensitive data is encrypted at rest\n- [ ] No debug/development code in production\n\n---\n\n## Testing Before Launch\n\n1. **Test all authentication flows** on real devices\n2. **Test deep links** work correctly\n3. **Test push notifications** (if applicable)\n4. **Test in-app purchases** (if applicable)\n5. **Performance testing** on various devices\n6. **Accessibility testing**\n\n---\n\n## Publishing from Replit\n\n### iOS\n1. In Replit, select \"Publish to App Store\"\n2. Connect your Apple Developer account\n3. Replit builds the app in the cloud\n4. Submit to TestFlight for testing\n5. Submit to App Store for review\n\n### Android\n1. Build APK/AAB using Expo EAS\n2. Upload to Google Play Console\n3. Complete store listing\n4. Submit for review\n\n---\n\n## Post-Launch\n\n- Monitor crash reports (App Store Connect / Play Console)\n- Respond to user reviews\n- Track analytics and user engagement\n- Plan update cycles\n\n---\n\n## Support\n\nFor technical questions about the MedInvest app:\n- Email: support@medinvest.com\n- Privacy: privacy@medinvest.com\n- Legal: legal@medinvest.com\n","path":null,"size_bytes":8704,"size_tokens":null},"client/components/VideoPlayer.tsx":{"content":"/**\n * Video Player Component\n * Full-featured video player with controls\n */\n\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  TouchableWithoutFeedback,\n  Dimensions,\n  ActivityIndicator,\n  Animated,\n  StatusBar,\n  Modal,\n} from 'react-native';\nimport { Video, ResizeMode, AVPlaybackStatus } from 'expo-av';\nimport { Ionicons } from '@expo/vector-icons';\nimport Slider from '@react-native-community/slider';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius } from '@/constants/theme';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\ninterface VideoPlayerProps {\n  uri: string;\n  posterUri?: string;\n  autoPlay?: boolean;\n  showControls?: boolean;\n  onClose?: () => void;\n  isFullscreen?: boolean;\n  style?: object;\n}\n\nexport default function VideoPlayer({\n  uri,\n  posterUri,\n  autoPlay = false,\n  showControls = true,\n  onClose,\n  isFullscreen = false,\n  style,\n}: VideoPlayerProps) {\n  const videoRef = useRef<Video>(null);\n  const controlsTimeout = useRef<NodeJS.Timeout | null>(null);\n  const controlsOpacity = useRef(new Animated.Value(1)).current;\n\n  const [status, setStatus] = useState<AVPlaybackStatus | null>(null);\n  const [isPlaying, setIsPlaying] = useState(autoPlay);\n  const [isLoading, setIsLoading] = useState(true);\n  const [showControlsOverlay, setShowControlsOverlay] = useState(true);\n  const [isFullscreenMode, setIsFullscreenMode] = useState(isFullscreen);\n  const [isMuted, setIsMuted] = useState(false);\n\n  const isBuffering = status?.isLoaded && status.isBuffering;\n  const duration = status?.isLoaded ? status.durationMillis || 0 : 0;\n  const position = status?.isLoaded ? status.positionMillis || 0 : 0;\n  const progress = duration > 0 ? position / duration : 0;\n\n  // Format time (mm:ss)\n  const formatTime = (millis: number): string => {\n    const totalSeconds = Math.floor(millis / 1000);\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = totalSeconds % 60;\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  // Hide controls after delay\n  const hideControlsAfterDelay = useCallback(() => {\n    if (controlsTimeout.current) {\n      clearTimeout(controlsTimeout.current);\n    }\n    controlsTimeout.current = setTimeout(() => {\n      if (isPlaying) {\n        Animated.timing(controlsOpacity, {\n          toValue: 0,\n          duration: 300,\n          useNativeDriver: true,\n        }).start(() => setShowControlsOverlay(false));\n      }\n    }, 3000);\n  }, [isPlaying, controlsOpacity]);\n\n  // Show controls\n  const showControlsWithTimeout = useCallback(() => {\n    setShowControlsOverlay(true);\n    Animated.timing(controlsOpacity, {\n      toValue: 1,\n      duration: 200,\n      useNativeDriver: true,\n    }).start();\n    hideControlsAfterDelay();\n  }, [controlsOpacity, hideControlsAfterDelay]);\n\n  // Toggle play/pause\n  const togglePlayPause = useCallback(async () => {\n    if (!videoRef.current) return;\n\n    if (isPlaying) {\n      await videoRef.current.pauseAsync();\n    } else {\n      await videoRef.current.playAsync();\n    }\n    setIsPlaying(!isPlaying);\n    showControlsWithTimeout();\n  }, [isPlaying, showControlsWithTimeout]);\n\n  // Seek\n  const handleSeek = useCallback(async (value: number) => {\n    if (!videoRef.current || !status?.isLoaded) return;\n    await videoRef.current.setPositionAsync(value * duration);\n  }, [duration, status]);\n\n  // Toggle mute\n  const toggleMute = useCallback(async () => {\n    if (!videoRef.current) return;\n    await videoRef.current.setIsMutedAsync(!isMuted);\n    setIsMuted(!isMuted);\n  }, [isMuted]);\n\n  // Toggle fullscreen\n  const toggleFullscreen = useCallback(() => {\n    setIsFullscreenMode(!isFullscreenMode);\n  }, [isFullscreenMode]);\n\n  // Skip forward/backward\n  const skip = useCallback(async (seconds: number) => {\n    if (!videoRef.current || !status?.isLoaded) return;\n    const newPosition = Math.max(0, Math.min(position + seconds * 1000, duration));\n    await videoRef.current.setPositionAsync(newPosition);\n  }, [position, duration, status]);\n\n  // Handle playback status update\n  const handlePlaybackStatusUpdate = useCallback((newStatus: AVPlaybackStatus) => {\n    setStatus(newStatus);\n    if (newStatus.isLoaded) {\n      setIsLoading(false);\n      setIsPlaying(newStatus.isPlaying);\n      \n      // Video ended\n      if (newStatus.didJustFinish) {\n        setIsPlaying(false);\n        setShowControlsOverlay(true);\n        Animated.timing(controlsOpacity, {\n          toValue: 1,\n          duration: 200,\n          useNativeDriver: true,\n        }).start();\n      }\n    }\n  }, [controlsOpacity]);\n\n  // Cleanup\n  useEffect(() => {\n    return () => {\n      if (controlsTimeout.current) {\n        clearTimeout(controlsTimeout.current);\n      }\n    };\n  }, []);\n\n  const renderControls = () => (\n    <Animated.View style={[styles.controlsOverlay, { opacity: controlsOpacity }]}>\n      {/* Top bar */}\n      <View style={styles.topBar}>\n        {onClose && (\n          <TouchableOpacity style={styles.closeButton} onPress={onClose}>\n            <Ionicons name=\"close\" size={28} color=\"white\" />\n          </TouchableOpacity>\n        )}\n        <View style={styles.topBarSpacer} />\n        <TouchableOpacity style={styles.controlButton} onPress={toggleMute}>\n          <Ionicons \n            name={isMuted ? 'volume-mute' : 'volume-high'} \n            size={24} \n            color=\"white\" \n          />\n        </TouchableOpacity>\n      </View>\n\n      {/* Center controls */}\n      <View style={styles.centerControls}>\n        <TouchableOpacity \n          style={styles.skipButton} \n          onPress={() => skip(-10)}\n        >\n          <Ionicons name=\"play-back\" size={32} color=\"white\" />\n          <ThemedText style={styles.skipText}>10</ThemedText>\n        </TouchableOpacity>\n\n        <TouchableOpacity \n          style={styles.playPauseButton} \n          onPress={togglePlayPause}\n        >\n          {isLoading || isBuffering ? (\n            <ActivityIndicator size=\"large\" color=\"white\" />\n          ) : (\n            <Ionicons \n              name={isPlaying ? 'pause' : 'play'} \n              size={48} \n              color=\"white\" \n            />\n          )}\n        </TouchableOpacity>\n\n        <TouchableOpacity \n          style={styles.skipButton} \n          onPress={() => skip(10)}\n        >\n          <Ionicons name=\"play-forward\" size={32} color=\"white\" />\n          <ThemedText style={styles.skipText}>10</ThemedText>\n        </TouchableOpacity>\n      </View>\n\n      {/* Bottom bar */}\n      <View style={styles.bottomBar}>\n        <ThemedText style={styles.timeText}>{formatTime(position)}</ThemedText>\n        <Slider\n          style={styles.slider}\n          minimumValue={0}\n          maximumValue={1}\n          value={progress}\n          onSlidingComplete={handleSeek}\n          minimumTrackTintColor={Colors.primary}\n          maximumTrackTintColor=\"rgba(255,255,255,0.3)\"\n          thumbTintColor={Colors.primary}\n        />\n        <ThemedText style={styles.timeText}>{formatTime(duration)}</ThemedText>\n        {!isFullscreen && (\n          <TouchableOpacity style={styles.fullscreenButton} onPress={toggleFullscreen}>\n            <Ionicons \n              name={isFullscreenMode ? 'contract' : 'expand'} \n              size={24} \n              color=\"white\" \n            />\n          </TouchableOpacity>\n        )}\n      </View>\n    </Animated.View>\n  );\n\n  const videoContent = (\n    <TouchableWithoutFeedback onPress={showControlsWithTimeout}>\n      <View style={[\n        styles.container, \n        isFullscreenMode && styles.fullscreenContainer,\n        style\n      ]}>\n        <Video\n          ref={videoRef}\n          source={{ uri }}\n          posterSource={posterUri ? { uri: posterUri } : undefined}\n          usePoster={!!posterUri}\n          posterStyle={styles.poster}\n          style={styles.video}\n          resizeMode={ResizeMode.CONTAIN}\n          shouldPlay={autoPlay}\n          isLooping={false}\n          onPlaybackStatusUpdate={handlePlaybackStatusUpdate}\n        />\n\n        {showControls && showControlsOverlay && renderControls()}\n\n        {/* Loading overlay */}\n        {isLoading && (\n          <View style={styles.loadingOverlay}>\n            <ActivityIndicator size=\"large\" color={Colors.primary} />\n          </View>\n        )}\n      </View>\n    </TouchableWithoutFeedback>\n  );\n\n  // Fullscreen mode\n  if (isFullscreenMode && !isFullscreen) {\n    return (\n      <Modal\n        visible={isFullscreenMode}\n        animationType=\"fade\"\n        supportedOrientations={['portrait', 'landscape']}\n        onRequestClose={toggleFullscreen}\n      >\n        <StatusBar hidden />\n        <View style={styles.fullscreenModal}>\n          {videoContent}\n        </View>\n      </Modal>\n    );\n  }\n\n  return videoContent;\n}\n\n// Inline/Feed video player (smaller, no fullscreen)\nexport function InlineVideoPlayer({ \n  uri, \n  posterUri,\n  style \n}: { \n  uri: string; \n  posterUri?: string;\n  style?: object;\n}) {\n  const videoRef = useRef<Video>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isMuted, setIsMuted] = useState(true);\n\n  const togglePlay = async () => {\n    if (!videoRef.current) return;\n    if (isPlaying) {\n      await videoRef.current.pauseAsync();\n    } else {\n      await videoRef.current.playAsync();\n    }\n    setIsPlaying(!isPlaying);\n  };\n\n  return (\n    <TouchableWithoutFeedback onPress={togglePlay}>\n      <View style={[styles.inlineContainer, style]}>\n        <Video\n          ref={videoRef}\n          source={{ uri }}\n          posterSource={posterUri ? { uri: posterUri } : undefined}\n          usePoster={!!posterUri}\n          style={styles.inlineVideo}\n          resizeMode={ResizeMode.COVER}\n          shouldPlay={false}\n          isLooping\n          isMuted={isMuted}\n        />\n        \n        {!isPlaying && (\n          <View style={styles.inlinePlayOverlay}>\n            <View style={styles.inlinePlayButton}>\n              <Ionicons name=\"play\" size={32} color=\"white\" />\n            </View>\n          </View>\n        )}\n\n        <TouchableOpacity \n          style={styles.inlineMuteButton}\n          onPress={() => setIsMuted(!isMuted)}\n        >\n          <Ionicons \n            name={isMuted ? 'volume-mute' : 'volume-high'} \n            size={16} \n            color=\"white\" \n          />\n        </TouchableOpacity>\n      </View>\n    </TouchableWithoutFeedback>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: 'black',\n    aspectRatio: 16 / 9,\n    width: '100%',\n  },\n  fullscreenContainer: {\n    flex: 1,\n    aspectRatio: undefined,\n  },\n  fullscreenModal: {\n    flex: 1,\n    backgroundColor: 'black',\n  },\n  video: {\n    flex: 1,\n  },\n  poster: {\n    resizeMode: 'cover',\n  },\n  controlsOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0,0,0,0.4)',\n    justifyContent: 'space-between',\n  },\n  topBar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingTop: Spacing.xl,\n    paddingHorizontal: Spacing.md,\n  },\n  closeButton: {\n    padding: Spacing.sm,\n  },\n  topBarSpacer: {\n    flex: 1,\n  },\n  controlButton: {\n    padding: Spacing.sm,\n  },\n  centerControls: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: Spacing['3xl'],\n  },\n  playPauseButton: {\n    width: 72,\n    height: 72,\n    borderRadius: 36,\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  skipButton: {\n    alignItems: 'center',\n    padding: Spacing.sm,\n  },\n  skipText: {\n    color: 'white',\n    fontSize: 12,\n    marginTop: 2,\n  },\n  bottomBar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingBottom: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  timeText: {\n    color: 'white',\n    fontSize: 12,\n    minWidth: 40,\n  },\n  slider: {\n    flex: 1,\n    height: 40,\n  },\n  fullscreenButton: {\n    padding: Spacing.sm,\n  },\n  loadingOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0,0,0,0.3)',\n  },\n  // Inline player styles\n  inlineContainer: {\n    width: '100%',\n    aspectRatio: 16 / 9,\n    backgroundColor: 'black',\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n  },\n  inlineVideo: {\n    flex: 1,\n  },\n  inlinePlayOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0,0,0,0.3)',\n  },\n  inlinePlayButton: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  inlineMuteButton: {\n    position: 'absolute',\n    bottom: Spacing.sm,\n    right: Spacing.sm,\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n","path":null,"size_bytes":12977,"size_tokens":null},"client/screens/NotificationSettingsScreen.tsx":{"content":"/**\n * Push Notification Settings Screen\n * Granular notification preferences\n */\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Switch,\n  Alert,\n  Linking,\n  Platform,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as Notifications from 'expo-notifications';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\n// Notification categories\ninterface NotificationSettings {\n  // Master toggle\n  enabled: boolean;\n  \n  // Social\n  likes: boolean;\n  comments: boolean;\n  mentions: boolean;\n  follows: boolean;\n  \n  // Messages\n  directMessages: boolean;\n  messageRequests: boolean;\n  \n  // Content\n  newPosts: boolean;\n  trendingPosts: boolean;\n  roomActivity: boolean;\n  \n  // Deals & Investments\n  newDeals: boolean;\n  dealUpdates: boolean;\n  investmentAlerts: boolean;\n  \n  // System\n  announcements: boolean;\n  securityAlerts: boolean;\n  weeklyDigest: boolean;\n  \n  // Quiet hours\n  quietHoursEnabled: boolean;\n  quietHoursStart: string; // \"22:00\"\n  quietHoursEnd: string; // \"08:00\"\n}\n\nconst DEFAULT_SETTINGS: NotificationSettings = {\n  enabled: true,\n  likes: true,\n  comments: true,\n  mentions: true,\n  follows: true,\n  directMessages: true,\n  messageRequests: true,\n  newPosts: false,\n  trendingPosts: true,\n  roomActivity: true,\n  newDeals: true,\n  dealUpdates: true,\n  investmentAlerts: true,\n  announcements: true,\n  securityAlerts: true,\n  weeklyDigest: true,\n  quietHoursEnabled: false,\n  quietHoursStart: '22:00',\n  quietHoursEnd: '08:00',\n};\n\nconst STORAGE_KEY = 'notification_settings';\n\nexport default function NotificationSettingsScreen() {\n  const navigation = useNavigation<any>();\n  const { colors } = useThemeContext();\n  const [settings, setSettings] = useState<NotificationSettings>(DEFAULT_SETTINGS);\n  const [isLoading, setIsLoading] = useState(true);\n  const [permissionStatus, setPermissionStatus] = useState<string>('unknown');\n\n  // Load settings\n  useEffect(() => {\n    loadSettings();\n    checkPermissions();\n  }, []);\n\n  const loadSettings = async () => {\n    try {\n      const stored = await AsyncStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        setSettings({ ...DEFAULT_SETTINGS, ...JSON.parse(stored) });\n      }\n    } catch (error) {\n      console.error('Error loading notification settings:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const saveSettings = async (newSettings: NotificationSettings) => {\n    try {\n      await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(newSettings));\n      // TODO: Sync with backend\n    } catch (error) {\n      console.error('Error saving notification settings:', error);\n    }\n  };\n\n  const checkPermissions = async () => {\n    const { status } = await Notifications.getPermissionsAsync();\n    setPermissionStatus(status);\n  };\n\n  const requestPermissions = async () => {\n    const { status } = await Notifications.requestPermissionsAsync();\n    setPermissionStatus(status);\n    \n    if (status !== 'granted') {\n      Alert.alert(\n        'Notifications Disabled',\n        'To receive notifications, please enable them in your device settings.',\n        [\n          { text: 'Cancel', style: 'cancel' },\n          { text: 'Open Settings', onPress: () => Linking.openSettings() },\n        ]\n      );\n    }\n  };\n\n  const updateSetting = useCallback((key: keyof NotificationSettings, value: boolean | string) => {\n    haptics.toggle();\n    const newSettings = { ...settings, [key]: value };\n    setSettings(newSettings);\n    saveSettings(newSettings);\n  }, [settings]);\n\n  const toggleMasterSwitch = useCallback((value: boolean) => {\n    haptics.toggle();\n    if (value && permissionStatus !== 'granted') {\n      requestPermissions();\n      return;\n    }\n    updateSetting('enabled', value);\n  }, [permissionStatus, updateSetting]);\n\n  const renderSwitch = (\n    key: keyof NotificationSettings,\n    label: string,\n    description?: string,\n    disabled?: boolean\n  ) => (\n    <View style={[styles.settingRow, { borderBottomColor: colors.border }]}>\n      <View style={styles.settingInfo}>\n        <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n          {label}\n        </ThemedText>\n        {description && (\n          <ThemedText style={[styles.settingDescription, { color: colors.textSecondary }]}>\n            {description}\n          </ThemedText>\n        )}\n      </View>\n      <Switch\n        value={settings[key] as boolean}\n        onValueChange={(value) => updateSetting(key, value)}\n        trackColor={{ false: colors.border, true: colors.primary + '80' }}\n        thumbColor={settings[key] ? colors.primary : colors.textSecondary}\n        disabled={disabled || !settings.enabled}\n      />\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={colors.primary} />\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Notifications\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Permission Status Banner */}\n        {permissionStatus !== 'granted' && (\n          <TouchableOpacity\n            style={[styles.permissionBanner, { backgroundColor: colors.warning + '20' }]}\n            onPress={requestPermissions}\n          >\n            <Ionicons name=\"warning-outline\" size={20} color={colors.warning} />\n            <ThemedText style={[styles.permissionText, { color: colors.warning }]}>\n              Notifications are disabled. Tap to enable.\n            </ThemedText>\n            <Ionicons name=\"chevron-forward\" size={16} color={colors.warning} />\n          </TouchableOpacity>\n        )}\n\n        {/* Master Toggle */}\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          <View style={[styles.masterToggle, { borderBottomColor: colors.border }]}>\n            <View style={styles.settingInfo}>\n              <ThemedText style={[styles.masterLabel, { color: colors.textPrimary }]}>\n                Push Notifications\n              </ThemedText>\n              <ThemedText style={[styles.settingDescription, { color: colors.textSecondary }]}>\n                Receive notifications on this device\n              </ThemedText>\n            </View>\n            <Switch\n              value={settings.enabled}\n              onValueChange={toggleMasterSwitch}\n              trackColor={{ false: colors.border, true: colors.primary + '80' }}\n              thumbColor={settings.enabled ? colors.primary : colors.textSecondary}\n            />\n          </View>\n        </View>\n\n        {/* Social Notifications */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            SOCIAL\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('likes', 'Likes', 'When someone likes your post or comment')}\n          {renderSwitch('comments', 'Comments', 'When someone comments on your post')}\n          {renderSwitch('mentions', 'Mentions', 'When someone mentions you')}\n          {renderSwitch('follows', 'New Followers', 'When someone follows you')}\n        </View>\n\n        {/* Messages */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            MESSAGES\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('directMessages', 'Direct Messages', 'New messages from connections')}\n          {renderSwitch('messageRequests', 'Message Requests', 'New messages from others')}\n        </View>\n\n        {/* Content */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            CONTENT\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('newPosts', 'New Posts', 'Posts from people you follow')}\n          {renderSwitch('trendingPosts', 'Trending', 'Popular posts in your rooms')}\n          {renderSwitch('roomActivity', 'Room Activity', 'Updates from your joined rooms')}\n        </View>\n\n        {/* Deals & Investments */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            DEALS & INVESTMENTS\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('newDeals', 'New Deals', 'New investment opportunities')}\n          {renderSwitch('dealUpdates', 'Deal Updates', 'Updates on deals you\\'re watching')}\n          {renderSwitch('investmentAlerts', 'Investment Alerts', 'Important alerts about your investments')}\n        </View>\n\n        {/* System */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            SYSTEM\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('announcements', 'Announcements', 'Product updates and news')}\n          {renderSwitch('securityAlerts', 'Security Alerts', 'Important account security notifications')}\n          {renderSwitch('weeklyDigest', 'Weekly Digest', 'Summary of activity you missed')}\n        </View>\n\n        {/* Quiet Hours */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            QUIET HOURS\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('quietHoursEnabled', 'Enable Quiet Hours', 'Pause notifications during set times')}\n          \n          {settings.quietHoursEnabled && (\n            <View style={styles.quietHoursConfig}>\n              <TouchableOpacity \n                style={[styles.timeSelector, { backgroundColor: colors.backgroundSecondary }]}\n                disabled={!settings.enabled}\n              >\n                <ThemedText style={[styles.timeLabel, { color: colors.textSecondary }]}>\n                  From\n                </ThemedText>\n                <ThemedText style={[styles.timeValue, { color: colors.textPrimary }]}>\n                  {settings.quietHoursStart}\n                </ThemedText>\n              </TouchableOpacity>\n              \n              <Ionicons name=\"arrow-forward\" size={16} color={colors.textSecondary} />\n              \n              <TouchableOpacity \n                style={[styles.timeSelector, { backgroundColor: colors.backgroundSecondary }]}\n                disabled={!settings.enabled}\n              >\n                <ThemedText style={[styles.timeLabel, { color: colors.textSecondary }]}>\n                  To\n                </ThemedText>\n                <ThemedText style={[styles.timeValue, { color: colors.textPrimary }]}>\n                  {settings.quietHoursEnd}\n                </ThemedText>\n              </TouchableOpacity>\n            </View>\n          )}\n        </View>\n\n        {/* Info */}\n        <View style={styles.infoSection}>\n          <Ionicons name=\"information-circle-outline\" size={16} color={colors.textSecondary} />\n          <ThemedText style={[styles.infoText, { color: colors.textSecondary }]}>\n            Security alerts will always be delivered regardless of your notification settings.\n          </ThemedText>\n        </View>\n\n        <View style={{ height: 40 }} />\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  content: {\n    flex: 1,\n  },\n  permissionBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    margin: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  permissionText: {\n    ...Typography.caption,\n    flex: 1,\n    fontWeight: '500',\n  },\n  sectionHeader: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.xl,\n    paddingBottom: Spacing.sm,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    letterSpacing: 0.5,\n  },\n  section: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  masterToggle: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n  },\n  masterLabel: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  settingRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  settingInfo: {\n    flex: 1,\n    marginRight: Spacing.md,\n  },\n  settingLabel: {\n    ...Typography.body,\n  },\n  settingDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  quietHoursConfig: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  timeSelector: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    minWidth: 100,\n  },\n  timeLabel: {\n    ...Typography.small,\n    marginBottom: 2,\n  },\n  timeValue: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  infoSection: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    padding: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  infoText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 18,\n  },\n});\n","path":null,"size_bytes":15155,"size_tokens":null},"client/screens/BiometricSettingsScreen.tsx":{"content":"/**\n * Biometric Settings Screen\n * Enable/disable Face ID / Touch ID login\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Switch,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { biometricAuth, BiometricStatus } from '@/lib/biometric-auth';\n\nexport default function BiometricSettingsScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  \n  const [biometricStatus, setBiometricStatus] = useState<BiometricStatus | null>(null);\n  const [isEnabled, setIsEnabled] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isToggling, setIsToggling] = useState(false);\n\n  useEffect(() => {\n    loadBiometricStatus();\n  }, []);\n\n  const loadBiometricStatus = async () => {\n    setIsLoading(true);\n    try {\n      const status = await biometricAuth.checkBiometricAvailability();\n      setBiometricStatus(status);\n      \n      const enabled = await biometricAuth.isBiometricLoginEnabled();\n      setIsEnabled(enabled);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleToggle = useCallback(async (value: boolean) => {\n    if (!biometricStatus?.isAvailable || !biometricStatus?.isEnrolled) {\n      Alert.alert(\n        'Biometric Not Available',\n        'Please set up Face ID or Touch ID in your device settings first.'\n      );\n      return;\n    }\n\n    setIsToggling(true);\n    try {\n      if (value) {\n        Alert.prompt(\n          'Enter Password',\n          'Enter your password to enable biometric login',\n          [\n            { text: 'Cancel', style: 'cancel' },\n            {\n              text: 'Enable',\n              onPress: async (password) => {\n                if (!password) {\n                  setIsToggling(false);\n                  return;\n                }\n                \n                const email = 'user@example.com';\n                \n                const success = await biometricAuth.enableBiometricLogin(email, password);\n                if (success) {\n                  setIsEnabled(true);\n                  Alert.alert('Success', `${biometricAuth.getBiometricName(biometricStatus.biometricType)} login enabled!`);\n                } else {\n                  Alert.alert('Failed', 'Could not enable biometric login. Please try again.');\n                }\n                setIsToggling(false);\n              },\n            },\n          ],\n          'secure-text'\n        );\n      } else {\n        const success = await biometricAuth.disableBiometricLogin();\n        if (success) {\n          setIsEnabled(false);\n        }\n        setIsToggling(false);\n      }\n    } catch (error) {\n      console.error('Error toggling biometric:', error);\n      setIsToggling(false);\n    }\n  }, [biometricStatus]);\n\n  const biometricName = biometricStatus \n    ? biometricAuth.getBiometricName(biometricStatus.biometricType)\n    : 'Biometric';\n\n  const biometricIcon = biometricStatus?.biometricType === 'facial' \n    ? 'scan-outline' \n    : 'finger-print-outline';\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Biometric Login</ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      <View style={styles.content}>\n        <View style={styles.iconContainer}>\n          <Ionicons name={biometricIcon} size={64} color={Colors.primary} />\n        </View>\n\n        <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>{biometricName}</ThemedText>\n        <ThemedText style={[styles.description, { color: appColors.textSecondary }]}>\n          Sign in quickly and securely using {biometricName} instead of entering your password.\n        </ThemedText>\n\n        {!biometricStatus?.isAvailable && (\n          <View style={styles.warningCard}>\n            <Ionicons name=\"warning-outline\" size={24} color={appColors.warning} />\n            <ThemedText style={[styles.warningText, { color: appColors.textPrimary }]}>\n              {biometricName} is not available on this device.\n            </ThemedText>\n          </View>\n        )}\n\n        {biometricStatus?.isAvailable && !biometricStatus?.isEnrolled && (\n          <View style={styles.warningCard}>\n            <Ionicons name=\"information-circle-outline\" size={24} color={Colors.primary} />\n            <ThemedText style={[styles.warningText, { color: appColors.textPrimary }]}>\n              {biometricName} is not set up. Please enable it in your device settings.\n            </ThemedText>\n          </View>\n        )}\n\n        {biometricStatus?.isAvailable && biometricStatus?.isEnrolled && (\n          <View style={[styles.toggleCard, { backgroundColor: appColors.surface }]}>\n            <View style={styles.toggleInfo}>\n              <Ionicons name={biometricIcon} size={24} color={Colors.primary} />\n              <View style={styles.toggleTextContainer}>\n                <ThemedText style={[styles.toggleTitle, { color: appColors.textPrimary }]}>Use {biometricName}</ThemedText>\n                <ThemedText style={[styles.toggleDescription, { color: appColors.textSecondary }]}>\n                  Sign in with {biometricName} instead of password\n                </ThemedText>\n              </View>\n            </View>\n            {isToggling ? (\n              <ActivityIndicator color={Colors.primary} />\n            ) : (\n              <Switch\n                value={isEnabled}\n                onValueChange={handleToggle}\n                trackColor={{ false: appColors.border, true: Colors.primary + '60' }}\n                thumbColor={isEnabled ? Colors.primary : appColors.textSecondary}\n              />\n            )}\n          </View>\n        )}\n\n        <View style={styles.infoSection}>\n          <ThemedText style={[styles.infoTitle, { color: appColors.textSecondary }]}>How it works</ThemedText>\n          <View style={styles.infoItem}>\n            <View style={styles.infoNumber}>\n              <ThemedText style={styles.infoNumberText}>1</ThemedText>\n            </View>\n            <ThemedText style={[styles.infoText, { color: appColors.textSecondary }]}>\n              Your login credentials are securely stored on your device\n            </ThemedText>\n          </View>\n          <View style={styles.infoItem}>\n            <View style={styles.infoNumber}>\n              <ThemedText style={styles.infoNumberText}>2</ThemedText>\n            </View>\n            <ThemedText style={[styles.infoText, { color: appColors.textSecondary }]}>\n              When signing in, use {biometricName} to verify your identity\n            </ThemedText>\n          </View>\n          <View style={styles.infoItem}>\n            <View style={styles.infoNumber}>\n              <ThemedText style={styles.infoNumberText}>3</ThemedText>\n            </View>\n            <ThemedText style={[styles.infoText, { color: appColors.textSecondary }]}>\n              Your stored credentials are used to sign you in automatically\n            </ThemedText>\n          </View>\n        </View>\n\n        <View style={styles.securityNote}>\n          <Ionicons name=\"shield-checkmark-outline\" size={20} color={Colors.secondary} />\n          <ThemedText style={[styles.securityText, { color: appColors.textSecondary }]}>\n            Your credentials are stored securely using device encryption and are never sent to our servers.\n          </ThemedText>\n        </View>\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  content: {\n    flex: 1,\n    padding: Spacing.xl,\n  },\n  iconContainer: {\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  title: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.sm,\n  },\n  description: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n    lineHeight: 24,\n  },\n  warningCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.light.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.xl,\n    gap: Spacing.md,\n  },\n  warningText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  toggleCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.xl,\n    ...Shadows.card,\n  },\n  toggleInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n    gap: Spacing.md,\n  },\n  toggleTextContainer: {\n    flex: 1,\n  },\n  toggleTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  toggleDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  infoSection: {\n    marginBottom: Spacing.xl,\n  },\n  infoTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n    marginBottom: Spacing.lg,\n  },\n  infoItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.md,\n    gap: Spacing.md,\n  },\n  infoNumber: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  infoNumberText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n  },\n  infoText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  securityNote: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    backgroundColor: Colors.secondary + '10',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.md,\n  },\n  securityText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":11054,"size_tokens":null},"client/lib/watch/index.ts":{"content":"import { Platform } from 'react-native';\n\nexport interface WatchMessage {\n  type: string;\n  payload?: Record<string, unknown>;\n  timestamp: number;\n}\n\nexport interface WatchConnectivityConfig {\n  debug?: boolean;\n}\n\ntype MessageHandler = (message: WatchMessage) => void;\n\nclass WatchConnectivity {\n  private debug: boolean;\n  private isReachable: boolean = false;\n  private isPaired: boolean = false;\n  private isWatchAppInstalled: boolean = false;\n  private messageHandlers: Set<MessageHandler> = new Set();\n\n  constructor(config: WatchConnectivityConfig = {}) {\n    this.debug = config.debug ?? __DEV__;\n    \n    if (Platform.OS === 'ios') {\n      this.log('Watch connectivity initialized (iOS)');\n    } else {\n      this.log('Watch connectivity not available on this platform');\n    }\n  }\n\n  private log(message: string, data?: unknown): void {\n    if (this.debug) {\n      console.log(`[Watch] ${message}`, data ?? '');\n    }\n  }\n\n  async initialize(): Promise<void> {\n    if (Platform.OS !== 'ios') {\n      this.log('Watch connectivity requires iOS');\n      return;\n    }\n\n    this.log('Initializing watch connectivity');\n    this.isPaired = false;\n    this.isWatchAppInstalled = false;\n    this.isReachable = false;\n  }\n\n  async sendMessage(message: WatchMessage): Promise<void> {\n    if (!this.isReachable) {\n      this.log('Watch is not reachable');\n      return;\n    }\n\n    this.log('Sending message to watch', message);\n  }\n\n  async sendPortfolioUpdate(portfolioData: {\n    totalValue: number;\n    dayChange: number;\n    dayChangePercent: number;\n  }): Promise<void> {\n    await this.sendMessage({\n      type: 'portfolio_update',\n      payload: portfolioData,\n      timestamp: Date.now(),\n    });\n  }\n\n  async sendNotification(notification: {\n    title: string;\n    body: string;\n    category?: string;\n  }): Promise<void> {\n    await this.sendMessage({\n      type: 'notification',\n      payload: notification,\n      timestamp: Date.now(),\n    });\n  }\n\n  async sendInvestmentAlert(alert: {\n    investmentId: string;\n    investmentName: string;\n    alertType: 'price_change' | 'milestone' | 'deadline';\n    message: string;\n  }): Promise<void> {\n    await this.sendMessage({\n      type: 'investment_alert',\n      payload: alert,\n      timestamp: Date.now(),\n    });\n  }\n\n  onMessage(handler: MessageHandler): () => void {\n    this.messageHandlers.add(handler);\n    return () => {\n      this.messageHandlers.delete(handler);\n    };\n  }\n\n  private handleIncomingMessage(message: WatchMessage): void {\n    this.log('Received message from watch', message);\n    this.messageHandlers.forEach(handler => {\n      try {\n        handler(message);\n      } catch (error) {\n        this.log('Error in message handler', error);\n      }\n    });\n  }\n\n  getReachabilityStatus(): boolean {\n    return this.isReachable;\n  }\n\n  getPairedStatus(): boolean {\n    return this.isPaired;\n  }\n\n  getWatchAppInstalledStatus(): boolean {\n    return this.isWatchAppInstalled;\n  }\n\n  async transferUserInfo(userInfo: Record<string, unknown>): Promise<void> {\n    this.log('Transferring user info to watch', userInfo);\n  }\n\n  async updateApplicationContext(context: Record<string, unknown>): Promise<void> {\n    this.log('Updating application context', context);\n  }\n}\n\nexport const watchConnectivity = new WatchConnectivity();\n\nexport default watchConnectivity;\n","path":null,"size_bytes":3340,"size_tokens":null},"client/hooks/useColorScheme.web.ts":{"content":"import { useEffect, useState } from \"react\";\nimport { useColorScheme as useRNColorScheme } from \"react-native\";\n\n/**\n * To support static rendering, this value needs to be re-calculated on the client side for web\n */\nexport function useColorScheme() {\n  const [hasHydrated, setHasHydrated] = useState(false);\n\n  useEffect(() => {\n    setHasHydrated(true);\n  }, []);\n\n  const colorScheme = useRNColorScheme();\n\n  if (hasHydrated) {\n    return colorScheme;\n  }\n\n  return \"light\";\n}\n","path":null,"size_bytes":480,"size_tokens":null},"server/replit_integrations/image/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { openai } from \"./client\";\n\nexport function registerImageRoutes(app: Express): void {\n  app.post(\"/api/generate-image\", async (req: Request, res: Response) => {\n    try {\n      const { prompt, size = \"1024x1024\" } = req.body;\n\n      if (!prompt) {\n        return res.status(400).json({ error: \"Prompt is required\" });\n      }\n\n      const response = await openai.images.generate({\n        model: \"gpt-image-1\",\n        prompt,\n        n: 1,\n        size: size as \"1024x1024\" | \"512x512\" | \"256x256\",\n      });\n\n      const imageData = response.data?.[0];\n      res.json({\n        url: imageData?.url,\n        b64_json: imageData?.b64_json,\n      });\n    } catch (error) {\n      console.error(\"Error generating image:\", error);\n      res.status(500).json({ error: \"Failed to generate image\" });\n    }\n  });\n}\n\n","path":null,"size_bytes":876,"size_tokens":null},"client/components/FilterModal.tsx":{"content":"import React, { useState, useCallback, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Modal,\n  Pressable,\n  ScrollView,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  FadeIn,\n  FadeOut,\n  SlideInDown,\n  SlideOutDown,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { InvestmentFilters, InvestmentCategory, RiskLevel } from '@/types';\n\ninterface FilterModalProps {\n  visible: boolean;\n  onClose: () => void;\n  filters: InvestmentFilters;\n  onApply: (filters: InvestmentFilters) => void;\n}\n\nconst CATEGORIES: { value: InvestmentCategory | 'all'; label: string }[] = [\n  { value: 'all', label: 'All Categories' },\n  { value: 'Biotech', label: 'Biotech' },\n  { value: 'Medical Devices', label: 'Medical Devices' },\n  { value: 'Digital Health', label: 'Digital Health' },\n  { value: 'Pharmaceuticals', label: 'Pharmaceuticals' },\n  { value: 'Research', label: 'Research' },\n  { value: 'Healthcare Services', label: 'Healthcare Services' },\n];\n\nconst RISK_LEVELS: { value: RiskLevel | 'all'; label: string; color: string }[] = [\n  { value: 'all', label: 'All Risk Levels', color: colors.text.secondary },\n  { value: 'Low', label: 'Low Risk', color: colors.semantic.success },\n  { value: 'Medium', label: 'Medium Risk', color: colors.semantic.warning },\n  { value: 'High', label: 'High Risk', color: colors.semantic.error },\n];\n\nconst SORT_OPTIONS: { value: InvestmentFilters['sortBy']; label: string }[] = [\n  { value: 'newest', label: 'Newest First' },\n  { value: 'endingSoon', label: 'Ending Soon' },\n  { value: 'mostFunded', label: 'Most Funded' },\n  { value: 'highestROI', label: 'Highest ROI' },\n];\n\nconst MIN_INVESTMENT_OPTIONS = [\n  { value: undefined, label: 'Any Amount' },\n  { value: 1000, label: '$1,000+' },\n  { value: 5000, label: '$5,000+' },\n  { value: 10000, label: '$10,000+' },\n  { value: 25000, label: '$25,000+' },\n];\n\nexport default function FilterModal({\n  visible,\n  onClose,\n  filters,\n  onApply,\n}: FilterModalProps) {\n  const insets = useSafeAreaInsets();\n\n  // Local state for editing\n  const [localFilters, setLocalFilters] = useState<InvestmentFilters>(filters);\n\n  // Reset local state when modal opens\n  useEffect(() => {\n    if (visible) {\n      setLocalFilters(filters);\n    }\n  }, [visible, filters]);\n\n  const handleApply = useCallback(() => {\n    onApply(localFilters);\n    onClose();\n  }, [localFilters, onApply, onClose]);\n\n  const handleReset = useCallback(() => {\n    setLocalFilters({});\n  }, []);\n\n  const updateFilter = useCallback(\n    <K extends keyof InvestmentFilters>(key: K, value: InvestmentFilters[K]) => {\n      setLocalFilters((prev) => ({\n        ...prev,\n        [key]: value,\n      }));\n    },\n    []\n  );\n\n  const activeFilterCount = Object.values(localFilters).filter(\n    (v) => v !== undefined && v !== 'all'\n  ).length;\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"none\"\n      onRequestClose={onClose}\n    >\n      {/* Backdrop */}\n      <Animated.View\n        entering={FadeIn.duration(200)}\n        exiting={FadeOut.duration(200)}\n        style={styles.backdrop}\n      >\n        <Pressable style={StyleSheet.absoluteFill} onPress={onClose} />\n      </Animated.View>\n\n      {/* Content */}\n      <Animated.View\n        entering={SlideInDown.duration(300).springify()}\n        exiting={SlideOutDown.duration(200)}\n        style={[\n          styles.container,\n          { paddingBottom: insets.bottom + spacing.lg },\n        ]}\n      >\n        {/* Header */}\n        <View style={styles.header}>\n          <Pressable onPress={onClose} hitSlop={8}>\n            <Feather name=\"x\" size={24} color={colors.text.primary} />\n          </Pressable>\n          <Text style={styles.title}>Filters</Text>\n          <Pressable onPress={handleReset} hitSlop={8}>\n            <Text style={styles.resetText}>Reset</Text>\n          </Pressable>\n        </View>\n\n        {/* Handle */}\n        <View style={styles.handle} />\n\n        <ScrollView\n          style={styles.scrollView}\n          contentContainerStyle={styles.scrollContent}\n          showsVerticalScrollIndicator={false}\n        >\n          {/* Category Filter */}\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>Category</Text>\n            <View style={styles.optionsGrid}>\n              {CATEGORIES.map((category) => {\n                const isSelected =\n                  category.value === 'all'\n                    ? !localFilters.category\n                    : localFilters.category === category.value;\n                return (\n                  <Pressable\n                    key={category.value}\n                    style={[\n                      styles.optionChip,\n                      isSelected && styles.optionChipSelected,\n                    ]}\n                    onPress={() =>\n                      updateFilter(\n                        'category',\n                        category.value === 'all' ? undefined : category.value\n                      )\n                    }\n                  >\n                    <Text\n                      style={[\n                        styles.optionChipText,\n                        isSelected && styles.optionChipTextSelected,\n                      ]}\n                    >\n                      {category.label}\n                    </Text>\n                  </Pressable>\n                );\n              })}\n            </View>\n          </View>\n\n          {/* Risk Level Filter */}\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>Risk Level</Text>\n            <View style={styles.optionsRow}>\n              {RISK_LEVELS.map((risk) => {\n                const isSelected =\n                  risk.value === 'all'\n                    ? !localFilters.riskLevel\n                    : localFilters.riskLevel === risk.value;\n                return (\n                  <Pressable\n                    key={risk.value}\n                    style={[\n                      styles.riskChip,\n                      isSelected && styles.riskChipSelected,\n                      isSelected && { borderColor: risk.color },\n                    ]}\n                    onPress={() =>\n                      updateFilter(\n                        'riskLevel',\n                        risk.value === 'all' ? undefined : risk.value\n                      )\n                    }\n                  >\n                    {risk.value !== 'all' && (\n                      <View\n                        style={[styles.riskDot, { backgroundColor: risk.color }]}\n                      />\n                    )}\n                    <Text\n                      style={[\n                        styles.riskChipText,\n                        isSelected && styles.riskChipTextSelected,\n                      ]}\n                    >\n                      {risk.label}\n                    </Text>\n                  </Pressable>\n                );\n              })}\n            </View>\n          </View>\n\n          {/* Minimum Investment Filter */}\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>Minimum Investment</Text>\n            <View style={styles.optionsRow}>\n              {MIN_INVESTMENT_OPTIONS.map((option) => {\n                const isSelected = localFilters.minInvestment === option.value;\n                return (\n                  <Pressable\n                    key={option.label}\n                    style={[\n                      styles.optionChip,\n                      isSelected && styles.optionChipSelected,\n                    ]}\n                    onPress={() => updateFilter('minInvestment', option.value)}\n                  >\n                    <Text\n                      style={[\n                        styles.optionChipText,\n                        isSelected && styles.optionChipTextSelected,\n                      ]}\n                    >\n                      {option.label}\n                    </Text>\n                  </Pressable>\n                );\n              })}\n            </View>\n          </View>\n\n          {/* Sort By Filter */}\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>Sort By</Text>\n            {SORT_OPTIONS.map((option) => {\n              const isSelected = localFilters.sortBy === option.value;\n              return (\n                <Pressable\n                  key={option.value}\n                  style={styles.sortOption}\n                  onPress={() => updateFilter('sortBy', option.value)}\n                >\n                  <Text\n                    style={[\n                      styles.sortOptionText,\n                      isSelected && styles.sortOptionTextSelected,\n                    ]}\n                  >\n                    {option.label}\n                  </Text>\n                  {isSelected && (\n                    <Feather\n                      name=\"check\"\n                      size={20}\n                      color={colors.primary.main}\n                    />\n                  )}\n                </Pressable>\n              );\n            })}\n          </View>\n        </ScrollView>\n\n        {/* Apply Button */}\n        <View style={styles.footer}>\n          <Pressable style={styles.applyButton} onPress={handleApply}>\n            <Text style={styles.applyButtonText}>\n              Apply Filters\n              {activeFilterCount > 0 && ` (${activeFilterCount})`}\n            </Text>\n          </Pressable>\n        </View>\n      </Animated.View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  backdrop: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: colors.transparent.black50,\n  },\n  container: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    backgroundColor: colors.surface.primary,\n    borderTopLeftRadius: layout.radiusXLarge,\n    borderTopRightRadius: layout.radiusXLarge,\n    maxHeight: '85%',\n    ...shadows.modal,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.lg,\n    paddingBottom: spacing.md,\n  },\n  title: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  resetText: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n  handle: {\n    width: 36,\n    height: 4,\n    backgroundColor: colors.border.light,\n    borderRadius: 2,\n    alignSelf: 'center',\n    marginBottom: spacing.md,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.lg,\n  },\n  section: {\n    marginBottom: spacing.xl,\n  },\n  sectionTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.md,\n  },\n  optionsGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: spacing.sm,\n  },\n  optionsRow: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: spacing.sm,\n  },\n  optionChip: {\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.sm,\n    borderRadius: layout.radiusFull,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  optionChipSelected: {\n    borderColor: colors.primary.main,\n    backgroundColor: colors.transparent.primary10,\n  },\n  optionChipText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  optionChipTextSelected: {\n    color: colors.primary.main,\n  },\n  riskChip: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.sm,\n    borderRadius: layout.radiusFull,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  riskChipSelected: {\n    backgroundColor: colors.transparent.primary10,\n  },\n  riskDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  riskChipText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  riskChipTextSelected: {\n    color: colors.text.primary,\n  },\n  sortOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  sortOptionText: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n  sortOptionTextSelected: {\n    color: colors.text.primary,\n    fontWeight: '600',\n  },\n  footer: {\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  applyButton: {\n    backgroundColor: colors.primary.main,\n    paddingVertical: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    alignItems: 'center',\n  },\n  applyButtonText: {\n    ...typography.button.medium,\n    color: colors.text.inverse,\n  },\n});\n","path":null,"size_bytes":12942,"size_tokens":null},"client/components/ThreadedComments.tsx":{"content":"/**\n * Threaded Comments Component\n * Nested reply visualization for comments\n */\n\nimport React, { useState, useCallback, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  TextInput,\n  ActivityIndicator,\n  LayoutAnimation,\n  Platform,\n  UIManager,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { commentsApi } from '@/lib/api';\nimport { formatRelativeTime } from '@/lib/utils';\n\nif (Platform.OS === 'android' && UIManager.setLayoutAnimationEnabledExperimental) {\n  UIManager.setLayoutAnimationEnabledExperimental(true);\n}\n\nexport interface Comment {\n  id: number;\n  content: string;\n  author: {\n    id: number;\n    full_name: string;\n    avatar_url?: string;\n    specialty?: string;\n  };\n  created_at: string;\n  updated_at?: string;\n  likes_count: number;\n  is_liked: boolean;\n  replies?: Comment[];\n  replies_count: number;\n  parent_id?: number;\n  depth?: number;\n}\n\ninterface ThreadedCommentsProps {\n  comments: Comment[];\n  postId: number;\n  onUserPress: (userId: number) => void;\n  maxDepth?: number;\n}\n\nexport default function ThreadedComments({\n  comments,\n  postId,\n  onUserPress,\n  maxDepth = 3,\n}: ThreadedCommentsProps) {\n  return (\n    <View style={styles.container}>\n      {comments.map((comment) => (\n        <CommentThread\n          key={comment.id}\n          comment={comment}\n          postId={postId}\n          onUserPress={onUserPress}\n          depth={0}\n          maxDepth={maxDepth}\n        />\n      ))}\n    </View>\n  );\n}\n\ninterface CommentThreadProps {\n  comment: Comment;\n  postId: number;\n  onUserPress: (userId: number) => void;\n  depth: number;\n  maxDepth: number;\n}\n\nconst CommentThread = memo(function CommentThread({\n  comment,\n  postId,\n  onUserPress,\n  depth,\n  maxDepth,\n}: CommentThreadProps) {\n  const appColors = useAppColors();\n  const queryClient = useQueryClient();\n  const [isExpanded, setIsExpanded] = useState(depth < 2);\n  const [showReplyInput, setShowReplyInput] = useState(false);\n  const [replyText, setReplyText] = useState('');\n\n  const likeMutation = useMutation({\n    mutationFn: async () => {\n      if (comment.is_liked) {\n        await commentsApi.unlike(comment.id);\n      } else {\n        await commentsApi.like(comment.id);\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['comments', postId] });\n    },\n  });\n\n  const replyMutation = useMutation({\n    mutationFn: async () => {\n      if (!replyText.trim()) return;\n      const response = await commentsApi.reply(postId, comment.id, replyText.trim());\n      return response.data;\n    },\n    onSuccess: () => {\n      setReplyText('');\n      setShowReplyInput(false);\n      queryClient.invalidateQueries({ queryKey: ['comments', postId] });\n    },\n  });\n\n  const handleToggleExpand = useCallback(() => {\n    LayoutAnimation.configureNext(LayoutAnimation.Presets.easeInEaseOut);\n    setIsExpanded(!isExpanded);\n  }, [isExpanded]);\n\n  const handleLike = useCallback(() => {\n    likeMutation.mutate();\n  }, [likeMutation]);\n\n  const handleReply = useCallback(() => {\n    setShowReplyInput(!showReplyInput);\n  }, [showReplyInput]);\n\n  const handleSubmitReply = useCallback(() => {\n    if (replyText.trim()) {\n      replyMutation.mutate();\n    }\n  }, [replyText, replyMutation]);\n\n  const hasReplies = comment.replies && comment.replies.length > 0;\n  const isMaxDepth = depth >= maxDepth;\n\n  return (\n    <View style={[styles.threadContainer, depth > 0 && [styles.nestedThread, { borderLeftColor: appColors.border }]]}>\n      {depth > 0 && <View style={[styles.threadLine, { backgroundColor: appColors.border }]} />}\n      \n      <View style={styles.commentContainer}>\n        <TouchableOpacity onPress={() => onUserPress(comment.author.id)}>\n          {comment.author.avatar_url ? (\n            <Image source={{ uri: comment.author.avatar_url }} style={styles.avatar} />\n          ) : (\n            <View style={[styles.avatar, styles.avatarPlaceholder]}>\n              <ThemedText style={styles.avatarText}>\n                {comment.author.full_name.split(' ').map(n => n[0]).join('')}\n              </ThemedText>\n            </View>\n          )}\n        </TouchableOpacity>\n\n        <View style={styles.contentContainer}>\n          <View style={styles.commentHeader}>\n            <TouchableOpacity onPress={() => onUserPress(comment.author.id)}>\n              <ThemedText style={[styles.authorName, { color: appColors.textPrimary }]}>{comment.author.full_name}</ThemedText>\n            </TouchableOpacity>\n            <ThemedText style={[styles.timestamp, { color: appColors.textSecondary }]}>\n              {formatRelativeTime(comment.created_at)}\n            </ThemedText>\n            {comment.updated_at && comment.updated_at !== comment.created_at && (\n              <ThemedText style={[styles.editedBadge, { color: appColors.textSecondary }]}>(edited)</ThemedText>\n            )}\n          </View>\n\n          <ThemedText style={[styles.commentText, { color: appColors.textPrimary }]}>{comment.content}</ThemedText>\n\n          <View style={styles.actions}>\n            <TouchableOpacity \n              style={styles.actionButton} \n              onPress={handleLike}\n              disabled={likeMutation.isPending}\n            >\n              <Ionicons\n                name={comment.is_liked ? 'heart' : 'heart-outline'}\n                size={16}\n                color={comment.is_liked ? appColors.error : appColors.textSecondary}\n              />\n              {comment.likes_count > 0 && (\n                <ThemedText style={[\n                  styles.actionText,\n                  { color: appColors.textSecondary },\n                  comment.is_liked && { color: appColors.error }\n                ]}>\n                  {comment.likes_count}\n                </ThemedText>\n              )}\n            </TouchableOpacity>\n\n            {!isMaxDepth && (\n              <TouchableOpacity style={styles.actionButton} onPress={handleReply}>\n                <Ionicons name=\"chatbubble-outline\" size={16} color={appColors.textSecondary} />\n                <ThemedText style={[styles.actionText, { color: appColors.textSecondary }]}>Reply</ThemedText>\n              </TouchableOpacity>\n            )}\n\n            {hasReplies && (\n              <TouchableOpacity style={styles.actionButton} onPress={handleToggleExpand}>\n                <Ionicons\n                  name={isExpanded ? 'chevron-up' : 'chevron-down'}\n                  size={16}\n                  color={Colors.primary}\n                />\n                <ThemedText style={[styles.actionText, styles.actionTextPrimary]}>\n                  {isExpanded ? 'Hide' : `${comment.replies_count} ${comment.replies_count === 1 ? 'reply' : 'replies'}`}\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n          </View>\n\n          {showReplyInput && (\n            <View style={styles.replyInputContainer}>\n              <TextInput\n                style={[styles.replyInput, { color: appColors.textPrimary }]}\n                placeholder={`Reply to ${comment.author.full_name.split(' ')[0]}...`}\n                placeholderTextColor={appColors.textSecondary}\n                value={replyText}\n                onChangeText={setReplyText}\n                multiline\n                maxLength={1000}\n              />\n              <View style={styles.replyActions}>\n                <TouchableOpacity\n                  style={styles.cancelReplyButton}\n                  onPress={() => {\n                    setShowReplyInput(false);\n                    setReplyText('');\n                  }}\n                >\n                  <ThemedText style={[styles.cancelReplyText, { color: appColors.textSecondary }]}>Cancel</ThemedText>\n                </TouchableOpacity>\n                <TouchableOpacity\n                  style={[\n                    styles.submitReplyButton,\n                    (!replyText.trim() || replyMutation.isPending) && [styles.submitReplyButtonDisabled, { backgroundColor: appColors.textSecondary }]\n                  ]}\n                  onPress={handleSubmitReply}\n                  disabled={!replyText.trim() || replyMutation.isPending}\n                >\n                  {replyMutation.isPending ? (\n                    <ActivityIndicator size=\"small\" color=\"white\" />\n                  ) : (\n                    <Ionicons name=\"send\" size={16} color=\"white\" />\n                  )}\n                </TouchableOpacity>\n              </View>\n            </View>\n          )}\n        </View>\n      </View>\n\n      {hasReplies && isExpanded && (\n        <View style={styles.repliesContainer}>\n          {comment.replies!.map((reply) => (\n            <CommentThread\n              key={reply.id}\n              comment={reply}\n              postId={postId}\n              onUserPress={onUserPress}\n              depth={depth + 1}\n              maxDepth={maxDepth}\n            />\n          ))}\n        </View>\n      )}\n\n      {hasReplies && isMaxDepth && (\n        <TouchableOpacity style={styles.viewMoreButton}>\n          <ThemedText style={styles.viewMoreText}>\n            View {comment.replies_count} more {comment.replies_count === 1 ? 'reply' : 'replies'}\n          </ThemedText>\n          <Ionicons name=\"chevron-forward\" size={14} color={Colors.primary} />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n});\n\ninterface CollapsedThreadProps {\n  count: number;\n  onExpand: () => void;\n}\n\nexport function CollapsedThread({ count, onExpand }: CollapsedThreadProps) {\n  const appColors = useAppColors();\n  return (\n    <TouchableOpacity style={styles.collapsedThread} onPress={onExpand}>\n      <View style={[styles.collapsedLine, { backgroundColor: appColors.border }]} />\n      <ThemedText style={styles.collapsedText}>\n        {count} hidden {count === 1 ? 'reply' : 'replies'}\n      </ThemedText>\n      <Ionicons name=\"chevron-down\" size={14} color={Colors.primary} />\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  threadContainer: {\n    marginBottom: Spacing.md,\n  },\n  nestedThread: {\n    marginLeft: Spacing.md,\n    paddingLeft: Spacing.md,\n    borderLeftWidth: 2,\n  },\n  threadLine: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n    width: 2,\n  },\n  commentContainer: {\n    flexDirection: 'row',\n  },\n  avatar: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    marginRight: Spacing.sm,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  contentContainer: {\n    flex: 1,\n  },\n  commentHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flexWrap: 'wrap',\n    gap: Spacing.xs,\n  },\n  authorName: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  timestamp: {\n    ...Typography.small,\n  },\n  editedBadge: {\n    ...Typography.small,\n    fontStyle: 'italic',\n  },\n  commentText: {\n    ...Typography.body,\n    marginTop: Spacing.xs,\n    lineHeight: 22,\n  },\n  actions: {\n    flexDirection: 'row',\n    marginTop: Spacing.sm,\n    gap: Spacing.lg,\n  },\n  actionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  actionText: {\n    ...Typography.small,\n  },\n  actionTextPrimary: {\n    color: Colors.primary,\n  },\n  repliesContainer: {\n    marginTop: Spacing.md,\n  },\n  replyInputContainer: {\n    marginTop: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.sm,\n  },\n  replyInput: {\n    ...Typography.body,\n    minHeight: 60,\n    textAlignVertical: 'top',\n  },\n  replyActions: {\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n    marginTop: Spacing.sm,\n    gap: Spacing.md,\n  },\n  cancelReplyButton: {\n    padding: Spacing.sm,\n  },\n  cancelReplyText: {\n    ...Typography.caption,\n  },\n  submitReplyButton: {\n    backgroundColor: Colors.primary,\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  submitReplyButtonDisabled: {\n    opacity: 0.6,\n  },\n  viewMoreButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.sm,\n    paddingLeft: 44,\n    gap: 4,\n  },\n  viewMoreText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  collapsedThread: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.sm,\n    paddingLeft: Spacing.xl,\n    gap: Spacing.sm,\n  },\n  collapsedLine: {\n    width: 20,\n    height: 2,\n  },\n  collapsedText: {\n    ...Typography.small,\n    color: Colors.primary,\n  },\n});\n","path":null,"size_bytes":12944,"size_tokens":null},"client/lib/push-notifications.ts":{"content":"/**\n * Push Notification Service\n * Handle push notification registration and handling\n */\n\nimport * as Notifications from 'expo-notifications';\nimport * as Device from 'expo-device';\nimport { Platform } from 'react-native';\nimport { notificationsApi } from './api';\nimport { storage } from './storage';\n\n// Configure notification handler\nNotifications.setNotificationHandler({\n  handleNotification: async () => ({\n    shouldShowAlert: true,\n    shouldPlaySound: true,\n    shouldSetBadge: true,\n  }),\n});\n\nexport interface PushNotificationData {\n  type: string;\n  postId?: number;\n  userId?: number;\n  conversationId?: number;\n  dealId?: number;\n  amaId?: number;\n}\n\nclass PushNotificationService {\n  private expoPushToken: string | null = null;\n  private notificationListener: Notifications.Subscription | null = null;\n  private responseListener: Notifications.Subscription | null = null;\n\n  /**\n   * Initialize push notifications\n   */\n  async initialize(): Promise<string | null> {\n    if (!Device.isDevice) {\n      console.log('Push notifications require a physical device');\n      return null;\n    }\n\n    // Check/request permissions\n    const { status: existingStatus } = await Notifications.getPermissionsAsync();\n    let finalStatus = existingStatus;\n\n    if (existingStatus !== 'granted') {\n      const { status } = await Notifications.requestPermissionsAsync();\n      finalStatus = status;\n    }\n\n    if (finalStatus !== 'granted') {\n      console.log('Push notification permission denied');\n      return null;\n    }\n\n    // Get push token\n    try {\n      // Use the Expo project ID from Constants or environment\n      const Constants = await import('expo-constants');\n      const projectId = Constants.default.expoConfig?.extra?.eas?.projectId \n        || Constants.default.easConfig?.projectId\n        || process.env.EXPO_PROJECT_ID;\n      \n      if (!projectId) {\n        console.log('No Expo project ID configured - push notifications disabled');\n        console.log('To enable, run: npx eas project:init');\n        return null;\n      }\n      \n      const tokenData = await Notifications.getExpoPushTokenAsync({\n        projectId,\n      });\n      this.expoPushToken = tokenData.data;\n\n      // Configure Android channel\n      if (Platform.OS === 'android') {\n        await this.setupAndroidChannels();\n      }\n\n      return this.expoPushToken;\n    } catch (error) {\n      console.error('Failed to get push token:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Setup Android notification channels\n   */\n  private async setupAndroidChannels(): Promise<void> {\n    await Notifications.setNotificationChannelAsync('default', {\n      name: 'Default',\n      importance: Notifications.AndroidImportance.MAX,\n      vibrationPattern: [0, 250, 250, 250],\n      lightColor: '#1E88E5',\n    });\n\n    await Notifications.setNotificationChannelAsync('messages', {\n      name: 'Messages',\n      importance: Notifications.AndroidImportance.HIGH,\n      sound: 'default',\n    });\n\n    await Notifications.setNotificationChannelAsync('deals', {\n      name: 'Investment Deals',\n      importance: Notifications.AndroidImportance.DEFAULT,\n    });\n\n    await Notifications.setNotificationChannelAsync('social', {\n      name: 'Social',\n      importance: Notifications.AndroidImportance.DEFAULT,\n    });\n  }\n\n  /**\n   * Register device token with backend\n   */\n  async registerToken(): Promise<boolean> {\n    if (!this.expoPushToken) {\n      await this.initialize();\n    }\n\n    if (!this.expoPushToken) {\n      return false;\n    }\n\n    try {\n      const response = await notificationsApi.registerPushToken({\n        token: this.expoPushToken,\n        platform: Platform.OS,\n        deviceId: Device.modelId || 'unknown',\n      });\n\n      if (response.success) {\n        await storage.set('pushTokenRegistered', 'true');\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Failed to register push token:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Unregister device token (on logout)\n   */\n  async unregisterToken(): Promise<void> {\n    if (!this.expoPushToken) return;\n\n    try {\n      await notificationsApi.unregisterPushToken(this.expoPushToken);\n      await storage.remove('pushTokenRegistered');\n    } catch (error) {\n      console.error('Failed to unregister push token:', error);\n    }\n  }\n\n  /**\n   * Set up notification listeners\n   */\n  setupListeners(\n    onNotificationReceived: (notification: Notifications.Notification) => void,\n    onNotificationResponse: (response: Notifications.NotificationResponse) => void\n  ): void {\n    // Clean up existing listeners\n    this.removeListeners();\n\n    // Listen for incoming notifications while app is foregrounded\n    this.notificationListener = Notifications.addNotificationReceivedListener(\n      onNotificationReceived\n    );\n\n    // Listen for user interaction with notification\n    this.responseListener = Notifications.addNotificationResponseReceivedListener(\n      onNotificationResponse\n    );\n  }\n\n  /**\n   * Remove notification listeners\n   */\n  removeListeners(): void {\n    if (this.notificationListener) {\n      Notifications.removeNotificationSubscription(this.notificationListener);\n      this.notificationListener = null;\n    }\n    if (this.responseListener) {\n      Notifications.removeNotificationSubscription(this.responseListener);\n      this.responseListener = null;\n    }\n  }\n\n  /**\n   * Get the last notification response (for cold start)\n   */\n  async getLastNotificationResponse(): Promise<Notifications.NotificationResponse | null> {\n    return Notifications.getLastNotificationResponseAsync();\n  }\n\n  /**\n   * Schedule a local notification\n   */\n  async scheduleLocalNotification(\n    title: string,\n    body: string,\n    data?: PushNotificationData,\n    trigger?: Notifications.NotificationTriggerInput\n  ): Promise<string> {\n    return Notifications.scheduleNotificationAsync({\n      content: {\n        title,\n        body,\n        data,\n        sound: true,\n      },\n      trigger: trigger || null,\n    });\n  }\n\n  /**\n   * Cancel all scheduled notifications\n   */\n  async cancelAllScheduledNotifications(): Promise<void> {\n    await Notifications.cancelAllScheduledNotificationsAsync();\n  }\n\n  /**\n   * Get badge count\n   */\n  async getBadgeCount(): Promise<number> {\n    return Notifications.getBadgeCountAsync();\n  }\n\n  /**\n   * Set badge count\n   */\n  async setBadgeCount(count: number): Promise<void> {\n    await Notifications.setBadgeCountAsync(count);\n  }\n\n  /**\n   * Clear badge\n   */\n  async clearBadge(): Promise<void> {\n    await Notifications.setBadgeCountAsync(0);\n  }\n\n  /**\n   * Get current push token\n   */\n  getToken(): string | null {\n    return this.expoPushToken;\n  }\n\n  /**\n   * Parse notification data for navigation\n   */\n  parseNotificationData(data: Record<string, unknown>): PushNotificationData | null {\n    if (!data || !data.type) return null;\n\n    return {\n      type: data.type as string,\n      postId: data.postId as number | undefined,\n      userId: data.userId as number | undefined,\n      conversationId: data.conversationId as number | undefined,\n      dealId: data.dealId as number | undefined,\n      amaId: data.amaId as number | undefined,\n    };\n  }\n\n  /**\n   * Get navigation route from notification data\n   */\n  getNavigationRoute(data: PushNotificationData): { screen: string; params?: Record<string, unknown> } | null {\n    switch (data.type) {\n      case 'like':\n      case 'comment':\n      case 'mention':\n      case 'reply':\n        if (data.postId) {\n          return { screen: 'PostDetail', params: { postId: data.postId } };\n        }\n        break;\n      case 'follow':\n        if (data.userId) {\n          return { screen: 'UserProfile', params: { userId: data.userId } };\n        }\n        break;\n      case 'message':\n        if (data.userId) {\n          return { screen: 'Conversation', params: { userId: data.userId } };\n        }\n        break;\n      case 'deal_update':\n        if (data.dealId) {\n          return { screen: 'DealDetail', params: { dealId: data.dealId } };\n        }\n        break;\n      case 'ama_live':\n        if (data.amaId) {\n          return { screen: 'AMADetail', params: { amaId: data.amaId } };\n        }\n        break;\n      case 'achievement':\n        return { screen: 'Achievements' };\n      default:\n        return { screen: 'Notifications' };\n    }\n    return null;\n  }\n}\n\nexport const pushNotificationService = new PushNotificationService();\n","path":null,"size_bytes":8455,"size_tokens":null},"client/navigation/NotificationsStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport NotificationsScreen from \"@/screens/NotificationsScreen\";\nimport NotificationSettingsScreen from \"@/screens/NotificationSettingsScreen\";\n\nexport type NotificationsStackParamList = {\n  Notifications: undefined;\n  NotificationSettings: undefined;\n};\n\nconst Stack = createNativeStackNavigator<NotificationsStackParamList>();\n\nexport default function NotificationsStackNavigator() {\n  const screenOptions = useScreenOptions();\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      <Stack.Screen\n        name=\"Notifications\"\n        component={NotificationsScreen}\n        options={{ headerShown: false }}\n      />\n      <Stack.Screen\n        name=\"NotificationSettings\"\n        component={NotificationSettingsScreen}\n        options={{ headerTitle: \"Notification Settings\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":999,"size_tokens":null},"client/components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","path":null,"size_bytes":1674,"size_tokens":null},"server/routes/ai.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { AIService } from '../services/ai';\n\nconst router = Router();\n\nrouter.post('/chat', async (req: Request, res: Response) => {\n  try {\n    const { messages } = req.body;\n    \n    if (!messages || !Array.isArray(messages)) {\n      return res.status(400).json({\n        success: false,\n        error: 'Messages array is required',\n      });\n    }\n    \n    const response = await AIService.chatWithAssistant(messages, {\n      specialty: req.body.specialty,\n      investorType: req.body.investorType,\n    });\n    \n    res.json({\n      success: true,\n      data: { message: response },\n    });\n  } catch (error) {\n    console.error('AI chat error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to generate response',\n    });\n  }\n});\n\nrouter.post('/moderate', async (req: Request, res: Response) => {\n  try {\n    const { content } = req.body;\n    \n    if (!content) {\n      return res.status(400).json({\n        success: false,\n        error: 'Content is required',\n      });\n    }\n    \n    const result = await AIService.moderateContent(content);\n    \n    res.json({\n      success: true,\n      data: result,\n    });\n  } catch (error) {\n    console.error('Moderation error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Moderation failed',\n    });\n  }\n});\n\nrouter.post('/summarize', async (req: Request, res: Response) => {\n  try {\n    const { content } = req.body;\n    \n    if (!content) {\n      return res.status(400).json({\n        success: false,\n        error: 'Content is required',\n      });\n    }\n    \n    const summary = await AIService.summarizePost(content);\n    \n    res.json({\n      success: true,\n      data: summary,\n    });\n  } catch (error) {\n    console.error('Summarization error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Summarization failed',\n    });\n  }\n});\n\nrouter.post('/analyze-deal', async (req: Request, res: Response) => {\n  try {\n    const dealInfo = req.body;\n    \n    if (!dealInfo.title || !dealInfo.description) {\n      return res.status(400).json({\n        success: false,\n        error: 'Deal title and description are required',\n      });\n    }\n    \n    const analysis = await AIService.analyzeDeal(dealInfo);\n    \n    res.json({\n      success: true,\n      data: analysis,\n    });\n  } catch (error) {\n    console.error('Deal analysis error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Deal analysis failed',\n    });\n  }\n});\n\nrouter.post('/enhance-search', async (req: Request, res: Response) => {\n  try {\n    const { query } = req.body;\n    \n    if (!query) {\n      return res.status(400).json({\n        success: false,\n        error: 'Query is required',\n      });\n    }\n    \n    const enhancement = await AIService.enhanceSearch(query);\n    \n    res.json({\n      success: true,\n      data: enhancement,\n    });\n  } catch (error) {\n    console.error('Search enhancement error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Search enhancement failed',\n    });\n  }\n});\n\nrouter.post('/recommendations', async (req: Request, res: Response) => {\n  try {\n    const userContext = req.body;\n    \n    const recommendations = await AIService.getRecommendations(userContext);\n    \n    res.json({\n      success: true,\n      data: recommendations,\n    });\n  } catch (error) {\n    console.error('Recommendations error:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to generate recommendations',\n    });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":3594,"size_tokens":null},"client/screens/VerifyEmailScreen.tsx":{"content":"/**\n * VerifyEmail Screen\n * Email verification flow\n */\n\nimport React, { useState, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { authApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\n\ntype VerifyEmailRouteParams = {\n  VerifyEmail: {\n    token?: string;\n    email?: string;\n  };\n};\n\nexport default function VerifyEmailScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const route = useRoute<RouteProp<VerifyEmailRouteParams, 'VerifyEmail'>>();\n  const { token, email } = route.params || {};\n  const { refreshUser } = useAuth();\n\n  const [status, setStatus] = useState<'verifying' | 'success' | 'error' | 'waiting'>('waiting');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [isResending, setIsResending] = useState(false);\n  const [resendCooldown, setResendCooldown] = useState(0);\n\n  useEffect(() => {\n    if (token) {\n      verifyEmail(token);\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (resendCooldown > 0) {\n      const timer = setTimeout(() => setResendCooldown(resendCooldown - 1), 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [resendCooldown]);\n\n  const verifyEmail = async (verificationToken: string) => {\n    setStatus('verifying');\n    try {\n      const response = await authApi.verifyEmail(verificationToken);\n      if (response.success) {\n        setStatus('success');\n        await refreshUser();\n      } else {\n        setStatus('error');\n        setErrorMessage(response.error?.message || 'Verification failed');\n      }\n    } catch (error) {\n      setStatus('error');\n      setErrorMessage('An error occurred during verification');\n    }\n  };\n\n  const handleResendEmail = async () => {\n    if (resendCooldown > 0 || !email) return;\n    \n    setIsResending(true);\n    try {\n      const response = await authApi.resendVerificationEmail(email);\n      if (response.success) {\n        setResendCooldown(60);\n      }\n    } catch (error) {\n    }\n    setIsResending(false);\n  };\n\n  const handleContinue = () => {\n    navigation.reset({\n      index: 0,\n      routes: [{ name: 'Main' }],\n    });\n  };\n\n  const renderContent = () => {\n    switch (status) {\n      case 'verifying':\n        return (\n          <>\n            <View style={styles.iconContainer}>\n              <ActivityIndicator size=\"large\" color={Colors.primary} />\n            </View>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Verifying Your Email</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n              Please wait while we verify your email address...\n            </ThemedText>\n          </>\n        );\n\n      case 'success':\n        return (\n          <>\n            <LinearGradient\n              colors={[Colors.secondary, Colors.secondary + 'CC']}\n              style={styles.iconContainer}\n            >\n              <Ionicons name=\"checkmark\" size={48} color=\"white\" />\n            </LinearGradient>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Email Verified!</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n              Your email has been successfully verified. You now have full access to all features.\n            </ThemedText>\n            <TouchableOpacity style={styles.primaryButton} onPress={handleContinue}>\n              <ThemedText style={styles.primaryButtonText}>Continue to App</ThemedText>\n            </TouchableOpacity>\n          </>\n        );\n\n      case 'error':\n        return (\n          <>\n            <View style={[styles.iconContainer, styles.errorIcon]}>\n              <Ionicons name=\"close\" size={48} color={appColors.error} />\n            </View>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Verification Failed</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>{errorMessage}</ThemedText>\n            {email && (\n              <TouchableOpacity\n                style={styles.primaryButton}\n                onPress={handleResendEmail}\n                disabled={isResending || resendCooldown > 0}\n              >\n                {isResending ? (\n                  <ActivityIndicator color=\"white\" />\n                ) : (\n                  <ThemedText style={styles.primaryButtonText}>\n                    {resendCooldown > 0 ? `Resend in ${resendCooldown}s` : 'Resend Verification Email'}\n                  </ThemedText>\n                )}\n              </TouchableOpacity>\n            )}\n            <TouchableOpacity style={styles.secondaryButton} onPress={() => navigation.goBack()}>\n              <ThemedText style={styles.secondaryButtonText}>Go Back</ThemedText>\n            </TouchableOpacity>\n          </>\n        );\n\n      case 'waiting':\n      default:\n        return (\n          <>\n            <View style={styles.iconContainer}>\n              <Ionicons name=\"mail-outline\" size={48} color={Colors.primary} />\n            </View>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Verify Your Email</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n              We've sent a verification link to{'\\n'}\n              <ThemedText style={styles.emailText}>{email || 'your email'}</ThemedText>\n            </ThemedText>\n\n            <View style={styles.instructionsContainer}>\n              <View style={styles.instructionItem}>\n                <View style={styles.instructionNumber}>\n                  <ThemedText style={styles.instructionNumberText}>1</ThemedText>\n                </View>\n                <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                  Check your email inbox\n                </ThemedText>\n              </View>\n              <View style={styles.instructionItem}>\n                <View style={styles.instructionNumber}>\n                  <ThemedText style={styles.instructionNumberText}>2</ThemedText>\n                </View>\n                <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                  Click the verification link\n                </ThemedText>\n              </View>\n              <View style={styles.instructionItem}>\n                <View style={styles.instructionNumber}>\n                  <ThemedText style={styles.instructionNumberText}>3</ThemedText>\n                </View>\n                <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                  Return to the app\n                </ThemedText>\n              </View>\n            </View>\n\n            <TouchableOpacity\n              style={[styles.secondaryButton, (isResending || resendCooldown > 0) && styles.buttonDisabled]}\n              onPress={handleResendEmail}\n              disabled={isResending || resendCooldown > 0}\n            >\n              {isResending ? (\n                <ActivityIndicator color={Colors.primary} />\n              ) : (\n                <ThemedText style={styles.secondaryButtonText}>\n                  {resendCooldown > 0 ? `Resend in ${resendCooldown}s` : \"Didn't receive? Resend\"}\n                </ThemedText>\n              )}\n            </TouchableOpacity>\n\n            <TouchableOpacity style={styles.skipButton} onPress={handleContinue}>\n              <ThemedText style={[styles.skipButtonText, { color: appColors.textSecondary }]}>Skip for now</ThemedText>\n            </TouchableOpacity>\n          </>\n        );\n    }\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]}>\n      <View style={styles.content}>\n        {renderContent()}\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n  },\n  iconContainer: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  errorIcon: {\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  title: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.sm,\n  },\n  subtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 24,\n    marginBottom: Spacing.xl,\n  },\n  emailText: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  instructionsContainer: {\n    width: '100%',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  instructionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  instructionNumber: {\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  instructionNumberText: {\n    ...Typography.caption,\n    color: 'white',\n    fontWeight: '700',\n  },\n  instructionText: {\n    ...Typography.body,\n  },\n  primaryButton: {\n    width: '100%',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  primaryButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  secondaryButton: {\n    width: '100%',\n    backgroundColor: Colors.primary + '15',\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  secondaryButtonText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  buttonDisabled: {\n    opacity: 0.5,\n  },\n  skipButton: {\n    paddingVertical: Spacing.md,\n  },\n  skipButtonText: {\n    ...Typography.body,\n  },\n});\n","path":null,"size_bytes":10454,"size_tokens":null},"client/screens/DraftsScreen.tsx":{"content":"/**\n * Drafts List Screen\n * View and manage saved post drafts\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { Swipeable } from 'react-native-gesture-handler';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { useDraftList, PostDraft } from '@/lib/drafts';\nimport { haptics } from '@/lib/haptics';\nimport { formatRelativeTime } from '@/lib/utils';\n\nexport default function DraftsScreen() {\n  const navigation = useNavigation<any>();\n  const { colors } = useThemeContext();\n  const { drafts, isLoading, refresh, deleteDraft, deleteAllDrafts } = useDraftList();\n\n  const handleOpenDraft = useCallback((draft: PostDraft) => {\n    haptics.selection();\n    navigation.navigate('CreatePost', { draftId: draft.id });\n  }, [navigation]);\n\n  const handleDeleteDraft = useCallback((id: string) => {\n    Alert.alert(\n      'Delete Draft',\n      'Are you sure you want to delete this draft?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Delete',\n          style: 'destructive',\n          onPress: () => {\n            haptics.delete();\n            deleteDraft(id);\n          },\n        },\n      ]\n    );\n  }, [deleteDraft]);\n\n  const handleDeleteAll = useCallback(() => {\n    Alert.alert(\n      'Delete All Drafts',\n      `Are you sure you want to delete all ${drafts.length} drafts?`,\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Delete All',\n          style: 'destructive',\n          onPress: () => {\n            haptics.delete();\n            deleteAllDrafts();\n          },\n        },\n      ]\n    );\n  }, [drafts.length, deleteAllDrafts]);\n\n  const renderRightActions = useCallback((id: string) => {\n    return (\n      <TouchableOpacity\n        style={[styles.deleteAction, { backgroundColor: colors.error }]}\n        onPress={() => handleDeleteDraft(id)}\n      >\n        <Ionicons name=\"trash-outline\" size={24} color=\"white\" />\n      </TouchableOpacity>\n    );\n  }, [handleDeleteDraft, colors.error]);\n\n  const renderDraftItem = useCallback(({ item }: { item: PostDraft }) => {\n    const previewText = item.content.trim() || 'No text content';\n    const hasMedia = (item.images && item.images.length > 0) || item.videoUri;\n\n    return (\n      <Swipeable\n        renderRightActions={() => renderRightActions(item.id)}\n        overshootRight={false}\n      >\n        <TouchableOpacity\n          style={[styles.draftItem, { backgroundColor: colors.surface }]}\n          onPress={() => handleOpenDraft(item)}\n          activeOpacity={0.7}\n        >\n          <View style={styles.draftContent}>\n            {item.roomName ? (\n              <View style={[styles.roomBadge, { backgroundColor: colors.primary + '15' }]}>\n                <ThemedText style={[styles.roomName, { color: colors.primary }]}>\n                  {item.roomName}\n                </ThemedText>\n              </View>\n            ) : null}\n\n            <ThemedText\n              style={[styles.previewText, { color: colors.textPrimary }]}\n              numberOfLines={2}\n            >\n              {previewText}\n            </ThemedText>\n\n            <View style={styles.metaRow}>\n              <ThemedText style={[styles.timestamp, { color: colors.textSecondary }]}>\n                {formatRelativeTime(item.updatedAt)}\n              </ThemedText>\n\n              {hasMedia ? (\n                <View style={styles.mediaIndicator}>\n                  <Ionicons\n                    name={item.videoUri ? 'videocam' : 'images'}\n                    size={14}\n                    color={colors.textSecondary}\n                  />\n                  {item.images && item.images.length > 1 ? (\n                    <ThemedText style={[styles.mediaCount, { color: colors.textSecondary }]}>\n                      {item.images.length}\n                    </ThemedText>\n                  ) : null}\n                </View>\n              ) : null}\n\n              {item.isAnonymous ? (\n                <View style={styles.anonymousBadge}>\n                  <Ionicons name=\"eye-off-outline\" size={14} color={colors.textSecondary} />\n                  <ThemedText style={[styles.anonymousText, { color: colors.textSecondary }]}>\n                    Anonymous\n                  </ThemedText>\n                </View>\n              ) : null}\n            </View>\n          </View>\n\n          <Ionicons name=\"chevron-forward\" size={20} color={colors.textTertiary} />\n        </TouchableOpacity>\n      </Swipeable>\n    );\n  }, [colors, handleOpenDraft, renderRightActions]);\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"document-text-outline\" size={48} color={colors.textTertiary} />\n      <ThemedText style={[styles.emptyTitle, { color: colors.textPrimary }]}>\n        No drafts\n      </ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: colors.textSecondary }]}>\n        When you start writing a post and leave without publishing, it will be saved here automatically.\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n        <View style={[styles.header, { backgroundColor: colors.surface, borderBottomColor: colors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n          </TouchableOpacity>\n          <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n            Drafts\n          </ThemedText>\n          <View style={styles.headerRight} />\n        </View>\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={colors.primary} />\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      <View style={[styles.header, { backgroundColor: colors.surface, borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Drafts ({drafts.length})\n        </ThemedText>\n        {drafts.length > 0 ? (\n          <TouchableOpacity style={styles.headerRight} onPress={handleDeleteAll}>\n            <ThemedText style={[styles.deleteAllText, { color: colors.error }]}>\n              Delete All\n            </ThemedText>\n          </TouchableOpacity>\n        ) : (\n          <View style={styles.headerRight} />\n        )}\n      </View>\n\n      <FlatList\n        data={drafts}\n        keyExtractor={(item) => item.id}\n        renderItem={renderDraftItem}\n        ItemSeparatorComponent={() => (\n          <View style={[styles.separator, { backgroundColor: colors.border }]} />\n        )}\n        ListEmptyComponent={renderEmptyState}\n        contentContainerStyle={drafts.length === 0 ? styles.emptyList : undefined}\n        onRefresh={refresh}\n        refreshing={isLoading}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'flex-start',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n    fontSize: 17,\n    fontWeight: '600',\n  },\n  headerRight: {\n    width: 80,\n    alignItems: 'flex-end',\n  },\n  deleteAllText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  emptyList: {\n    flex: 1,\n  },\n  draftItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  draftContent: {\n    flex: 1,\n  },\n  roomBadge: {\n    alignSelf: 'flex-start',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.xs,\n  },\n  roomName: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  previewText: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  metaRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.sm,\n    gap: Spacing.md,\n  },\n  timestamp: {\n    ...Typography.small,\n  },\n  mediaIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  mediaCount: {\n    ...Typography.small,\n  },\n  anonymousBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  anonymousText: {\n    ...Typography.small,\n  },\n  separator: {\n    height: 1,\n    marginLeft: Spacing.lg,\n  },\n  deleteAction: {\n    width: 80,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n});\n","path":null,"size_bytes":9720,"size_tokens":null},"client/screens/AMADetailScreen.tsx":{"content":"/**\n * AMADetail Screen\n * View and participate in AMA sessions\n */\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  TextInput,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { contentApi } from '@/lib/api';\nimport { AMA } from '@/types';\nimport { formatRelativeTime, formatDate } from '@/lib/utils';\n\ntype AMADetailRouteParams = {\n  AMADetail: {\n    amaId: number;\n  };\n};\n\ninterface Question {\n  id: number;\n  content: string;\n  author: {\n    id: number;\n    full_name: string;\n    avatar_url?: string;\n  };\n  upvotes: number;\n  user_voted: boolean;\n  answer?: string;\n  answered_at?: string;\n  created_at: string;\n}\n\nexport default function AMADetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<AMADetailRouteParams, 'AMADetail'>>();\n  const { amaId } = route.params;\n  const queryClient = useQueryClient();\n  const inputRef = useRef<TextInput>(null);\n  const appColors = useAppColors();\n\n  const [questionText, setQuestionText] = useState('');\n\n  // Fetch AMA details\n  const {\n    data: ama,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['ama', amaId],\n    queryFn: async () => {\n      const response = await contentApi.getAMA(amaId);\n      return response.data;\n    },\n  });\n\n  // Submit question mutation\n  const askQuestionMutation = useMutation({\n    mutationFn: async () => {\n      const response = await contentApi.askQuestion(amaId, questionText.trim());\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to submit question');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      setQuestionText('');\n      refetch();\n    },\n  });\n\n  const handleSubmitQuestion = useCallback(() => {\n    if (!questionText.trim()) return;\n    askQuestionMutation.mutate();\n  }, [questionText, askQuestionMutation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'live': return appColors.error;\n      case 'upcoming': return appColors.warning;\n      case 'completed': return appColors.textSecondary;\n      default: return Colors.primary;\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'live': return 'üî¥ LIVE NOW';\n      case 'upcoming': return 'üìÖ Upcoming';\n      case 'completed': return '‚úì Completed';\n      default: return status;\n    }\n  };\n\n  const renderHeader = () => {\n    if (!ama) return null;\n\n    return (\n      <View style={[styles.headerContainer, { backgroundColor: appColors.surface }]}>\n        {/* Hero */}\n        <LinearGradient\n          colors={[Colors.primary, Colors.secondary]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.heroBanner}\n        >\n          <View style={styles.statusBadge}>\n            <ThemedText style={styles.statusText}>{getStatusText(ama.status)}</ThemedText>\n          </View>\n        </LinearGradient>\n\n        {/* Host Info */}\n        <View style={[styles.hostSection, { borderBottomColor: appColors.border }]}>\n          <TouchableOpacity\n            style={styles.hostInfo}\n            onPress={() => handleUserPress(ama.host.id)}\n          >\n            {ama.host.avatar_url ? (\n              <Image source={{ uri: ama.host.avatar_url }} style={styles.hostAvatar} />\n            ) : (\n              <View style={[styles.hostAvatar, styles.hostAvatarPlaceholder]}>\n                <ThemedText style={styles.hostAvatarText}>\n                  {ama.host.first_name[0]}{ama.host.last_name[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={styles.hostDetails}>\n              <ThemedText style={[styles.hostName, { color: appColors.textPrimary }]}>{ama.host.full_name}</ThemedText>\n              {ama.host.specialty && (\n                <ThemedText style={[styles.hostSpecialty, { color: appColors.textSecondary }]}>{ama.host.specialty}</ThemedText>\n              )}\n            </View>\n          </TouchableOpacity>\n        </View>\n\n        {/* AMA Info */}\n        <View style={styles.amaInfo}>\n          <ThemedText style={[styles.amaTitle, { color: appColors.textPrimary }]}>{ama.title}</ThemedText>\n          <ThemedText style={[styles.amaDescription, { color: appColors.textSecondary }]}>{ama.description}</ThemedText>\n\n          {/* Meta Info */}\n          <View style={styles.metaRow}>\n            <View style={styles.metaItem}>\n              <Ionicons name=\"calendar-outline\" size={16} color={appColors.textSecondary} />\n              <ThemedText style={[styles.metaText, { color: appColors.textSecondary }]}>\n                {formatDate(ama.scheduled_at)}\n              </ThemedText>\n            </View>\n            <View style={styles.metaItem}>\n              <Ionicons name=\"help-circle-outline\" size={16} color={appColors.textSecondary} />\n              <ThemedText style={[styles.metaText, { color: appColors.textSecondary }]}>\n                {ama.questions_count} questions\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n\n        {/* Questions Header */}\n        <View style={[styles.questionsHeader, { borderTopColor: appColors.border }]}>\n          <ThemedText style={[styles.questionsTitle, { color: appColors.textPrimary }]}>Questions</ThemedText>\n          <ThemedText style={[styles.questionsSubtitle, { color: appColors.textSecondary }]}>\n            Upvote questions you want answered\n          </ThemedText>\n        </View>\n      </View>\n    );\n  };\n\n  const renderQuestion = ({ item }: { item: Question }) => (\n    <View style={[styles.questionCard, { backgroundColor: appColors.surface }]}>\n      <TouchableOpacity\n        style={styles.questionAuthor}\n        onPress={() => handleUserPress(item.author.id)}\n      >\n        {item.author.avatar_url ? (\n          <Image source={{ uri: item.author.avatar_url }} style={styles.questionAvatar} />\n        ) : (\n          <View style={[styles.questionAvatar, styles.questionAvatarPlaceholder]}>\n            <ThemedText style={styles.questionAvatarText}>\n              {item.author.full_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View>\n          <ThemedText style={[styles.questionAuthorName, { color: appColors.textPrimary }]}>{item.author.full_name}</ThemedText>\n          <ThemedText style={[styles.questionTime, { color: appColors.textSecondary }]}>{formatRelativeTime(item.created_at)}</ThemedText>\n        </View>\n      </TouchableOpacity>\n\n      <ThemedText style={[styles.questionContent, { color: appColors.textPrimary }]}>{item.content}</ThemedText>\n\n      {item.answer && (\n        <View style={styles.answerContainer}>\n          <View style={styles.answerBadge}>\n            <MaterialCommunityIcons name=\"check-circle\" size={14} color={Colors.secondary} />\n            <ThemedText style={styles.answerBadgeText}>Answered</ThemedText>\n          </View>\n          <ThemedText style={[styles.answerText, { color: appColors.textPrimary }]}>{item.answer}</ThemedText>\n        </View>\n      )}\n\n      <View style={[styles.questionActions, { borderTopColor: appColors.border }]}>\n        <TouchableOpacity style={styles.upvoteButton}>\n          <Ionicons\n            name={item.user_voted ? 'arrow-up' : 'arrow-up-outline'}\n            size={20}\n            color={item.user_voted ? Colors.primary : appColors.textSecondary}\n          />\n          <ThemedText style={[\n            styles.upvoteCount,\n            { color: appColors.textSecondary },\n            item.user_voted && styles.upvoteCountActive,\n          ]}>\n            {item.upvotes}\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"help-circle-outline\" size={48} color={appColors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No questions yet</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        Be the first to ask a question!\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  const isLive = ama?.status === 'live';\n  const isUpcoming = ama?.status === 'upcoming';\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        {/* Header */}\n        <View style={[styles.navHeader, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n          <ThemedText style={[styles.navTitle, { color: appColors.textPrimary }]}>AMA Session</ThemedText>\n          <TouchableOpacity style={styles.shareButton}>\n            <Ionicons name=\"share-outline\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Questions List */}\n        <FlatList\n          data={ama?.questions || []}\n          renderItem={renderQuestion}\n          keyExtractor={(item) => item.id.toString()}\n          ListHeaderComponent={renderHeader}\n          ListEmptyComponent={renderEmpty}\n          refreshControl={\n            <RefreshControl\n              refreshing={isRefetching}\n              onRefresh={refetch}\n              tintColor={Colors.primary}\n            />\n          }\n          contentContainerStyle={styles.listContent}\n          showsVerticalScrollIndicator={false}\n        />\n\n        {/* Ask Question Input */}\n        {(isLive || isUpcoming) && (\n          <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n            <TextInput\n              ref={inputRef}\n              style={[styles.input, { color: appColors.textPrimary }]}\n              placeholder=\"Ask a question...\"\n              placeholderTextColor={appColors.textSecondary}\n              value={questionText}\n              onChangeText={setQuestionText}\n              multiline\n              maxLength={500}\n            />\n            <TouchableOpacity\n              style={[styles.sendButton, !questionText.trim() && styles.sendButtonDisabled]}\n              onPress={handleSubmitQuestion}\n              disabled={!questionText.trim() || askQuestionMutation.isPending}\n            >\n              {askQuestionMutation.isPending ? (\n                <ActivityIndicator size=\"small\" color={Colors.primary} />\n              ) : (\n                <Ionicons\n                  name=\"send\"\n                  size={20}\n                  color={questionText.trim() ? Colors.primary : appColors.textSecondary}\n                />\n              )}\n            </TouchableOpacity>\n          </View>\n        )}\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  navHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  navTitle: {\n    ...Typography.heading,\n  },\n  shareButton: {\n    padding: Spacing.sm,\n  },\n  listContent: {\n    paddingBottom: Spacing.xl,\n  },\n  headerContainer: {\n    marginBottom: Spacing.md,\n  },\n  heroBanner: {\n    height: 120,\n    justifyContent: 'flex-end',\n    padding: Spacing.lg,\n  },\n  statusBadge: {\n    alignSelf: 'flex-start',\n    backgroundColor: 'rgba(255,255,255,0.2)',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n  },\n  statusText: {\n    ...Typography.caption,\n    color: 'white',\n    fontWeight: '600',\n  },\n  hostSection: {\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  hostInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  hostAvatar: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    marginRight: Spacing.md,\n  },\n  hostAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  hostAvatarText: {\n    ...Typography.heading,\n    color: Colors.primary,\n  },\n  hostDetails: {\n    flex: 1,\n  },\n  hostName: {\n    ...Typography.heading,\n  },\n  hostSpecialty: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  amaInfo: {\n    padding: Spacing.lg,\n  },\n  amaTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.sm,\n  },\n  amaDescription: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  metaRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.xl,\n  },\n  metaItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  metaText: {\n    ...Typography.caption,\n  },\n  questionsHeader: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  questionsTitle: {\n    ...Typography.heading,\n  },\n  questionsSubtitle: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  questionCard: {\n    padding: Spacing.lg,\n    marginHorizontal: Spacing.md,\n    marginBottom: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  questionAuthor: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  questionAvatar: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    marginRight: Spacing.sm,\n  },\n  questionAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  questionAvatarText: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  questionAuthorName: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  questionTime: {\n    ...Typography.small,\n  },\n  questionContent: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  answerContainer: {\n    marginTop: Spacing.md,\n    padding: Spacing.md,\n    backgroundColor: Colors.secondary + '10',\n    borderRadius: BorderRadius.sm,\n    borderLeftWidth: 3,\n    borderLeftColor: Colors.secondary,\n  },\n  answerBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n    marginBottom: Spacing.sm,\n  },\n  answerBadgeText: {\n    ...Typography.small,\n    color: Colors.secondary,\n    fontWeight: '600',\n  },\n  answerText: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  questionActions: {\n    marginTop: Spacing.md,\n    paddingTop: Spacing.md,\n    borderTopWidth: 1,\n  },\n  upvoteButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  upvoteCount: {\n    ...Typography.caption,\n  },\n  upvoteCountActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    marginTop: Spacing.sm,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    padding: Spacing.md,\n    borderTopWidth: 1,\n    gap: Spacing.sm,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    maxHeight: 100,\n  },\n  sendButton: {\n    padding: Spacing.sm,\n  },\n  sendButtonDisabled: {\n    opacity: 0.5,\n  },\n});\n","path":null,"size_bytes":16644,"size_tokens":null},"client/components/ProgressBar.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, type StyleProp, type ViewStyle } from 'react-native';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withTiming,\n  withSpring,\n  Easing,\n  interpolate,\n} from 'react-native-reanimated';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport type ProgressVariant = 'default' | 'gradient' | 'success' | 'warning' | 'error';\nexport type ProgressSize = 'sm' | 'md' | 'lg';\n\nexport interface ProgressBarProps {\n  /** Progress value (0-100) */\n  value: number;\n  /** Maximum value */\n  max?: number;\n  /** Visual variant */\n  variant?: ProgressVariant;\n  /** Size preset */\n  size?: ProgressSize;\n  /** Show percentage label */\n  showLabel?: boolean;\n  /** Label position */\n  labelPosition?: 'top' | 'right' | 'inside';\n  /** Custom label formatter */\n  formatLabel?: (value: number, max: number) => string;\n  /** Animate on mount */\n  animated?: boolean;\n  /** Animation duration (ms) */\n  animationDuration?: number;\n  /** Custom track color */\n  trackColor?: string;\n  /** Custom fill color */\n  fillColor?: string;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nconst SIZE_CONFIG = {\n  sm: { height: 4, borderRadius: 2, fontSize: 10 },\n  md: { height: 8, borderRadius: 4, fontSize: 12 },\n  lg: { height: 12, borderRadius: 6, fontSize: 14 },\n};\n\nconst VARIANT_COLORS: Record<ProgressVariant, string | string[]> = {\n  default: colors.primary.main,\n  gradient: colors.gradient.colors as unknown as string[],\n  success: colors.semantic.success,\n  warning: colors.semantic.warning,\n  error: colors.semantic.error,\n};\n\nexport function ProgressBar({\n  value,\n  max = 100,\n  variant = 'default',\n  size = 'md',\n  showLabel = false,\n  labelPosition = 'right',\n  formatLabel,\n  animated = true,\n  animationDuration = 800,\n  trackColor,\n  fillColor,\n  style,\n}: ProgressBarProps) {\n  const progress = useSharedValue(animated ? 0 : Math.min(value, max));\n  const sizeConfig = SIZE_CONFIG[size];\n  const percentage = Math.min((value / max) * 100, 100);\n\n  useEffect(() => {\n    if (animated) {\n      progress.value = withTiming(Math.min(value, max), {\n        duration: animationDuration,\n        easing: Easing.bezier(0.25, 0.1, 0.25, 1),\n      });\n    } else {\n      progress.value = Math.min(value, max);\n    }\n  }, [value, max, animated, animationDuration, progress]);\n\n  const animatedFillStyle = useAnimatedStyle(() => {\n    const widthPercent = interpolate(progress.value, [0, max], [0, 100]);\n    return {\n      width: `${Math.min(widthPercent, 100)}%`,\n    };\n  });\n\n  const label = formatLabel\n    ? formatLabel(value, max)\n    : `${Math.round(percentage)}%`;\n\n  const getTrackColor = () => trackColor || colors.border.light;\n  \n  const getFillColor = () => {\n    if (fillColor) return fillColor;\n    const variantColor = VARIANT_COLORS[variant];\n    return Array.isArray(variantColor) ? variantColor[0] : variantColor;\n  };\n\n  const isGradient = variant === 'gradient' && !fillColor;\n\n  const renderFill = () => {\n    if (isGradient) {\n      return (\n        <Animated.View style={[styles.fillWrapper, animatedFillStyle]}>\n          <LinearGradient\n            colors={colors.gradient.colors as unknown as string[]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={[\n              styles.gradientFill,\n              { height: sizeConfig.height, borderRadius: sizeConfig.borderRadius },\n            ]}\n          />\n        </Animated.View>\n      );\n    }\n\n    return (\n      <Animated.View\n        style={[\n          styles.fill,\n          {\n            height: sizeConfig.height,\n            borderRadius: sizeConfig.borderRadius,\n            backgroundColor: getFillColor(),\n          },\n          animatedFillStyle,\n        ]}\n      />\n    );\n  };\n\n  return (\n    <View style={[styles.container, style]}>\n      {/* Top Label */}\n      {showLabel && labelPosition === 'top' && (\n        <View style={styles.topLabelContainer}>\n          <Text style={[styles.label, { fontSize: sizeConfig.fontSize }]}>\n            {label}\n          </Text>\n        </View>\n      )}\n\n      <View style={styles.barContainer}>\n        {/* Track */}\n        <View\n          style={[\n            styles.track,\n            {\n              height: sizeConfig.height,\n              borderRadius: sizeConfig.borderRadius,\n              backgroundColor: getTrackColor(),\n            },\n          ]}\n        >\n          {/* Fill */}\n          {renderFill()}\n\n          {/* Inside Label */}\n          {showLabel && labelPosition === 'inside' && size === 'lg' && (\n            <View style={styles.insideLabelContainer}>\n              <Text style={[styles.insideLabel, { fontSize: sizeConfig.fontSize - 2 }]}>\n                {label}\n              </Text>\n            </View>\n          )}\n        </View>\n\n        {/* Right Label */}\n        {showLabel && labelPosition === 'right' && (\n          <Text\n            style={[\n              styles.rightLabel,\n              { fontSize: sizeConfig.fontSize, minWidth: 40 },\n            ]}\n          >\n            {label}\n          </Text>\n        )}\n      </View>\n    </View>\n  );\n}\n\n// Circular Progress\nexport interface CircularProgressProps {\n  /** Progress value (0-100) */\n  value: number;\n  /** Size in pixels */\n  size?: number;\n  /** Stroke width */\n  strokeWidth?: number;\n  /** Track color */\n  trackColor?: string;\n  /** Fill color */\n  fillColor?: string;\n  /** Show label in center */\n  showLabel?: boolean;\n  /** Custom label */\n  label?: string;\n  /** Animate on mount */\n  animated?: boolean;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n  /** Children to render in center */\n  children?: React.ReactNode;\n}\n\nexport function CircularProgress({\n  value,\n  size = 80,\n  strokeWidth = 8,\n  trackColor,\n  fillColor,\n  showLabel = true,\n  label,\n  animated = true,\n  style,\n  children,\n}: CircularProgressProps) {\n  const progress = useSharedValue(animated ? 0 : value);\n  const radius = (size - strokeWidth) / 2;\n  const circumference = 2 * Math.PI * radius;\n\n  useEffect(() => {\n    if (animated) {\n      progress.value = withSpring(Math.min(value, 100), {\n        damping: 15,\n        stiffness: 100,\n      });\n    } else {\n      progress.value = Math.min(value, 100);\n    }\n  }, [value, animated, progress]);\n\n  const animatedStrokeStyle = useAnimatedStyle(() => {\n    const strokeDashoffset = circumference - (progress.value / 100) * circumference;\n    return {\n      strokeDashoffset,\n    };\n  });\n\n  return (\n    <View style={[styles.circularContainer, { width: size, height: size }, style]}>\n      <View style={styles.svgContainer}>\n        {/* Track Circle */}\n        <View\n          style={[\n            styles.circleTrack,\n            {\n              width: size,\n              height: size,\n              borderRadius: size / 2,\n              borderWidth: strokeWidth,\n              borderColor: trackColor || colors.border.light,\n            },\n          ]}\n        />\n        \n        {/* Progress indicator - simplified without SVG */}\n        <Animated.View\n          style={[\n            styles.circleProgress,\n            {\n              width: size,\n              height: size,\n              borderRadius: size / 2,\n              borderWidth: strokeWidth,\n              borderColor: fillColor || colors.primary.main,\n              borderTopColor: 'transparent',\n              borderRightColor: 'transparent',\n              transform: [{ rotate: `${(value / 100) * 360}deg` }],\n            },\n          ]}\n        />\n      </View>\n\n      {/* Center Content */}\n      <View style={styles.circularCenter}>\n        {children || (showLabel && (\n          <Text style={styles.circularLabel}>\n            {label || `${Math.round(value)}%`}\n          </Text>\n        ))}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    // Container\n  },\n  barContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  track: {\n    flex: 1,\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  fill: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n  },\n  fillWrapper: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n    overflow: 'hidden',\n  },\n  gradientFill: {\n    width: '100%',\n    height: '100%',\n  },\n\n  // Labels\n  topLabelContainer: {\n    marginBottom: spacing.xs,\n  },\n  label: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    fontWeight: '500',\n  },\n  rightLabel: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    fontWeight: '600',\n    marginLeft: spacing.sm,\n    textAlign: 'right',\n  },\n  insideLabelContainer: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  insideLabel: {\n    color: colors.text.inverse,\n    fontWeight: '700',\n  },\n\n  // Circular\n  circularContainer: {\n    position: 'relative',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  svgContainer: {\n    position: 'absolute',\n  },\n  circleTrack: {\n    position: 'absolute',\n  },\n  circleProgress: {\n    position: 'absolute',\n  },\n  circularCenter: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  circularLabel: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n});\n\nexport default ProgressBar;\n","path":null,"size_bytes":9403,"size_tokens":null},"server/db/schema.ts":{"content":"import {\n  pgTable,\n  uuid,\n  varchar,\n  text,\n  integer,\n  decimal,\n  boolean,\n  timestamp,\n  pgEnum,\n  index,\n  uniqueIndex,\n} from 'drizzle-orm/pg-core';\nimport { relations } from 'drizzle-orm';\n\n// ============================================\n// Enums\n// ============================================\n\nexport const authProviderEnum = pgEnum('auth_provider', ['apple', 'google', 'email', 'demo', 'github', 'facebook']);\n\nexport const investmentCategoryEnum = pgEnum('investment_category', [\n  'Biotech',\n  'Medical Devices',\n  'Digital Health',\n  'Pharmaceuticals',\n  'Research',\n  'Healthcare Services',\n]);\n\nexport const riskLevelEnum = pgEnum('risk_level', ['Low', 'Medium', 'High']);\n\nexport const investmentStatusEnum = pgEnum('investment_status', [\n  'active',\n  'funded',\n  'closed',\n  'cancelled',\n]);\n\nexport const portfolioStatusEnum = pgEnum('portfolio_status', [\n  'active',\n  'completed',\n  'pending',\n  'cancelled',\n]);\n\nexport const transactionTypeEnum = pgEnum('transaction_type', [\n  'investment',\n  'dividend',\n  'withdrawal',\n  'refund',\n]);\n\nexport const transactionStatusEnum = pgEnum('transaction_status', [\n  'pending',\n  'completed',\n  'failed',\n]);\n\nexport const articleCategoryEnum = pgEnum('article_category', [\n  'AI & Healthcare',\n  'Biotech',\n  'Medical Devices',\n  'Digital Health',\n  'Market Trends',\n  'Regulations',\n  'Research',\n]);\n\nexport const paymentMethodTypeEnum = pgEnum('payment_method_type', ['bank', 'card']);\n\nexport const notificationTypeEnum = pgEnum('notification_type', [\n  'investment_update',\n  'portfolio_milestone',\n  'new_opportunity',\n  'article',\n  'system',\n]);\n\n// ============================================\n// Users Table\n// ============================================\n\nexport const users = pgTable(\n  'users',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    email: varchar('email', { length: 255 }).notNull().unique(),\n    firstName: varchar('first_name', { length: 100 }),\n    lastName: varchar('last_name', { length: 100 }),\n    phone: varchar('phone', { length: 20 }),\n    avatarUrl: text('avatar_url'),\n    provider: authProviderEnum('provider').notNull().default('email'),\n    providerUserId: varchar('provider_user_id', { length: 255 }),\n    passwordHash: text('password_hash'),\n    isVerified: boolean('is_verified').notNull().default(false),\n    isAccredited: boolean('is_accredited').notNull().default(false),\n    emailVerifiedAt: timestamp('email_verified_at'),\n    lastLoginAt: timestamp('last_login_at'),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    updatedAt: timestamp('updated_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    emailIdx: uniqueIndex('users_email_idx').on(table.email),\n    providerIdx: index('users_provider_idx').on(table.provider, table.providerUserId),\n  })\n);\n\n// ============================================\n// User Sessions Table\n// ============================================\n\nexport const userSessions = pgTable(\n  'user_sessions',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    token: text('token').notNull().unique(),\n    expiresAt: timestamp('expires_at').notNull(),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('sessions_user_id_idx').on(table.userId),\n    tokenIdx: uniqueIndex('sessions_token_idx').on(table.token),\n  })\n);\n\n// ============================================\n// Password Reset Tokens Table\n// ============================================\n\nexport const passwordResetTokens = pgTable(\n  'password_reset_tokens',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    token: varchar('token', { length: 64 }).notNull().unique(),\n    expiresAt: timestamp('expires_at').notNull(),\n    usedAt: timestamp('used_at'),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    tokenIdx: uniqueIndex('password_reset_token_idx').on(table.token),\n    userIdIdx: index('password_reset_user_id_idx').on(table.userId),\n  })\n);\n\n// ============================================\n// Push Tokens Table\n// ============================================\n\nexport const pushTokens = pgTable(\n  'push_tokens',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    token: text('token').notNull(),\n    platform: varchar('platform', { length: 10 }), // ios, android\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('push_tokens_user_id_idx').on(table.userId),\n    tokenIdx: uniqueIndex('push_tokens_token_idx').on(table.token),\n  })\n);\n\n// ============================================\n// Notification Preferences Table\n// ============================================\n\nexport const notificationPreferences = pgTable('notification_preferences', {\n  id: uuid('id').defaultRandom().primaryKey(),\n  userId: uuid('user_id')\n    .notNull()\n    .unique()\n    .references(() => users.id, { onDelete: 'cascade' }),\n  investmentUpdates: boolean('investment_updates').notNull().default(true),\n  newOpportunities: boolean('new_opportunities').notNull().default(true),\n  portfolioMilestones: boolean('portfolio_milestones').notNull().default(true),\n  articles: boolean('articles').notNull().default(false),\n  marketing: boolean('marketing').notNull().default(false),\n  updatedAt: timestamp('updated_at').notNull().defaultNow(),\n});\n\n// ============================================\n// Investments Table\n// ============================================\n\nexport const investments = pgTable(\n  'investments',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    name: varchar('name', { length: 255 }).notNull(),\n    description: text('description').notNull(),\n    longDescription: text('long_description'),\n    category: investmentCategoryEnum('category').notNull(),\n    fundingGoal: decimal('funding_goal', { precision: 15, scale: 2 }).notNull(),\n    fundingCurrent: decimal('funding_current', { precision: 15, scale: 2 })\n      .notNull()\n      .default('0'),\n    minimumInvestment: decimal('minimum_investment', { precision: 15, scale: 2 })\n      .notNull()\n      .default('1000'),\n    expectedRoiMin: decimal('expected_roi_min', { precision: 5, scale: 2 }),\n    expectedRoiMax: decimal('expected_roi_max', { precision: 5, scale: 2 }),\n    riskLevel: riskLevelEnum('risk_level').notNull().default('Medium'),\n    status: investmentStatusEnum('status').notNull().default('active'),\n    imageUrl: text('image_url'),\n    startDate: timestamp('start_date').notNull(),\n    endDate: timestamp('end_date').notNull(),\n    investorCount: integer('investor_count').notNull().default(0),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    updatedAt: timestamp('updated_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    statusIdx: index('investments_status_idx').on(table.status),\n    categoryIdx: index('investments_category_idx').on(table.category),\n    endDateIdx: index('investments_end_date_idx').on(table.endDate),\n  })\n);\n\n// ============================================\n// Investment Documents Table\n// ============================================\n\nexport const investmentDocuments = pgTable(\n  'investment_documents',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    investmentId: uuid('investment_id')\n      .notNull()\n      .references(() => investments.id, { onDelete: 'cascade' }),\n    name: varchar('name', { length: 255 }).notNull(),\n    type: varchar('type', { length: 50 }).notNull(), // pdf, xlsx, etc.\n    url: text('url').notNull(),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    investmentIdIdx: index('inv_docs_investment_id_idx').on(table.investmentId),\n  })\n);\n\n// ============================================\n// Investment Team Members Table\n// ============================================\n\nexport const investmentTeamMembers = pgTable(\n  'investment_team_members',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    investmentId: uuid('investment_id')\n      .notNull()\n      .references(() => investments.id, { onDelete: 'cascade' }),\n    name: varchar('name', { length: 255 }).notNull(),\n    role: varchar('role', { length: 255 }).notNull(),\n    avatarUrl: text('avatar_url'),\n    linkedInUrl: text('linkedin_url'),\n    sortOrder: integer('sort_order').notNull().default(0),\n  },\n  (table) => ({\n    investmentIdIdx: index('inv_team_investment_id_idx').on(table.investmentId),\n  })\n);\n\n// ============================================\n// Investment Milestones Table\n// ============================================\n\nexport const investmentMilestones = pgTable(\n  'investment_milestones',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    investmentId: uuid('investment_id')\n      .notNull()\n      .references(() => investments.id, { onDelete: 'cascade' }),\n    title: varchar('title', { length: 255 }).notNull(),\n    description: text('description'),\n    targetDate: timestamp('target_date'),\n    completed: boolean('completed').notNull().default(false),\n    completedAt: timestamp('completed_at'),\n    sortOrder: integer('sort_order').notNull().default(0),\n  },\n  (table) => ({\n    investmentIdIdx: index('inv_milestones_investment_id_idx').on(table.investmentId),\n  })\n);\n\n// ============================================\n// Portfolio (User Investments) Table\n// ============================================\n\nexport const portfolioInvestments = pgTable(\n  'portfolio_investments',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    investmentId: uuid('investment_id')\n      .notNull()\n      .references(() => investments.id, { onDelete: 'restrict' }),\n    amountInvested: decimal('amount_invested', { precision: 15, scale: 2 }).notNull(),\n    currentValue: decimal('current_value', { precision: 15, scale: 2 }).notNull(),\n    shares: decimal('shares', { precision: 15, scale: 6 }),\n    status: portfolioStatusEnum('status').notNull().default('pending'),\n    investedAt: timestamp('invested_at').notNull().defaultNow(),\n    completedAt: timestamp('completed_at'),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    updatedAt: timestamp('updated_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('portfolio_user_id_idx').on(table.userId),\n    investmentIdIdx: index('portfolio_investment_id_idx').on(table.investmentId),\n    userInvestmentIdx: uniqueIndex('portfolio_user_investment_idx').on(\n      table.userId,\n      table.investmentId\n    ),\n  })\n);\n\n// ============================================\n// Transactions Table\n// ============================================\n\nexport const transactions = pgTable(\n  'transactions',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    portfolioInvestmentId: uuid('portfolio_investment_id').references(\n      () => portfolioInvestments.id,\n      { onDelete: 'set null' }\n    ),\n    type: transactionTypeEnum('type').notNull(),\n    amount: decimal('amount', { precision: 15, scale: 2 }).notNull(),\n    status: transactionStatusEnum('status').notNull().default('pending'),\n    paymentMethodId: uuid('payment_method_id').references(() => paymentMethods.id),\n    reference: varchar('reference', { length: 255 }),\n    metadata: text('metadata'), // JSON string for additional data\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    completedAt: timestamp('completed_at'),\n  },\n  (table) => ({\n    userIdIdx: index('transactions_user_id_idx').on(table.userId),\n    statusIdx: index('transactions_status_idx').on(table.status),\n    createdAtIdx: index('transactions_created_at_idx').on(table.createdAt),\n  })\n);\n\n// ============================================\n// Payment Methods Table\n// ============================================\n\nexport const paymentMethods = pgTable(\n  'payment_methods',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    type: paymentMethodTypeEnum('type').notNull(),\n    name: varchar('name', { length: 255 }).notNull(),\n    last4: varchar('last4', { length: 4 }).notNull(),\n    expiryMonth: integer('expiry_month'),\n    expiryYear: integer('expiry_year'),\n    bankName: varchar('bank_name', { length: 255 }),\n    isDefault: boolean('is_default').notNull().default(false),\n    stripePaymentMethodId: varchar('stripe_payment_method_id', { length: 255 }),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('payment_methods_user_id_idx').on(table.userId),\n  })\n);\n\n// ============================================\n// Articles Table\n// ============================================\n\nexport const articles = pgTable(\n  'articles',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    title: varchar('title', { length: 500 }).notNull(),\n    summary: text('summary').notNull(),\n    content: text('content'),\n    source: varchar('source', { length: 255 }).notNull(),\n    sourceUrl: text('source_url'),\n    author: varchar('author', { length: 255 }),\n    imageUrl: text('image_url'),\n    category: articleCategoryEnum('category').notNull(),\n    tags: text('tags'), // JSON array as string\n    readTime: integer('read_time').notNull().default(5),\n    isFeatured: boolean('is_featured').notNull().default(false),\n    viewCount: integer('view_count').notNull().default(0),\n    publishedAt: timestamp('published_at').notNull(),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    updatedAt: timestamp('updated_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    categoryIdx: index('articles_category_idx').on(table.category),\n    publishedAtIdx: index('articles_published_at_idx').on(table.publishedAt),\n    featuredIdx: index('articles_featured_idx').on(table.isFeatured),\n  })\n);\n\n// ============================================\n// Article Bookmarks Table\n// ============================================\n\nexport const articleBookmarks = pgTable(\n  'article_bookmarks',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    articleId: uuid('article_id')\n      .notNull()\n      .references(() => articles.id, { onDelete: 'cascade' }),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('bookmarks_user_id_idx').on(table.userId),\n    userArticleIdx: uniqueIndex('bookmarks_user_article_idx').on(\n      table.userId,\n      table.articleId\n    ),\n  })\n);\n\n// ============================================\n// Notifications Table\n// ============================================\n\nexport const notifications = pgTable(\n  'notifications',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    userId: uuid('user_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    type: notificationTypeEnum('type').notNull(),\n    title: varchar('title', { length: 255 }).notNull(),\n    body: text('body').notNull(),\n    data: text('data'), // JSON string\n    read: boolean('read').notNull().default(false),\n    readAt: timestamp('read_at'),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    userIdIdx: index('notifications_user_id_idx').on(table.userId),\n    readIdx: index('notifications_read_idx').on(table.userId, table.read),\n  })\n);\n\n// ============================================\n// Direct Messages Tables\n// ============================================\n\nexport const dmConversations = pgTable(\n  'dm_conversations',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    user1Id: uuid('user1_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    user2Id: uuid('user2_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    lastMessageAt: timestamp('last_message_at'),\n    lastMessage: text('last_message'),\n    user1Unread: integer('user1_unread').notNull().default(0),\n    user2Unread: integer('user2_unread').notNull().default(0),\n    user1Muted: boolean('user1_muted').notNull().default(false),\n    user2Muted: boolean('user2_muted').notNull().default(false),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n    updatedAt: timestamp('updated_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    user1Idx: index('dm_conv_user1_idx').on(table.user1Id),\n    user2Idx: index('dm_conv_user2_idx').on(table.user2Id),\n    usersIdx: uniqueIndex('dm_conv_users_idx').on(table.user1Id, table.user2Id),\n  })\n);\n\nexport const directMessages = pgTable(\n  'direct_messages',\n  {\n    id: uuid('id').defaultRandom().primaryKey(),\n    conversationId: uuid('conversation_id')\n      .notNull()\n      .references(() => dmConversations.id, { onDelete: 'cascade' }),\n    senderId: uuid('sender_id')\n      .notNull()\n      .references(() => users.id, { onDelete: 'cascade' }),\n    content: text('content').notNull(),\n    isRead: boolean('is_read').notNull().default(false),\n    readAt: timestamp('read_at'),\n    createdAt: timestamp('created_at').notNull().defaultNow(),\n  },\n  (table) => ({\n    conversationIdx: index('dm_conversation_idx').on(table.conversationId),\n    senderIdx: index('dm_sender_idx').on(table.senderId),\n    createdAtIdx: index('dm_created_at_idx').on(table.createdAt),\n  })\n);\n\n// ============================================\n// Relations\n// ============================================\n\nexport const usersRelations = relations(users, ({ many, one }) => ({\n  sessions: many(userSessions),\n  pushTokens: many(pushTokens),\n  notificationPreferences: one(notificationPreferences),\n  portfolioInvestments: many(portfolioInvestments),\n  transactions: many(transactions),\n  paymentMethods: many(paymentMethods),\n  bookmarks: many(articleBookmarks),\n  notifications: many(notifications),\n  dmConversationsAsUser1: many(dmConversations, { relationName: 'user1' }),\n  dmConversationsAsUser2: many(dmConversations, { relationName: 'user2' }),\n  sentMessages: many(directMessages),\n}));\n\nexport const dmConversationsRelations = relations(dmConversations, ({ one, many }) => ({\n  user1: one(users, {\n    fields: [dmConversations.user1Id],\n    references: [users.id],\n    relationName: 'user1',\n  }),\n  user2: one(users, {\n    fields: [dmConversations.user2Id],\n    references: [users.id],\n    relationName: 'user2',\n  }),\n  messages: many(directMessages),\n}));\n\nexport const directMessagesRelations = relations(directMessages, ({ one }) => ({\n  conversation: one(dmConversations, {\n    fields: [directMessages.conversationId],\n    references: [dmConversations.id],\n  }),\n  sender: one(users, {\n    fields: [directMessages.senderId],\n    references: [users.id],\n  }),\n}));\n\nexport const investmentsRelations = relations(investments, ({ many }) => ({\n  documents: many(investmentDocuments),\n  teamMembers: many(investmentTeamMembers),\n  milestones: many(investmentMilestones),\n  portfolioInvestments: many(portfolioInvestments),\n}));\n\nexport const investmentDocumentsRelations = relations(investmentDocuments, ({ one }) => ({\n  investment: one(investments, {\n    fields: [investmentDocuments.investmentId],\n    references: [investments.id],\n  }),\n}));\n\nexport const investmentTeamMembersRelations = relations(investmentTeamMembers, ({ one }) => ({\n  investment: one(investments, {\n    fields: [investmentTeamMembers.investmentId],\n    references: [investments.id],\n  }),\n}));\n\nexport const investmentMilestonesRelations = relations(investmentMilestones, ({ one }) => ({\n  investment: one(investments, {\n    fields: [investmentMilestones.investmentId],\n    references: [investments.id],\n  }),\n}));\n\nexport const portfolioInvestmentsRelations = relations(portfolioInvestments, ({ one, many }) => ({\n  user: one(users, {\n    fields: [portfolioInvestments.userId],\n    references: [users.id],\n  }),\n  investment: one(investments, {\n    fields: [portfolioInvestments.investmentId],\n    references: [investments.id],\n  }),\n  transactions: many(transactions),\n}));\n\nexport const transactionsRelations = relations(transactions, ({ one }) => ({\n  user: one(users, {\n    fields: [transactions.userId],\n    references: [users.id],\n  }),\n  portfolioInvestment: one(portfolioInvestments, {\n    fields: [transactions.portfolioInvestmentId],\n    references: [portfolioInvestments.id],\n  }),\n  paymentMethod: one(paymentMethods, {\n    fields: [transactions.paymentMethodId],\n    references: [paymentMethods.id],\n  }),\n}));\n\nexport const articlesRelations = relations(articles, ({ many }) => ({\n  bookmarks: many(articleBookmarks),\n}));\n\nexport const articleBookmarksRelations = relations(articleBookmarks, ({ one }) => ({\n  user: one(users, {\n    fields: [articleBookmarks.userId],\n    references: [users.id],\n  }),\n  article: one(articles, {\n    fields: [articleBookmarks.articleId],\n    references: [articles.id],\n  }),\n}));\n","path":null,"size_bytes":21196,"size_tokens":null},"client/components/Input.tsx":{"content":"import React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  StyleSheet,\n  Pressable,\n  type TextInputProps,\n  type StyleProp,\n  type ViewStyle,\n} from 'react-native';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withTiming,\n  interpolateColor,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nconst AnimatedView = Animated.createAnimatedComponent(View);\n\nexport interface InputProps extends Omit<TextInputProps, 'style'> {\n  /** Input label */\n  label?: string;\n  /** Helper text below input */\n  helperText?: string;\n  /** Error message (shows error state when present) */\n  error?: string;\n  /** Icon name (Feather) for left side */\n  leftIcon?: keyof typeof Feather.glyphMap;\n  /** Icon name (Feather) for right side */\n  rightIcon?: keyof typeof Feather.glyphMap;\n  /** Callback when right icon is pressed */\n  onRightIconPress?: () => void;\n  /** Show as disabled */\n  disabled?: boolean;\n  /** Show as read-only */\n  readOnly?: boolean;\n  /** Container style */\n  containerStyle?: StyleProp<ViewStyle>;\n  /** Input container style */\n  inputContainerStyle?: StyleProp<ViewStyle>;\n  /** Required field indicator */\n  required?: boolean;\n  /** Character count (shows count/max) */\n  maxLength?: number;\n  /** Show character count */\n  showCharacterCount?: boolean;\n}\n\nexport function Input({\n  label,\n  helperText,\n  error,\n  leftIcon,\n  rightIcon,\n  onRightIconPress,\n  disabled = false,\n  readOnly = false,\n  containerStyle,\n  inputContainerStyle,\n  required = false,\n  maxLength,\n  showCharacterCount = false,\n  value,\n  onFocus,\n  onBlur,\n  secureTextEntry,\n  ...props\n}: InputProps) {\n  const inputRef = useRef<TextInput>(null);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isSecureVisible, setIsSecureVisible] = useState(!secureTextEntry);\n  const focusAnimation = useSharedValue(0);\n\n  const hasError = !!error;\n  const isDisabled = disabled || readOnly;\n  const characterCount = value?.length || 0;\n\n  const handleFocus = useCallback(\n    (e: any) => {\n      setIsFocused(true);\n      focusAnimation.value = withTiming(1, { duration: 150 });\n      onFocus?.(e);\n    },\n    [onFocus, focusAnimation]\n  );\n\n  const handleBlur = useCallback(\n    (e: any) => {\n      setIsFocused(false);\n      focusAnimation.value = withTiming(0, { duration: 150 });\n      onBlur?.(e);\n    },\n    [onBlur, focusAnimation]\n  );\n\n  const handleContainerPress = useCallback(() => {\n    if (!isDisabled) {\n      inputRef.current?.focus();\n    }\n  }, [isDisabled]);\n\n  const toggleSecureVisibility = useCallback(() => {\n    setIsSecureVisible((prev) => !prev);\n  }, []);\n\n  const animatedContainerStyle = useAnimatedStyle(() => {\n    const borderColor = hasError\n      ? colors.semantic.error\n      : interpolateColor(\n          focusAnimation.value,\n          [0, 1],\n          [colors.border.light, colors.primary.main]\n        );\n\n    return {\n      borderColor,\n      borderWidth: isFocused ? 1.5 : 1,\n    };\n  });\n\n  const getBorderColor = () => {\n    if (hasError) return colors.semantic.error;\n    if (isFocused) return colors.primary.main;\n    return colors.border.light;\n  };\n\n  return (\n    <View style={[styles.container, containerStyle]}>\n      {/* Label */}\n      {label && (\n        <View style={styles.labelContainer}>\n          <Text\n            style={[\n              styles.label,\n              isFocused && styles.labelFocused,\n              hasError && styles.labelError,\n            ]}\n          >\n            {label}\n          </Text>\n          {required && <Text style={styles.required}>*</Text>}\n        </View>\n      )}\n\n      {/* Input Container */}\n      <Pressable onPress={handleContainerPress} disabled={isDisabled}>\n        <AnimatedView\n          style={[\n            styles.inputContainer,\n            animatedContainerStyle,\n            isDisabled && styles.inputContainerDisabled,\n            inputContainerStyle,\n          ]}\n        >\n          {/* Left Icon */}\n          {leftIcon && (\n            <Feather\n              name={leftIcon}\n              size={20}\n              color={\n                hasError\n                  ? colors.semantic.error\n                  : isFocused\n                  ? colors.primary.main\n                  : colors.text.tertiary\n              }\n              style={styles.leftIcon}\n            />\n          )}\n\n          {/* Text Input */}\n          <TextInput\n            ref={inputRef}\n            style={[\n              styles.input,\n              isDisabled && styles.inputDisabled,\n              leftIcon && styles.inputWithLeftIcon,\n              (rightIcon || secureTextEntry) && styles.inputWithRightIcon,\n            ]}\n            value={value}\n            placeholderTextColor={colors.text.tertiary}\n            editable={!isDisabled}\n            onFocus={handleFocus}\n            onBlur={handleBlur}\n            secureTextEntry={secureTextEntry && !isSecureVisible}\n            maxLength={maxLength}\n            {...props}\n          />\n\n          {/* Right Icon / Secure Toggle */}\n          {secureTextEntry ? (\n            <Pressable\n              onPress={toggleSecureVisibility}\n              style={styles.rightIconButton}\n              hitSlop={8}\n            >\n              <Feather\n                name={isSecureVisible ? 'eye-off' : 'eye'}\n                size={20}\n                color={colors.text.tertiary}\n              />\n            </Pressable>\n          ) : rightIcon ? (\n            <Pressable\n              onPress={onRightIconPress}\n              style={styles.rightIconButton}\n              hitSlop={8}\n              disabled={!onRightIconPress}\n            >\n              <Feather\n                name={rightIcon}\n                size={20}\n                color={\n                  hasError\n                    ? colors.semantic.error\n                    : isFocused\n                    ? colors.primary.main\n                    : colors.text.tertiary\n                }\n              />\n            </Pressable>\n          ) : null}\n        </AnimatedView>\n      </Pressable>\n\n      {/* Footer: Helper Text / Error / Character Count */}\n      <View style={styles.footer}>\n        {(helperText || error) && (\n          <Text\n            style={[\n              styles.helperText,\n              hasError && styles.errorText,\n            ]}\n          >\n            {error || helperText}\n          </Text>\n        )}\n        {showCharacterCount && maxLength && (\n          <Text\n            style={[\n              styles.characterCount,\n              characterCount >= maxLength && styles.characterCountMax,\n            ]}\n          >\n            {characterCount}/{maxLength}\n          </Text>\n        )}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    marginBottom: spacing.md,\n  },\n\n  // Label\n  labelContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: spacing.sm,\n  },\n  label: {\n    ...typography.captionMedium,\n    color: colors.text.primary,\n  },\n  labelFocused: {\n    color: colors.primary.main,\n  },\n  labelError: {\n    color: colors.semantic.error,\n  },\n  required: {\n    ...typography.caption,\n    color: colors.semantic.error,\n    marginLeft: spacing.xs,\n  },\n\n  // Input Container\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    minHeight: layout.inputHeight,\n  },\n  inputContainerDisabled: {\n    backgroundColor: colors.background.secondary,\n  },\n\n  // Icons\n  leftIcon: {\n    marginLeft: spacing.md,\n  },\n  rightIconButton: {\n    padding: spacing.md,\n  },\n\n  // Input\n  input: {\n    flex: 1,\n    ...typography.body,\n    color: colors.text.primary,\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.md,\n  },\n  inputDisabled: {\n    color: colors.text.secondary,\n  },\n  inputWithLeftIcon: {\n    paddingLeft: spacing.sm,\n  },\n  inputWithRightIcon: {\n    paddingRight: spacing.xs,\n  },\n\n  // Footer\n  footer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: spacing.xs,\n    minHeight: 18,\n  },\n  helperText: {\n    ...typography.small,\n    color: colors.text.secondary,\n    flex: 1,\n  },\n  errorText: {\n    color: colors.semantic.error,\n  },\n  characterCount: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    marginLeft: spacing.sm,\n  },\n  characterCountMax: {\n    color: colors.semantic.error,\n  },\n});\n\nexport default Input;\n","path":null,"size_bytes":8621,"size_tokens":null},"client/components/Skeleton.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, StyleSheet, type StyleProp, type ViewStyle } from 'react-native';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withRepeat,\n  withTiming,\n  interpolate,\n  Easing,\n} from 'react-native-reanimated';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { colors, spacing, layout } from '@/theme';\n\nexport interface SkeletonProps {\n  /** Width (number for pixels, string for percentage) */\n  width?: number | string;\n  /** Height in pixels */\n  height?: number;\n  /** Border radius */\n  borderRadius?: number;\n  /** Circle shape (overrides width/height/borderRadius) */\n  circle?: boolean;\n  /** Circle/square size when using circle prop */\n  size?: number;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function Skeleton({\n  width = '100%',\n  height = 16,\n  borderRadius = layout.radiusSmall,\n  circle = false,\n  size = 40,\n  style,\n}: SkeletonProps) {\n  const shimmerPosition = useSharedValue(0);\n\n  useEffect(() => {\n    shimmerPosition.value = withRepeat(\n      withTiming(1, {\n        duration: 1500,\n        easing: Easing.bezier(0.4, 0, 0.6, 1),\n      }),\n      -1, // Infinite repeat\n      false // Don't reverse\n    );\n  }, [shimmerPosition]);\n\n  const animatedStyle = useAnimatedStyle(() => {\n    const translateX = interpolate(\n      shimmerPosition.value,\n      [0, 1],\n      [-100, 100]\n    );\n    return {\n      transform: [{ translateX: `${translateX}%` as any }],\n    };\n  });\n\n  const containerStyle = circle\n    ? {\n        width: size,\n        height: size,\n        borderRadius: size / 2,\n      }\n    : {\n        width,\n        height,\n        borderRadius,\n      };\n\n  return (\n    <View style={[styles.container, containerStyle, style]}>\n      <Animated.View style={[styles.shimmer, animatedStyle]}>\n        <LinearGradient\n          colors={[\n            'transparent',\n            'rgba(255, 255, 255, 0.3)',\n            'transparent',\n          ]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 0 }}\n          style={styles.gradient}\n        />\n      </Animated.View>\n    </View>\n  );\n}\n\n// Skeleton Text (multiple lines)\nexport interface SkeletonTextProps {\n  /** Number of lines */\n  lines?: number;\n  /** Line height */\n  lineHeight?: number;\n  /** Gap between lines */\n  gap?: number;\n  /** Last line width percentage */\n  lastLineWidth?: number | string;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function SkeletonText({\n  lines = 3,\n  lineHeight = 14,\n  gap = spacing.sm,\n  lastLineWidth = '60%',\n  style,\n}: SkeletonTextProps) {\n  return (\n    <View style={[styles.textContainer, style]}>\n      {Array.from({ length: lines }).map((_, index) => (\n        <Skeleton\n          key={index}\n          width={index === lines - 1 ? lastLineWidth : '100%'}\n          height={lineHeight}\n          style={index < lines - 1 ? { marginBottom: gap } : undefined}\n        />\n      ))}\n    </View>\n  );\n}\n\n// Skeleton Avatar\nexport interface SkeletonAvatarProps {\n  /** Avatar size */\n  size?: number;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function SkeletonAvatar({ size = 40, style }: SkeletonAvatarProps) {\n  return <Skeleton circle size={size} style={style} />;\n}\n\n// Skeleton Card\nexport interface SkeletonCardProps {\n  /** Show image placeholder */\n  hasImage?: boolean;\n  /** Image height */\n  imageHeight?: number;\n  /** Number of text lines */\n  lines?: number;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function SkeletonCard({\n  hasImage = true,\n  imageHeight = 160,\n  lines = 2,\n  style,\n}: SkeletonCardProps) {\n  return (\n    <View style={[styles.card, style]}>\n      {hasImage && (\n        <Skeleton\n          width=\"100%\"\n          height={imageHeight}\n          borderRadius={0}\n          style={styles.cardImage}\n        />\n      )}\n      <View style={styles.cardContent}>\n        <Skeleton width=\"70%\" height={18} style={styles.cardTitle} />\n        <SkeletonText lines={lines} lineHeight={12} />\n      </View>\n    </View>\n  );\n}\n\n// Skeleton List Item\nexport interface SkeletonListItemProps {\n  /** Show avatar */\n  hasAvatar?: boolean;\n  /** Avatar size */\n  avatarSize?: number;\n  /** Number of text lines */\n  lines?: number;\n  /** Show right element placeholder */\n  hasRightElement?: boolean;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function SkeletonListItem({\n  hasAvatar = true,\n  avatarSize = 48,\n  lines = 2,\n  hasRightElement = false,\n  style,\n}: SkeletonListItemProps) {\n  return (\n    <View style={[styles.listItem, style]}>\n      {hasAvatar && (\n        <SkeletonAvatar size={avatarSize} style={styles.listItemAvatar} />\n      )}\n      <View style={styles.listItemContent}>\n        <Skeleton width=\"60%\" height={14} style={styles.listItemTitle} />\n        {lines > 1 && <Skeleton width=\"40%\" height={12} />}\n      </View>\n      {hasRightElement && (\n        <Skeleton width={60} height={24} borderRadius={layout.radiusSmall} />\n      )}\n    </View>\n  );\n}\n\n// Skeleton Investment Card\nexport function SkeletonInvestmentCard({ style }: { style?: StyleProp<ViewStyle> }) {\n  return (\n    <View style={[styles.investmentCard, style]}>\n      {/* Header */}\n      <View style={styles.investmentHeader}>\n        <Skeleton width={80} height={20} borderRadius={layout.radiusFull} />\n        <Skeleton width={70} height={20} borderRadius={layout.radiusFull} />\n      </View>\n\n      {/* Content */}\n      <View style={styles.investmentContent}>\n        <Skeleton width=\"80%\" height={20} style={styles.investmentTitle} />\n        <SkeletonText lines={2} lineHeight={12} />\n      </View>\n\n      {/* Progress */}\n      <Skeleton width=\"100%\" height={8} style={styles.investmentProgress} />\n\n      {/* Footer */}\n      <View style={styles.investmentFooter}>\n        <Skeleton width={80} height={14} />\n        <Skeleton width={80} height={14} />\n      </View>\n    </View>\n  );\n}\n\n// Skeleton Article Card\nexport function SkeletonArticleCard({ style }: { style?: StyleProp<ViewStyle> }) {\n  return (\n    <View style={[styles.articleCard, style]}>\n      <Skeleton\n        width={72}\n        height={72}\n        borderRadius={layout.radiusMedium}\n        style={styles.articleImage}\n      />\n      <View style={styles.articleContent}>\n        <View style={styles.articleMeta}>\n          <Skeleton width={60} height={12} />\n          <Skeleton width={40} height={12} />\n        </View>\n        <Skeleton width=\"90%\" height={16} style={styles.articleTitle} />\n        <Skeleton width=\"70%\" height={12} />\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: colors.border.light,\n    overflow: 'hidden',\n  },\n  shimmer: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  gradient: {\n    flex: 1,\n  },\n\n  // Text\n  textContainer: {\n    width: '100%',\n  },\n\n  // Card\n  card: {\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusLarge,\n    overflow: 'hidden',\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  cardImage: {\n    marginBottom: 0,\n  },\n  cardContent: {\n    padding: spacing.md,\n  },\n  cardTitle: {\n    marginBottom: spacing.sm,\n  },\n\n  // List Item\n  listItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: spacing.md,\n  },\n  listItemAvatar: {\n    marginRight: spacing.md,\n  },\n  listItemContent: {\n    flex: 1,\n  },\n  listItemTitle: {\n    marginBottom: spacing.xs,\n  },\n\n  // Investment Card\n  investmentCard: {\n    backgroundColor: colors.primary.main,\n    borderRadius: layout.radiusLarge,\n    padding: spacing.lg,\n  },\n  investmentHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: spacing.md,\n  },\n  investmentContent: {\n    marginBottom: spacing.lg,\n  },\n  investmentTitle: {\n    marginBottom: spacing.sm,\n  },\n  investmentProgress: {\n    marginBottom: spacing.md,\n  },\n  investmentFooter: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n\n  // Article Card\n  articleCard: {\n    flexDirection: 'row',\n    padding: spacing.md,\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  articleImage: {\n    marginRight: spacing.md,\n  },\n  articleContent: {\n    flex: 1,\n    justifyContent: 'center',\n  },\n  articleMeta: {\n    flexDirection: 'row',\n    gap: spacing.sm,\n    marginBottom: spacing.xs,\n  },\n  articleTitle: {\n    marginBottom: spacing.xs,\n  },\n});\n\nexport default Skeleton;\n","path":null,"size_bytes":8540,"size_tokens":null},"client/hooks/useAuth.ts":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"docs/API_INTEGRATION_GUIDE.md":{"content":"# MedInvest Mobile - API Integration Guide\n\n## Overview\n\nThis guide covers integrating the MedInvest mobile app with your backend API. The app is built with React Native/Expo and uses a RESTful API architecture.\n\n---\n\n## Table of Contents\n\n1. [API Configuration](#api-configuration)\n2. [Authentication](#authentication)\n3. [Core Endpoints](#core-endpoints)\n4. [Real-time Features](#real-time-features)\n5. [Error Handling](#error-handling)\n6. [Rate Limiting](#rate-limiting)\n7. [Testing](#testing)\n\n---\n\n## API Configuration\n\n### Base Setup\n\nConfigure the API base URL in `client/lib/api.ts`:\n\n```typescript\nconst API_BASE_URL = __DEV__ \n  ? 'http://localhost:3000/api/v1'\n  : 'https://api.medinvest.com/v1';\n```\n\n### Environment Variables\n\nCreate a `.env` file:\n\n```env\nAPI_URL=https://api.medinvest.com/v1\nWS_URL=wss://api.medinvest.com/ws\nSENTRY_DSN=your-sentry-dsn\n```\n\n---\n\n## Authentication\n\n### JWT Token Flow\n\nThe app uses JWT tokens stored in secure storage:\n\n```typescript\n// Login\nPOST /auth/login\nBody: { email: string, password: string }\nResponse: { token: string, refreshToken: string, user: User }\n\n// Register\nPOST /auth/register\nBody: { email: string, password: string, full_name: string, specialty?: string }\nResponse: { token: string, user: User }\n\n// Refresh Token\nPOST /auth/refresh\nBody: { refreshToken: string }\nResponse: { token: string, refreshToken: string }\n\n// Logout\nPOST /auth/logout\nHeaders: { Authorization: 'Bearer <token>' }\n```\n\n### Token Storage\n\nTokens are stored using `expo-secure-store`:\n\n```typescript\nimport * as SecureStore from 'expo-secure-store';\n\n// Store token\nawait SecureStore.setItemAsync('auth_token', token);\n\n// Retrieve token\nconst token = await SecureStore.getItemAsync('auth_token');\n```\n\n### Request Interceptor\n\nAll authenticated requests include the token:\n\n```typescript\napi.interceptors.request.use(async (config) => {\n  const token = await SecureStore.getItemAsync('auth_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n```\n\n---\n\n## Core Endpoints\n\n### Users\n\n```typescript\n// Get current user\nGET /users/me\nResponse: User\n\n// Update profile\nPUT /users/me\nBody: { full_name?: string, bio?: string, specialty?: string, avatar_url?: string }\n\n// Get user by ID\nGET /users/:id\nResponse: User\n\n// Follow user\nPOST /users/:id/follow\n\n// Unfollow user\nDELETE /users/:id/follow\n\n// Get followers\nGET /users/:id/followers?page=1&limit=20\nResponse: { users: User[], hasMore: boolean }\n\n// Get following\nGET /users/:id/following?page=1&limit=20\nResponse: { users: User[], hasMore: boolean }\n\n// Block user\nPOST /users/:id/block\n\n// Unblock user\nDELETE /users/:id/block\n\n// Mute user\nPOST /users/:id/mute\nBody: { mute_posts: boolean, mute_comments: boolean, mute_messages: boolean, duration: string }\n\n// Search users\nGET /users/search?q=query&page=1&limit=20\nResponse: { users: User[], hasMore: boolean }\n```\n\n### Posts\n\n```typescript\n// Get feed\nGET /posts/feed?page=1&limit=20&room_id=optional\nResponse: { posts: Post[], hasMore: boolean }\n\n// Get post by ID\nGET /posts/:id\nResponse: Post\n\n// Create post\nPOST /posts\nBody: { \n  content: string, \n  room_id?: number, \n  is_anonymous?: boolean,\n  images?: string[],\n  video_url?: string,\n  poll?: PollData\n}\nResponse: Post\n\n// Update post\nPUT /posts/:id\nBody: { content?: string }\n\n// Delete post\nDELETE /posts/:id\n\n// Like post\nPOST /posts/:id/like\n\n// Unlike post\nDELETE /posts/:id/like\n\n// React to post\nPOST /posts/:id/react\nBody: { type: 'like' | 'love' | 'laugh' | 'wow' | 'sad' | 'fire' | 'thinking' | 'clap' }\n\n// Remove reaction\nDELETE /posts/:id/react\n\n// Bookmark post\nPOST /posts/:id/bookmark\n\n// Remove bookmark\nDELETE /posts/:id/bookmark\n\n// Get bookmarks\nGET /posts/bookmarks?page=1&limit=20\nResponse: { posts: Post[], hasMore: boolean }\n\n// Report post\nPOST /posts/:id/report\nBody: { reason: string, details?: string }\n\n// Pin post to profile\nPOST /posts/:id/pin\n\n// Unpin post\nDELETE /posts/:id/pin\n```\n\n### Comments\n\n```typescript\n// Get comments\nGET /posts/:postId/comments?page=1&limit=20\nResponse: { comments: Comment[], hasMore: boolean }\n\n// Create comment\nPOST /posts/:postId/comments\nBody: { content: string, parent_id?: number }\nResponse: Comment\n\n// Update comment\nPUT /comments/:id\nBody: { content: string }\n\n// Delete comment\nDELETE /comments/:id\n\n// Like comment\nPOST /comments/:id/like\n\n// Unlike comment\nDELETE /comments/:id/like\n```\n\n### Rooms\n\n```typescript\n// Get all rooms\nGET /rooms\nResponse: Room[]\n\n// Get room by ID\nGET /rooms/:id\nResponse: Room\n\n// Get room posts\nGET /rooms/:id/posts?page=1&limit=20\nResponse: { posts: Post[], hasMore: boolean }\n\n// Join room\nPOST /rooms/:id/join\n\n// Leave room\nDELETE /rooms/:id/join\n\n// Get user's rooms\nGET /rooms/joined\nResponse: Room[]\n```\n\n### Messages\n\n```typescript\n// Get conversations\nGET /conversations?page=1&limit=20\nResponse: { conversations: Conversation[], hasMore: boolean }\n\n// Get conversation messages\nGET /conversations/:id/messages?page=1&limit=50\nResponse: { messages: Message[], hasMore: boolean }\n\n// Send message\nPOST /conversations/:id/messages\nBody: { content: string, attachments?: string[] }\nResponse: Message\n\n// Create conversation\nPOST /conversations\nBody: { user_id: number }\nResponse: Conversation\n\n// Mark as read\nPOST /conversations/:id/read\n\n// Delete conversation\nDELETE /conversations/:id\n```\n\n### Notifications\n\n```typescript\n// Get notifications\nGET /notifications?page=1&limit=20\nResponse: { notifications: Notification[], hasMore: boolean, unreadCount: number }\n\n// Mark as read\nPOST /notifications/:id/read\n\n// Mark all as read\nPOST /notifications/read-all\n\n// Get unread count\nGET /notifications/unread-count\nResponse: { count: number }\n```\n\n### Deals\n\n```typescript\n// Get deals\nGET /deals?page=1&limit=20&stage=optional&sector=optional\nResponse: { deals: Deal[], hasMore: boolean }\n\n// Get deal by ID\nGET /deals/:id\nResponse: Deal\n\n// Watch deal\nPOST /deals/:id/watch\n\n// Unwatch deal\nDELETE /deals/:id/watch\n\n// Express interest\nPOST /deals/:id/interest\nBody: { amount?: number, message?: string }\n```\n\n### Search\n\n```typescript\n// Global search\nGET /search?q=query&type=all|posts|users|rooms|deals&page=1&limit=20\nResponse: { \n  posts?: Post[], \n  users?: User[], \n  rooms?: Room[], \n  deals?: Deal[],\n  hasMore: boolean \n}\n\n// Trending topics\nGET /search/trending\nResponse: { topics: TrendingTopic[] }\n\n// Autocomplete\nGET /search/autocomplete?q=query\nResponse: { suggestions: string[], users: User[], hashtags: string[] }\n```\n\n### Polls\n\n```typescript\n// Vote on poll\nPOST /posts/:postId/polls/:pollId/vote\nBody: { option_ids: string[] }\n\n// Get poll results\nGET /posts/:postId/polls/:pollId\nResponse: Poll\n```\n\n### Reports\n\n```typescript\n// Report content\nPOST /reports\nBody: { \n  type: 'user' | 'post' | 'comment' | 'message',\n  target_id: number,\n  reason: string,\n  details?: string\n}\n```\n\n### Account\n\n```typescript\n// Change password\nPUT /account/password\nBody: { current_password: string, new_password: string }\n\n// Request data export\nPOST /account/export\nBody: { categories: string[], format: 'json' | 'csv' | 'html' }\nResponse: { exportId: string }\n\n// Get export status\nGET /account/export/:id/status\nResponse: { status: string, progress: number, downloadUrl?: string }\n\n// Delete account\nDELETE /account\nBody: { password: string }\n\n// Get notification settings\nGET /account/notification-settings\nResponse: NotificationSettings\n\n// Update notification settings\nPUT /account/notification-settings\nBody: NotificationSettings\n```\n\n### App Version\n\n```typescript\n// Check for updates\nGET /app/version?currentVersion=1.0.0&platform=ios|android\nResponse: {\n  latestVersion: string,\n  minimumVersion: string,\n  updateRequired: boolean,\n  updateRecommended: boolean,\n  releaseNotes?: string[]\n}\n```\n\n---\n\n## Real-time Features\n\n### WebSocket Connection\n\n```typescript\n// Connect\nconst ws = new WebSocket(`wss://api.medinvest.com/ws?token=${authToken}`);\n\n// Events to listen for:\n// - 'typing' - User typing indicator\n// - 'message' - New message\n// - 'notification' - New notification\n// - 'message_read' - Message read receipt\n// - 'user_online' - User came online\n// - 'user_offline' - User went offline\n\n// Send typing indicator\nws.send(JSON.stringify({\n  type: 'typing',\n  data: { conversationId: 123, isTyping: true }\n}));\n\n// Send read receipt\nws.send(JSON.stringify({\n  type: 'message_read',\n  data: { conversationId: 123, messageId: 456 }\n}));\n```\n\n### Push Notifications\n\nFirebase Cloud Messaging (FCM) for Android, APNs for iOS.\n\n```typescript\n// Register device token\nPOST /devices/register\nBody: { \n  token: string, \n  platform: 'ios' | 'android',\n  deviceId: string \n}\n\n// Unregister device\nDELETE /devices/:token\n```\n\n---\n\n## Error Handling\n\n### Error Response Format\n\n```typescript\n{\n  error: {\n    code: string,        // e.g., 'VALIDATION_ERROR', 'UNAUTHORIZED'\n    message: string,     // Human-readable message\n    details?: any        // Additional error details\n  }\n}\n```\n\n### Common Error Codes\n\n| Code | HTTP Status | Description |\n|------|-------------|-------------|\n| `UNAUTHORIZED` | 401 | Invalid or expired token |\n| `FORBIDDEN` | 403 | Insufficient permissions |\n| `NOT_FOUND` | 404 | Resource not found |\n| `VALIDATION_ERROR` | 400 | Invalid request data |\n| `RATE_LIMIT` | 429 | Too many requests |\n| `SERVER_ERROR` | 500 | Internal server error |\n\n### Client-side Error Handling\n\n```typescript\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    if (error.response?.status === 401) {\n      // Try refresh token\n      const refreshed = await refreshToken();\n      if (refreshed) {\n        // Retry original request\n        return api.request(error.config);\n      }\n      // Logout user\n      await logout();\n    }\n    \n    if (error.response?.status === 429) {\n      // Handle rate limit\n      const retryAfter = error.response.headers['retry-after'];\n      // Show rate limit message\n    }\n    \n    return Promise.reject(error);\n  }\n);\n```\n\n---\n\n## Rate Limiting\n\n### Limits\n\n| Endpoint Category | Limit |\n|-------------------|-------|\n| Authentication | 5 requests/minute |\n| Read operations | 100 requests/minute |\n| Write operations | 30 requests/minute |\n| Search | 20 requests/minute |\n| File uploads | 10 requests/minute |\n\n### Headers\n\n```\nX-RateLimit-Limit: 100\nX-RateLimit-Remaining: 95\nX-RateLimit-Reset: 1640000000\n```\n\n---\n\n## Testing\n\n### Mock API Setup\n\nFor development, use the mock data in `client/lib/mockData.ts`:\n\n```typescript\n// Enable mock mode\nconst USE_MOCK_API = __DEV__ && true;\n\nif (USE_MOCK_API) {\n  // Intercept requests and return mock data\n}\n```\n\n### Test Users\n\n```\nEmail: test@medinvest.com\nPassword: TestPassword123!\n\nEmail: premium@medinvest.com  \nPassword: PremiumUser123!\n```\n\n### Postman Collection\n\nImport the provided Postman collection for API testing:\n`docs/MedInvest-API.postman_collection.json`\n\n---\n\n## Data Types\n\n### User\n\n```typescript\ninterface User {\n  id: number;\n  email: string;\n  full_name: string;\n  username?: string;\n  avatar_url?: string;\n  bio?: string;\n  specialty?: string;\n  is_verified: boolean;\n  is_premium: boolean;\n  followers_count: number;\n  following_count: number;\n  posts_count: number;\n  created_at: string;\n}\n```\n\n### Post\n\n```typescript\ninterface Post {\n  id: number;\n  author: User;\n  content: string;\n  room?: Room;\n  is_anonymous: boolean;\n  images?: string[];\n  video_url?: string;\n  poll?: Poll;\n  likes_count: number;\n  comments_count: number;\n  is_liked: boolean;\n  is_bookmarked: boolean;\n  is_pinned: boolean;\n  reactions: ReactionCount[];\n  user_reaction?: string;\n  created_at: string;\n  updated_at: string;\n}\n```\n\n### Message\n\n```typescript\ninterface Message {\n  id: number;\n  conversation_id: number;\n  sender: User;\n  content: string;\n  attachments?: string[];\n  status: 'sending' | 'sent' | 'delivered' | 'read';\n  read_at?: string;\n  created_at: string;\n}\n```\n\n### Notification\n\n```typescript\ninterface Notification {\n  id: number;\n  type: string;\n  title: string;\n  body: string;\n  data?: any;\n  is_read: boolean;\n  created_at: string;\n}\n```\n\n---\n\n## Security Considerations\n\n1. **Always use HTTPS** in production\n2. **Validate all input** on the server\n3. **Sanitize user content** to prevent XSS\n4. **Implement proper CORS** headers\n5. **Use parameterized queries** to prevent SQL injection\n6. **Rate limit** all endpoints\n7. **Log security events** for monitoring\n8. **Rotate JWT secrets** periodically\n\n---\n\n## Support\n\nFor API integration support, contact:\n- Email: api-support@medinvest.com\n- Documentation: https://docs.medinvest.com/api\n","path":null,"size_bytes":12588,"size_tokens":null},"client/lib/offline-queue.ts":{"content":"/**\n * Offline Queue Service\n * Queue actions when offline and sync when back online\n */\n\nimport { useEffect, useCallback, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport NetInfo, { NetInfoState } from '@react-native-community/netinfo';\n\nimport { haptics } from '@/lib/haptics';\nimport { api } from '@/lib/api';\n\n// Queue item types\nexport type QueuedActionType = \n  | 'create_post'\n  | 'edit_post'\n  | 'delete_post'\n  | 'create_comment'\n  | 'edit_comment'\n  | 'delete_comment'\n  | 'like'\n  | 'unlike'\n  | 'bookmark'\n  | 'unbookmark'\n  | 'follow'\n  | 'unfollow'\n  | 'send_message'\n  | 'mark_read'\n  | 'vote_poll';\n\n// Queued action\nexport interface QueuedAction {\n  id: string;\n  type: QueuedActionType;\n  payload: any;\n  timestamp: string;\n  retryCount: number;\n  maxRetries: number;\n  priority: number; // Lower = higher priority\n}\n\n// Sync result\nexport interface SyncResult {\n  success: boolean;\n  actionId: string;\n  error?: string;\n}\n\n// Storage key\nconst QUEUE_STORAGE_KEY = 'offline_action_queue';\n\n// Action configurations\nconst ACTION_CONFIG: Record<QueuedActionType, { endpoint: string; method: string; priority: number }> = {\n  create_post: { endpoint: '/posts', method: 'POST', priority: 1 },\n  edit_post: { endpoint: '/posts/:id', method: 'PUT', priority: 2 },\n  delete_post: { endpoint: '/posts/:id', method: 'DELETE', priority: 3 },\n  create_comment: { endpoint: '/posts/:postId/comments', method: 'POST', priority: 1 },\n  edit_comment: { endpoint: '/comments/:id', method: 'PUT', priority: 2 },\n  delete_comment: { endpoint: '/comments/:id', method: 'DELETE', priority: 3 },\n  like: { endpoint: '/posts/:id/like', method: 'POST', priority: 4 },\n  unlike: { endpoint: '/posts/:id/like', method: 'DELETE', priority: 4 },\n  bookmark: { endpoint: '/posts/:id/bookmark', method: 'POST', priority: 4 },\n  unbookmark: { endpoint: '/posts/:id/bookmark', method: 'DELETE', priority: 4 },\n  follow: { endpoint: '/users/:id/follow', method: 'POST', priority: 3 },\n  unfollow: { endpoint: '/users/:id/follow', method: 'DELETE', priority: 3 },\n  send_message: { endpoint: '/conversations/:id/messages', method: 'POST', priority: 1 },\n  mark_read: { endpoint: '/conversations/:id/read', method: 'POST', priority: 5 },\n  vote_poll: { endpoint: '/posts/:postId/polls/:pollId/vote', method: 'POST', priority: 2 },\n};\n\n/**\n * Offline Queue Service\n */\nclass OfflineQueueService {\n  private queue: QueuedAction[] = [];\n  private isOnline: boolean = true;\n  private isSyncing: boolean = false;\n  private loaded: boolean = false;\n  private listeners: Set<(queue: QueuedAction[]) => void> = new Set();\n  private unsubscribeNetInfo: (() => void) | null = null;\n\n  /**\n   * Initialize the service\n   */\n  async initialize(): Promise<void> {\n    if (this.loaded) return;\n\n    // Load queue from storage\n    await this.loadQueue();\n\n    // Subscribe to network state\n    this.unsubscribeNetInfo = NetInfo.addEventListener(this.handleNetworkChange);\n\n    // Check initial network state\n    const state = await NetInfo.fetch();\n    this.isOnline = state.isConnected ?? true;\n\n    // Sync if online and have queued items\n    if (this.isOnline && this.queue.length > 0) {\n      this.syncQueue();\n    }\n\n    this.loaded = true;\n  }\n\n  /**\n   * Handle network state changes\n   */\n  private handleNetworkChange = (state: NetInfoState) => {\n    const wasOffline = !this.isOnline;\n    this.isOnline = state.isConnected ?? true;\n\n    // Came back online - sync queue\n    if (wasOffline && this.isOnline && this.queue.length > 0) {\n      console.log('[OfflineQueue] Back online, syncing queue...');\n      this.syncQueue();\n    }\n  };\n\n  /**\n   * Load queue from storage\n   */\n  private async loadQueue(): Promise<void> {\n    try {\n      const stored = await AsyncStorage.getItem(QUEUE_STORAGE_KEY);\n      if (stored) {\n        this.queue = JSON.parse(stored);\n        this.notifyListeners();\n      }\n    } catch (error) {\n      console.error('[OfflineQueue] Error loading queue:', error);\n    }\n  }\n\n  /**\n   * Save queue to storage\n   */\n  private async saveQueue(): Promise<void> {\n    try {\n      await AsyncStorage.setItem(QUEUE_STORAGE_KEY, JSON.stringify(this.queue));\n    } catch (error) {\n      console.error('[OfflineQueue] Error saving queue:', error);\n    }\n  }\n\n  /**\n   * Generate unique ID\n   */\n  private generateId(): string {\n    return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Add action to queue\n   */\n  async enqueue(type: QueuedActionType, payload: any): Promise<string> {\n    const config = ACTION_CONFIG[type];\n    \n    const action: QueuedAction = {\n      id: this.generateId(),\n      type,\n      payload,\n      timestamp: new Date().toISOString(),\n      retryCount: 0,\n      maxRetries: 3,\n      priority: config.priority,\n    };\n\n    // Add to queue sorted by priority\n    this.queue.push(action);\n    this.queue.sort((a, b) => a.priority - b.priority);\n\n    await this.saveQueue();\n    this.notifyListeners();\n\n    console.log(`[OfflineQueue] Enqueued action: ${type}`, action.id);\n\n    // Try to execute immediately if online\n    if (this.isOnline && !this.isSyncing) {\n      this.syncQueue();\n    }\n\n    return action.id;\n  }\n\n  /**\n   * Remove action from queue\n   */\n  async dequeue(actionId: string): Promise<void> {\n    this.queue = this.queue.filter(a => a.id !== actionId);\n    await this.saveQueue();\n    this.notifyListeners();\n  }\n\n  /**\n   * Sync queue with server\n   */\n  async syncQueue(): Promise<SyncResult[]> {\n    if (this.isSyncing || !this.isOnline || this.queue.length === 0) {\n      return [];\n    }\n\n    this.isSyncing = true;\n    const results: SyncResult[] = [];\n\n    console.log(`[OfflineQueue] Syncing ${this.queue.length} actions...`);\n\n    // Process queue in order\n    const queueCopy = [...this.queue];\n\n    for (const action of queueCopy) {\n      const result = await this.executeAction(action);\n      results.push(result);\n\n      if (result.success) {\n        await this.dequeue(action.id);\n      } else if (action.retryCount >= action.maxRetries) {\n        // Max retries reached, remove from queue\n        console.warn(`[OfflineQueue] Max retries reached for action ${action.id}`);\n        await this.dequeue(action.id);\n      } else {\n        // Increment retry count\n        action.retryCount++;\n        await this.saveQueue();\n      }\n    }\n\n    this.isSyncing = false;\n\n    if (results.some(r => r.success)) {\n      haptics.success();\n    }\n\n    console.log(`[OfflineQueue] Sync complete. ${results.filter(r => r.success).length}/${results.length} successful`);\n\n    return results;\n  }\n\n  /**\n   * Execute a single queued action\n   */\n  private async executeAction(action: QueuedAction): Promise<SyncResult> {\n    const config = ACTION_CONFIG[action.type];\n    \n    try {\n      // Build endpoint with params\n      let endpoint = config.endpoint;\n      const payload = { ...action.payload };\n\n      // Replace URL params\n      endpoint = endpoint.replace(/:(\\w+)/g, (_, key) => {\n        const value = payload[key];\n        delete payload[key];\n        return value;\n      });\n\n      // Make request\n      let response;\n      switch (config.method) {\n        case 'POST':\n          response = await api.post(endpoint, payload);\n          break;\n        case 'PUT':\n          response = await api.put(endpoint, payload);\n          break;\n        case 'DELETE':\n          response = await api.delete(endpoint);\n          break;\n        default:\n          throw new Error(`Unknown method: ${config.method}`);\n      }\n\n      console.log(`[OfflineQueue] Action ${action.id} executed successfully`);\n\n      return {\n        success: true,\n        actionId: action.id,\n      };\n    } catch (error: any) {\n      console.error(`[OfflineQueue] Action ${action.id} failed:`, error);\n\n      return {\n        success: false,\n        actionId: action.id,\n        error: error.message || 'Unknown error',\n      };\n    }\n  }\n\n  /**\n   * Get queue status\n   */\n  getQueueStatus(): { count: number; isOnline: boolean; isSyncing: boolean } {\n    return {\n      count: this.queue.length,\n      isOnline: this.isOnline,\n      isSyncing: this.isSyncing,\n    };\n  }\n\n  /**\n   * Get all queued actions\n   */\n  getQueue(): QueuedAction[] {\n    return [...this.queue];\n  }\n\n  /**\n   * Clear all queued actions\n   */\n  async clearQueue(): Promise<void> {\n    this.queue = [];\n    await AsyncStorage.removeItem(QUEUE_STORAGE_KEY);\n    this.notifyListeners();\n  }\n\n  /**\n   * Subscribe to queue changes\n   */\n  subscribe(listener: (queue: QueuedAction[]) => void): () => void {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  /**\n   * Notify all listeners\n   */\n  private notifyListeners(): void {\n    this.listeners.forEach(listener => listener([...this.queue]));\n  }\n\n  /**\n   * Check if online\n   */\n  isNetworkOnline(): boolean {\n    return this.isOnline;\n  }\n\n  /**\n   * Cleanup\n   */\n  destroy(): void {\n    if (this.unsubscribeNetInfo) {\n      this.unsubscribeNetInfo();\n    }\n  }\n}\n\nexport const offlineQueueService = new OfflineQueueService();\n\n// =============================================================================\n// HOOKS\n// =============================================================================\n\n/**\n * Hook to manage offline queue\n */\nexport function useOfflineQueue() {\n  const [queue, setQueue] = useState<QueuedAction[]>([]);\n  const [isOnline, setIsOnline] = useState(true);\n  const [isSyncing, setIsSyncing] = useState(false);\n\n  useEffect(() => {\n    // Initialize service\n    offlineQueueService.initialize();\n\n    // Subscribe to queue changes\n    const unsubscribe = offlineQueueService.subscribe(setQueue);\n\n    // Subscribe to network changes\n    const unsubscribeNetInfo = NetInfo.addEventListener((state) => {\n      setIsOnline(state.isConnected ?? true);\n    });\n\n    // Update initial state\n    const status = offlineQueueService.getQueueStatus();\n    setQueue(offlineQueueService.getQueue());\n    setIsOnline(status.isOnline);\n    setIsSyncing(status.isSyncing);\n\n    return () => {\n      unsubscribe();\n      unsubscribeNetInfo();\n    };\n  }, []);\n\n  const enqueue = useCallback(async (type: QueuedActionType, payload: any) => {\n    return offlineQueueService.enqueue(type, payload);\n  }, []);\n\n  const syncNow = useCallback(async () => {\n    setIsSyncing(true);\n    const results = await offlineQueueService.syncQueue();\n    setIsSyncing(false);\n    return results;\n  }, []);\n\n  const clearQueue = useCallback(async () => {\n    await offlineQueueService.clearQueue();\n  }, []);\n\n  return {\n    queue,\n    queueCount: queue.length,\n    isOnline,\n    isSyncing,\n    enqueue,\n    syncNow,\n    clearQueue,\n  };\n}\n\n/**\n * Hook for offline-aware actions\n * Automatically queues actions when offline\n */\nexport function useOfflineAction<T>(\n  type: QueuedActionType,\n  onlineAction: (payload: T) => Promise<any>,\n  options?: {\n    onQueued?: (actionId: string) => void;\n    onSynced?: (result: any) => void;\n    onError?: (error: any) => void;\n  }\n) {\n  const { isOnline, enqueue } = useOfflineQueue();\n\n  const execute = useCallback(async (payload: T) => {\n    if (isOnline) {\n      try {\n        const result = await onlineAction(payload);\n        options?.onSynced?.(result);\n        return result;\n      } catch (error) {\n        options?.onError?.(error);\n        throw error;\n      }\n    } else {\n      // Offline - queue the action\n      const actionId = await enqueue(type, payload);\n      options?.onQueued?.(actionId);\n      haptics.warning();\n      return { queued: true, actionId };\n    }\n  }, [isOnline, type, onlineAction, enqueue, options]);\n\n  return {\n    execute,\n    isOnline,\n  };\n}\n\n// =============================================================================\n// OFFLINE INDICATOR COMPONENT\n// =============================================================================\n\nimport React, { memo } from 'react';\nimport { Animated, StyleSheet as RNStyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\n\ninterface OfflineIndicatorProps {\n  showQueueCount?: boolean;\n}\n\nexport const OfflineIndicator = memo(function OfflineIndicator({\n  showQueueCount = true,\n}: OfflineIndicatorProps) {\n  const { isOnline, queueCount } = useOfflineQueue();\n  const translateY = React.useRef(new Animated.Value(-50)).current;\n\n  React.useEffect(() => {\n    Animated.spring(translateY, {\n      toValue: isOnline ? -50 : 0,\n      friction: 8,\n      tension: 100,\n      useNativeDriver: true,\n    }).start();\n  }, [isOnline]);\n\n  return (\n    <Animated.View\n      style={[\n        offlineStyles.container,\n        { transform: [{ translateY }] },\n      ]}\n    >\n      <Ionicons name=\"cloud-offline-outline\" size={16} color=\"white\" />\n      <ThemedText style={offlineStyles.text}>\n        You're offline\n        {showQueueCount && queueCount > 0 && ` ‚Ä¢ ${queueCount} pending`}\n      </ThemedText>\n    </Animated.View>\n  );\n});\n\nimport { ThemedText } from '@/components/ThemedText';\n\nconst offlineStyles = RNStyleSheet.create({\n  container: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    backgroundColor: Colors.warning,\n    paddingVertical: 8,\n    paddingHorizontal: 16,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n    zIndex: 1000,\n  },\n  text: {\n    color: 'white',\n    fontSize: 13,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":13412,"size_tokens":null},"server/routes/posts.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { authMiddleware, optionalAuthMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\nconst ROOMS = [\n  { id: 1, name: 'Cardiology', slug: 'cardiology', description: 'Heart health and cardiovascular innovations', icon: 'heart', color: '#EF4444', posts_count: 1243, members_count: 8521 },\n  { id: 2, name: 'Oncology', slug: 'oncology', description: 'Cancer research and treatment advances', icon: 'activity', color: '#8B5CF6', posts_count: 987, members_count: 6234 },\n  { id: 3, name: 'Neurology', slug: 'neurology', description: 'Brain and nervous system innovations', icon: 'cpu', color: '#3B82F6', posts_count: 756, members_count: 5102 },\n  { id: 4, name: 'Digital Health', slug: 'digital-health', description: 'Health tech and digital therapeutics', icon: 'smartphone', color: '#10B981', posts_count: 1567, members_count: 9876 },\n  { id: 5, name: 'Biotech', slug: 'biotech', description: 'Biotechnology breakthroughs', icon: 'flask-conical', color: '#F59E0B', posts_count: 892, members_count: 7234 },\n  { id: 6, name: 'Medical Devices', slug: 'medical-devices', description: 'Innovative medical equipment', icon: 'stethoscope', color: '#06B6D4', posts_count: 654, members_count: 4521 },\n];\n\nconst generateMockPosts = (count: number, roomId?: number) => {\n  const authors = [\n    { id: 1, first_name: 'Sarah', last_name: 'Chen', full_name: 'Dr. Sarah Chen', specialty: 'Cardiologist', avatar_url: null, is_verified: true, is_premium: true },\n    { id: 2, first_name: 'Michael', last_name: 'Roberts', full_name: 'Dr. Michael Roberts', specialty: 'Oncologist', avatar_url: null, is_verified: true, is_premium: false },\n    { id: 3, first_name: 'Emily', last_name: 'Thompson', full_name: 'Emily Thompson, RN', specialty: 'Nurse Practitioner', avatar_url: null, is_verified: false, is_premium: true },\n    { id: 4, first_name: 'James', last_name: 'Wilson', full_name: 'James Wilson, PhD', specialty: 'Researcher', avatar_url: null, is_verified: true, is_premium: false },\n  ];\n\n  const contents = [\n    'Just reviewed the latest clinical trial data for the new CRISPR-based therapy. The results are incredibly promising for treating genetic disorders. This could be a game-changer for patients with rare diseases. #CRISPR #GeneTherapy',\n    'Interesting discussion at the conference today about AI-powered diagnostic tools. The accuracy rates are now exceeding human specialists in certain areas. What are your thoughts on AI in healthcare? #DigitalHealth #AI',\n    'New FDA approval for the minimally invasive cardiac device shows 40% improvement in patient outcomes. This is exactly the kind of innovation we need to invest in. #CardiacCare #MedTech',\n    'The biotech sector is seeing unprecedented growth in personalized medicine. Companies focusing on targeted therapies are showing exceptional promise. #Biotech #PersonalizedMedicine',\n    'Great webinar on medical device regulations and the new EU MDR requirements. Compliance is becoming increasingly complex but necessary for patient safety. #MedicalDevices #Regulatory',\n  ];\n\n  return Array.from({ length: count }, (_, i) => {\n    const author = authors[i % authors.length];\n    const room = roomId ? ROOMS.find(r => r.id === roomId) : ROOMS[i % ROOMS.length];\n    return {\n      id: i + 1,\n      content: contents[i % contents.length],\n      author,\n      room: room ? { ...room, is_member: true } : null,\n      images: [],\n      video_url: null,\n      is_anonymous: false,\n      mentions: [],\n      hashtags: contents[i % contents.length].match(/#\\w+/g) || [],\n      upvotes: Math.floor(Math.random() * 100) + 10,\n      downvotes: Math.floor(Math.random() * 10),\n      comments_count: Math.floor(Math.random() * 50),\n      user_vote: null,\n      is_bookmarked: false,\n      feed_score: Math.random() * 100,\n      created_at: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString(),\n      updated_at: new Date().toISOString(),\n    };\n  });\n};\n\nrouter.get('/feed', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { cursor, style = 'algorithmic', limit = 20 } = req.query;\n    const posts = generateMockPosts(Number(limit));\n    \n    res.json({\n      posts,\n      has_more: true,\n      next_cursor: 'next_page_token',\n      feed_style: style,\n    });\n  } catch (error) {\n    console.error('Feed error:', error);\n    res.status(500).json({ error: 'Failed to fetch feed' });\n  }\n});\n\nrouter.get('/feed/trending', async (req: Request, res: Response) => {\n  try {\n    const topics = [\n      { hashtag: 'CRISPR', count: 1234, trend: 'up' },\n      { hashtag: 'DigitalHealth', count: 987, trend: 'up' },\n      { hashtag: 'AI', count: 876, trend: 'stable' },\n      { hashtag: 'Biotech', count: 654, trend: 'up' },\n      { hashtag: 'MedTech', count: 543, trend: 'down' },\n    ];\n    res.json({ topics });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch trending topics' });\n  }\n});\n\nrouter.get('/:id', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const posts = generateMockPosts(1);\n    const post = { ...posts[0], id: parseInt(id) };\n    res.json(post);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch post' });\n  }\n});\n\nrouter.post('/', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { content, room_id, is_anonymous = false, images = [] } = req.body;\n    const userId = (req as any).userId;\n\n    if (!content || content.trim().length === 0) {\n      return res.status(400).json({ error: 'Content is required' });\n    }\n\n    const room = ROOMS.find(r => r.id === room_id);\n    const post = {\n      id: Date.now(),\n      content,\n      author: {\n        id: userId,\n        first_name: 'Current',\n        last_name: 'User',\n        full_name: 'Current User',\n        specialty: 'Healthcare Professional',\n        avatar_url: null,\n        is_verified: false,\n        is_premium: false,\n      },\n      room: room ? { ...room, is_member: true } : null,\n      images,\n      video_url: null,\n      is_anonymous,\n      mentions: content.match(/@\\w+/g) || [],\n      hashtags: content.match(/#\\w+/g) || [],\n      upvotes: 0,\n      downvotes: 0,\n      comments_count: 0,\n      user_vote: null,\n      is_bookmarked: false,\n      feed_score: 0,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    };\n\n    res.status(201).json(post);\n  } catch (error) {\n    console.error('Create post error:', error);\n    res.status(500).json({ error: 'Failed to create post' });\n  }\n});\n\nrouter.put('/:id', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const { content } = req.body;\n    \n    const posts = generateMockPosts(1);\n    const post = { \n      ...posts[0], \n      id: parseInt(id),\n      content,\n      updated_at: new Date().toISOString(),\n    };\n    \n    res.json(post);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update post' });\n  }\n});\n\nrouter.delete('/:id', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete post' });\n  }\n});\n\nrouter.post('/:id/vote', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { direction } = req.body;\n    res.json({ \n      upvotes: direction === 'up' ? 51 : 50, \n      downvotes: direction === 'down' ? 6 : 5 \n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to vote' });\n  }\n});\n\nrouter.delete('/:id/vote', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ upvotes: 50, downvotes: 5 });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to remove vote' });\n  }\n});\n\nrouter.post('/:id/bookmark', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ success: true, is_bookmarked: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to bookmark' });\n  }\n});\n\nrouter.delete('/:id/bookmark', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ success: true, is_bookmarked: false });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to remove bookmark' });\n  }\n});\n\nrouter.get('/:postId/comments', async (req: Request, res: Response) => {\n  try {\n    const comments = [\n      {\n        id: 1,\n        content: 'Great insights! The implications for patient care are significant.',\n        author: { id: 2, first_name: 'John', last_name: 'Doe', full_name: 'Dr. John Doe', specialty: 'Surgeon', avatar_url: null, is_verified: true },\n        post_id: parseInt(req.params.postId),\n        parent_id: null,\n        upvotes: 12,\n        downvotes: 0,\n        user_vote: null,\n        replies_count: 2,\n        created_at: new Date(Date.now() - 3600000).toISOString(),\n      },\n      {\n        id: 2,\n        content: 'I agree, this technology could revolutionize how we approach treatment.',\n        author: { id: 3, first_name: 'Jane', last_name: 'Smith', full_name: 'Jane Smith, PhD', specialty: 'Researcher', avatar_url: null, is_verified: false },\n        post_id: parseInt(req.params.postId),\n        parent_id: null,\n        upvotes: 8,\n        downvotes: 1,\n        user_vote: null,\n        replies_count: 0,\n        created_at: new Date(Date.now() - 1800000).toISOString(),\n      },\n    ];\n    res.json({ comments });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch comments' });\n  }\n});\n\nrouter.post('/:postId/comments', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { content, parent_id } = req.body;\n    const userId = (req as any).userId;\n\n    const comment = {\n      id: Date.now(),\n      content,\n      author: { id: userId, first_name: 'Current', last_name: 'User', full_name: 'Current User', specialty: 'Healthcare Professional', avatar_url: null, is_verified: false },\n      post_id: parseInt(req.params.postId),\n      parent_id: parent_id || null,\n      upvotes: 0,\n      downvotes: 0,\n      user_vote: null,\n      replies_count: 0,\n      created_at: new Date().toISOString(),\n    };\n\n    res.status(201).json(comment);\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to add comment' });\n  }\n});\n\nrouter.delete('/:postId/comments/:commentId', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to delete comment' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":10574,"size_tokens":null},"client/hooks/useTheme.ts":{"content":"import { Colors } from \"@/constants/theme\";\nimport { useThemeContext } from \"@/contexts/ThemeContext\";\n\nexport function useTheme() {\n  const { isDark } = useThemeContext();\n  const theme = Colors[isDark ? \"dark\" : \"light\"];\n\n  return {\n    theme,\n    isDark,\n  };\n}\n","path":null,"size_bytes":266,"size_tokens":null},"client/components/HeaderTitle.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Image } from \"react-native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Spacing } from \"@/constants/theme\";\n\ninterface HeaderTitleProps {\n  title: string;\n}\n\nexport function HeaderTitle({ title }: HeaderTitleProps) {\n  return (\n    <View style={styles.container}>\n      <Image\n        source={require(\"../../assets/images/icon.png\")}\n        style={styles.icon}\n        resizeMode=\"contain\"\n      />\n      <ThemedText style={styles.title}>{title}</ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n  icon: {\n    width: 28,\n    height: 28,\n    marginRight: Spacing.sm,\n  },\n  title: {\n    fontSize: 17,\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":832,"size_tokens":null},"server/db/index.ts":{"content":"import { drizzle } from 'drizzle-orm/postgres-js';\nimport postgres from 'postgres';\nimport * as schema from './schema';\n\n// Database connection string from environment\nconst connectionString = process.env.DATABASE_URL!;\n\n// Create postgres client\nconst client = postgres(connectionString, {\n  max: 10, // Maximum number of connections\n  idle_timeout: 20,\n  connect_timeout: 10,\n});\n\n// Create drizzle database instance with schema\nexport const db = drizzle(client, { schema });\n\n// Export schema for use in queries\nexport * from './schema';\n\n// Export type for database instance\nexport type Database = typeof db;\n","path":null,"size_bytes":613,"size_tokens":null},"client/screens/DealDetailScreen.tsx":{"content":"/**\n * DealDetail Screen\n * View investment deal details and invest\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n  Linking,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { dealsApi } from '@/lib/api';\nimport { Deal } from '@/types';\nimport { formatCurrency, formatNumber, formatDate } from '@/lib/utils';\n\ntype DealDetailRouteParams = {\n  DealDetail: {\n    dealId: number;\n  };\n};\n\nexport default function DealDetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<DealDetailRouteParams, 'DealDetail'>>();\n  const { dealId } = route.params;\n  const appColors = useAppColors();\n\n  const {\n    data: deal,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['deal', dealId],\n    queryFn: async () => {\n      const response = await dealsApi.getDeal(dealId);\n      return response.data;\n    },\n  });\n\n  const handleInvest = useCallback(() => {\n    if (deal?.investment_url) {\n      Linking.openURL(deal.investment_url);\n    }\n  }, [deal]);\n\n  const handleDocumentPress = useCallback((url: string) => {\n    Linking.openURL(url);\n  }, []);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'open': return Colors.secondary;\n      case 'closing_soon': return appColors.warning;\n      case 'funded': return Colors.primary;\n      case 'closed': return appColors.textSecondary;\n      default: return Colors.primary;\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'open': return 'Open for Investment';\n      case 'closing_soon': return 'Closing Soon';\n      case 'funded': return 'Fully Funded';\n      case 'closed': return 'Closed';\n      default: return status;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  if (!deal) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ThemedText>Deal not found</ThemedText>\n      </SafeAreaView>\n    );\n  }\n\n  const fundingProgress = (deal.raised_amount / deal.funding_goal) * 100;\n  const daysLeft = deal.closing_date \n    ? Math.max(0, Math.ceil((new Date(deal.closing_date).getTime() - Date.now()) / (1000 * 60 * 60 * 24)))\n    : null;\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Deal Details</ThemedText>\n        <TouchableOpacity style={styles.shareButton}>\n          <Ionicons name=\"share-outline\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Company Header */}\n        <View style={[styles.companyHeader, { backgroundColor: appColors.surface }]}>\n          {deal.company_logo ? (\n            <Image source={{ uri: deal.company_logo }} style={styles.companyLogo} />\n          ) : (\n            <View style={[styles.companyLogo, styles.logoPlaceholder]}>\n              <MaterialCommunityIcons name=\"domain\" size={32} color={Colors.primary} />\n            </View>\n          )}\n          <View style={styles.companyInfo}>\n            <ThemedText style={[styles.companyName, { color: appColors.textPrimary }]}>{deal.company_name}</ThemedText>\n            <View style={styles.categoryBadge}>\n              <ThemedText style={styles.categoryText}>{deal.category}</ThemedText>\n            </View>\n          </View>\n          <View style={[styles.statusBadge, { backgroundColor: getStatusColor(deal.status) + '20' }]}>\n            <ThemedText style={[styles.statusText, { color: getStatusColor(deal.status) }]}>\n              {getStatusText(deal.status)}\n            </ThemedText>\n          </View>\n        </View>\n\n        {/* Key Metrics */}\n        <View style={[styles.metricsCard, { backgroundColor: appColors.surface }]}>\n          <View style={styles.metricRow}>\n            <View style={styles.metricItem}>\n              <ThemedText style={[styles.metricLabel, { color: appColors.textSecondary }]}>Funding Goal</ThemedText>\n              <ThemedText style={[styles.metricValue, { color: appColors.textPrimary }]}>\n                {formatCurrency(deal.funding_goal)}\n              </ThemedText>\n            </View>\n            <View style={[styles.metricDivider, { backgroundColor: appColors.border }]} />\n            <View style={styles.metricItem}>\n              <ThemedText style={[styles.metricLabel, { color: appColors.textSecondary }]}>Raised</ThemedText>\n              <ThemedText style={[styles.metricValue, { color: Colors.secondary }]}>\n                {formatCurrency(deal.raised_amount)}\n              </ThemedText>\n            </View>\n          </View>\n\n          {/* Progress Bar */}\n          <View style={styles.progressContainer}>\n            <View style={styles.progressBar}>\n              <View style={[styles.progressFill, { width: `${Math.min(fundingProgress, 100)}%` }]} />\n            </View>\n            <ThemedText style={[styles.progressText, { color: appColors.textSecondary }]}>{Math.round(fundingProgress)}% funded</ThemedText>\n          </View>\n\n          <View style={styles.metricRow}>\n            <View style={styles.metricItem}>\n              <ThemedText style={[styles.metricLabel, { color: appColors.textSecondary }]}>Min Investment</ThemedText>\n              <ThemedText style={[styles.metricValue, { color: appColors.textPrimary }]}>\n                {formatCurrency(deal.min_investment)}\n              </ThemedText>\n            </View>\n            <View style={[styles.metricDivider, { backgroundColor: appColors.border }]} />\n            <View style={styles.metricItem}>\n              <ThemedText style={[styles.metricLabel, { color: appColors.textSecondary }]}>Investors</ThemedText>\n              <ThemedText style={[styles.metricValue, { color: appColors.textPrimary }]}>\n                {formatNumber(deal.investors_count)}\n              </ThemedText>\n            </View>\n            {daysLeft !== null && (\n              <>\n                <View style={[styles.metricDivider, { backgroundColor: appColors.border }]} />\n                <View style={styles.metricItem}>\n                  <ThemedText style={[styles.metricLabel, { color: appColors.textSecondary }]}>Days Left</ThemedText>\n                  <ThemedText style={[styles.metricValue, { color: appColors.textPrimary }, daysLeft < 7 && { color: appColors.warning }]}>\n                    {daysLeft}\n                  </ThemedText>\n                </View>\n              </>\n            )}\n          </View>\n        </View>\n\n        {/* Description */}\n        <View style={[styles.section, { backgroundColor: appColors.surface }]}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>About</ThemedText>\n          <ThemedText style={[styles.descriptionText, { color: appColors.textSecondary }]}>{deal.description}</ThemedText>\n        </View>\n\n        {/* Highlights */}\n        {deal.highlights && deal.highlights.length > 0 && (\n          <View style={[styles.section, { backgroundColor: appColors.surface }]}>\n            <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Investment Highlights</ThemedText>\n            {deal.highlights.map((highlight, index) => (\n              <View key={index} style={styles.highlightItem}>\n                <Ionicons name=\"checkmark-circle\" size={20} color={Colors.secondary} />\n                <ThemedText style={[styles.highlightText, { color: appColors.textPrimary }]}>{highlight}</ThemedText>\n              </View>\n            ))}\n          </View>\n        )}\n\n        {/* Team */}\n        {deal.team && deal.team.length > 0 && (\n          <View style={[styles.section, { backgroundColor: appColors.surface }]}>\n            <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Leadership Team</ThemedText>\n            {deal.team.map((member, index) => (\n              <View key={index} style={[styles.teamMember, { borderBottomColor: appColors.border }]}>\n                {member.avatar_url ? (\n                  <Image source={{ uri: member.avatar_url }} style={styles.teamAvatar} />\n                ) : (\n                  <View style={[styles.teamAvatar, styles.teamAvatarPlaceholder]}>\n                    <ThemedText style={styles.teamAvatarText}>\n                      {member.name.split(' ').map(n => n[0]).join('')}\n                    </ThemedText>\n                  </View>\n                )}\n                <View style={styles.teamInfo}>\n                  <ThemedText style={[styles.teamName, { color: appColors.textPrimary }]}>{member.name}</ThemedText>\n                  <ThemedText style={[styles.teamRole, { color: appColors.textSecondary }]}>{member.role}</ThemedText>\n                </View>\n              </View>\n            ))}\n          </View>\n        )}\n\n        {/* Documents */}\n        {deal.documents && deal.documents.length > 0 && (\n          <View style={[styles.section, { backgroundColor: appColors.surface }]}>\n            <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Documents</ThemedText>\n            {deal.documents.map((doc, index) => (\n              <TouchableOpacity\n                key={index}\n                style={[styles.documentItem, { borderBottomColor: appColors.border }]}\n                onPress={() => handleDocumentPress(doc.url)}\n              >\n                <View style={styles.documentIcon}>\n                  <Ionicons name=\"document-text-outline\" size={24} color={Colors.primary} />\n                </View>\n                <View style={styles.documentInfo}>\n                  <ThemedText style={[styles.documentName, { color: appColors.textPrimary }]}>{doc.name}</ThemedText>\n                  <ThemedText style={[styles.documentType, { color: appColors.textSecondary }]}>{doc.type}</ThemedText>\n                </View>\n                <Ionicons name=\"download-outline\" size={20} color={appColors.textSecondary} />\n              </TouchableOpacity>\n            ))}\n          </View>\n        )}\n\n        {/* Risk Disclosure */}\n        <View style={styles.riskSection}>\n          <View style={styles.riskHeader}>\n            <Ionicons name=\"warning-outline\" size={20} color={appColors.warning} />\n            <ThemedText style={[styles.riskTitle, { color: appColors.warning }]}>Risk Disclosure</ThemedText>\n          </View>\n          <ThemedText style={[styles.riskText, { color: appColors.textSecondary }]}>\n            Investing in startups and early-stage companies involves substantial risk, including \n            the risk of loss of your entire investment. Past performance is not indicative of \n            future results. Please invest responsibly and consult with a financial advisor.\n          </ThemedText>\n        </View>\n      </ScrollView>\n\n      {/* Invest Button */}\n      {deal.status === 'open' || deal.status === 'closing_soon' ? (\n        <View style={[styles.footer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <View style={styles.footerInfo}>\n            <ThemedText style={[styles.footerLabel, { color: appColors.textSecondary }]}>Min Investment</ThemedText>\n            <ThemedText style={[styles.footerValue, { color: appColors.textPrimary }]}>{formatCurrency(deal.min_investment)}</ThemedText>\n          </View>\n          <TouchableOpacity style={styles.investButton} onPress={handleInvest}>\n            <LinearGradient\n              colors={[Colors.primary, Colors.secondary]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 0 }}\n              style={styles.investGradient}\n            >\n              <ThemedText style={styles.investButtonText}>Invest Now</ThemedText>\n              <Ionicons name=\"arrow-forward\" size={20} color=\"white\" />\n            </LinearGradient>\n          </TouchableOpacity>\n        </View>\n      ) : null}\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  shareButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  companyHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n  },\n  companyLogo: {\n    width: 64,\n    height: 64,\n    borderRadius: BorderRadius.md,\n    marginRight: Spacing.md,\n  },\n  logoPlaceholder: {\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  companyInfo: {\n    flex: 1,\n  },\n  companyName: {\n    ...Typography.title,\n  },\n  categoryBadge: {\n    alignSelf: 'flex-start',\n    backgroundColor: Colors.primary + '15',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.full,\n    marginTop: Spacing.xs,\n  },\n  categoryText: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  statusBadge: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n  },\n  statusText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  metricsCard: {\n    margin: Spacing.md,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  metricRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  metricItem: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  metricDivider: {\n    width: 1,\n    height: 40,\n  },\n  metricLabel: {\n    ...Typography.small,\n  },\n  metricValue: {\n    ...Typography.heading,\n    marginTop: 2,\n  },\n  progressContainer: {\n    marginVertical: Spacing.lg,\n  },\n  progressBar: {\n    height: 8,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: 4,\n    marginBottom: Spacing.xs,\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: Colors.secondary,\n    borderRadius: 4,\n  },\n  progressText: {\n    ...Typography.small,\n    textAlign: 'center',\n  },\n  section: {\n    padding: Spacing.lg,\n    marginTop: Spacing.md,\n  },\n  sectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.md,\n  },\n  descriptionText: {\n    ...Typography.body,\n    lineHeight: 24,\n  },\n  highlightItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.md,\n    gap: Spacing.sm,\n  },\n  highlightText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  teamMember: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  teamAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  teamAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  teamAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  teamInfo: {\n    flex: 1,\n  },\n  teamName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  teamRole: {\n    ...Typography.caption,\n  },\n  documentItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  documentIcon: {\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.sm,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  documentInfo: {\n    flex: 1,\n  },\n  documentName: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  documentType: {\n    ...Typography.small,\n  },\n  riskSection: {\n    margin: Spacing.md,\n    padding: Spacing.lg,\n    backgroundColor: Colors.warning + '10',\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    borderColor: Colors.warning + '30',\n    marginBottom: Spacing.xl,\n  },\n  riskHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n    marginBottom: Spacing.sm,\n  },\n  riskTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n  },\n  riskText: {\n    ...Typography.small,\n    lineHeight: 20,\n  },\n  footer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  footerInfo: {\n    marginRight: Spacing.lg,\n  },\n  footerLabel: {\n    ...Typography.small,\n  },\n  footerValue: {\n    ...Typography.heading,\n  },\n  investButton: {\n    flex: 1,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.button,\n  },\n  investGradient: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.md,\n    gap: Spacing.sm,\n  },\n  investButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '700',\n  },\n});\n","path":null,"size_bytes":18233,"size_tokens":null},"client/screens/NewConversationScreen.tsx":{"content":"/**\n * NewConversation Screen\n * Start a new direct message conversation\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  TextInput,\n  Image,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi, searchApi } from '@/lib/api';\nimport { User } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { debounce } from '@/lib/utils';\n\nexport default function NewConversationScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { user: currentUser } = useAuth();\n  \n  const [searchQuery, setSearchQuery] = useState('');\n  const [debouncedQuery, setDebouncedQuery] = useState('');\n\n  const handleSearch = useCallback(\n    debounce((query: string) => {\n      setDebouncedQuery(query);\n    }, 300),\n    []\n  );\n\n  const handleQueryChange = (text: string) => {\n    setSearchQuery(text);\n    handleSearch(text);\n  };\n\n  const { data: suggestedData, isLoading: suggestedLoading, error: suggestedError } = useQuery({\n    queryKey: ['exploreUsers'],\n    queryFn: async () => {\n      console.log('Fetching explore users...');\n      const response = await usersApi.explore();\n      console.log('Explore response:', response);\n      return response.data?.users || [];\n    },\n    enabled: !debouncedQuery,\n  });\n\n  console.log('suggestedData:', suggestedData, 'error:', suggestedError, 'loading:', suggestedLoading);\n\n  const { data: searchResults, isLoading: searchLoading } = useQuery({\n    queryKey: ['searchUsers', debouncedQuery],\n    queryFn: async () => {\n      const response = await usersApi.search(debouncedQuery);\n      return response.data?.users || [];\n    },\n    enabled: debouncedQuery.length > 0,\n  });\n\n  const users = debouncedQuery ? searchResults : suggestedData;\n  const isLoading = debouncedQuery ? searchLoading : suggestedLoading;\n\n  const handleUserPress = useCallback((userId: string | number) => {\n    navigation.replace('Conversation', { userId: String(userId) });\n  }, [navigation]);\n\n  const renderUser = ({ item }: { item: User }) => (\n    <TouchableOpacity\n      style={[styles.userItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}\n      onPress={() => handleUserPress(item.id)}\n    >\n      {item.avatarUrl ? (\n        <Image source={{ uri: item.avatarUrl }} style={styles.avatar} />\n      ) : (\n        <View style={[styles.avatar, styles.avatarPlaceholder]}>\n          <ThemedText style={styles.avatarText}>\n            {item.firstName?.[0]}{item.lastName?.[0]}\n          </ThemedText>\n        </View>\n      )}\n      <View style={styles.userInfo}>\n        <View style={styles.userNameRow}>\n          <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>{item.fullName}</ThemedText>\n          {item.isVerified && (\n            <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n          )}\n        </View>\n        {item.specialty && (\n          <ThemedText style={[styles.userSpecialty, { color: appColors.textSecondary }]}>{item.specialty}</ThemedText>\n        )}\n      </View>\n      <Ionicons name=\"chatbubble-outline\" size={20} color={Colors.primary} />\n    </TouchableOpacity>\n  );\n\n  const renderSectionHeader = () => {\n    if (debouncedQuery) return null;\n    return (\n      <View style={styles.sectionHeader}>\n        <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>\n          {suggestedData && suggestedData.length > 0 ? 'People to Message' : 'Suggested'}\n        </ThemedText>\n      </View>\n    );\n  };\n\n  const renderEmpty = () => {\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={Colors.primary} />\n        </View>\n      );\n    }\n\n    return (\n      <View style={styles.emptyContainer}>\n        <Ionicons name=\"people-outline\" size={48} color={appColors.textSecondary} />\n        <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>\n          {debouncedQuery ? 'No users found' : 'No suggestions'}\n        </ThemedText>\n        <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n          {debouncedQuery\n            ? 'Try searching for a different name'\n            : 'Follow people to see them here'}\n        </ThemedText>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.cancelButton} onPress={() => navigation.goBack()}>\n          <ThemedText style={styles.cancelText}>Cancel</ThemedText>\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>New Message</ThemedText>\n        <View style={styles.cancelButton} />\n      </View>\n\n      {/* Search Input */}\n      <View style={[styles.searchContainer, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <View style={styles.searchInputWrapper}>\n          <Ionicons name=\"search\" size={20} color={appColors.textSecondary} />\n          <TextInput\n            style={[styles.searchInput, { color: appColors.textPrimary }]}\n            placeholder=\"Search people...\"\n            placeholderTextColor={appColors.textSecondary}\n            value={searchQuery}\n            onChangeText={handleQueryChange}\n            autoFocus\n          />\n          {searchQuery.length > 0 && (\n            <TouchableOpacity onPress={() => handleQueryChange('')}>\n              <Ionicons name=\"close-circle\" size={20} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          )}\n        </View>\n      </View>\n\n      <FlatList\n        data={users}\n        renderItem={renderUser}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderSectionHeader}\n        ListEmptyComponent={renderEmpty}\n        contentContainerStyle={users?.length === 0 ? styles.emptyList : undefined}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  cancelButton: {\n    width: 60,\n  },\n  cancelText: {\n    ...Typography.body,\n    color: Colors.primary,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  searchContainer: {\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  searchInputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    height: 40,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    ...Typography.body,\n    height: '100%',\n  },\n  sectionHeader: {\n    padding: Spacing.lg,\n    paddingBottom: Spacing.sm,\n  },\n  sectionTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  userItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  avatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  userInfo: {\n    flex: 1,\n  },\n  userNameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userSpecialty: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyList: {\n    flex: 1,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":8867,"size_tokens":null},"docs/SYNC_ARCHITECTURE.md":{"content":"# Web & Mobile Sync Architecture\n\n## Overview\n\nThis document outlines strategies to keep the MedInvest web and mobile applications in sync, ensuring consistent behavior, shared business logic, and efficient development.\n\n---\n\n## Table of Contents\n\n1. [Architecture Options](#architecture-options)\n2. [Recommended Approach](#recommended-approach)\n3. [Shared Code Structure](#shared-code-structure)\n4. [API Contract Enforcement](#api-contract-enforcement)\n5. [Real-time Sync](#real-time-sync)\n6. [Feature Parity Tracking](#feature-parity-tracking)\n7. [Testing Strategy](#testing-strategy)\n8. [CI/CD Pipeline](#cicd-pipeline)\n\n---\n\n## Architecture Options\n\n### Option 1: Monorepo (Recommended)\n\n```\nmedinvest/\n‚îú‚îÄ‚îÄ apps/\n‚îÇ   ‚îú‚îÄ‚îÄ web/                 # Next.js/React web app\n‚îÇ   ‚îú‚îÄ‚îÄ mobile/              # React Native app\n‚îÇ   ‚îî‚îÄ‚îÄ api/                 # Backend API\n‚îú‚îÄ‚îÄ packages/\n‚îÇ   ‚îú‚îÄ‚îÄ shared-types/        # TypeScript types\n‚îÇ   ‚îú‚îÄ‚îÄ shared-utils/        # Common utilities\n‚îÇ   ‚îú‚îÄ‚îÄ shared-validators/   # Zod schemas\n‚îÇ   ‚îú‚îÄ‚îÄ ui-primitives/       # Cross-platform components\n‚îÇ   ‚îî‚îÄ‚îÄ api-client/          # Shared API client\n‚îú‚îÄ‚îÄ package.json\n‚îú‚îÄ‚îÄ turbo.json              # Turborepo config\n‚îî‚îÄ‚îÄ pnpm-workspace.yaml\n```\n\n**Pros:**\n- Single source of truth\n- Atomic changes across platforms\n- Shared dependencies\n- Easy refactoring\n\n**Cons:**\n- Larger repository\n- More complex CI/CD\n- Learning curve for team\n\n### Option 2: Separate Repos + Shared Package\n\n```\n# Three separate repositories\nmedinvest-web/\nmedinvest-mobile/\nmedinvest-api/\n\n# Published npm package\n@medinvest/shared (types, utils, validators)\n```\n\n**Pros:**\n- Independent deployments\n- Smaller repos\n- Team autonomy\n\n**Cons:**\n- Version synchronization overhead\n- Possible drift between platforms\n\n### Option 3: API-First with OpenAPI\n\n```\n# API spec drives everything\nopenapi.yaml ‚Üí Generate types for all platforms\n```\n\n**Pros:**\n- API is single source of truth\n- Auto-generated clients\n- Documentation included\n\n**Cons:**\n- Less flexibility\n- Generated code can be verbose\n\n---\n\n## Recommended Approach\n\n### Monorepo with Turborepo\n\n```bash\n# Setup\nnpx create-turbo@latest medinvest\ncd medinvest\n\n# Structure\npnpm init\n```\n\n**turbo.json:**\n```json\n{\n  \"$schema\": \"https://turbo.build/schema.json\",\n  \"pipeline\": {\n    \"build\": {\n      \"dependsOn\": [\"^build\"],\n      \"outputs\": [\"dist/**\", \".next/**\", \"build/**\"]\n    },\n    \"test\": {\n      \"dependsOn\": [\"build\"]\n    },\n    \"lint\": {},\n    \"typecheck\": {\n      \"dependsOn\": [\"^build\"]\n    }\n  }\n}\n```\n\n**pnpm-workspace.yaml:**\n```yaml\npackages:\n  - \"apps/*\"\n  - \"packages/*\"\n```\n\n---\n\n## Shared Code Structure\n\n### 1. Shared Types Package\n\n```\npackages/shared-types/\n‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îú‚îÄ‚îÄ index.ts\n‚îÇ   ‚îú‚îÄ‚îÄ user.ts\n‚îÇ   ‚îú‚îÄ‚îÄ post.ts\n‚îÇ   ‚îú‚îÄ‚îÄ message.ts\n‚îÇ   ‚îú‚îÄ‚îÄ notification.ts\n‚îÇ   ‚îú‚îÄ‚îÄ deal.ts\n‚îÇ   ‚îú‚îÄ‚îÄ api.ts\n‚îÇ   ‚îî‚îÄ‚îÄ websocket.ts\n‚îú‚îÄ‚îÄ package.json\n‚îî‚îÄ‚îÄ tsconfig.json\n```\n\n**package.json:**\n```json\n{\n  \"name\": \"@medinvest/shared-types\",\n  \"version\": \"1.0.0\",\n  \"main\": \"./dist/index.js\",\n  \"types\": \"./dist/index.d.ts\",\n  \"scripts\": {\n    \"build\": \"tsc\",\n    \"typecheck\": \"tsc --noEmit\"\n  }\n}\n```\n\n**Usage in apps:**\n```typescript\n// apps/web/src/types.ts\nexport * from '@medinvest/shared-types';\n\n// apps/mobile/src/types.ts\nexport * from '@medinvest/shared-types';\n```\n\n### 2. Shared Validators Package\n\n```typescript\n// packages/shared-validators/src/user.ts\nimport { z } from 'zod';\n\nexport const userSchema = z.object({\n  id: z.number(),\n  email: z.string().email(),\n  full_name: z.string().min(2).max(100),\n  username: z.string().min(3).max(30).optional(),\n  bio: z.string().max(500).optional(),\n  specialty: z.string().optional(),\n});\n\nexport const loginSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n});\n\nexport const registerSchema = z.object({\n  email: z.string().email('Invalid email address'),\n  password: z.string()\n    .min(8, 'Password must be at least 8 characters')\n    .regex(/[A-Z]/, 'Password must contain uppercase letter')\n    .regex(/[0-9]/, 'Password must contain a number'),\n  full_name: z.string().min(2, 'Name is required'),\n  specialty: z.string().optional(),\n});\n\nexport const postSchema = z.object({\n  content: z.string().min(1).max(5000),\n  room_id: z.number().optional(),\n  is_anonymous: z.boolean().optional(),\n  images: z.array(z.string().url()).max(10).optional(),\n});\n\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type PostInput = z.infer<typeof postSchema>;\n```\n\n**Usage:**\n```typescript\n// Both web and mobile use same validation\nimport { loginSchema, LoginInput } from '@medinvest/shared-validators';\n\nconst validateLogin = (data: unknown): LoginInput => {\n  return loginSchema.parse(data);\n};\n```\n\n### 3. Shared API Client Package\n\n```typescript\n// packages/api-client/src/client.ts\nimport type { \n  User, \n  Post, \n  LoginRequest, \n  LoginResponse,\n  ApiResponse,\n  PaginatedResponse,\n} from '@medinvest/shared-types';\n\nexport interface ApiClientConfig {\n  baseUrl: string;\n  getToken: () => Promise<string | null>;\n  onUnauthorized?: () => void;\n}\n\nexport class ApiClient {\n  private config: ApiClientConfig;\n\n  constructor(config: ApiClientConfig) {\n    this.config = config;\n  }\n\n  private async request<T>(\n    method: string,\n    path: string,\n    body?: unknown\n  ): Promise<T> {\n    const token = await this.config.getToken();\n    \n    const response = await fetch(`${this.config.baseUrl}${path}`, {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        ...(token && { Authorization: `Bearer ${token}` }),\n      },\n      body: body ? JSON.stringify(body) : undefined,\n    });\n\n    if (response.status === 401) {\n      this.config.onUnauthorized?.();\n      throw new Error('Unauthorized');\n    }\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Request failed');\n    }\n\n    return response.json();\n  }\n\n  // Auth\n  async login(data: LoginRequest): Promise<LoginResponse> {\n    return this.request('POST', '/auth/login', data);\n  }\n\n  // Users\n  async getUser(id: number): Promise<User> {\n    return this.request('GET', `/users/${id}`);\n  }\n\n  async getCurrentUser(): Promise<User> {\n    return this.request('GET', '/users/me');\n  }\n\n  // Posts\n  async getFeed(page = 1, limit = 20): Promise<PaginatedResponse<Post>> {\n    return this.request('GET', `/posts/feed?page=${page}&limit=${limit}`);\n  }\n\n  async getPost(id: number): Promise<Post> {\n    return this.request('GET', `/posts/${id}`);\n  }\n\n  async createPost(data: PostInput): Promise<Post> {\n    return this.request('POST', '/posts', data);\n  }\n\n  async likePost(id: number): Promise<void> {\n    return this.request('POST', `/posts/${id}/like`);\n  }\n\n  async unlikePost(id: number): Promise<void> {\n    return this.request('DELETE', `/posts/${id}/like`);\n  }\n\n  // ... more methods\n}\n```\n\n**Web usage:**\n```typescript\n// apps/web/src/lib/api.ts\nimport { ApiClient } from '@medinvest/api-client';\n\nexport const api = new ApiClient({\n  baseUrl: process.env.NEXT_PUBLIC_API_URL!,\n  getToken: async () => localStorage.getItem('token'),\n  onUnauthorized: () => {\n    window.location.href = '/login';\n  },\n});\n```\n\n**Mobile usage:**\n```typescript\n// apps/mobile/src/lib/api.ts\nimport { ApiClient } from '@medinvest/api-client';\nimport * as SecureStore from 'expo-secure-store';\n\nexport const api = new ApiClient({\n  baseUrl: Constants.expoConfig?.extra?.apiUrl,\n  getToken: async () => SecureStore.getItemAsync('token'),\n  onUnauthorized: () => {\n    // Navigate to login\n  },\n});\n```\n\n### 4. Shared Utilities Package\n\n```typescript\n// packages/shared-utils/src/index.ts\n\n// Date formatting\nexport function formatRelativeTime(date: string | Date): string {\n  const now = new Date();\n  const then = new Date(date);\n  const seconds = Math.floor((now.getTime() - then.getTime()) / 1000);\n\n  if (seconds < 60) return 'just now';\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h`;\n  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d`;\n  \n  return then.toLocaleDateString();\n}\n\n// Number formatting\nexport function formatCompactNumber(num: number): string {\n  if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`;\n  if (num >= 1000) return `${(num / 1000).toFixed(1)}K`;\n  return num.toString();\n}\n\n// Content parsing\nexport function extractMentions(content: string): string[] {\n  const regex = /@(\\w+)/g;\n  const matches = content.match(regex);\n  return matches ? matches.map(m => m.slice(1)) : [];\n}\n\nexport function extractHashtags(content: string): string[] {\n  const regex = /#(\\w+)/g;\n  const matches = content.match(regex);\n  return matches ? matches.map(m => m.slice(1)) : [];\n}\n\n// Validation helpers\nexport function isValidEmail(email: string): boolean {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n\nexport function isStrongPassword(password: string): boolean {\n  return password.length >= 8 && \n         /[A-Z]/.test(password) && \n         /[0-9]/.test(password);\n}\n\n// Content filtering\nexport function containsMutedKeywords(\n  content: string, \n  keywords: string[]\n): boolean {\n  const lowerContent = content.toLowerCase();\n  return keywords.some(kw => lowerContent.includes(kw.toLowerCase()));\n}\n```\n\n---\n\n## API Contract Enforcement\n\n### OpenAPI Specification\n\n```yaml\n# api/openapi.yaml\nopenapi: 3.0.0\ninfo:\n  title: MedInvest API\n  version: 1.0.0\n\npaths:\n  /auth/login:\n    post:\n      operationId: login\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/LoginRequest'\n      responses:\n        '200':\n          description: Success\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/LoginResponse'\n\ncomponents:\n  schemas:\n    LoginRequest:\n      type: object\n      required:\n        - email\n        - password\n      properties:\n        email:\n          type: string\n          format: email\n        password:\n          type: string\n          minLength: 8\n    \n    LoginResponse:\n      type: object\n      properties:\n        token:\n          type: string\n        refresh_token:\n          type: string\n        user:\n          $ref: '#/components/schemas/User'\n```\n\n### Generate Types from OpenAPI\n\n```bash\n# Generate TypeScript types\nnpx openapi-typescript api/openapi.yaml -o packages/shared-types/src/generated.ts\n\n# Generate API client\nnpx openapi-generator-cli generate \\\n  -i api/openapi.yaml \\\n  -g typescript-fetch \\\n  -o packages/api-client/src/generated\n```\n\n### Contract Testing\n\n```typescript\n// packages/api-client/src/__tests__/contract.test.ts\nimport { api } from '../client';\nimport { loginSchema } from '@medinvest/shared-validators';\n\ndescribe('API Contract Tests', () => {\n  it('login response matches schema', async () => {\n    const response = await api.login({\n      email: 'test@example.com',\n      password: 'Password123!',\n    });\n\n    // Validate response matches expected shape\n    expect(response).toHaveProperty('token');\n    expect(response).toHaveProperty('user');\n    expect(response.user).toHaveProperty('id');\n    expect(response.user).toHaveProperty('email');\n  });\n\n  it('validates login input', () => {\n    expect(() => loginSchema.parse({ email: 'invalid' })).toThrow();\n    expect(() => loginSchema.parse({ \n      email: 'valid@email.com', \n      password: '12345678' \n    })).not.toThrow();\n  });\n});\n```\n\n---\n\n## Real-time Sync\n\n### Shared WebSocket Handler\n\n```typescript\n// packages/shared-utils/src/websocket.ts\nimport type { WebSocketEvent } from '@medinvest/shared-types';\n\nexport type WebSocketHandler = (event: WebSocketEvent) => void;\n\nexport interface WebSocketClientConfig {\n  url: string;\n  getToken: () => Promise<string | null>;\n  onConnect?: () => void;\n  onDisconnect?: () => void;\n  onError?: (error: Error) => void;\n}\n\nexport class WebSocketClient {\n  private ws: WebSocket | null = null;\n  private config: WebSocketClientConfig;\n  private handlers: Set<WebSocketHandler> = new Set();\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 5;\n\n  constructor(config: WebSocketClientConfig) {\n    this.config = config;\n  }\n\n  async connect(): Promise<void> {\n    const token = await this.config.getToken();\n    if (!token) return;\n\n    const url = `${this.config.url}?token=${token}`;\n    this.ws = new WebSocket(url);\n\n    this.ws.onopen = () => {\n      this.reconnectAttempts = 0;\n      this.config.onConnect?.();\n    };\n\n    this.ws.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data) as WebSocketEvent;\n        this.handlers.forEach(handler => handler(data));\n      } catch (error) {\n        console.error('WebSocket message parse error:', error);\n      }\n    };\n\n    this.ws.onclose = () => {\n      this.config.onDisconnect?.();\n      this.attemptReconnect();\n    };\n\n    this.ws.onerror = (error) => {\n      this.config.onError?.(new Error('WebSocket error'));\n    };\n  }\n\n  private attemptReconnect(): void {\n    if (this.reconnectAttempts < this.maxReconnectAttempts) {\n      this.reconnectAttempts++;\n      const delay = Math.min(1000 * Math.pow(2, this.reconnectAttempts), 30000);\n      setTimeout(() => this.connect(), delay);\n    }\n  }\n\n  subscribe(handler: WebSocketHandler): () => void {\n    this.handlers.add(handler);\n    return () => this.handlers.delete(handler);\n  }\n\n  send(event: WebSocketEvent): void {\n    if (this.ws?.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify(event));\n    }\n  }\n\n  disconnect(): void {\n    this.ws?.close();\n    this.ws = null;\n  }\n}\n```\n\n---\n\n## Feature Parity Tracking\n\n### Feature Matrix\n\n```markdown\n# features.md - Keep in root of monorepo\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| **Auth** |\n| Login | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Register | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Biometric | ‚ùå | ‚úÖ | N/A | Mobile only |\n| OAuth | üöß | üöß | ‚úÖ | In progress |\n| **Posts** |\n| Create | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Edit | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Delete | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Polls | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Reactions | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Pin | ‚úÖ | ‚úÖ | ‚úÖ | |\n| **Messaging** |\n| Send | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Typing indicator | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Read receipts | ‚úÖ | ‚úÖ | ‚úÖ | |\n| **Platform Specific** |\n| Push notifications | N/A | ‚úÖ | ‚úÖ | |\n| iOS widgets | N/A | ‚úÖ | N/A | |\n| App shortcuts | N/A | ‚úÖ | N/A | |\n| Offline queue | ‚ùå | ‚úÖ | N/A | Mobile priority |\n```\n\n### Automated Feature Sync Check\n\n```typescript\n// scripts/check-feature-parity.ts\nimport * as fs from 'fs';\nimport * as path from 'path';\n\ninterface Feature {\n  name: string;\n  web: boolean;\n  mobile: boolean;\n  api: boolean;\n}\n\nfunction checkFeatureParity(): void {\n  const webScreens = fs.readdirSync('apps/web/src/pages');\n  const mobileScreens = fs.readdirSync('apps/mobile/src/screens');\n  const apiRoutes = fs.readdirSync('apps/api/src/routes');\n\n  // Compare and report\n  console.log('=== Feature Parity Report ===\\n');\n  \n  // Check for screens in mobile but not web\n  const mobileOnly = mobileScreens.filter(s => !webScreens.includes(s));\n  if (mobileOnly.length > 0) {\n    console.log('Mobile only screens:', mobileOnly);\n  }\n\n  // Check for pages in web but not mobile\n  const webOnly = webScreens.filter(s => !mobileScreens.includes(s));\n  if (webOnly.length > 0) {\n    console.log('Web only pages:', webOnly);\n  }\n}\n\ncheckFeatureParity();\n```\n\n---\n\n## Testing Strategy\n\n### Shared Test Utilities\n\n```typescript\n// packages/test-utils/src/index.ts\nimport type { User, Post } from '@medinvest/shared-types';\n\nexport function createMockUser(overrides?: Partial<User>): User {\n  return {\n    id: 1,\n    email: 'test@example.com',\n    full_name: 'Test User',\n    is_verified: false,\n    is_premium: false,\n    is_admin: false,\n    followers_count: 0,\n    following_count: 0,\n    posts_count: 0,\n    created_at: new Date().toISOString(),\n    updated_at: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\nexport function createMockPost(overrides?: Partial<Post>): Post {\n  return {\n    id: 1,\n    author: {\n      id: 1,\n      full_name: 'Test User',\n      is_verified: false,\n    },\n    content: 'Test post content',\n    is_anonymous: false,\n    likes_count: 0,\n    comments_count: 0,\n    shares_count: 0,\n    views_count: 0,\n    is_liked: false,\n    is_bookmarked: false,\n    is_pinned: false,\n    reactions: [],\n    created_at: new Date().toISOString(),\n    updated_at: new Date().toISOString(),\n    ...overrides,\n  };\n}\n```\n\n### E2E Tests (Shared Scenarios)\n\n```typescript\n// packages/e2e-tests/src/scenarios/auth.ts\nexport const authScenarios = {\n  login: {\n    validCredentials: {\n      email: 'test@medinvest.com',\n      password: 'TestPassword123!',\n    },\n    invalidPassword: {\n      email: 'test@medinvest.com',\n      password: 'wrongpassword',\n    },\n  },\n  \n  steps: {\n    login: [\n      'Navigate to login page',\n      'Enter email',\n      'Enter password',\n      'Tap login button',\n      'Verify redirected to home',\n    ],\n  },\n};\n\n// Use in both web (Playwright) and mobile (Detox) tests\n```\n\n---\n\n## CI/CD Pipeline\n\n### GitHub Actions Workflow\n\n```yaml\n# .github/workflows/ci.yml\nname: CI\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main, develop]\n\njobs:\n  # Shared packages\n  shared:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: 'pnpm'\n      \n      - run: pnpm install\n      - run: pnpm --filter \"@medinvest/*\" build\n      - run: pnpm --filter \"@medinvest/*\" test\n      - run: pnpm --filter \"@medinvest/*\" typecheck\n\n  # Web app\n  web:\n    needs: shared\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: 'pnpm'\n      \n      - run: pnpm install\n      - run: pnpm --filter web build\n      - run: pnpm --filter web test\n      - run: pnpm --filter web lint\n\n  # Mobile app\n  mobile:\n    needs: shared\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: 'pnpm'\n      \n      - run: pnpm install\n      - run: pnpm --filter mobile typecheck\n      - run: pnpm --filter mobile lint\n      - run: pnpm --filter mobile test\n\n  # API\n  api:\n    needs: shared\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - uses: actions/setup-node@v3\n        with:\n          node-version: 18\n          cache: 'pnpm'\n      \n      - run: pnpm install\n      - run: pnpm --filter api build\n      - run: pnpm --filter api test\n      \n  # Contract tests\n  contract-tests:\n    needs: [web, mobile, api]\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - run: pnpm install\n      - run: pnpm --filter api start &\n      - run: sleep 10\n      - run: pnpm --filter api-client test:contract\n\n  # Feature parity check\n  feature-parity:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - uses: pnpm/action-setup@v2\n      - run: pnpm install\n      - run: pnpm run check-feature-parity\n```\n\n---\n\n## Summary\n\n### Key Sync Strategies\n\n1. **Shared Types Package** - Single source of truth for all TypeScript types\n2. **Shared Validators** - Same validation rules (Zod) across platforms\n3. **Shared API Client** - Consistent API calls with platform-specific config\n4. **Shared Utilities** - Common functions (date formatting, parsing, etc.)\n5. **OpenAPI Spec** - API contract enforcement\n6. **Feature Matrix** - Track what's implemented where\n7. **Contract Tests** - Verify API responses match expected types\n8. **CI/CD Pipeline** - Automated checks on every PR\n\n### Quick Start\n\n```bash\n# 1. Create monorepo\nnpx create-turbo@latest medinvest\n\n# 2. Add shared packages\nmkdir -p packages/{shared-types,shared-validators,shared-utils,api-client}\n\n# 3. Copy existing code\ncp -r web-app apps/web\ncp -r mobile-app apps/mobile\n\n# 4. Update imports to use shared packages\n# @medinvest/shared-types\n# @medinvest/shared-validators\n# @medinvest/api-client\n\n# 5. Run everything\npnpm install\npnpm build\npnpm test\n```\n\nThis architecture ensures your web and mobile apps stay in sync while allowing platform-specific features where needed.\n","path":null,"size_bytes":20840,"size_tokens":null},"client/lib/validation.ts":{"content":"import { z } from 'zod';\n\n// ============================================\n// Common Validators\n// ============================================\n\nexport const emailSchema = z\n  .string()\n  .min(1, 'Email is required')\n  .email('Please enter a valid email address');\n\nexport const passwordSchema = z\n  .string()\n  .min(1, 'Password is required')\n  .min(8, 'Password must be at least 8 characters')\n  .regex(\n    /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/,\n    'Password must contain uppercase, lowercase, and a number'\n  );\n\nexport const phoneSchema = z\n  .string()\n  .optional()\n  .refine(\n    (val) => !val || /^\\+?[\\d\\s\\-()]{10,}$/.test(val),\n    'Please enter a valid phone number'\n  );\n\nexport const nameSchema = z\n  .string()\n  .min(1, 'This field is required')\n  .min(2, 'Must be at least 2 characters')\n  .max(50, 'Must be less than 50 characters')\n  .regex(/^[a-zA-Z\\s'-]+$/, 'Only letters, spaces, hyphens, and apostrophes allowed');\n\nexport const amountSchema = z\n  .number({ invalid_type_error: 'Please enter a valid amount' })\n  .positive('Amount must be greater than 0');\n\nexport const urlSchema = z\n  .string()\n  .url('Please enter a valid URL')\n  .optional()\n  .or(z.literal(''));\n\n// ============================================\n// Auth Schemas\n// ============================================\n\nexport const loginSchema = z.object({\n  email: emailSchema,\n  password: z.string().min(1, 'Password is required'),\n});\n\nexport type LoginFormData = z.infer<typeof loginSchema>;\n\nexport const signupSchema = z\n  .object({\n    firstName: nameSchema,\n    lastName: nameSchema,\n    email: emailSchema,\n    password: passwordSchema,\n    confirmPassword: z.string().min(1, 'Please confirm your password'),\n    acceptTerms: z.boolean().refine((val) => val === true, {\n      message: 'You must accept the terms and conditions',\n    }),\n  })\n  .refine((data) => data.password === data.confirmPassword, {\n    message: 'Passwords do not match',\n    path: ['confirmPassword'],\n  });\n\nexport type SignupFormData = z.infer<typeof signupSchema>;\n\nexport const forgotPasswordSchema = z.object({\n  email: emailSchema,\n});\n\nexport type ForgotPasswordFormData = z.infer<typeof forgotPasswordSchema>;\n\nexport const resetPasswordSchema = z\n  .object({\n    password: passwordSchema,\n    confirmPassword: z.string().min(1, 'Please confirm your password'),\n  })\n  .refine((data) => data.password === data.confirmPassword, {\n    message: 'Passwords do not match',\n    path: ['confirmPassword'],\n  });\n\nexport type ResetPasswordFormData = z.infer<typeof resetPasswordSchema>;\n\n// ============================================\n// Profile Schemas\n// ============================================\n\nexport const updateProfileSchema = z.object({\n  firstName: nameSchema,\n  lastName: nameSchema,\n  phone: phoneSchema,\n});\n\nexport type UpdateProfileFormData = z.infer<typeof updateProfileSchema>;\n\n// ============================================\n// Investment Schemas\n// ============================================\n\nexport const investSchema = z.object({\n  amount: amountSchema.refine(\n    (val) => val >= 1000,\n    'Minimum investment is $1,000'\n  ),\n  paymentMethodId: z.string().min(1, 'Please select a payment method'),\n  acceptTerms: z.boolean().refine((val) => val === true, {\n    message: 'You must accept the investment terms',\n  }),\n  acceptRisk: z.boolean().refine((val) => val === true, {\n    message: 'You must acknowledge the risk disclosure',\n  }),\n});\n\nexport type InvestFormData = z.infer<typeof investSchema>;\n\n// Dynamic invest schema with custom minimum\nexport function createInvestSchema(minimumInvestment: number) {\n  return z.object({\n    amount: amountSchema.refine(\n      (val) => val >= minimumInvestment,\n      `Minimum investment is $${minimumInvestment.toLocaleString()}`\n    ),\n    paymentMethodId: z.string().min(1, 'Please select a payment method'),\n    acceptTerms: z.boolean().refine((val) => val === true, {\n      message: 'You must accept the investment terms',\n    }),\n    acceptRisk: z.boolean().refine((val) => val === true, {\n      message: 'You must acknowledge the risk disclosure',\n    }),\n  });\n}\n\n// ============================================\n// Payment Method Schemas\n// ============================================\n\nexport const bankAccountSchema = z.object({\n  accountType: z.enum(['checking', 'savings'], {\n    required_error: 'Please select account type',\n  }),\n  routingNumber: z\n    .string()\n    .min(1, 'Routing number is required')\n    .length(9, 'Routing number must be 9 digits')\n    .regex(/^\\d+$/, 'Routing number must contain only numbers'),\n  accountNumber: z\n    .string()\n    .min(1, 'Account number is required')\n    .min(8, 'Account number must be at least 8 digits')\n    .max(17, 'Account number must be at most 17 digits')\n    .regex(/^\\d+$/, 'Account number must contain only numbers'),\n  confirmAccountNumber: z.string().min(1, 'Please confirm account number'),\n  accountHolderName: z\n    .string()\n    .min(1, 'Account holder name is required')\n    .min(2, 'Name must be at least 2 characters'),\n}).refine((data) => data.accountNumber === data.confirmAccountNumber, {\n  message: 'Account numbers do not match',\n  path: ['confirmAccountNumber'],\n});\n\nexport type BankAccountFormData = z.infer<typeof bankAccountSchema>;\n\nexport const cardSchema = z.object({\n  cardNumber: z\n    .string()\n    .min(1, 'Card number is required')\n    .transform((val) => val.replace(/\\s/g, ''))\n    .refine(\n      (val) => /^\\d{13,19}$/.test(val),\n      'Please enter a valid card number'\n    ),\n  expiryDate: z\n    .string()\n    .min(1, 'Expiry date is required')\n    .regex(/^(0[1-9]|1[0-2])\\/\\d{2}$/, 'Please use MM/YY format')\n    .refine((val) => {\n      const [month, year] = val.split('/').map(Number);\n      const now = new Date();\n      const expiry = new Date(2000 + year, month);\n      return expiry > now;\n    }, 'Card has expired'),\n  cvv: z\n    .string()\n    .min(1, 'CVV is required')\n    .regex(/^\\d{3,4}$/, 'CVV must be 3 or 4 digits'),\n  cardholderName: z\n    .string()\n    .min(1, 'Cardholder name is required')\n    .min(2, 'Name must be at least 2 characters'),\n  billingZip: z\n    .string()\n    .min(1, 'Billing ZIP is required')\n    .regex(/^\\d{5}(-\\d{4})?$/, 'Please enter a valid ZIP code'),\n});\n\nexport type CardFormData = z.infer<typeof cardSchema>;\n\n// ============================================\n// Support Schemas\n// ============================================\n\nexport const supportRequestSchema = z.object({\n  subject: z\n    .string()\n    .min(1, 'Subject is required')\n    .min(5, 'Subject must be at least 5 characters')\n    .max(100, 'Subject must be less than 100 characters'),\n  category: z.enum(\n    ['general', 'investment', 'account', 'technical', 'billing'],\n    { required_error: 'Please select a category' }\n  ),\n  message: z\n    .string()\n    .min(1, 'Message is required')\n    .min(20, 'Message must be at least 20 characters')\n    .max(2000, 'Message must be less than 2000 characters'),\n  priority: z.enum(['low', 'medium', 'high']).default('medium'),\n});\n\nexport type SupportRequestFormData = z.infer<typeof supportRequestSchema>;\n\n// ============================================\n// Filter Schemas\n// ============================================\n\nexport const investmentFiltersSchema = z.object({\n  category: z.string().optional(),\n  riskLevel: z.enum(['Low', 'Medium', 'High']).optional(),\n  minInvestment: z.number().optional(),\n  status: z.enum(['active', 'funded', 'closed']).optional(),\n  sortBy: z.enum(['newest', 'endingSoon', 'mostFunded', 'highestROI']).optional(),\n});\n\nexport type InvestmentFiltersFormData = z.infer<typeof investmentFiltersSchema>;\n\n// ============================================\n// Validation Helpers\n// ============================================\n\n/**\n * Validate form data against a schema\n */\nexport function validateForm<T>(\n  schema: z.ZodSchema<T>,\n  data: unknown\n): { success: true; data: T } | { success: false; errors: Record<string, string> } {\n  const result = schema.safeParse(data);\n\n  if (result.success) {\n    return { success: true, data: result.data };\n  }\n\n  const errors: Record<string, string> = {};\n  \n  for (const error of result.error.errors) {\n    const path = error.path.join('.');\n    if (!errors[path]) {\n      errors[path] = error.message;\n    }\n  }\n\n  return { success: false, errors };\n}\n\n/**\n * Get first error message for a field\n */\nexport function getFieldError(\n  errors: z.ZodError | undefined,\n  field: string\n): string | undefined {\n  if (!errors) return undefined;\n  \n  const fieldError = errors.errors.find(\n    (err) => err.path.join('.') === field\n  );\n  \n  return fieldError?.message;\n}\n\n/**\n * Check if form has any errors\n */\nexport function hasErrors(errors: z.ZodError | undefined): boolean {\n  return errors !== undefined && errors.errors.length > 0;\n}\n\nexport default {\n  loginSchema,\n  signupSchema,\n  forgotPasswordSchema,\n  resetPasswordSchema,\n  updateProfileSchema,\n  investSchema,\n  createInvestSchema,\n  bankAccountSchema,\n  cardSchema,\n  supportRequestSchema,\n  investmentFiltersSchema,\n  validateForm,\n  getFieldError,\n  hasErrors,\n};\n","path":null,"size_bytes":9088,"size_tokens":null},"client/hooks/useColorScheme.ts":{"content":"import { useThemeContext } from \"@/contexts/ThemeContext\";\n\nexport function useColorScheme(): \"light\" | \"dark\" {\n  const { isDark } = useThemeContext();\n  return isDark ? \"dark\" : \"light\";\n}\n","path":null,"size_bytes":191,"size_tokens":null},"docs/APP_STORE_SUBMISSION_CHECKLIST.md":{"content":"# MedInvest Mobile - App Store Submission Checklist\n\n## Overview\n\nThis checklist covers everything needed to submit MedInvest to the Apple App Store and Google Play Store.\n\n---\n\n## Pre-Submission Requirements\n\n### ‚úÖ App Configuration\n\n- [ ] **Bundle Identifier**: `com.medinvest.app`\n- [ ] **Version Number**: Semantic versioning (e.g., `1.0.0`)\n- [ ] **Build Number**: Incremental integer\n- [ ] **App Name**: MedInvest (max 30 characters)\n- [ ] **Subtitle**: Medical Professional Investment Network (max 30 characters)\n\n### ‚úÖ Code Signing\n\n#### iOS\n- [ ] Apple Developer Account ($99/year)\n- [ ] App ID registered in Apple Developer Portal\n- [ ] Distribution certificate created\n- [ ] Provisioning profile (App Store distribution)\n- [ ] Push notification certificate (APNs)\n\n#### Android\n- [ ] Google Play Developer Account ($25 one-time)\n- [ ] Keystore file created and securely stored\n- [ ] SHA-256 fingerprint registered for Firebase\n\n---\n\n## App Store Assets\n\n### ‚úÖ App Icon\n\n| Platform | Size | Requirements |\n|----------|------|--------------|\n| iOS | 1024x1024 | PNG, no alpha, no rounded corners |\n| Android | 512x512 | PNG, 32-bit with alpha |\n\n- [ ] Icon created at required sizes\n- [ ] No text on icon (except logo)\n- [ ] Recognizable at small sizes\n\n### ‚úÖ Screenshots\n\n#### iOS (Required sizes)\n- [ ] 6.7\" (iPhone 15 Pro Max): 1290 x 2796\n- [ ] 6.5\" (iPhone 14 Plus): 1284 x 2778\n- [ ] 5.5\" (iPhone 8 Plus): 1242 x 2208\n- [ ] 12.9\" iPad Pro: 2048 x 2732\n\n#### Android\n- [ ] Phone: 1080 x 1920 minimum\n- [ ] 7\" Tablet: 1200 x 1920\n- [ ] 10\" Tablet: 1920 x 1200\n\n#### Screenshot Requirements\n- [ ] Minimum 3 screenshots per device type\n- [ ] Maximum 10 screenshots\n- [ ] PNG or JPEG format\n- [ ] Show key features: Feed, Posts, Messaging, Deals, Profile\n- [ ] Use device frames (optional but recommended)\n- [ ] Localize for each supported language\n\n### ‚úÖ App Preview Videos (Optional)\n\n- [ ] 15-30 seconds duration\n- [ ] H.264 codec\n- [ ] Show app in action\n- [ ] No hands visible\n- [ ] Background music licensed\n\n---\n\n## App Store Metadata\n\n### ‚úÖ Description\n\n**Short Description** (80 characters):\n```\nConnect with medical professionals. Discover exclusive healthcare investments.\n```\n\n**Full Description** (4000 characters max):\n```\nMedInvest is the premier social network and investment platform exclusively for medical professionals.\n\nCONNECT WITH YOUR PEERS\n‚Ä¢ Join specialty-specific rooms (Cardiology, Oncology, Surgery, and more)\n‚Ä¢ Share cases, insights, and questions with fellow physicians\n‚Ä¢ Build your professional network within the medical community\n\nEXCLUSIVE INVESTMENT OPPORTUNITIES\n‚Ä¢ Access vetted healthcare investment deals\n‚Ä¢ Connect with other physician investors\n‚Ä¢ Track your portfolio performance\n\nKEY FEATURES\n‚Ä¢ Secure, verified medical professional community\n‚Ä¢ Real-time messaging with colleagues\n‚Ä¢ Anonymous posting for sensitive discussions\n‚Ä¢ AI-powered insights and recommendations\n‚Ä¢ Premium tier with advanced features\n\nPRIVACY & SECURITY\n‚Ä¢ HIPAA-compliant infrastructure\n‚Ä¢ End-to-end encrypted messaging\n‚Ä¢ Biometric authentication support\n‚Ä¢ Full data export capability\n\nJoin thousands of medical professionals already using MedInvest to advance their careers and financial futures.\n\nDownload now and connect with your medical community!\n```\n\n### ‚úÖ Keywords (iOS - 100 characters)\n\n```\nmedical,physician,doctor,healthcare,investment,networking,social,community,deals,portfolio\n```\n\n### ‚úÖ Categories\n\n**iOS:**\n- Primary: Medical\n- Secondary: Finance\n\n**Android:**\n- Category: Medical\n- Tags: Medical, Finance, Social, Networking\n\n### ‚úÖ Content Rating\n\nComplete content rating questionnaires:\n- [ ] iOS: Age Rating in App Store Connect\n- [ ] Android: Content rating questionnaire in Play Console\n\n**Expected Rating:** \n- iOS: 17+ (medical content, financial information)\n- Android: Teen or Mature\n\n### ‚úÖ Privacy Information\n\n#### iOS App Privacy Labels\n\n**Data Collected:**\n- [ ] Contact Info (Email, Name)\n- [ ] Identifiers (User ID, Device ID)\n- [ ] Usage Data (App interactions)\n- [ ] Financial Info (Investment data)\n- [ ] Health & Fitness (Medical specialty - professional, not personal health)\n\n**Data Usage:**\n- [ ] Analytics\n- [ ] Product Personalization\n- [ ] App Functionality\n\n#### Privacy Policy URL\n```\nhttps://medinvest.com/privacy\n```\n\n#### Terms of Service URL\n```\nhttps://medinvest.com/terms\n```\n\n---\n\n## Technical Requirements\n\n### ‚úÖ iOS Specific\n\n- [ ] Supports iOS 14.0+\n- [ ] Universal app (iPhone + iPad)\n- [ ] Supports all screen sizes\n- [ ] Dark mode support\n- [ ] Dynamic Type support\n- [ ] VoiceOver accessibility\n- [ ] No private API usage\n- [ ] No UIWebView (deprecated)\n- [ ] IPv6 network support\n\n### ‚úÖ Android Specific\n\n- [ ] Minimum SDK: 24 (Android 7.0)\n- [ ] Target SDK: 34 (Android 14)\n- [ ] 64-bit support\n- [ ] Adaptive icons\n- [ ] Supports various screen densities\n- [ ] ProGuard/R8 enabled for release\n- [ ] No sensitive permissions without justification\n\n### ‚úÖ Universal Requirements\n\n- [ ] App works offline (graceful degradation)\n- [ ] No crashes on launch\n- [ ] All features functional\n- [ ] No placeholder content\n- [ ] No \"test\" or \"demo\" text\n- [ ] All links work\n- [ ] All images load\n\n---\n\n## Testing Checklist\n\n### ‚úÖ Functionality Testing\n\n- [ ] User registration flow\n- [ ] User login flow\n- [ ] Password reset flow\n- [ ] Email verification\n- [ ] Profile creation/editing\n- [ ] Post creation with text\n- [ ] Post creation with images\n- [ ] Post creation with video\n- [ ] Post creation with poll\n- [ ] Commenting on posts\n- [ ] Liking/reacting to posts\n- [ ] Following/unfollowing users\n- [ ] Direct messaging\n- [ ] Push notifications received\n- [ ] Search functionality\n- [ ] Room filtering\n- [ ] Deal viewing\n- [ ] Investment flow (if applicable)\n- [ ] Settings changes persist\n- [ ] Logout functionality\n- [ ] Account deletion\n\n### ‚úÖ Performance Testing\n\n- [ ] App launches in < 3 seconds\n- [ ] Feed loads in < 2 seconds\n- [ ] Images load progressively\n- [ ] No memory leaks\n- [ ] Battery usage reasonable\n- [ ] Network usage optimized\n\n### ‚úÖ Security Testing\n\n- [ ] Authentication tokens stored securely\n- [ ] No sensitive data in logs\n- [ ] Certificate pinning (optional)\n- [ ] Biometric authentication works\n- [ ] Session timeout works\n- [ ] Deep links validated\n\n### ‚úÖ Compatibility Testing\n\n- [ ] Tested on oldest supported iOS version\n- [ ] Tested on latest iOS version\n- [ ] Tested on oldest supported Android version\n- [ ] Tested on latest Android version\n- [ ] Tested on various screen sizes\n- [ ] Tested on tablets (if supported)\n\n### ‚úÖ Accessibility Testing\n\n- [ ] VoiceOver/TalkBack navigable\n- [ ] Sufficient color contrast\n- [ ] Touch targets ‚â• 44pt\n- [ ] Text scalable\n- [ ] No information conveyed by color alone\n\n---\n\n## App Store Connect Setup (iOS)\n\n### ‚úÖ App Information\n\n- [ ] App name\n- [ ] Subtitle\n- [ ] Privacy policy URL\n- [ ] Category\n- [ ] Content rights\n- [ ] Age rating\n\n### ‚úÖ Pricing and Availability\n\n- [ ] Price (Free)\n- [ ] Available in all territories (or select)\n- [ ] Pre-order (optional)\n\n### ‚úÖ App Privacy\n\n- [ ] Privacy policy URL\n- [ ] Data collection declarations\n- [ ] Third-party SDK disclosures\n\n### ‚úÖ In-App Purchases (if applicable)\n\n- [ ] Premium subscription created\n- [ ] Pricing tiers set\n- [ ] Subscription group configured\n- [ ] Promotional offers (optional)\n\n### ‚úÖ App Review Information\n\n- [ ] Demo account credentials\n- [ ] Contact information\n- [ ] Notes for reviewer\n- [ ] Attachment (if needed for verification)\n\n**Demo Account:**\n```\nEmail: reviewer@medinvest.com\nPassword: AppReview2024!\nNotes: This account has full access to all features including premium tier.\n```\n\n---\n\n## Google Play Console Setup (Android)\n\n### ‚úÖ Store Listing\n\n- [ ] App name\n- [ ] Short description\n- [ ] Full description\n- [ ] Screenshots\n- [ ] Feature graphic (1024 x 500)\n- [ ] App icon\n\n### ‚úÖ Content Rating\n\n- [ ] Complete questionnaire\n- [ ] Receive rating certificate\n\n### ‚úÖ Pricing & Distribution\n\n- [ ] Free app\n- [ ] Countries selected\n- [ ] Content guidelines acknowledged\n\n### ‚úÖ App Content\n\n- [ ] Privacy policy\n- [ ] Ads declaration\n- [ ] Target audience\n- [ ] News app declaration (No)\n- [ ] COVID-19 app declaration (No)\n- [ ] Data safety section\n\n### ‚úÖ Release Management\n\n- [ ] Internal testing track\n- [ ] Closed testing track\n- [ ] Open testing track (optional)\n- [ ] Production release\n\n---\n\n## Common Rejection Reasons & Fixes\n\n### iOS\n\n| Reason | Fix |\n|--------|-----|\n| Crashes on launch | Test on multiple devices, fix startup errors |\n| Broken links | Verify all URLs work |\n| Placeholder content | Remove all test/demo content |\n| Incomplete information | Fill all required metadata |\n| Login required without explanation | Add \"Why sign up\" explanation |\n| No demo account | Provide test credentials |\n| Privacy policy missing | Add privacy policy URL |\n| Guideline 4.2 - Minimum functionality | Ensure app provides value |\n\n### Android\n\n| Reason | Fix |\n|--------|-----|\n| Crashes | Fix all crash reports |\n| Policy violation | Review content policies |\n| Misleading claims | Ensure description matches features |\n| Improper permissions | Justify all permissions |\n| Target API too low | Update to latest target SDK |\n\n---\n\n## Post-Launch Checklist\n\n### ‚úÖ Monitoring\n\n- [ ] Crash reporting active (Sentry/Crashlytics)\n- [ ] Analytics tracking (Mixpanel/Amplitude)\n- [ ] Performance monitoring\n- [ ] User feedback monitoring\n- [ ] Review responses\n\n### ‚úÖ Marketing\n\n- [ ] App Store Optimization (ASO)\n- [ ] Social media announcement\n- [ ] Press release (optional)\n- [ ] Email to waitlist\n- [ ] In-app referral program\n\n### ‚úÖ Support\n\n- [ ] Support email active\n- [ ] FAQ page live\n- [ ] Help center ready\n- [ ] Bug reporting flow\n\n---\n\n## Submission Commands\n\n### iOS (using EAS)\n\n```bash\n# Build for App Store\neas build --platform ios --profile production\n\n# Submit to App Store\neas submit --platform ios\n\n# Or using Fastlane\nfastlane ios release\n```\n\n### Android (using EAS)\n\n```bash\n# Build for Play Store\neas build --platform android --profile production\n\n# Submit to Play Store\neas submit --platform android\n\n# Or using Fastlane\nfastlane android release\n```\n\n---\n\n## Timeline\n\n| Phase | Duration | Tasks |\n|-------|----------|-------|\n| Preparation | 1-2 weeks | Assets, metadata, testing |\n| Internal Testing | 1 week | Bug fixes, polish |\n| Beta Testing | 1-2 weeks | TestFlight/Play Beta |\n| Submission | 1-3 days | Upload and submit |\n| Review | 1-7 days | Apple/Google review |\n| Launch | 1 day | Release to public |\n\n---\n\n## Contacts\n\n- **App Store Team Lead**: [Name] - [email]\n- **Android Team Lead**: [Name] - [email]\n- **Legal/Privacy**: [Name] - [email]\n- **Marketing**: [Name] - [email]\n\n---\n\n## Version History\n\n| Version | Date | Changes |\n|---------|------|---------|\n| 1.0.0 | TBD | Initial release |\n","path":null,"size_bytes":10870,"size_tokens":null},"client/components/PeopleYouMayKnow.tsx":{"content":"/**\n * People You May Know Component\n * Suggested users to follow based on specialty, location, connections\n */\n\nimport React, { useCallback, useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  FlatList,\n  ActivityIndicator,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi } from '@/lib/api';\n\ninterface SuggestedUser {\n  id: number;\n  first_name: string;\n  last_name: string;\n  full_name: string;\n  avatar_url?: string;\n  specialty?: string;\n  location?: string;\n  mutual_connections?: number;\n  reason?: string;\n}\n\ninterface PeopleYouMayKnowProps {\n  limit?: number;\n  horizontal?: boolean;\n  showHeader?: boolean;\n  onViewAll?: () => void;\n}\n\nexport default function PeopleYouMayKnow({\n  limit = 6,\n  horizontal = false,\n  showHeader = true,\n  onViewAll,\n}: PeopleYouMayKnowProps) {\n  const appColors = useAppColors();\n  const navigation = useNavigation<any>();\n  const queryClient = useQueryClient();\n\n  const { data: suggestions, isLoading } = useQuery({\n    queryKey: ['suggestedUsers', limit],\n    queryFn: async () => {\n      const response = await usersApi.getSuggestedUsers(limit);\n      return response.data?.users || [];\n    },\n  });\n\n  const followMutation = useMutation({\n    mutationFn: async (userId: number) => {\n      const response = await usersApi.follow(userId);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to follow');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['suggestedUsers'] });\n    },\n  });\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const handleFollow = useCallback((userId: number) => {\n    followMutation.mutate(userId);\n  }, [followMutation]);\n\n  const handleViewAll = useCallback(() => {\n    if (onViewAll) {\n      onViewAll();\n    } else {\n      navigation.navigate('Discover', { tab: 'people' });\n    }\n  }, [onViewAll, navigation]);\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"small\" color={Colors.primary} />\n      </View>\n    );\n  }\n\n  if (!suggestions || suggestions.length === 0) {\n    return null;\n  }\n\n  const renderUserCard = ({ item }: { item: SuggestedUser }) => (\n    <SuggestedUserCard\n      user={item}\n      onPress={() => handleUserPress(item.id)}\n      onFollow={() => handleFollow(item.id)}\n      isFollowing={followMutation.isPending && followMutation.variables === item.id}\n      horizontal={horizontal}\n    />\n  );\n\n  return (\n    <View style={[styles.container, { backgroundColor: appColors.surface }]}>\n      {showHeader && (\n        <View style={styles.header}>\n          <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>People you may know</ThemedText>\n          <TouchableOpacity onPress={handleViewAll}>\n            <ThemedText style={styles.viewAllText}>View all</ThemedText>\n          </TouchableOpacity>\n        </View>\n      )}\n\n      {horizontal ? (\n        <FlatList\n          data={suggestions}\n          renderItem={renderUserCard}\n          keyExtractor={(item) => item.id.toString()}\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          contentContainerStyle={styles.horizontalList}\n        />\n      ) : (\n        <View style={styles.verticalList}>\n          {suggestions.map((user: SuggestedUser) => (\n            <SuggestedUserCard\n              key={user.id}\n              user={user}\n              onPress={() => handleUserPress(user.id)}\n              onFollow={() => handleFollow(user.id)}\n              isFollowing={followMutation.isPending && followMutation.variables === user.id}\n              horizontal={false}\n            />\n          ))}\n        </View>\n      )}\n    </View>\n  );\n}\n\ninterface SuggestedUserCardProps {\n  user: SuggestedUser;\n  onPress: () => void;\n  onFollow: () => void;\n  isFollowing: boolean;\n  horizontal: boolean;\n}\n\nfunction SuggestedUserCard({ \n  user, \n  onPress, \n  onFollow, \n  isFollowing,\n  horizontal \n}: SuggestedUserCardProps) {\n  const appColors = useAppColors();\n  const [followed, setFollowed] = useState(false);\n\n  const handleFollow = () => {\n    setFollowed(true);\n    onFollow();\n  };\n\n  if (horizontal) {\n    return (\n      <TouchableOpacity style={styles.horizontalCard} onPress={onPress}>\n        {user.avatar_url ? (\n          <Image source={{ uri: user.avatar_url }} style={styles.horizontalAvatar} />\n        ) : (\n          <View style={[styles.horizontalAvatar, styles.avatarPlaceholder]}>\n            <ThemedText style={styles.avatarText}>\n              {user.first_name[0]}{user.last_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <ThemedText style={[styles.horizontalName, { color: appColors.textPrimary }]} numberOfLines={1}>\n          {user.full_name}\n        </ThemedText>\n        {user.specialty && (\n          <ThemedText style={[styles.horizontalSpecialty, { color: appColors.textSecondary }]} numberOfLines={1}>\n            {user.specialty}\n          </ThemedText>\n        )}\n        <TouchableOpacity\n          style={[styles.followButtonSmall, followed && styles.followedButton]}\n          onPress={handleFollow}\n          disabled={isFollowing || followed}\n        >\n          {isFollowing ? (\n            <ActivityIndicator size=\"small\" color={Colors.primary} />\n          ) : (\n            <ThemedText style={[styles.followButtonTextSmall, followed && [styles.followedButtonText, { color: appColors.textSecondary }]]}>\n              {followed ? 'Following' : 'Follow'}\n            </ThemedText>\n          )}\n        </TouchableOpacity>\n      </TouchableOpacity>\n    );\n  }\n\n  return (\n    <View style={[styles.listItem, { borderBottomColor: appColors.border }]}>\n      <TouchableOpacity style={styles.listItemContent} onPress={onPress}>\n        {user.avatar_url ? (\n          <Image source={{ uri: user.avatar_url }} style={styles.listAvatar} />\n        ) : (\n          <View style={[styles.listAvatar, styles.avatarPlaceholder]}>\n            <ThemedText style={styles.avatarTextSmall}>\n              {user.first_name[0]}{user.last_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View style={styles.listUserInfo}>\n          <ThemedText style={styles.listUserName}>{user.full_name}</ThemedText>\n          <ThemedText style={[styles.listUserMeta, { color: appColors.textSecondary }]}>\n            {user.specialty}{user.location ? ` ¬∑ ${user.location}` : ''}\n          </ThemedText>\n          {user.mutual_connections && user.mutual_connections > 0 && (\n            <ThemedText style={[styles.mutualConnections, { color: appColors.textSecondary }]}>\n              {user.mutual_connections} mutual connection{user.mutual_connections > 1 ? 's' : ''}\n            </ThemedText>\n          )}\n        </View>\n      </TouchableOpacity>\n      \n      <TouchableOpacity\n        style={[styles.followButton, followed && styles.followedButton]}\n        onPress={handleFollow}\n        disabled={isFollowing || followed}\n      >\n        {isFollowing ? (\n          <ActivityIndicator size=\"small\" color={Colors.primary} />\n        ) : followed ? (\n          <Ionicons name=\"checkmark\" size={18} color={appColors.textSecondary} />\n        ) : (\n          <Ionicons name=\"person-add-outline\" size={18} color={Colors.primary} />\n        )}\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nexport function PeopleYouMayKnowCompact({ limit = 3 }: { limit?: number }) {\n  const appColors = useAppColors();\n  return (\n    <View style={[styles.compactContainer, { backgroundColor: appColors.surface }]}>\n      <PeopleYouMayKnow \n        limit={limit} \n        horizontal={false} \n        showHeader={true}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n  },\n  loadingContainer: {\n    padding: Spacing.xl,\n    alignItems: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n  },\n  headerTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  viewAllText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  \n  horizontalList: {\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: Spacing.lg,\n    gap: Spacing.md,\n  },\n  horizontalCard: {\n    width: 140,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    alignItems: 'center',\n    marginRight: Spacing.md,\n  },\n  horizontalAvatar: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    marginBottom: Spacing.sm,\n  },\n  horizontalName: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textAlign: 'center',\n  },\n  horizontalSpecialty: {\n    ...Typography.small,\n    textAlign: 'center',\n    marginTop: 2,\n  },\n  followButtonSmall: {\n    marginTop: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    paddingHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.primary,\n    minWidth: 80,\n    alignItems: 'center',\n  },\n  followButtonTextSmall: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n  },\n\n  verticalList: {\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: Spacing.lg,\n  },\n  listItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  listItemContent: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  listAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  avatarTextSmall: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  listUserInfo: {\n    flex: 1,\n  },\n  listUserName: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: Colors.primary,\n  },\n  listUserMeta: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  mutualConnections: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  followButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  followedButton: {\n    backgroundColor: Colors.light.backgroundTertiary,\n  },\n  followedButtonText: {\n  },\n\n  compactContainer: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n});\n","path":null,"size_bytes":11033,"size_tokens":null},"client/theme/typography.ts":{"content":"import { Platform, TextStyle } from 'react-native';\n\n/**\n * MedInvest Typography System\n * Font: System (SF Pro for iOS, Roboto for Android)\n * Professional yet approachable\n */\n\n// Font families based on platform\nconst fontFamily = Platform.select({\n  ios: {\n    regular: 'System',\n    medium: 'System',\n    semibold: 'System',\n    bold: 'System',\n  },\n  android: {\n    regular: 'Roboto',\n    medium: 'Roboto-Medium',\n    semibold: 'Roboto-Medium',\n    bold: 'Roboto-Bold',\n  },\n  default: {\n    regular: 'System',\n    medium: 'System',\n    semibold: 'System',\n    bold: 'System',\n  },\n});\n\n// Font weights\nexport const fontWeights = {\n  regular: '400' as const,\n  medium: '500' as const,\n  semibold: '600' as const,\n  bold: '700' as const,\n};\n\n// Line height multipliers\nconst lineHeightMultipliers = {\n  tight: 1.2,\n  normal: 1.4,\n  relaxed: 1.6,\n};\n\n/**\n * Typography Scale\n * Based on design guidelines:\n * - Hero: 32pt, Bold\n * - Title: 24pt, Bold  \n * - Heading: 18pt, Semibold\n * - Body: 16pt, Regular\n * - Caption: 14pt, Regular\n * - Small: 12pt, Regular\n */\nexport const typography = {\n  // Hero - Large feature text, portfolio totals\n  hero: {\n    fontSize: 32,\n    fontWeight: fontWeights.bold,\n    fontFamily: fontFamily.bold,\n    lineHeight: 32 * lineHeightMultipliers.tight,\n    letterSpacing: -0.5,\n  } as TextStyle,\n\n  // Title - Screen titles, card headers\n  title: {\n    fontSize: 24,\n    fontWeight: fontWeights.bold,\n    fontFamily: fontFamily.bold,\n    lineHeight: 24 * lineHeightMultipliers.tight,\n    letterSpacing: -0.3,\n  } as TextStyle,\n\n  // Heading - Section headers, list item titles\n  heading: {\n    fontSize: 18,\n    fontWeight: fontWeights.semibold,\n    fontFamily: fontFamily.semibold,\n    lineHeight: 18 * lineHeightMultipliers.normal,\n    letterSpacing: -0.2,\n  } as TextStyle,\n\n  // Body - Main content text\n  body: {\n    fontSize: 16,\n    fontWeight: fontWeights.regular,\n    fontFamily: fontFamily.regular,\n    lineHeight: 16 * lineHeightMultipliers.relaxed,\n    letterSpacing: 0,\n  } as TextStyle,\n\n  // Body Medium - Emphasized body text\n  bodyMedium: {\n    fontSize: 16,\n    fontWeight: fontWeights.medium,\n    fontFamily: fontFamily.medium,\n    lineHeight: 16 * lineHeightMultipliers.relaxed,\n    letterSpacing: 0,\n  } as TextStyle,\n\n  // Caption - Secondary info, timestamps\n  caption: {\n    fontSize: 14,\n    fontWeight: fontWeights.regular,\n    fontFamily: fontFamily.regular,\n    lineHeight: 14 * lineHeightMultipliers.normal,\n    letterSpacing: 0.1,\n  } as TextStyle,\n\n  // Caption Medium - Emphasized captions\n  captionMedium: {\n    fontSize: 14,\n    fontWeight: fontWeights.medium,\n    fontFamily: fontFamily.medium,\n    lineHeight: 14 * lineHeightMultipliers.normal,\n    letterSpacing: 0.1,\n  } as TextStyle,\n\n  // Small - Labels, badges, fine print\n  small: {\n    fontSize: 12,\n    fontWeight: fontWeights.regular,\n    fontFamily: fontFamily.regular,\n    lineHeight: 12 * lineHeightMultipliers.normal,\n    letterSpacing: 0.2,\n  } as TextStyle,\n\n  // Small Medium - Emphasized small text\n  smallMedium: {\n    fontSize: 12,\n    fontWeight: fontWeights.medium,\n    fontFamily: fontFamily.medium,\n    lineHeight: 12 * lineHeightMultipliers.normal,\n    letterSpacing: 0.2,\n  } as TextStyle,\n\n  // Button text styles\n  button: {\n    large: {\n      fontSize: 18,\n      fontWeight: fontWeights.semibold,\n      fontFamily: fontFamily.semibold,\n      lineHeight: 18 * lineHeightMultipliers.tight,\n      letterSpacing: 0.3,\n    } as TextStyle,\n    medium: {\n      fontSize: 16,\n      fontWeight: fontWeights.semibold,\n      fontFamily: fontFamily.semibold,\n      lineHeight: 16 * lineHeightMultipliers.tight,\n      letterSpacing: 0.2,\n    } as TextStyle,\n    small: {\n      fontSize: 14,\n      fontWeight: fontWeights.semibold,\n      fontFamily: fontFamily.semibold,\n      lineHeight: 14 * lineHeightMultipliers.tight,\n      letterSpacing: 0.2,\n    } as TextStyle,\n  },\n\n  // Number styles (for financial data)\n  number: {\n    large: {\n      fontSize: 32,\n      fontWeight: fontWeights.bold,\n      fontFamily: fontFamily.bold,\n      lineHeight: 32 * lineHeightMultipliers.tight,\n      letterSpacing: -0.5,\n      fontVariant: ['tabular-nums'],\n    } as TextStyle,\n    medium: {\n      fontSize: 24,\n      fontWeight: fontWeights.semibold,\n      fontFamily: fontFamily.semibold,\n      lineHeight: 24 * lineHeightMultipliers.tight,\n      letterSpacing: -0.3,\n      fontVariant: ['tabular-nums'],\n    } as TextStyle,\n    small: {\n      fontSize: 16,\n      fontWeight: fontWeights.medium,\n      fontFamily: fontFamily.medium,\n      lineHeight: 16 * lineHeightMultipliers.tight,\n      letterSpacing: 0,\n      fontVariant: ['tabular-nums'],\n    } as TextStyle,\n  },\n\n  // Percentage styles (for gains/losses)\n  percentage: {\n    large: {\n      fontSize: 18,\n      fontWeight: fontWeights.semibold,\n      fontFamily: fontFamily.semibold,\n      lineHeight: 18 * lineHeightMultipliers.tight,\n      letterSpacing: 0,\n      fontVariant: ['tabular-nums'],\n    } as TextStyle,\n    small: {\n      fontSize: 14,\n      fontWeight: fontWeights.medium,\n      fontFamily: fontFamily.medium,\n      lineHeight: 14 * lineHeightMultipliers.tight,\n      letterSpacing: 0,\n      fontVariant: ['tabular-nums'],\n    } as TextStyle,\n  },\n} as const;\n\nexport type Typography = typeof typography;\n","path":null,"size_bytes":5306,"size_tokens":null},"client/theme/colors.ts":{"content":"/**\n * MedInvest Color Palette\n * Medical blue meets financial confidence\n * \"Bloomberg meets Apple Health\" aesthetic\n */\n\nexport const colors = {\n  // Primary Colors\n  primary: {\n    main: '#0066CC',      // Medical Blue - Main actions, active states\n    light: '#3385D6',\n    dark: '#004C99',\n    contrast: '#FFFFFF',\n  },\n\n  // Secondary Colors  \n  secondary: {\n    main: '#00A86B',      // Investment Green - Success, gains\n    light: '#33BA89',\n    dark: '#007A4D',\n    contrast: '#FFFFFF',\n  },\n\n  // Gradient (Healthcare-Finance Bridge)\n  gradient: {\n    start: '#0066CC',     // Medical Blue\n    end: '#00A86B',       // Investment Green\n    // CSS gradient string\n    primary: 'linear-gradient(135deg, #0066CC 0%, #00A86B 100%)',\n    // For React Native\n    colors: ['#0066CC', '#00A86B'] as const,\n    locations: [0, 1] as const,\n  },\n\n  // Background Colors\n  background: {\n    primary: '#F8F9FA',   // Main background\n    secondary: '#F1F3F5',\n    tertiary: '#E9ECEF',\n  },\n\n  // Surface Colors\n  surface: {\n    primary: '#FFFFFF',   // Cards, modals\n    elevated: '#FFFFFF',\n    overlay: 'rgba(0, 0, 0, 0.5)',\n  },\n\n  // Text Colors\n  text: {\n    primary: '#1A1A1A',\n    secondary: '#6B7280',\n    tertiary: '#9CA3AF',\n    inverse: '#FFFFFF',\n    link: '#0066CC',\n  },\n\n  // Semantic Colors\n  semantic: {\n    success: '#00A86B',   // Same as secondary - gains\n    error: '#DC2626',     // Losses, validation errors\n    warning: '#F59E0B',   // Risk indicators\n    info: '#0066CC',      // Same as primary\n  },\n\n  // Border Colors\n  border: {\n    light: '#E5E7EB',\n    medium: '#D1D5DB',\n    dark: '#9CA3AF',\n  },\n\n  // Chart Colors (for portfolio graphs)\n  chart: {\n    positive: '#00A86B',\n    negative: '#DC2626',\n    neutral: '#6B7280',\n    line: '#0066CC',\n    area: 'rgba(0, 102, 204, 0.1)',\n  },\n\n  // Status Colors\n  status: {\n    active: '#00A86B',\n    pending: '#F59E0B',\n    completed: '#0066CC',\n    failed: '#DC2626',\n  },\n\n  // Transparent variants\n  transparent: {\n    primary10: 'rgba(0, 102, 204, 0.1)',\n    primary20: 'rgba(0, 102, 204, 0.2)',\n    secondary10: 'rgba(0, 168, 107, 0.1)',\n    secondary20: 'rgba(0, 168, 107, 0.2)',\n    black10: 'rgba(0, 0, 0, 0.1)',\n    black20: 'rgba(0, 0, 0, 0.2)',\n    black50: 'rgba(0, 0, 0, 0.5)',\n    white10: 'rgba(255, 255, 255, 0.1)',\n    white20: 'rgba(255, 255, 255, 0.2)',\n    white50: 'rgba(255, 255, 255, 0.5)',\n  },\n} as const;\n\nexport type ColorPalette = typeof colors;\n","path":null,"size_bytes":2447,"size_tokens":null},"docs/TESTING_CHECKLIST.md":{"content":"# MedInvest Mobile - Testing Checklist\n\n## Overview\n\nComprehensive testing checklist for the MedInvest mobile application covering all features, screens, and edge cases.\n\n---\n\n## Test Environment Setup\n\n### Devices Required\n\n**iOS:**\n- [ ] iPhone SE (smallest screen)\n- [ ] iPhone 14/15 (standard)\n- [ ] iPhone 14/15 Pro Max (largest)\n- [ ] iPad (if supporting tablets)\n\n**Android:**\n- [ ] Small phone (5\" screen)\n- [ ] Standard phone (6\" screen)\n- [ ] Large phone (6.7\"+ screen)\n- [ ] Tablet (if supporting)\n\n### OS Versions\n\n- [ ] iOS 14 (minimum supported)\n- [ ] iOS 15\n- [ ] iOS 16\n- [ ] iOS 17 (latest)\n- [ ] Android 7 (API 24 - minimum)\n- [ ] Android 12\n- [ ] Android 13\n- [ ] Android 14 (latest)\n\n### Network Conditions\n\n- [ ] Strong WiFi\n- [ ] Weak WiFi\n- [ ] 4G/LTE\n- [ ] 3G (slow)\n- [ ] Offline\n- [ ] Airplane mode\n- [ ] Network transitions\n\n---\n\n## Authentication Tests\n\n### Registration\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Valid registration | Enter valid email, password, name | Account created, verification email sent | ‚òê |\n| Invalid email format | Enter \"notanemail\" | Error: Invalid email | ‚òê |\n| Weak password | Enter \"123\" | Error: Password requirements | ‚òê |\n| Password mismatch | Enter different passwords | Error: Passwords don't match | ‚òê |\n| Existing email | Use registered email | Error: Email already exists | ‚òê |\n| Empty fields | Leave fields empty | Error: Required fields | ‚òê |\n| Network error | Disable network, submit | Error: Network unavailable | ‚òê |\n\n### Login\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Valid login | Enter correct credentials | Logged in, redirected to home | ‚òê |\n| Wrong password | Enter incorrect password | Error: Invalid credentials | ‚òê |\n| Unverified email | Login with unverified account | Prompt to verify email | ‚òê |\n| Remember me | Enable, close app, reopen | Still logged in | ‚òê |\n| Biometric login | Enable FaceID/TouchID | Biometric prompt works | ‚òê |\n| Session expiry | Wait for token expiry | Prompted to re-login | ‚òê |\n\n### Password Reset\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Request reset | Enter email, submit | Success message, email sent | ‚òê |\n| Invalid email | Enter unregistered email | Error or generic success (security) | ‚òê |\n| Reset link | Click link in email | Opens app, shows reset form | ‚òê |\n| New password | Enter new password | Password updated, can login | ‚òê |\n\n### Logout\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Logout | Tap logout in settings | Logged out, token cleared | ‚òê |\n| Clear data | Check after logout | Sensitive data removed | ‚òê |\n\n---\n\n## Home Feed Tests\n\n### Feed Loading\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Initial load | Open app | Feed loads with posts | ‚òê |\n| Skeleton loading | Observe during load | Skeleton placeholders shown | ‚òê |\n| Empty feed | New user, no follows | Empty state with suggestions | ‚òê |\n| Pull to refresh | Pull down on feed | Feed refreshes, haptic feedback | ‚òê |\n| Infinite scroll | Scroll to bottom | More posts load | ‚òê |\n| No more posts | Reach end of feed | \"No more posts\" indicator | ‚òê |\n\n### Room Filtering\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Select room | Tap room filter | Feed filtered to room | ‚òê |\n| All rooms | Select \"All\" | All posts shown | ‚òê |\n| Multiple rooms | Quick switch rooms | Correct filtering each time | ‚òê |\n| Room persistence | Select room, leave, return | Room selection persisted | ‚òê |\n\n### Post Interactions\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Like post | Tap heart icon | Heart fills, count increases | ‚òê |\n| Unlike post | Tap filled heart | Heart empties, count decreases | ‚òê |\n| Reaction picker | Long press heart | Emoji picker appears | ‚òê |\n| Select reaction | Choose emoji | Reaction applied, animation | ‚òê |\n| Comment | Tap comment icon | Opens post detail | ‚òê |\n| Share | Tap share icon | Share sheet opens | ‚òê |\n| Bookmark | Tap bookmark icon | Post saved, icon fills | ‚òê |\n\n---\n\n## Post Creation Tests\n\n### Text Posts\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Create post | Enter text, submit | Post created, appears in feed | ‚òê |\n| Empty post | Try to submit empty | Submit disabled | ‚òê |\n| Long post | Enter 5000+ characters | Character limit enforced | ‚òê |\n| Mentions | Type @username | Autocomplete appears | ‚òê |\n| Select mention | Tap suggestion | Username inserted | ‚òê |\n| Hashtags | Type #topic | Hashtag highlighted | ‚òê |\n| Draft auto-save | Enter text, leave | Draft saved | ‚òê |\n| Restore draft | Return to create | Draft restored | ‚òê |\n\n### Media Posts\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Add image | Tap image icon | Picker opens | ‚òê |\n| Take photo | Select camera | Camera opens | ‚òê |\n| Select gallery | Choose from library | Image selected | ‚òê |\n| Crop image | Select crop option | Cropper opens | ‚òê |\n| Multiple images | Add up to 10 | All images attach | ‚òê |\n| Remove image | Tap X on image | Image removed | ‚òê |\n| Add video | Select video | Video attaches | ‚òê |\n| Video limit | Select long video | Trimmed or error | ‚òê |\n\n### Poll Posts\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Create poll | Add question + options | Poll preview shown | ‚òê |\n| Add option | Tap add option | New option added (max 6) | ‚òê |\n| Remove option | Tap X on option | Option removed (min 2) | ‚òê |\n| Set duration | Select duration | Duration applied | ‚òê |\n| Anonymous poll | Enable anonymous | Setting applied | ‚òê |\n| Multi-select | Enable multi-select | Setting applied | ‚òê |\n\n### Post Settings\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Select room | Choose room | Room attached to post | ‚òê |\n| Anonymous post | Enable toggle | Username hidden on post | ‚òê |\n| Post visibility | Check on feed | Post appears correctly | ‚òê |\n\n---\n\n## Comments Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| View comments | Open post | Comments load | ‚òê |\n| Add comment | Enter text, submit | Comment added | ‚òê |\n| Reply to comment | Tap reply | Reply attached to parent | ‚òê |\n| Threaded view | Multiple replies | Thread structure correct | ‚òê |\n| Like comment | Tap heart on comment | Comment liked | ‚òê |\n| Edit comment | Own comment, edit | Comment updated | ‚òê |\n| Delete comment | Own comment, delete | Comment removed | ‚òê |\n| Report comment | Tap report | Report flow opens | ‚òê |\n\n---\n\n## Profile Tests\n\n### View Profile\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Own profile | Tap profile tab | Profile loads with stats | ‚òê |\n| Other's profile | Tap username | Their profile loads | ‚òê |\n| Posts tab | View posts | User's posts shown | ‚òê |\n| Followers list | Tap followers count | Followers list opens | ‚òê |\n| Following list | Tap following count | Following list opens | ‚òê |\n| Pinned posts | Check pinned section | Pinned posts shown at top | ‚òê |\n\n### Edit Profile\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Edit name | Change name, save | Name updated | ‚òê |\n| Edit bio | Change bio, save | Bio updated | ‚òê |\n| Edit specialty | Select specialty | Specialty updated | ‚òê |\n| Change avatar | Select new image | Avatar updated | ‚òê |\n| Crop avatar | Crop selected image | Cropped image saved | ‚òê |\n\n### Follow Actions\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Follow user | Tap follow button | Button changes to Following | ‚òê |\n| Unfollow user | Tap Following button | Confirmation, unfollowed | ‚òê |\n| Block user | Tap more, block | User blocked | ‚òê |\n| Mute user | Tap more, mute | Mute options shown | ‚òê |\n| Report user | Tap more, report | Report flow opens | ‚òê |\n\n---\n\n## Messaging Tests\n\n### Conversations List\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| View messages | Open messages tab | Conversations list loads | ‚òê |\n| Unread indicator | Have unread messages | Badge shown on tab | ‚òê |\n| New conversation | Tap compose | User search opens | ‚òê |\n| Search users | Enter name | Users filtered | ‚òê |\n| Select user | Tap user | Conversation opens | ‚òê |\n\n### Chat\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Send message | Enter text, send | Message sent, appears | ‚òê |\n| Receive message | Other user sends | Message appears, notification | ‚òê |\n| Read receipts | Open conversation | Messages marked as read | ‚òê |\n| Typing indicator | Other types | \"Typing...\" shown | ‚òê |\n| Send image | Attach image | Image sent | ‚òê |\n| Image preview | Tap sent image | Full screen preview | ‚òê |\n| Scroll history | Scroll up | Older messages load | ‚òê |\n| Online status | Check user status | Online/offline shown | ‚òê |\n\n---\n\n## Search Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Search posts | Enter query | Relevant posts shown | ‚òê |\n| Search users | Search username | Users found | ‚òê |\n| Search hashtags | Search #topic | Posts with hashtag | ‚òê |\n| Filters | Apply filters | Results filtered | ‚òê |\n| Save search | Tap save | Search saved | ‚òê |\n| Recent searches | Check history | Recent shown | ‚òê |\n| Clear search | Tap clear | Query cleared | ‚òê |\n| No results | Search nonsense | Empty state shown | ‚òê |\n\n---\n\n## Notifications Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| View notifications | Open notifications | List loads | ‚òê |\n| Unread badge | Have unread | Badge shows count | ‚òê |\n| Mark as read | Open notification | Marked as read | ‚òê |\n| Mark all read | Tap mark all | All marked read | ‚òê |\n| Like notification | Someone likes | Notification appears | ‚òê |\n| Comment notification | Someone comments | Notification appears | ‚òê |\n| Follow notification | Someone follows | Notification appears | ‚òê |\n| Mention notification | Someone mentions | Notification appears | ‚òê |\n| Push notification | App backgrounded | Push received | ‚òê |\n| Tap notification | Tap push | Opens correct screen | ‚òê |\n\n---\n\n## Settings Tests\n\n### Account Settings\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Change password | Enter new password | Password changed | ‚òê |\n| Enable biometric | Toggle on | Biometric enabled | ‚òê |\n| Disable biometric | Toggle off | Biometric disabled | ‚òê |\n| Delete account | Go through flow | Account deleted | ‚òê |\n\n### Notification Settings\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Toggle all off | Disable master toggle | All notifications off | ‚òê |\n| Individual toggles | Toggle specific types | Only those disabled | ‚òê |\n| Quiet hours | Enable and set times | Applied correctly | ‚òê |\n\n### Content Preferences\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Hide NSFW | Enable | Sensitive content hidden | ‚òê |\n| Blur images | Enable | Sensitive images blurred | ‚òê |\n| Add muted keyword | Enter keyword | Posts with word hidden | ‚òê |\n| Autoplay videos | Set to WiFi only | Videos don't autoplay on cellular | ‚òê |\n\n### Appearance\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Dark mode | Enable | App switches to dark | ‚òê |\n| Light mode | Enable | App switches to light | ‚òê |\n| System default | Select | Follows system setting | ‚òê |\n\n---\n\n## Deals Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| View deals | Open deals tab | Deals list loads | ‚òê |\n| Filter deals | Apply filters | Deals filtered | ‚òê |\n| Deal detail | Tap deal | Detail page opens | ‚òê |\n| Watch deal | Tap watch | Deal added to watchlist | ‚òê |\n| Express interest | Tap interested | Interest form opens | ‚òê |\n| Submit interest | Fill form, submit | Confirmation shown | ‚òê |\n\n---\n\n## Offline Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Offline indicator | Disable network | Offline banner appears | ‚òê |\n| View cached feed | Go offline | Cached posts visible | ‚òê |\n| Create post offline | Write post offline | Queued for later | ‚òê |\n| Queue indicator | Have queued items | Pending count shown | ‚òê |\n| Sync on reconnect | Enable network | Queued items sync | ‚òê |\n| Failed sync | Item fails | Retry option shown | ‚òê |\n\n---\n\n## Accessibility Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| VoiceOver navigation | Enable VoiceOver | All elements announced | ‚òê |\n| Touch targets | Check buttons | Min 44pt touch area | ‚òê |\n| Color contrast | Check text | WCAG AA compliant | ‚òê |\n| Dynamic type | Increase text size | Text scales properly | ‚òê |\n| Reduce motion | Enable setting | Animations reduced | ‚òê |\n\n---\n\n## Performance Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Cold start | Force close, reopen | < 3 seconds to interactive | ‚òê |\n| Feed scroll | Scroll rapidly | 60fps, no jank | ‚òê |\n| Image loading | Load image-heavy feed | Progressive loading | ‚òê |\n| Memory usage | Use for 10 minutes | No memory leaks | ‚òê |\n| Battery | Use for 1 hour | Reasonable battery usage | ‚òê |\n\n---\n\n## Edge Cases\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Deep link | Tap external link | Opens correct screen | ‚òê |\n| Universal link | Tap web URL | Opens in app | ‚òê |\n| Background refresh | Background for 1 hour | Data refreshes on foreground | ‚òê |\n| Low storage | Fill device storage | Graceful handling | ‚òê |\n| Orientation | Rotate device | Layout adapts (if supported) | ‚òê |\n| Interrupted upload | Kill during upload | Recovers gracefully | ‚òê |\n\n---\n\n## Security Tests\n\n| Test Case | Steps | Expected | Pass |\n|-----------|-------|----------|------|\n| Token storage | Check storage | Token in secure storage | ‚òê |\n| SSL pinning | Use proxy | Connection refused (if enabled) | ‚òê |\n| Session timeout | Leave app idle | Session expires | ‚òê |\n| Sensitive screenshots | Take screenshot on sensitive screen | Content protected (if enabled) | ‚òê |\n| Biometric bypass | Cancel biometric | Falls back to password | ‚òê |\n\n---\n\n## Regression Tests\n\nAfter each release, verify:\n\n- [ ] All authentication flows work\n- [ ] Feed loads and scrolls\n- [ ] Posts can be created\n- [ ] Comments work\n- [ ] Messages send and receive\n- [ ] Notifications appear\n- [ ] Profile edits save\n- [ ] Settings persist\n- [ ] No new crashes in analytics\n\n---\n\n## Test Reporting\n\n### Bug Report Template\n\n```markdown\n**Title**: [Brief description]\n\n**Environment**:\n- Device: [e.g., iPhone 14 Pro]\n- OS: [e.g., iOS 17.0]\n- App Version: [e.g., 1.0.0 (build 42)]\n\n**Steps to Reproduce**:\n1. [First step]\n2. [Second step]\n3. [And so on...]\n\n**Expected Result**:\n[What should happen]\n\n**Actual Result**:\n[What actually happened]\n\n**Screenshots/Video**:\n[Attach if applicable]\n\n**Severity**: [Critical/High/Medium/Low]\n\n**Additional Notes**:\n[Any other relevant information]\n```\n\n---\n\n## Sign-off\n\n| Role | Name | Date | Signature |\n|------|------|------|-----------|\n| QA Lead | | | |\n| Dev Lead | | | |\n| Product Manager | | | |\n","path":null,"size_bytes":15580,"size_tokens":null},"client/components/ThemedText.tsx":{"content":"import { Text, type TextProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Typography } from \"@/constants/theme\";\n\nexport type ThemedTextProps = TextProps & {\n  lightColor?: string;\n  darkColor?: string;\n  type?: \"hero\" | \"title\" | \"heading\" | \"body\" | \"caption\" | \"small\" | \"link\";\n};\n\nexport function ThemedText({\n  style,\n  lightColor,\n  darkColor,\n  type = \"body\",\n  ...rest\n}: ThemedTextProps) {\n  const { theme, isDark } = useTheme();\n\n  const getColor = () => {\n    if (isDark && darkColor) {\n      return darkColor;\n    }\n\n    if (!isDark && lightColor) {\n      return lightColor;\n    }\n\n    if (type === \"link\") {\n      return theme.link;\n    }\n\n    return theme.text;\n  };\n\n  const getTypeStyle = () => {\n    switch (type) {\n      case \"hero\":\n        return Typography.hero;\n      case \"title\":\n        return Typography.title;\n      case \"heading\":\n        return Typography.heading;\n      case \"body\":\n        return Typography.body;\n      case \"caption\":\n        return Typography.caption;\n      case \"small\":\n        return Typography.small;\n      case \"link\":\n        return Typography.link;\n      default:\n        return Typography.body;\n    }\n  };\n\n  return (\n    <Text style={[{ color: getColor() }, getTypeStyle(), style]} {...rest} />\n  );\n}\n","path":null,"size_bytes":1296,"size_tokens":null},"babel.config.js":{"content":"module.exports = function (api) {\n  api.cache(true);\n  return {\n    presets: [\"babel-preset-expo\"],\n    plugins: [\n      [\n        \"module-resolver\",\n        {\n          root: [\"./\"],\n          alias: {\n            \"@\": \"./client\",\n            \"@shared\": \"./shared\",\n            \"@medinvest/shared\": \"./packages/shared/src\",\n          },\n          extensions: [\".ios.js\", \".android.js\", \".js\", \".ts\", \".tsx\", \".json\"],\n        },\n      ],\n      \"react-native-reanimated/plugin\",\n    ],\n  };\n};\n","path":null,"size_bytes":494,"size_tokens":null},"client/components/InAppBrowser.tsx":{"content":"/**\n * In-App Browser Component\n * Open links without leaving the app\n */\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Modal,\n  ActivityIndicator,\n  Share,\n  Alert,\n  Linking,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { WebView, WebViewNavigation } from 'react-native-webview';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Clipboard from 'expo-clipboard';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\ninterface InAppBrowserProps {\n  visible: boolean;\n  url: string;\n  onClose: () => void;\n  title?: string;\n}\n\nexport default function InAppBrowser({\n  visible,\n  url,\n  onClose,\n  title,\n}: InAppBrowserProps) {\n  const { colors, isDark } = useThemeContext();\n  const appColors = useAppColors();\n  const webViewRef = useRef<WebView>(null);\n  \n  const [currentUrl, setCurrentUrl] = useState(url);\n  const [currentTitle, setCurrentTitle] = useState(title || '');\n  const [canGoBack, setCanGoBack] = useState(false);\n  const [canGoForward, setCanGoForward] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [progress, setProgress] = useState(0);\n  const [showMenu, setShowMenu] = useState(false);\n\n  const handleNavigationStateChange = useCallback((navState: WebViewNavigation) => {\n    setCurrentUrl(navState.url);\n    setCurrentTitle(navState.title || '');\n    setCanGoBack(navState.canGoBack);\n    setCanGoForward(navState.canGoForward);\n    setIsLoading(navState.loading);\n  }, []);\n\n  const handleGoBack = useCallback(() => {\n    if (canGoBack) {\n      webViewRef.current?.goBack();\n      haptics.buttonPress();\n    }\n  }, [canGoBack]);\n\n  const handleGoForward = useCallback(() => {\n    if (canGoForward) {\n      webViewRef.current?.goForward();\n      haptics.buttonPress();\n    }\n  }, [canGoForward]);\n\n  const handleRefresh = useCallback(() => {\n    webViewRef.current?.reload();\n    haptics.buttonPress();\n  }, []);\n\n  const handleShare = useCallback(async () => {\n    haptics.buttonPress();\n    setShowMenu(false);\n    \n    try {\n      await Share.share({\n        message: currentTitle ? `${currentTitle}\\n${currentUrl}` : currentUrl,\n        url: Platform.OS === 'ios' ? currentUrl : undefined,\n      });\n    } catch (error) {\n      console.error('Error sharing:', error);\n    }\n  }, [currentUrl, currentTitle]);\n\n  const handleCopyLink = useCallback(async () => {\n    haptics.buttonPress();\n    setShowMenu(false);\n    \n    await Clipboard.setStringAsync(currentUrl);\n    Alert.alert('Copied', 'Link copied to clipboard');\n  }, [currentUrl]);\n\n  const handleOpenInBrowser = useCallback(() => {\n    haptics.buttonPress();\n    setShowMenu(false);\n    \n    Linking.openURL(currentUrl);\n  }, [currentUrl]);\n\n  const handleClose = useCallback(() => {\n    haptics.modalClose();\n    onClose();\n  }, [onClose]);\n\n  // Extract domain from URL\n  const getDomain = (urlString: string): string => {\n    try {\n      const urlObj = new URL(urlString);\n      return urlObj.hostname.replace('www.', '');\n    } catch {\n      return urlString;\n    }\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      animationType=\"slide\"\n      presentationStyle=\"fullScreen\"\n      onRequestClose={handleClose}\n    >\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.surface }]} edges={['top']}>\n        {/* Header */}\n        <View style={[styles.header, { borderBottomColor: colors.border }]}>\n          <TouchableOpacity style={styles.closeButton} onPress={handleClose}>\n            <Ionicons name=\"close\" size={24} color={colors.textPrimary} />\n          </TouchableOpacity>\n          \n          <View style={styles.urlContainer}>\n            <Ionicons \n              name=\"lock-closed\" \n              size={12} \n              color={currentUrl.startsWith('https') ? Colors.secondary : colors.textSecondary}\n              style={styles.lockIcon}\n            />\n            <ThemedText style={[styles.urlText, { color: colors.textSecondary }]} numberOfLines={1}>\n              {getDomain(currentUrl)}\n            </ThemedText>\n          </View>\n          \n          <TouchableOpacity style={styles.menuButton} onPress={() => setShowMenu(true)}>\n            <Ionicons name=\"ellipsis-horizontal\" size={24} color={colors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Progress Bar */}\n        {isLoading && progress < 1 && (\n          <View style={styles.progressContainer}>\n            <View \n              style={[\n                styles.progressBar, \n                { \n                  backgroundColor: colors.primary,\n                  width: `${progress * 100}%`,\n                }\n              ]} \n            />\n          </View>\n        )}\n\n        {/* WebView */}\n        <WebView\n          ref={webViewRef}\n          source={{ uri: url }}\n          style={styles.webView}\n          onNavigationStateChange={handleNavigationStateChange}\n          onLoadStart={() => setIsLoading(true)}\n          onLoadEnd={() => setIsLoading(false)}\n          onLoadProgress={({ nativeEvent }) => setProgress(nativeEvent.progress)}\n          startInLoadingState\n          renderLoading={() => (\n            <View style={[styles.loadingContainer, { backgroundColor: appColors.surface }]}>\n              <ActivityIndicator size=\"large\" color={colors.primary} />\n            </View>\n          )}\n          allowsBackForwardNavigationGestures\n          sharedCookiesEnabled\n          thirdPartyCookiesEnabled\n          javaScriptEnabled\n          domStorageEnabled\n          mediaPlaybackRequiresUserAction\n          allowsInlineMediaPlayback\n        />\n\n        {/* Bottom Toolbar */}\n        <View style={[styles.toolbar, { backgroundColor: colors.surface, borderTopColor: colors.border }]}>\n          <TouchableOpacity\n            style={[styles.toolbarButton, !canGoBack && styles.toolbarButtonDisabled]}\n            onPress={handleGoBack}\n            disabled={!canGoBack}\n          >\n            <Ionicons\n              name=\"chevron-back\"\n              size={24}\n              color={canGoBack ? colors.textPrimary : colors.textTertiary}\n            />\n          </TouchableOpacity>\n          \n          <TouchableOpacity\n            style={[styles.toolbarButton, !canGoForward && styles.toolbarButtonDisabled]}\n            onPress={handleGoForward}\n            disabled={!canGoForward}\n          >\n            <Ionicons\n              name=\"chevron-forward\"\n              size={24}\n              color={canGoForward ? colors.textPrimary : colors.textTertiary}\n            />\n          </TouchableOpacity>\n          \n          <TouchableOpacity style={styles.toolbarButton} onPress={handleShare}>\n            <Ionicons name=\"share-outline\" size={22} color={colors.textPrimary} />\n          </TouchableOpacity>\n          \n          <TouchableOpacity style={styles.toolbarButton} onPress={handleRefresh}>\n            {isLoading ? (\n              <Ionicons name=\"close\" size={22} color={colors.textPrimary} />\n            ) : (\n              <Ionicons name=\"refresh\" size={22} color={colors.textPrimary} />\n            )}\n          </TouchableOpacity>\n        </View>\n\n        {/* Menu Modal */}\n        <Modal\n          visible={showMenu}\n          transparent\n          animationType=\"fade\"\n          onRequestClose={() => setShowMenu(false)}\n        >\n          <TouchableOpacity\n            style={styles.menuOverlay}\n            activeOpacity={1}\n            onPress={() => setShowMenu(false)}\n          >\n            <View style={[styles.menuContainer, { backgroundColor: colors.surface }]}>\n              <View style={[styles.menuHeader, { borderBottomColor: colors.border }]}>\n                <ThemedText style={[styles.menuTitle, { color: colors.textPrimary }]} numberOfLines={2}>\n                  {currentTitle || getDomain(currentUrl)}\n                </ThemedText>\n                <ThemedText style={[styles.menuUrl, { color: colors.textSecondary }]} numberOfLines={1}>\n                  {currentUrl}\n                </ThemedText>\n              </View>\n\n              <TouchableOpacity style={styles.menuItem} onPress={handleCopyLink}>\n                <Ionicons name=\"copy-outline\" size={22} color={colors.textPrimary} />\n                <ThemedText style={[styles.menuItemText, { color: colors.textPrimary }]}>\n                  Copy Link\n                </ThemedText>\n              </TouchableOpacity>\n\n              <TouchableOpacity style={styles.menuItem} onPress={handleShare}>\n                <Ionicons name=\"share-outline\" size={22} color={colors.textPrimary} />\n                <ThemedText style={[styles.menuItemText, { color: colors.textPrimary }]}>\n                  Share\n                </ThemedText>\n              </TouchableOpacity>\n\n              <TouchableOpacity style={styles.menuItem} onPress={handleOpenInBrowser}>\n                <Ionicons name=\"open-outline\" size={22} color={colors.textPrimary} />\n                <ThemedText style={[styles.menuItemText, { color: colors.textPrimary }]}>\n                  Open in Browser\n                </ThemedText>\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={[styles.menuItem, styles.menuCancel, { borderTopColor: appColors.border }]}\n                onPress={() => setShowMenu(false)}\n              >\n                <ThemedText style={[styles.menuCancelText, { color: colors.error }]}>\n                  Cancel\n                </ThemedText>\n              </TouchableOpacity>\n            </View>\n          </TouchableOpacity>\n        </Modal>\n      </SafeAreaView>\n    </Modal>\n  );\n}\n\n// Hook for managing in-app browser state\nexport function useInAppBrowser() {\n  const [browserState, setBrowserState] = useState<{\n    visible: boolean;\n    url: string;\n    title?: string;\n  }>({\n    visible: false,\n    url: '',\n  });\n\n  const openUrl = useCallback((url: string, title?: string) => {\n    haptics.modalOpen();\n    setBrowserState({\n      visible: true,\n      url,\n      title,\n    });\n  }, []);\n\n  const closeBrowser = useCallback(() => {\n    setBrowserState(prev => ({\n      ...prev,\n      visible: false,\n    }));\n  }, []);\n\n  return {\n    browserState,\n    openUrl,\n    closeBrowser,\n  };\n}\n\n// Link handler that opens in-app browser for external links\nexport function useLinkHandler() {\n  const { openUrl, closeBrowser, browserState } = useInAppBrowser();\n\n  const handleLink = useCallback((url: string, title?: string) => {\n    // Check if it's an internal app link\n    if (url.startsWith('medinvest://') || url.includes('medinvest.com')) {\n      // Handle internal navigation\n      Linking.openURL(url);\n    } else {\n      // Open external links in in-app browser\n      openUrl(url, title);\n    }\n  }, [openUrl]);\n\n  return {\n    handleLink,\n    openUrl,\n    closeBrowser,\n    browserState,\n  };\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  closeButton: {\n    padding: Spacing.sm,\n  },\n  urlContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.sm,\n  },\n  lockIcon: {\n    marginRight: 4,\n  },\n  urlText: {\n    ...Typography.caption,\n  },\n  menuButton: {\n    padding: Spacing.sm,\n  },\n  progressContainer: {\n    height: 2,\n    backgroundColor: 'transparent',\n  },\n  progressBar: {\n    height: '100%',\n  },\n  webView: {\n    flex: 1,\n  },\n  loadingContainer: {\n    ...StyleSheet.absoluteFillObject,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  toolbar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-around',\n    paddingVertical: Spacing.sm,\n    borderTopWidth: 1,\n  },\n  toolbarButton: {\n    padding: Spacing.md,\n  },\n  toolbarButtonDisabled: {\n    opacity: 0.5,\n  },\n\n  // Menu\n  menuOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'flex-end',\n  },\n  menuContainer: {\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n    paddingBottom: Spacing.xl,\n  },\n  menuHeader: {\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  menuTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  menuUrl: {\n    ...Typography.small,\n    marginTop: 4,\n  },\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  menuItemText: {\n    ...Typography.body,\n  },\n  menuCancel: {\n    justifyContent: 'center',\n    borderTopWidth: 1,\n    marginTop: Spacing.sm,\n  },\n  menuCancelText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":12973,"size_tokens":null},"client/services/storage.ts":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"client/components/SearchFilters.tsx":{"content":"/**\n * Search Filters Component\n * Filter search results by date, type, room, etc.\n */\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  ScrollView,\n  Modal,\n  Pressable,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport DateTimePicker from '@react-native-community/datetimepicker';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\n// Filter types\nexport type SearchType = 'all' | 'posts' | 'users' | 'rooms' | 'deals' | 'news';\nexport type DateRange = 'any' | 'today' | 'week' | 'month' | 'year' | 'custom';\nexport type SortBy = 'relevance' | 'recent' | 'popular';\n\nexport interface SearchFilters {\n  type: SearchType;\n  dateRange: DateRange;\n  customDateStart?: Date;\n  customDateEnd?: Date;\n  sortBy: SortBy;\n  roomId?: string;\n  verified?: boolean;\n}\n\nconst DEFAULT_FILTERS: SearchFilters = {\n  type: 'all',\n  dateRange: 'any',\n  sortBy: 'relevance',\n};\n\n// Type options\nconst TYPE_OPTIONS: { value: SearchType; label: string; icon: string }[] = [\n  { value: 'all', label: 'All', icon: 'apps-outline' },\n  { value: 'posts', label: 'Posts', icon: 'document-text-outline' },\n  { value: 'users', label: 'People', icon: 'people-outline' },\n  { value: 'rooms', label: 'Rooms', icon: 'grid-outline' },\n  { value: 'deals', label: 'Deals', icon: 'briefcase-outline' },\n  { value: 'news', label: 'News', icon: 'newspaper-outline' },\n];\n\n// Date range options\nconst DATE_OPTIONS: { value: DateRange; label: string }[] = [\n  { value: 'any', label: 'Any time' },\n  { value: 'today', label: 'Today' },\n  { value: 'week', label: 'Past week' },\n  { value: 'month', label: 'Past month' },\n  { value: 'year', label: 'Past year' },\n  { value: 'custom', label: 'Custom range' },\n];\n\n// Sort options\nconst SORT_OPTIONS: { value: SortBy; label: string }[] = [\n  { value: 'relevance', label: 'Most relevant' },\n  { value: 'recent', label: 'Most recent' },\n  { value: 'popular', label: 'Most popular' },\n];\n\ninterface SearchFiltersProps {\n  filters: SearchFilters;\n  onFiltersChange: (filters: SearchFilters) => void;\n  rooms?: { id: string; name: string }[];\n}\n\nexport default function SearchFiltersComponent({\n  filters,\n  onFiltersChange,\n  rooms = [],\n}: SearchFiltersProps) {\n  const { colors } = useThemeContext();\n  const [showFiltersModal, setShowFiltersModal] = useState(false);\n  const [showDatePicker, setShowDatePicker] = useState<'start' | 'end' | null>(null);\n  const [tempFilters, setTempFilters] = useState<SearchFilters>(filters);\n\n  // Count active filters\n  const activeFilterCount = useMemo(() => {\n    let count = 0;\n    if (filters.type !== 'all') count++;\n    if (filters.dateRange !== 'any') count++;\n    if (filters.sortBy !== 'relevance') count++;\n    if (filters.roomId) count++;\n    if (filters.verified) count++;\n    return count;\n  }, [filters]);\n\n  const handleOpenFilters = useCallback(() => {\n    setTempFilters(filters);\n    setShowFiltersModal(true);\n    haptics.modalOpen();\n  }, [filters]);\n\n  const handleApplyFilters = useCallback(() => {\n    onFiltersChange(tempFilters);\n    setShowFiltersModal(false);\n    haptics.success();\n  }, [tempFilters, onFiltersChange]);\n\n  const handleResetFilters = useCallback(() => {\n    setTempFilters(DEFAULT_FILTERS);\n    haptics.buttonPress();\n  }, []);\n\n  const handleTypeChange = useCallback((type: SearchType) => {\n    haptics.selection();\n    onFiltersChange({ ...filters, type });\n  }, [filters, onFiltersChange]);\n\n  const handleDateChange = useCallback((event: any, date?: Date) => {\n    if (date) {\n      if (showDatePicker === 'start') {\n        setTempFilters(prev => ({ ...prev, customDateStart: date }));\n      } else if (showDatePicker === 'end') {\n        setTempFilters(prev => ({ ...prev, customDateEnd: date }));\n      }\n    }\n    setShowDatePicker(null);\n  }, [showDatePicker]);\n\n  return (\n    <View style={styles.container}>\n      {/* Type Pills */}\n      <ScrollView\n        horizontal\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.typePills}\n      >\n        {TYPE_OPTIONS.map((option) => (\n          <TouchableOpacity\n            key={option.value}\n            style={[\n              styles.typePill,\n              { \n                backgroundColor: filters.type === option.value \n                  ? colors.primary \n                  : colors.backgroundSecondary,\n                borderColor: filters.type === option.value \n                  ? colors.primary \n                  : colors.border,\n              },\n            ]}\n            onPress={() => handleTypeChange(option.value)}\n          >\n            <Ionicons\n              name={option.icon as any}\n              size={16}\n              color={filters.type === option.value ? 'white' : colors.textSecondary}\n            />\n            <ThemedText\n              style={[\n                styles.typePillText,\n                { color: filters.type === option.value ? 'white' : colors.textPrimary },\n              ]}\n            >\n              {option.label}\n            </ThemedText>\n          </TouchableOpacity>\n        ))}\n\n        {/* Filter Button */}\n        <TouchableOpacity\n          style={[\n            styles.filterButton,\n            { \n              backgroundColor: activeFilterCount > 0 ? colors.primary + '15' : colors.backgroundSecondary,\n              borderColor: activeFilterCount > 0 ? colors.primary : colors.border,\n            },\n          ]}\n          onPress={handleOpenFilters}\n        >\n          <Ionicons\n            name=\"options-outline\"\n            size={18}\n            color={activeFilterCount > 0 ? colors.primary : colors.textSecondary}\n          />\n          {activeFilterCount > 0 && (\n            <View style={[styles.filterBadge, { backgroundColor: colors.primary }]}>\n              <ThemedText style={styles.filterBadgeText}>{activeFilterCount}</ThemedText>\n            </View>\n          )}\n        </TouchableOpacity>\n      </ScrollView>\n\n      {/* Filters Modal */}\n      <Modal\n        visible={showFiltersModal}\n        animationType=\"slide\"\n        presentationStyle=\"pageSheet\"\n        onRequestClose={() => setShowFiltersModal(false)}\n      >\n        <View style={[styles.modalContainer, { backgroundColor: colors.background }]}>\n          {/* Modal Header */}\n          <View style={[styles.modalHeader, { borderBottomColor: colors.border }]}>\n            <TouchableOpacity onPress={() => setShowFiltersModal(false)}>\n              <ThemedText style={[styles.modalCancel, { color: colors.textSecondary }]}>\n                Cancel\n              </ThemedText>\n            </TouchableOpacity>\n            <ThemedText style={[styles.modalTitle, { color: colors.textPrimary }]}>\n              Filters\n            </ThemedText>\n            <TouchableOpacity onPress={handleResetFilters}>\n              <ThemedText style={[styles.modalReset, { color: colors.primary }]}>\n                Reset\n              </ThemedText>\n            </TouchableOpacity>\n          </View>\n\n          <ScrollView style={styles.modalContent}>\n            {/* Date Range */}\n            <View style={styles.filterSection}>\n              <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                DATE RANGE\n              </ThemedText>\n              <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n                {DATE_OPTIONS.map((option, index) => (\n                  <TouchableOpacity\n                    key={option.value}\n                    style={[\n                      styles.optionItem,\n                      index < DATE_OPTIONS.length - 1 && { borderBottomWidth: 1, borderBottomColor: colors.border },\n                    ]}\n                    onPress={() => {\n                      haptics.selection();\n                      setTempFilters(prev => ({ ...prev, dateRange: option.value }));\n                    }}\n                  >\n                    <ThemedText style={[styles.optionText, { color: colors.textPrimary }]}>\n                      {option.label}\n                    </ThemedText>\n                    {tempFilters.dateRange === option.value && (\n                      <Ionicons name=\"checkmark\" size={20} color={colors.primary} />\n                    )}\n                  </TouchableOpacity>\n                ))}\n              </View>\n\n              {/* Custom Date Pickers */}\n              {tempFilters.dateRange === 'custom' && (\n                <View style={styles.customDateContainer}>\n                  <TouchableOpacity\n                    style={[styles.datePickerButton, { backgroundColor: colors.surface }]}\n                    onPress={() => setShowDatePicker('start')}\n                  >\n                    <ThemedText style={{ color: colors.textSecondary }}>From:</ThemedText>\n                    <ThemedText style={{ color: colors.textPrimary }}>\n                      {tempFilters.customDateStart?.toLocaleDateString() || 'Select date'}\n                    </ThemedText>\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    style={[styles.datePickerButton, { backgroundColor: colors.surface }]}\n                    onPress={() => setShowDatePicker('end')}\n                  >\n                    <ThemedText style={{ color: colors.textSecondary }}>To:</ThemedText>\n                    <ThemedText style={{ color: colors.textPrimary }}>\n                      {tempFilters.customDateEnd?.toLocaleDateString() || 'Select date'}\n                    </ThemedText>\n                  </TouchableOpacity>\n                </View>\n              )}\n            </View>\n\n            {/* Sort By */}\n            <View style={styles.filterSection}>\n              <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                SORT BY\n              </ThemedText>\n              <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n                {SORT_OPTIONS.map((option, index) => (\n                  <TouchableOpacity\n                    key={option.value}\n                    style={[\n                      styles.optionItem,\n                      index < SORT_OPTIONS.length - 1 && { borderBottomWidth: 1, borderBottomColor: colors.border },\n                    ]}\n                    onPress={() => {\n                      haptics.selection();\n                      setTempFilters(prev => ({ ...prev, sortBy: option.value }));\n                    }}\n                  >\n                    <ThemedText style={[styles.optionText, { color: colors.textPrimary }]}>\n                      {option.label}\n                    </ThemedText>\n                    {tempFilters.sortBy === option.value && (\n                      <Ionicons name=\"checkmark\" size={20} color={colors.primary} />\n                    )}\n                  </TouchableOpacity>\n                ))}\n              </View>\n            </View>\n\n            {/* Room Filter (if applicable) */}\n            {rooms.length > 0 && (tempFilters.type === 'all' || tempFilters.type === 'posts') && (\n              <View style={styles.filterSection}>\n                <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                  ROOM\n                </ThemedText>\n                <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n                  <TouchableOpacity\n                    style={[styles.optionItem, { borderBottomWidth: 1, borderBottomColor: colors.border }]}\n                    onPress={() => {\n                      haptics.selection();\n                      setTempFilters(prev => ({ ...prev, roomId: undefined }));\n                    }}\n                  >\n                    <ThemedText style={[styles.optionText, { color: colors.textPrimary }]}>\n                      All rooms\n                    </ThemedText>\n                    {!tempFilters.roomId && (\n                      <Ionicons name=\"checkmark\" size={20} color={colors.primary} />\n                    )}\n                  </TouchableOpacity>\n                  {rooms.slice(0, 10).map((room, index) => (\n                    <TouchableOpacity\n                      key={room.id}\n                      style={[\n                        styles.optionItem,\n                        index < Math.min(rooms.length, 10) - 1 && { borderBottomWidth: 1, borderBottomColor: colors.border },\n                      ]}\n                      onPress={() => {\n                        haptics.selection();\n                        setTempFilters(prev => ({ ...prev, roomId: room.id }));\n                      }}\n                    >\n                      <ThemedText style={[styles.optionText, { color: colors.textPrimary }]}>\n                        {room.name}\n                      </ThemedText>\n                      {tempFilters.roomId === room.id && (\n                        <Ionicons name=\"checkmark\" size={20} color={colors.primary} />\n                      )}\n                    </TouchableOpacity>\n                  ))}\n                </View>\n              </View>\n            )}\n\n            {/* Additional Options */}\n            <View style={styles.filterSection}>\n              <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n                OPTIONS\n              </ThemedText>\n              <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n                <TouchableOpacity\n                  style={styles.optionItem}\n                  onPress={() => {\n                    haptics.toggle();\n                    setTempFilters(prev => ({ ...prev, verified: !prev.verified }));\n                  }}\n                >\n                  <ThemedText style={[styles.optionText, { color: colors.textPrimary }]}>\n                    Verified users only\n                  </ThemedText>\n                  <Ionicons\n                    name={tempFilters.verified ? 'checkbox' : 'square-outline'}\n                    size={22}\n                    color={tempFilters.verified ? colors.primary : colors.textSecondary}\n                  />\n                </TouchableOpacity>\n              </View>\n            </View>\n          </ScrollView>\n\n          {/* Apply Button */}\n          <View style={[styles.modalFooter, { borderTopColor: colors.border }]}>\n            <TouchableOpacity\n              style={[styles.applyButton, { backgroundColor: colors.primary }]}\n              onPress={handleApplyFilters}\n            >\n              <ThemedText style={styles.applyButtonText}>Apply Filters</ThemedText>\n            </TouchableOpacity>\n          </View>\n        </View>\n\n        {/* Date Picker */}\n        {showDatePicker && (\n          <DateTimePicker\n            value={\n              showDatePicker === 'start'\n                ? tempFilters.customDateStart || new Date()\n                : tempFilters.customDateEnd || new Date()\n            }\n            mode=\"date\"\n            display=\"spinner\"\n            onChange={handleDateChange}\n          />\n        )}\n      </Modal>\n    </View>\n  );\n}\n\n// Active filter tags component\ninterface ActiveFilterTagsProps {\n  filters: SearchFilters;\n  onRemoveFilter: (key: keyof SearchFilters) => void;\n}\n\nexport function ActiveFilterTags({ filters, onRemoveFilter }: ActiveFilterTagsProps) {\n  const { colors } = useThemeContext();\n  const tags: { key: keyof SearchFilters; label: string }[] = [];\n\n  if (filters.dateRange !== 'any') {\n    const dateLabel = DATE_OPTIONS.find(d => d.value === filters.dateRange)?.label || filters.dateRange;\n    tags.push({ key: 'dateRange', label: dateLabel });\n  }\n  if (filters.sortBy !== 'relevance') {\n    const sortLabel = SORT_OPTIONS.find(s => s.value === filters.sortBy)?.label || filters.sortBy;\n    tags.push({ key: 'sortBy', label: sortLabel });\n  }\n  if (filters.verified) {\n    tags.push({ key: 'verified', label: 'Verified only' });\n  }\n\n  if (tags.length === 0) return null;\n\n  return (\n    <ScrollView\n      horizontal\n      showsHorizontalScrollIndicator={false}\n      contentContainerStyle={styles.activeTagsContainer}\n    >\n      {tags.map((tag) => (\n        <TouchableOpacity\n          key={tag.key}\n          style={[styles.activeTag, { backgroundColor: colors.primary + '15' }]}\n          onPress={() => {\n            haptics.buttonPress();\n            onRemoveFilter(tag.key);\n          }}\n        >\n          <ThemedText style={[styles.activeTagText, { color: colors.primary }]}>\n            {tag.label}\n          </ThemedText>\n          <Ionicons name=\"close-circle\" size={16} color={colors.primary} />\n        </TouchableOpacity>\n      ))}\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {},\n  typePills: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    gap: Spacing.sm,\n  },\n  typePill: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    borderWidth: 1,\n    gap: 6,\n  },\n  typePillText: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  filterButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 1,\n    position: 'relative',\n  },\n  filterBadge: {\n    position: 'absolute',\n    top: -4,\n    right: -4,\n    width: 18,\n    height: 18,\n    borderRadius: 9,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  filterBadgeText: {\n    ...Typography.small,\n    fontSize: 10,\n    color: 'white',\n    fontWeight: '700',\n  },\n\n  // Modal\n  modalContainer: {\n    flex: 1,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  modalCancel: {\n    ...Typography.body,\n  },\n  modalTitle: {\n    ...Typography.heading,\n  },\n  modalReset: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  modalContent: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  modalFooter: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  applyButton: {\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  applyButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n\n  // Filter sections\n  filterSection: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    letterSpacing: 0.5,\n    marginBottom: Spacing.sm,\n    marginLeft: Spacing.xs,\n  },\n  optionsContainer: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n  },\n  optionText: {\n    ...Typography.body,\n  },\n  customDateContainer: {\n    marginTop: Spacing.md,\n    gap: Spacing.sm,\n  },\n  datePickerButton: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n  },\n\n  // Active tags\n  activeTagsContainer: {\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: Spacing.sm,\n    gap: Spacing.sm,\n  },\n  activeTag: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: 4,\n  },\n  activeTagText: {\n    ...Typography.small,\n    fontWeight: '500',\n  },\n});\n","path":null,"size_bytes":19607,"size_tokens":null},"client/screens/AppearanceSettingsScreen.tsx":{"content":"/**\n * Appearance Settings Screen\n * Dark mode toggle and theme customization\n */\n\nimport React from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  ScrollView,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { useThemeContext, ThemeMode } from '@/contexts/ThemeContext';\nimport { Spacing, BorderRadius, Typography } from '@/constants/theme';\n\ninterface ThemeOption {\n  mode: ThemeMode;\n  title: string;\n  description: string;\n  icon: string;\n}\n\nconst THEME_OPTIONS: ThemeOption[] = [\n  {\n    mode: 'light',\n    title: 'Light',\n    description: 'Always use light theme',\n    icon: 'sunny-outline',\n  },\n  {\n    mode: 'dark',\n    title: 'Dark',\n    description: 'Always use dark theme',\n    icon: 'moon-outline',\n  },\n  {\n    mode: 'system',\n    title: 'System',\n    description: 'Match device settings',\n    icon: 'phone-portrait-outline',\n  },\n];\n\nexport default function AppearanceSettingsScreen() {\n  const navigation = useNavigation<any>();\n  const { mode, setMode, colors, isDark } = useThemeContext();\n\n  const handleSelectTheme = (newMode: ThemeMode) => {\n    setMode(newMode);\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      <View style={[styles.header, { backgroundColor: colors.surface, borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Appearance\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            THEME\n          </ThemedText>\n          \n          <View style={[styles.optionsCard, { backgroundColor: colors.surface }]}>\n            {THEME_OPTIONS.map((option, index) => (\n              <TouchableOpacity\n                key={option.mode}\n                style={[\n                  styles.optionItem,\n                  index < THEME_OPTIONS.length - 1 && { borderBottomWidth: 1, borderBottomColor: colors.border },\n                ]}\n                onPress={() => handleSelectTheme(option.mode)}\n              >\n                <View style={[styles.optionIcon, { backgroundColor: colors.backgroundSecondary }]}>\n                  <Ionicons \n                    name={option.icon as any} \n                    size={22} \n                    color={mode === option.mode ? colors.primary : colors.textSecondary} \n                  />\n                </View>\n                <View style={styles.optionContent}>\n                  <ThemedText style={[styles.optionTitle, { color: colors.textPrimary }]}>\n                    {option.title}\n                  </ThemedText>\n                  <ThemedText style={[styles.optionDescription, { color: colors.textSecondary }]}>\n                    {option.description}\n                  </ThemedText>\n                </View>\n                {mode === option.mode ? (\n                  <Ionicons name=\"checkmark-circle\" size={24} color={colors.primary} />\n                ) : null}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            PREVIEW\n          </ThemedText>\n          \n          <View style={[styles.previewCard, { backgroundColor: colors.surface }]}>\n            <View style={[styles.previewHeader, { borderBottomColor: colors.border }]}>\n              <View style={styles.previewNav}>\n                <View style={[styles.previewDot, { backgroundColor: colors.error }]} />\n                <View style={[styles.previewDot, { backgroundColor: colors.warning }]} />\n                <View style={[styles.previewDot, { backgroundColor: colors.success }]} />\n              </View>\n              <View style={[styles.previewLine, { backgroundColor: colors.backgroundSecondary, width: 120 }]} />\n            </View>\n            <View style={styles.previewContent}>\n              <View style={styles.previewPost}>\n                <View style={[styles.previewAvatar, { backgroundColor: colors.primary }]} />\n                <View style={styles.previewPostContent}>\n                  <View style={[styles.previewLine, { backgroundColor: colors.textPrimary, width: 100, height: 12, opacity: 0.8 }]} />\n                  <View style={[styles.previewLine, { backgroundColor: colors.textSecondary, width: 150, height: 10, marginTop: Spacing.xs }]} />\n                </View>\n              </View>\n              <View style={styles.previewActions}>\n                <View style={[styles.previewButton, { backgroundColor: colors.backgroundSecondary }]} />\n                <View style={[styles.previewButton, { backgroundColor: colors.primary }]} />\n              </View>\n            </View>\n          </View>\n        </View>\n\n        <View style={[styles.infoCard, { backgroundColor: colors.info + '15' }]}>\n          <Ionicons name=\"information-circle\" size={20} color={colors.info} />\n          <ThemedText style={[styles.infoText, { color: colors.textSecondary }]}>\n            System mode will automatically switch between light and dark themes based on your device settings.\n          </ThemedText>\n        </View>\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'flex-start',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n    fontSize: 17,\n    fontWeight: '600',\n  },\n  headerRight: {\n    width: 40,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n    marginLeft: Spacing.sm,\n  },\n  optionsCard: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  optionIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  optionContent: {\n    flex: 1,\n  },\n  optionTitle: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  optionDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  previewCard: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n  },\n  previewHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  previewNav: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  previewDot: {\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n  },\n  previewLine: {\n    height: 12,\n    borderRadius: 6,\n  },\n  previewContent: {\n    padding: Spacing.md,\n  },\n  previewPost: {\n    flexDirection: 'row',\n  },\n  previewAvatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    marginRight: Spacing.md,\n  },\n  previewPostContent: {\n    flex: 1,\n  },\n  previewActions: {\n    flexDirection: 'row',\n    marginTop: Spacing.md,\n    gap: Spacing.md,\n  },\n  previewButton: {\n    width: 60,\n    height: 28,\n    borderRadius: 14,\n  },\n  infoCard: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  infoText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":8240,"size_tokens":null},"client/navigation/DiscoverStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport DiscoverScreen from \"@/screens/DiscoverScreen\";\nimport InvestmentDetailScreen from \"@/screens/InvestmentDetailScreen\";\n\nexport type DiscoverStackParamList = {\n  Discover: undefined;\n  InvestmentDetail: { id: string };\n};\n\nconst Stack = createNativeStackNavigator<DiscoverStackParamList>();\n\nexport default function DiscoverStackNavigator() {\n  const screenOptions = useScreenOptions();\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      <Stack.Screen\n        name=\"Discover\"\n        component={DiscoverScreen}\n        options={{ headerShown: false }}\n      />\n      <Stack.Screen\n        name=\"InvestmentDetail\"\n        component={InvestmentDetailScreen}\n        options={{ headerTitle: \"\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":923,"size_tokens":null},"client/screens/ResearchScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  RefreshControl,\n  Pressable,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Haptics from \"expo-haptics\";\nimport Animated, {\n  FadeInDown,\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { articles, Article } from \"@/lib/mockData\";\nimport { storage } from \"@/lib/storage\";\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport default function ResearchScreen() {\n  const insets = useSafeAreaInsets();\n  const { theme } = useTheme();\n  const appColors = useAppColors();\n  const [refreshing, setRefreshing] = useState(false);\n  const [bookmarkedIds, setBookmarkedIds] = useState<string[]>([]);\n\n  React.useEffect(() => {\n    loadBookmarks();\n  }, []);\n\n  const loadBookmarks = async () => {\n    const bookmarks = await storage.getBookmarks();\n    setBookmarkedIds(bookmarks);\n  };\n\n  const onRefresh = useCallback(() => {\n    setRefreshing(true);\n    setTimeout(() => {\n      setRefreshing(false);\n    }, 1000);\n  }, []);\n\n  const handleBookmark = async (articleId: string) => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    const isNowBookmarked = await storage.toggleBookmark(articleId);\n    if (isNowBookmarked) {\n      setBookmarkedIds((prev) => [...prev, articleId]);\n    } else {\n      setBookmarkedIds((prev) => prev.filter((id) => id !== articleId));\n    }\n  };\n\n  const featuredArticle = articles.find((a) => a.featured);\n  const regularArticles = articles.filter((a) => !a.featured);\n\n  const renderFeaturedArticle = () => {\n    if (!featuredArticle) return null;\n\n    return (\n      <Animated.View\n        entering={FadeInDown.springify()}\n        style={[\n          styles.featuredCard,\n          { backgroundColor: theme.backgroundDefault },\n          Shadows.card,\n        ]}\n      >\n        <View\n          style={[styles.featuredImagePlaceholder, { backgroundColor: Colors.primary + \"15\" }]}\n        >\n          <Feather name=\"file-text\" size={48} color={Colors.primary} />\n        </View>\n        <View style={styles.featuredContent}>\n          <View style={styles.featuredMeta}>\n            <View style={[styles.categoryTag, { backgroundColor: Colors.primary + \"15\" }]}>\n              <ThemedText type=\"small\" style={{ color: Colors.primary, fontWeight: \"600\" }}>\n                {featuredArticle.category}\n              </ThemedText>\n            </View>\n            <Pressable\n              onPress={() => handleBookmark(featuredArticle.id)}\n              hitSlop={8}\n            >\n              <Feather\n                name={bookmarkedIds.includes(featuredArticle.id) ? \"bookmark\" : \"bookmark\"}\n                size={20}\n                color={\n                  bookmarkedIds.includes(featuredArticle.id)\n                    ? Colors.primary\n                    : theme.textSecondary\n                }\n              />\n            </Pressable>\n          </View>\n          <ThemedText type=\"heading\" style={styles.featuredTitle}>\n            {featuredArticle.title}\n          </ThemedText>\n          <View style={styles.articleMeta}>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {featuredArticle.source}\n            </ThemedText>\n            <View style={[styles.metaDot, { backgroundColor: appColors.border }]} />\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {featuredArticle.publishedAt}\n            </ThemedText>\n            <View style={[styles.metaDot, { backgroundColor: appColors.border }]} />\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {featuredArticle.readTime}\n            </ThemedText>\n          </View>\n        </View>\n      </Animated.View>\n    );\n  };\n\n  const renderItem = useCallback(\n    ({ item, index }: { item: Article; index: number }) => (\n      <ArticleCard\n        article={item}\n        index={index}\n        isBookmarked={bookmarkedIds.includes(item.id)}\n        onBookmark={() => handleBookmark(item.id)}\n      />\n    ),\n    [bookmarkedIds]\n  );\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <View\n        style={[\n          styles.screenHeader,\n          { paddingTop: insets.top + Spacing.lg },\n        ]}\n      >\n        <ThemedText type=\"title\">Research</ThemedText>\n        <Pressable hitSlop={8}>\n          <Feather name=\"bookmark\" size={22} color={theme.text} />\n        </Pressable>\n      </View>\n\n      <FlatList\n        data={regularArticles}\n        renderItem={renderItem}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: insets.bottom + 100 },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n        }\n        ListHeaderComponent={\n          <>\n            {renderFeaturedArticle()}\n            <ThemedText type=\"heading\" style={styles.sectionTitle}>\n              Latest News\n            </ThemedText>\n          </>\n        }\n      />\n    </View>\n  );\n}\n\nfunction ArticleCard({\n  article,\n  index,\n  isBookmarked,\n  onBookmark,\n}: {\n  article: Article;\n  index: number;\n  isBookmarked: boolean;\n  onBookmark: () => void;\n}) {\n  const { theme } = useTheme();\n  const appColors = useAppColors();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98, { damping: 15, stiffness: 150 });\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, { damping: 15, stiffness: 150 });\n  };\n\n  return (\n    <AnimatedPressable\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={animatedStyle}\n    >\n      <Animated.View\n        entering={FadeInDown.delay(index * 60).springify()}\n        style={[\n          styles.articleCard,\n          { backgroundColor: theme.backgroundDefault },\n          Shadows.card,\n        ]}\n      >\n        <View\n          style={[styles.articleThumbnail, { backgroundColor: Colors.primary + \"10\" }]}\n        >\n          <Feather name=\"file-text\" size={24} color={Colors.primary} />\n        </View>\n        <View style={styles.articleContent}>\n          <View style={styles.articleHeader}>\n            <View style={[styles.smallCategoryTag, { backgroundColor: Colors.primary + \"15\" }]}>\n              <ThemedText type=\"small\" style={{ color: Colors.primary, fontWeight: \"500\" }}>\n                {article.category}\n              </ThemedText>\n            </View>\n            <Pressable onPress={onBookmark} hitSlop={8}>\n              <Feather\n                name=\"bookmark\"\n                size={16}\n                color={isBookmarked ? Colors.primary : theme.textSecondary}\n              />\n            </Pressable>\n          </View>\n          <ThemedText type=\"body\" numberOfLines={2} style={styles.articleTitle}>\n            {article.title}\n          </ThemedText>\n          <View style={styles.articleMeta}>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {article.source}\n            </ThemedText>\n            <View style={[styles.metaDot, { backgroundColor: appColors.border }]} />\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {article.publishedAt}\n            </ThemedText>\n          </View>\n        </View>\n      </Animated.View>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  screenHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.lg,\n  },\n  listContent: {\n    padding: Spacing.xl,\n    paddingTop: 0,\n  },\n  featuredCard: {\n    borderRadius: BorderRadius.sm,\n    overflow: \"hidden\",\n    marginBottom: Spacing.xl,\n  },\n  featuredImagePlaceholder: {\n    height: 160,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  featuredContent: {\n    padding: Spacing.lg,\n  },\n  featuredMeta: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  categoryTag: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  featuredTitle: {\n    marginBottom: Spacing.sm,\n  },\n  sectionTitle: {\n    marginBottom: Spacing.md,\n  },\n  articleCard: {\n    flexDirection: \"row\",\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.md,\n    gap: Spacing.md,\n  },\n  articleThumbnail: {\n    width: 80,\n    height: 80,\n    borderRadius: BorderRadius.xs,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  articleContent: {\n    flex: 1,\n  },\n  articleHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: Spacing.xs,\n  },\n  smallCategoryTag: {\n    paddingHorizontal: Spacing.xs,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  articleTitle: {\n    marginBottom: Spacing.xs,\n  },\n  articleMeta: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  metaDot: {\n    width: 3,\n    height: 3,\n    borderRadius: 1.5,\n    marginHorizontal: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":9781,"size_tokens":null},"client/components/CustomRefreshControl.tsx":{"content":"/**\n * Custom Pull-to-Refresh Animation\n * Branded refresh animation with MedInvest styling\n */\n\nimport React, { useRef, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  Easing,\n  RefreshControl as RNRefreshControl,\n  RefreshControlProps,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport Svg, { Circle, Path, G } from 'react-native-svg';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\n\nconst AnimatedCircle = Animated.createAnimatedComponent(Circle);\nconst AnimatedPath = Animated.createAnimatedComponent(Path);\nconst AnimatedG = Animated.createAnimatedComponent(G);\n\ninterface CustomRefreshControlProps extends Omit<RefreshControlProps, 'colors' | 'tintColor'> {\n  refreshing: boolean;\n  onRefresh: () => void;\n  pullProgress?: number;\n}\n\nexport default function CustomRefreshControl({\n  refreshing,\n  onRefresh,\n  ...props\n}: CustomRefreshControlProps) {\n  const appColors = useAppColors();\n  return (\n    <RNRefreshControl\n      refreshing={refreshing}\n      onRefresh={onRefresh}\n      tintColor={Colors.primary}\n      colors={[Colors.primary, Colors.secondary]}\n      progressBackgroundColor={appColors.surface}\n      {...props}\n    />\n  );\n}\n\ninterface LogoRefreshAnimationProps {\n  progress: Animated.Value;\n  isRefreshing: boolean;\n}\n\nexport function LogoRefreshAnimation({ progress, isRefreshing }: LogoRefreshAnimationProps) {\n  const spinValue = useRef(new Animated.Value(0)).current;\n  const pulseValue = useRef(new Animated.Value(1)).current;\n\n  useEffect(() => {\n    if (isRefreshing) {\n      const spinAnimation = Animated.loop(\n        Animated.timing(spinValue, {\n          toValue: 1,\n          duration: 1000,\n          easing: Easing.linear,\n          useNativeDriver: true,\n        })\n      );\n      spinAnimation.start();\n\n      const pulseAnimation = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseValue, {\n            toValue: 1.1,\n            duration: 500,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pulseValue, {\n            toValue: 1,\n            duration: 500,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n      pulseAnimation.start();\n\n      return () => {\n        spinAnimation.stop();\n        pulseAnimation.stop();\n      };\n    } else {\n      spinValue.setValue(0);\n      pulseValue.setValue(1);\n    }\n  }, [isRefreshing]);\n\n  const spin = spinValue.interpolate({\n    inputRange: [0, 1],\n    outputRange: ['0deg', '360deg'],\n  });\n\n  const scale = progress.interpolate({\n    inputRange: [0, 1],\n    outputRange: [0.5, 1],\n    extrapolate: 'clamp',\n  });\n\n  const opacity = progress.interpolate({\n    inputRange: [0, 0.5, 1],\n    outputRange: [0, 0.5, 1],\n    extrapolate: 'clamp',\n  });\n\n  return (\n    <Animated.View\n      style={[\n        styles.logoContainer,\n        {\n          opacity,\n          transform: [\n            { scale: Animated.multiply(scale, pulseValue) },\n            { rotate: isRefreshing ? spin : '0deg' },\n          ],\n        },\n      ]}\n    >\n      <View style={styles.logoCircle}>\n        <Ionicons name=\"medical\" size={24} color=\"white\" />\n      </View>\n    </Animated.View>\n  );\n}\n\ninterface PulseDotsProps {\n  isActive: boolean;\n  color?: string;\n}\n\nexport function PulseDots({ isActive, color = Colors.primary }: PulseDotsProps) {\n  const dot1 = useRef(new Animated.Value(0.3)).current;\n  const dot2 = useRef(new Animated.Value(0.3)).current;\n  const dot3 = useRef(new Animated.Value(0.3)).current;\n\n  useEffect(() => {\n    if (isActive) {\n      const createDotAnimation = (dot: Animated.Value, delay: number) => {\n        return Animated.loop(\n          Animated.sequence([\n            Animated.delay(delay),\n            Animated.timing(dot, {\n              toValue: 1,\n              duration: 300,\n              useNativeDriver: true,\n            }),\n            Animated.timing(dot, {\n              toValue: 0.3,\n              duration: 300,\n              useNativeDriver: true,\n            }),\n          ])\n        );\n      };\n\n      const animation = Animated.parallel([\n        createDotAnimation(dot1, 0),\n        createDotAnimation(dot2, 150),\n        createDotAnimation(dot3, 300),\n      ]);\n\n      animation.start();\n      return () => animation.stop();\n    }\n  }, [isActive]);\n\n  if (!isActive) return null;\n\n  return (\n    <View style={styles.dotsContainer}>\n      <Animated.View style={[styles.dot, { backgroundColor: color, opacity: dot1 }]} />\n      <Animated.View style={[styles.dot, { backgroundColor: color, opacity: dot2 }]} />\n      <Animated.View style={[styles.dot, { backgroundColor: color, opacity: dot3 }]} />\n    </View>\n  );\n}\n\ninterface HeartbeatAnimationProps {\n  isActive: boolean;\n}\n\nexport function HeartbeatAnimation({ isActive }: HeartbeatAnimationProps) {\n  const translateX = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    if (isActive) {\n      const animation = Animated.loop(\n        Animated.timing(translateX, {\n          toValue: -100,\n          duration: 1500,\n          easing: Easing.linear,\n          useNativeDriver: true,\n        })\n      );\n      animation.start();\n      return () => animation.stop();\n    } else {\n      translateX.setValue(0);\n    }\n  }, [isActive]);\n\n  if (!isActive) return null;\n\n  return (\n    <View style={styles.heartbeatContainer}>\n      <Animated.View style={[styles.heartbeatLine, { transform: [{ translateX }] }]}>\n        <Svg width={200} height={40} viewBox=\"0 0 200 40\">\n          <Path\n            d=\"M0,20 L30,20 L35,20 L40,5 L45,35 L50,10 L55,30 L60,20 L65,20 L200,20\"\n            stroke={Colors.primary}\n            strokeWidth={2}\n            fill=\"none\"\n          />\n        </Svg>\n      </Animated.View>\n    </View>\n  );\n}\n\ninterface CircularProgressProps {\n  progress: number;\n  size?: number;\n  strokeWidth?: number;\n  color?: string;\n}\n\nexport function CircularProgress({\n  progress,\n  size = 40,\n  strokeWidth = 3,\n  color = Colors.primary,\n}: CircularProgressProps) {\n  const appColors = useAppColors();\n  const radius = (size - strokeWidth) / 2;\n  const circumference = radius * 2 * Math.PI;\n  const strokeDashoffset = circumference - progress * circumference;\n\n  return (\n    <View style={{ width: size, height: size }}>\n      <Svg width={size} height={size}>\n        {/* Background circle */}\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke={appColors.border}\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n        />\n        {/* Progress circle */}\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke={color}\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n          strokeDasharray={circumference}\n          strokeDashoffset={strokeDashoffset}\n          strokeLinecap=\"round\"\n          transform={`rotate(-90 ${size / 2} ${size / 2})`}\n        />\n      </Svg>\n      {/* Center icon */}\n      <View style={styles.circularProgressIcon}>\n        <Ionicons name=\"arrow-down\" size={16} color={color} />\n      </View>\n    </View>\n  );\n}\n\ninterface RefreshHeaderProps {\n  progress: number;\n  isRefreshing: boolean;\n  pullText?: string;\n  releaseText?: string;\n  refreshingText?: string;\n}\n\nexport function RefreshHeader({\n  progress,\n  isRefreshing,\n  pullText = 'Pull to refresh',\n  releaseText = 'Release to refresh',\n  refreshingText = 'Refreshing...',\n}: RefreshHeaderProps) {\n  const appColors = useAppColors();\n\n  const getText = () => {\n    if (isRefreshing) return refreshingText;\n    if (progress >= 1) return releaseText;\n    return pullText;\n  };\n\n  return (\n    <View style={[styles.refreshHeader, { backgroundColor: appColors.background }]}>\n      <View style={styles.refreshContent}>\n        {isRefreshing ? (\n          <PulseDots isActive={true} />\n        ) : (\n          <CircularProgress progress={Math.min(progress, 1)} />\n        )}\n        <ThemedText style={[styles.refreshText, { color: appColors.textSecondary }]}>{getText()}</ThemedText>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  logoContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  logoCircle: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    shadowColor: Colors.primary,\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.3,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n\n  dotsContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: Spacing.xs,\n  },\n  dot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n\n  heartbeatContainer: {\n    width: 100,\n    height: 40,\n    overflow: 'hidden',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  heartbeatLine: {\n    position: 'absolute',\n  },\n\n  circularProgressIcon: {\n    ...StyleSheet.absoluteFillObject,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n\n  refreshHeader: {\n    height: 60,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  refreshContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.md,\n  },\n  refreshText: {\n    ...Typography.caption,\n  },\n});\n","path":null,"size_bytes":9332,"size_tokens":null},"client/screens/BookmarksScreen.tsx":{"content":"/**\n * Bookmarks Screen\n * View saved/bookmarked posts\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi, postsApi } from '@/lib/api';\nimport { Post } from '@/types';\nimport PostCard from '@/components/PostCard';\n\nexport default function BookmarksScreen() {\n  const navigation = useNavigation<any>();\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  const {\n    data: posts,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['bookmarks'],\n    queryFn: async () => {\n      const response = await usersApi.getBookmarks();\n      return response.data?.posts || [];\n    },\n  });\n\n  const removeBookmarkMutation = useMutation({\n    mutationFn: (postId: number) => postsApi.removeBookmark(postId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['bookmarks'] });\n    },\n  });\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const handleRemoveBookmark = useCallback((postId: number) => {\n    removeBookmarkMutation.mutate(postId);\n  }, [removeBookmarkMutation]);\n\n  const renderPost = ({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item.id)}\n      onUserPress={() => handleUserPress(item.author.id)}\n      onVote={() => {}}\n      onBookmark={() => handleRemoveBookmark(item.id)}\n    />\n  );\n\n  const renderEmpty = () => {\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={Colors.primary} />\n        </View>\n      );\n    }\n    return (\n      <View style={styles.emptyContainer}>\n        <Ionicons name=\"bookmark-outline\" size={64} color={appColors.textSecondary} />\n        <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No bookmarks yet</ThemedText>\n        <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n          Posts you save will appear here\n        </ThemedText>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Bookmarks</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      {/* Posts List */}\n      <FlatList\n        data={posts}\n        renderItem={renderPost}\n        keyExtractor={(item) => item.id.toString()}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={posts?.length === 0 ? styles.emptyList : undefined}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyList: {\n    flex: 1,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":4750,"size_tokens":null},"client/screens/BlockedUsersScreen.tsx":{"content":"/**\n * BlockedUsers Screen\n * View and manage blocked users\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi } from '@/lib/api';\nimport { User } from '@/types';\nimport { formatRelativeTime } from '@/lib/utils';\n\ninterface BlockedUser {\n  user: User;\n  blocked_at: string;\n}\n\nexport default function BlockedUsersScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const queryClient = useQueryClient();\n\n  const {\n    data: blockedUsers,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['blockedUsers'],\n    queryFn: async () => {\n      const response = await usersApi.getBlockedUsers();\n      return response.data?.users || [];\n    },\n  });\n\n  const unblockMutation = useMutation({\n    mutationFn: async (userId: number) => {\n      const response = await usersApi.unblock(userId);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to unblock user');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['blockedUsers'] });\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const handleUnblock = useCallback((user: User) => {\n    Alert.alert(\n      'Unblock User',\n      `Are you sure you want to unblock ${user.full_name}? They will be able to see your profile and interact with your content again.`,\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Unblock',\n          onPress: () => unblockMutation.mutate(user.id),\n        },\n      ]\n    );\n  }, [unblockMutation]);\n\n  const renderUser = ({ item }: { item: BlockedUser }) => (\n    <View style={[styles.userCard, { backgroundColor: appColors.surface }]}>\n      <TouchableOpacity\n        style={styles.userInfo}\n        onPress={() => navigation.navigate('UserProfile', { userId: item.user.id })}\n      >\n        {item.user.avatar_url ? (\n          <Image source={{ uri: item.user.avatar_url }} style={styles.avatar} />\n        ) : (\n          <View style={[styles.avatar, styles.avatarPlaceholder]}>\n            <ThemedText style={styles.avatarText}>\n              {item.user.first_name?.[0]}{item.user.last_name?.[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View style={styles.userDetails}>\n          <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>{item.user.full_name}</ThemedText>\n          {item.user.specialty && (\n            <ThemedText style={[styles.userSpecialty, { color: appColors.textSecondary }]}>{item.user.specialty}</ThemedText>\n          )}\n          <ThemedText style={[styles.blockedDate, { color: appColors.textSecondary }]}>\n            Blocked {formatRelativeTime(item.blocked_at)}\n          </ThemedText>\n        </View>\n      </TouchableOpacity>\n\n      <TouchableOpacity\n        style={styles.unblockButton}\n        onPress={() => handleUnblock(item.user)}\n        disabled={unblockMutation.isPending}\n      >\n        {unblockMutation.isPending ? (\n          <ActivityIndicator size=\"small\" color={Colors.primary} />\n        ) : (\n          <ThemedText style={styles.unblockButtonText}>Unblock</ThemedText>\n        )}\n      </TouchableOpacity>\n    </View>\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <View style={styles.emptyIcon}>\n        <Ionicons name=\"person-remove-outline\" size={48} color={appColors.textSecondary} />\n      </View>\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No Blocked Users</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        When you block someone, they'll appear here. Blocked users can't see your profile or interact with your content.\n      </ThemedText>\n    </View>\n  );\n\n  const renderHeader = () => (\n    <View style={styles.infoCard}>\n      <Ionicons name=\"information-circle-outline\" size={20} color={appColors.textSecondary} />\n      <ThemedText style={[styles.infoText, { color: appColors.textSecondary }]}>\n        Blocked users cannot view your profile, see your posts, or send you messages. They won't be notified when you block or unblock them.\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Blocked Users</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      <FlatList\n        data={blockedUsers}\n        renderItem={renderUser}\n        keyExtractor={(item) => item.user.id.toString()}\n        ListHeaderComponent={blockedUsers && blockedUsers.length > 0 ? renderHeader : null}\n        ListEmptyComponent={renderEmpty}\n        contentContainerStyle={[\n          styles.listContent,\n          (!blockedUsers || blockedUsers.length === 0) && styles.listContentEmpty,\n        ]}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  listContent: {\n    padding: Spacing.md,\n  },\n  listContentEmpty: {\n    flex: 1,\n  },\n  infoCard: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    backgroundColor: Colors.light.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  infoText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 20,\n  },\n  userCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.sm,\n    ...Shadows.card,\n  },\n  userInfo: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  avatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  userDetails: {\n    flex: 1,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userSpecialty: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  blockedDate: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  unblockButton: {\n    backgroundColor: Colors.primary + '15',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    minWidth: 80,\n    alignItems: 'center',\n  },\n  unblockButtonText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.lg,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.sm,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 24,\n  },\n});\n","path":null,"size_bytes":8960,"size_tokens":null},"client/lib/share.ts":{"content":"/**\n * Share Sheet Service\n * Share posts and content externally\n */\n\nimport { Share, Platform, Alert } from 'react-native';\nimport * as Clipboard from 'expo-clipboard';\nimport { haptics } from '@/lib/haptics';\nimport { useCallback } from 'react';\n\nexport interface ShareContent {\n  title?: string;\n  message: string;\n  url?: string;\n}\n\nexport interface ShareResult {\n  success: boolean;\n  action?: 'shared' | 'dismissed' | 'copied';\n  activityType?: string;\n}\n\nclass ShareService {\n  async share(content: ShareContent): Promise<ShareResult> {\n    try {\n      haptics.modalOpen();\n\n      const shareOptions: { message: string; title?: string; url?: string } = {\n        message: content.message,\n      };\n\n      if (content.title) {\n        shareOptions.title = content.title;\n      }\n\n      if (content.url) {\n        if (Platform.OS === 'ios') {\n          shareOptions.url = content.url;\n        } else {\n          shareOptions.message = `${content.message}\\n\\n${content.url}`;\n        }\n      }\n\n      const result = await Share.share(shareOptions);\n\n      if (result.action === Share.sharedAction) {\n        haptics.success();\n        return {\n          success: true,\n          action: 'shared',\n          activityType: result.activityType ?? undefined,\n        };\n      } else if (result.action === Share.dismissedAction) {\n        return {\n          success: false,\n          action: 'dismissed',\n        };\n      }\n\n      return { success: false };\n    } catch (error) {\n      console.error('[Share] Error sharing:', error);\n      haptics.error();\n      return { success: false };\n    }\n  }\n\n  async copyToClipboard(text: string): Promise<boolean> {\n    try {\n      await Clipboard.setStringAsync(text);\n      haptics.success();\n      return true;\n    } catch (error) {\n      console.error('[Share] Error copying to clipboard:', error);\n      haptics.error();\n      return false;\n    }\n  }\n\n  async sharePost(post: {\n    id: number;\n    content: string;\n    author: { full_name: string };\n  }): Promise<ShareResult> {\n    const postUrl = `https://medinvest.com/posts/${post.id}`;\n    const truncatedContent = post.content.length > 100 \n      ? `${post.content.substring(0, 100)}...` \n      : post.content;\n\n    return this.share({\n      title: `Post by ${post.author.full_name} on MedInvest`,\n      message: truncatedContent,\n      url: postUrl,\n    });\n  }\n\n  async shareDeal(deal: {\n    id: number;\n    company_name: string;\n    tagline?: string;\n  }): Promise<ShareResult> {\n    const dealUrl = `https://medinvest.com/deals/${deal.id}`;\n    \n    return this.share({\n      title: deal.company_name,\n      message: deal.tagline || `Check out ${deal.company_name} on MedInvest`,\n      url: dealUrl,\n    });\n  }\n\n  async shareProfile(user: {\n    id: number;\n    full_name: string;\n    specialty?: string;\n  }): Promise<ShareResult> {\n    const profileUrl = `https://medinvest.com/users/${user.id}`;\n    const message = user.specialty \n      ? `${user.full_name} - ${user.specialty} on MedInvest`\n      : `${user.full_name} on MedInvest`;\n\n    return this.share({\n      title: user.full_name,\n      message,\n      url: profileUrl,\n    });\n  }\n\n  async shareRoom(room: {\n    slug: string;\n    name: string;\n    member_count?: number;\n  }): Promise<ShareResult> {\n    const roomUrl = `https://medinvest.com/rooms/${room.slug}`;\n    const message = room.member_count \n      ? `Join ${room.name} - ${room.member_count} members on MedInvest`\n      : `Join ${room.name} on MedInvest`;\n\n    return this.share({\n      title: room.name,\n      message,\n      url: roomUrl,\n    });\n  }\n\n  async shareAppInvite(referralCode?: string): Promise<ShareResult> {\n    const baseUrl = 'https://medinvest.com';\n    const url = referralCode ? `${baseUrl}?ref=${referralCode}` : baseUrl;\n\n    return this.share({\n      title: 'Join MedInvest',\n      message: 'Join me on MedInvest - the healthcare investment community!',\n      url,\n    });\n  }\n\n  showShareSheet(content: ShareContent, onCopy?: () => void) {\n    const options = [\n      {\n        text: 'Share',\n        onPress: () => this.share(content),\n      },\n      {\n        text: 'Copy Link',\n        onPress: async () => {\n          if (content.url) {\n            await this.copyToClipboard(content.url);\n            onCopy?.();\n          }\n        },\n      },\n      { text: 'Cancel', style: 'cancel' as const },\n    ];\n\n    Alert.alert('Share', 'How would you like to share?', options);\n  }\n}\n\nexport const shareService = new ShareService();\n\nexport function useShare() {\n  const share = useCallback((content: ShareContent) => {\n    return shareService.share(content);\n  }, []);\n\n  const sharePost = useCallback((post: Parameters<typeof shareService.sharePost>[0]) => {\n    return shareService.sharePost(post);\n  }, []);\n\n  const shareDeal = useCallback((deal: Parameters<typeof shareService.shareDeal>[0]) => {\n    return shareService.shareDeal(deal);\n  }, []);\n\n  const shareProfile = useCallback((user: Parameters<typeof shareService.shareProfile>[0]) => {\n    return shareService.shareProfile(user);\n  }, []);\n\n  const copyToClipboard = useCallback((text: string) => {\n    return shareService.copyToClipboard(text);\n  }, []);\n\n  const shareAppInvite = useCallback((referralCode?: string) => {\n    return shareService.shareAppInvite(referralCode);\n  }, []);\n\n  return {\n    share,\n    sharePost,\n    shareDeal,\n    shareProfile,\n    copyToClipboard,\n    shareAppInvite,\n  };\n}\n","path":null,"size_bytes":5423,"size_tokens":null},"client/components/PinnedPosts.tsx":{"content":"/**\n * Pinned Posts\n * Pin important posts to profile\n */\n\nimport React, { useState, useCallback, memo, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Alert,\n  FlatList,\n  ActivityIndicator,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { postsApi } from '@/lib/api';\n\n// Types\nexport interface PinnedPost {\n  postId: number;\n  pinnedAt: string;\n  order: number;\n}\n\nconst MAX_PINNED_POSTS = 3;\nconst PINNED_POSTS_KEY = 'pinned_posts';\n\n// =============================================================================\n// PINNED POSTS SERVICE\n// =============================================================================\n\nclass PinnedPostsService {\n  private pinnedPosts: Map<number, PinnedPost[]> = new Map(); // userId -> posts\n  private loaded: Set<number> = new Set();\n\n  async loadPinnedPosts(userId: number): Promise<PinnedPost[]> {\n    if (this.loaded.has(userId)) {\n      return this.pinnedPosts.get(userId) || [];\n    }\n\n    try {\n      const key = `${PINNED_POSTS_KEY}_${userId}`;\n      const stored = await AsyncStorage.getItem(key);\n      if (stored) {\n        const posts = JSON.parse(stored) as PinnedPost[];\n        this.pinnedPosts.set(userId, posts);\n        this.loaded.add(userId);\n        return posts;\n      }\n    } catch (error) {\n      console.error('[PinnedPosts] Error loading:', error);\n    }\n    return [];\n  }\n\n  private async persist(userId: number): Promise<void> {\n    try {\n      const key = `${PINNED_POSTS_KEY}_${userId}`;\n      const posts = this.pinnedPosts.get(userId) || [];\n      await AsyncStorage.setItem(key, JSON.stringify(posts));\n    } catch (error) {\n      console.error('[PinnedPosts] Error saving:', error);\n    }\n  }\n\n  async pinPost(userId: number, postId: number): Promise<boolean> {\n    const posts = await this.loadPinnedPosts(userId);\n    \n    // Check if already pinned\n    if (posts.some(p => p.postId === postId)) {\n      return true;\n    }\n\n    // Check max limit\n    if (posts.length >= MAX_PINNED_POSTS) {\n      return false;\n    }\n\n    const newPost: PinnedPost = {\n      postId,\n      pinnedAt: new Date().toISOString(),\n      order: posts.length,\n    };\n\n    posts.push(newPost);\n    this.pinnedPosts.set(userId, posts);\n    await this.persist(userId);\n\n    // TODO: Sync with backend\n    // await postsApi.pinPost(postId);\n\n    return true;\n  }\n\n  async unpinPost(userId: number, postId: number): Promise<void> {\n    const posts = await this.loadPinnedPosts(userId);\n    const filtered = posts.filter(p => p.postId !== postId);\n    \n    // Reorder remaining posts\n    filtered.forEach((post, index) => {\n      post.order = index;\n    });\n\n    this.pinnedPosts.set(userId, filtered);\n    await this.persist(userId);\n\n    // TODO: Sync with backend\n    // await postsApi.unpinPost(postId);\n  }\n\n  async reorderPinnedPosts(userId: number, postIds: number[]): Promise<void> {\n    const posts = await this.loadPinnedPosts(userId);\n    \n    // Create new order based on postIds array\n    const reordered = postIds\n      .map((id, index) => {\n        const post = posts.find(p => p.postId === id);\n        if (post) {\n          return { ...post, order: index };\n        }\n        return null;\n      })\n      .filter(Boolean) as PinnedPost[];\n\n    this.pinnedPosts.set(userId, reordered);\n    await this.persist(userId);\n  }\n\n  async isPostPinned(userId: number, postId: number): Promise<boolean> {\n    const posts = await this.loadPinnedPosts(userId);\n    return posts.some(p => p.postId === postId);\n  }\n\n  async getPinnedPostIds(userId: number): Promise<number[]> {\n    const posts = await this.loadPinnedPosts(userId);\n    return posts.sort((a, b) => a.order - b.order).map(p => p.postId);\n  }\n\n  async canPinMore(userId: number): Promise<boolean> {\n    const posts = await this.loadPinnedPosts(userId);\n    return posts.length < MAX_PINNED_POSTS;\n  }\n\n  getMaxPinnedPosts(): number {\n    return MAX_PINNED_POSTS;\n  }\n}\n\nexport const pinnedPostsService = new PinnedPostsService();\n\n// =============================================================================\n// PIN POST BUTTON\n// =============================================================================\n\ninterface PinPostButtonProps {\n  postId: number;\n  userId: number;\n  isOwner: boolean;\n  size?: 'small' | 'medium';\n  onPinChange?: (isPinned: boolean) => void;\n}\n\nexport const PinPostButton = memo(function PinPostButton({\n  postId,\n  userId,\n  isOwner,\n  size = 'medium',\n  onPinChange,\n}: PinPostButtonProps) {\n  const { colors } = useThemeContext();\n  const queryClient = useQueryClient();\n  const [isPinned, setIsPinned] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    checkPinStatus();\n  }, [postId, userId]);\n\n  const checkPinStatus = async () => {\n    setIsLoading(true);\n    const pinned = await pinnedPostsService.isPostPinned(userId, postId);\n    setIsPinned(pinned);\n    setIsLoading(false);\n  };\n\n  const handleTogglePin = useCallback(async () => {\n    if (!isOwner) return;\n\n    haptics.buttonPress();\n\n    if (isPinned) {\n      // Unpin\n      await pinnedPostsService.unpinPost(userId, postId);\n      setIsPinned(false);\n      onPinChange?.(false);\n      haptics.success();\n    } else {\n      // Check if can pin more\n      const canPin = await pinnedPostsService.canPinMore(userId);\n      if (!canPin) {\n        haptics.warning();\n        Alert.alert(\n          'Maximum Pinned Posts',\n          `You can only pin up to ${MAX_PINNED_POSTS} posts. Unpin another post first.`\n        );\n        return;\n      }\n\n      // Pin\n      await pinnedPostsService.pinPost(userId, postId);\n      setIsPinned(true);\n      onPinChange?.(true);\n      haptics.success();\n    }\n\n    queryClient.invalidateQueries({ queryKey: ['profile', userId] });\n    queryClient.invalidateQueries({ queryKey: ['pinnedPosts', userId] });\n  }, [isPinned, isOwner, postId, userId, onPinChange, queryClient]);\n\n  if (!isOwner) return null;\n\n  const iconSize = size === 'small' ? 18 : 22;\n\n  return (\n    <TouchableOpacity\n      style={styles.pinButton}\n      onPress={handleTogglePin}\n      disabled={isLoading}\n    >\n      {isLoading ? (\n        <ActivityIndicator size=\"small\" color={colors.textSecondary} />\n      ) : (\n        <Ionicons\n          name={isPinned ? 'pin' : 'pin-outline'}\n          size={iconSize}\n          color={isPinned ? colors.primary : colors.textSecondary}\n        />\n      )}\n    </TouchableOpacity>\n  );\n});\n\n// =============================================================================\n// PINNED POSTS SECTION (For Profile)\n// =============================================================================\n\ninterface PinnedPostsSectionProps {\n  userId: number;\n  isOwner: boolean;\n  onPostPress: (postId: number) => void;\n  renderPost: (postId: number) => React.ReactNode;\n}\n\nexport const PinnedPostsSection = memo(function PinnedPostsSection({\n  userId,\n  isOwner,\n  onPostPress,\n  renderPost,\n}: PinnedPostsSectionProps) {\n  const { colors } = useThemeContext();\n  const [pinnedPostIds, setPinnedPostIds] = useState<number[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    loadPinnedPosts();\n  }, [userId]);\n\n  const loadPinnedPosts = async () => {\n    setIsLoading(true);\n    const ids = await pinnedPostsService.getPinnedPostIds(userId);\n    setPinnedPostIds(ids);\n    setIsLoading(false);\n  };\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"small\" color={colors.primary} />\n      </View>\n    );\n  }\n\n  if (pinnedPostIds.length === 0) {\n    if (!isOwner) return null;\n    \n    return (\n      <View style={[styles.emptyPinnedSection, { backgroundColor: colors.backgroundSecondary }]}>\n        <Ionicons name=\"pin-outline\" size={24} color={colors.textSecondary} />\n        <ThemedText style={[styles.emptyPinnedText, { color: colors.textSecondary }]}>\n          Pin up to {MAX_PINNED_POSTS} posts to show them here\n        </ThemedText>\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.pinnedSection}>\n      {/* Header */}\n      <View style={styles.pinnedHeader}>\n        <Ionicons name=\"pin\" size={16} color={colors.primary} />\n        <ThemedText style={[styles.pinnedHeaderText, { color: colors.textPrimary }]}>\n          Pinned Posts\n        </ThemedText>\n      </View>\n\n      {/* Posts */}\n      <View style={styles.pinnedPostsContainer}>\n        {pinnedPostIds.map((postId) => (\n          <View key={postId} style={styles.pinnedPostWrapper}>\n            {renderPost(postId)}\n          </View>\n        ))}\n      </View>\n    </View>\n  );\n});\n\n// =============================================================================\n// PIN INDICATOR BADGE\n// =============================================================================\n\ninterface PinIndicatorProps {\n  isPinned: boolean;\n  size?: 'small' | 'medium';\n}\n\nexport const PinIndicator = memo(function PinIndicator({\n  isPinned,\n  size = 'small',\n}: PinIndicatorProps) {\n  const { colors } = useThemeContext();\n\n  if (!isPinned) return null;\n\n  return (\n    <View style={[styles.pinIndicator, { backgroundColor: colors.primary + '20' }]}>\n      <Ionicons name=\"pin\" size={size === 'small' ? 12 : 14} color={colors.primary} />\n      <ThemedText style={[styles.pinIndicatorText, { color: colors.primary }]}>\n        Pinned\n      </ThemedText>\n    </View>\n  );\n});\n\n// =============================================================================\n// PIN POST ACTION SHEET OPTION\n// =============================================================================\n\ninterface PinPostMenuItemProps {\n  postId: number;\n  userId: number;\n  onAction: () => void;\n}\n\nexport const PinPostMenuItem = memo(function PinPostMenuItem({\n  postId,\n  userId,\n  onAction,\n}: PinPostMenuItemProps) {\n  const { colors } = useThemeContext();\n  const [isPinned, setIsPinned] = useState(false);\n\n  useEffect(() => {\n    checkPinStatus();\n  }, [postId, userId]);\n\n  const checkPinStatus = async () => {\n    const pinned = await pinnedPostsService.isPostPinned(userId, postId);\n    setIsPinned(pinned);\n  };\n\n  const handlePress = async () => {\n    haptics.buttonPress();\n\n    if (isPinned) {\n      await pinnedPostsService.unpinPost(userId, postId);\n      haptics.success();\n    } else {\n      const canPin = await pinnedPostsService.canPinMore(userId);\n      if (!canPin) {\n        haptics.warning();\n        Alert.alert(\n          'Maximum Pinned Posts',\n          `You can only pin up to ${MAX_PINNED_POSTS} posts. Unpin another post first.`\n        );\n        return;\n      }\n      await pinnedPostsService.pinPost(userId, postId);\n      haptics.success();\n    }\n\n    onAction();\n  };\n\n  return (\n    <TouchableOpacity\n      style={[styles.menuItem, { borderBottomColor: colors.border }]}\n      onPress={handlePress}\n    >\n      <Ionicons\n        name={isPinned ? 'pin-sharp' : 'pin-outline'}\n        size={22}\n        color={colors.textPrimary}\n      />\n      <ThemedText style={[styles.menuItemText, { color: colors.textPrimary }]}>\n        {isPinned ? 'Unpin from profile' : 'Pin to profile'}\n      </ThemedText>\n    </TouchableOpacity>\n  );\n});\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function usePinnedPosts(userId: number) {\n  const [pinnedPostIds, setPinnedPostIds] = useState<number[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    loadPinnedPosts();\n  }, [userId]);\n\n  const loadPinnedPosts = async () => {\n    setIsLoading(true);\n    const ids = await pinnedPostsService.getPinnedPostIds(userId);\n    setPinnedPostIds(ids);\n    setIsLoading(false);\n  };\n\n  const pinPost = useCallback(async (postId: number) => {\n    const success = await pinnedPostsService.pinPost(userId, postId);\n    if (success) {\n      setPinnedPostIds(prev => [...prev, postId]);\n    }\n    return success;\n  }, [userId]);\n\n  const unpinPost = useCallback(async (postId: number) => {\n    await pinnedPostsService.unpinPost(userId, postId);\n    setPinnedPostIds(prev => prev.filter(id => id !== postId));\n  }, [userId]);\n\n  const isPostPinned = useCallback((postId: number) => {\n    return pinnedPostIds.includes(postId);\n  }, [pinnedPostIds]);\n\n  const canPinMore = useCallback(() => {\n    return pinnedPostIds.length < MAX_PINNED_POSTS;\n  }, [pinnedPostIds]);\n\n  return {\n    pinnedPostIds,\n    isLoading,\n    pinPost,\n    unpinPost,\n    isPostPinned,\n    canPinMore,\n    maxPinnedPosts: MAX_PINNED_POSTS,\n    refresh: loadPinnedPosts,\n  };\n}\n\nconst styles = StyleSheet.create({\n  // Pin button\n  pinButton: {\n    padding: Spacing.sm,\n  },\n\n  // Loading\n  loadingContainer: {\n    padding: Spacing.lg,\n    alignItems: 'center',\n  },\n\n  // Empty state\n  emptyPinnedSection: {\n    margin: Spacing.lg,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  emptyPinnedText: {\n    ...Typography.caption,\n    flex: 1,\n  },\n\n  // Pinned section\n  pinnedSection: {\n    marginBottom: Spacing.lg,\n  },\n  pinnedHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  pinnedHeaderText: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  pinnedPostsContainer: {\n    gap: Spacing.sm,\n  },\n  pinnedPostWrapper: {\n    position: 'relative',\n  },\n\n  // Pin indicator\n  pinIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.sm,\n    gap: 4,\n  },\n  pinIndicatorText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n\n  // Menu item\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    gap: Spacing.md,\n  },\n  menuItemText: {\n    ...Typography.body,\n  },\n});\n","path":null,"size_bytes":14353,"size_tokens":null},"client/screens/ForgotPasswordScreen.tsx":{"content":"/**\n * ForgotPassword Screen\n * Password reset flow\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { isValidEmail } from '@/lib/utils';\n\nexport default function ForgotPasswordScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { forgotPassword, isLoading } = useAuth();\n\n  const [email, setEmail] = useState('');\n  const [emailError, setEmailError] = useState('');\n  const [sent, setSent] = useState(false);\n\n  const validateEmail = (): boolean => {\n    if (!email) {\n      setEmailError('Email is required');\n      return false;\n    }\n    if (!isValidEmail(email)) {\n      setEmailError('Please enter a valid email');\n      return false;\n    }\n    setEmailError('');\n    return true;\n  };\n\n  const handleSubmit = async () => {\n    if (!validateEmail()) return;\n\n    const success = await forgotPassword(email);\n    if (success) {\n      setSent(true);\n    }\n  };\n\n  const handleResend = async () => {\n    const success = await forgotPassword(email);\n    if (success) {\n      Alert.alert('Email Sent', 'A new reset link has been sent to your email.');\n    }\n  };\n\n  if (sent) {\n    return (\n      <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]}>\n        <View style={styles.header}>\n          <TouchableOpacity style={[styles.backButton, { backgroundColor: appColors.surfaceSecondary }]} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.successContent}>\n          <View style={[styles.successIcon, { backgroundColor: Colors.primary + '15' }]}>\n            <Ionicons name=\"mail\" size={48} color={Colors.primary} />\n          </View>\n          <ThemedText style={[styles.successTitle, { color: appColors.textPrimary }]}>Check Your Email</ThemedText>\n          <ThemedText style={[styles.successMessage, { color: appColors.textSecondary }]}>\n            We've sent password reset instructions to{'\\n'}\n            <ThemedText style={[styles.emailHighlight, { color: appColors.textPrimary }]}>{email}</ThemedText>\n          </ThemedText>\n\n          <View style={[styles.instructionsContainer, { backgroundColor: appColors.surfaceSecondary }]}>\n            <View style={styles.instructionItem}>\n              <View style={styles.instructionNumber}>\n                <ThemedText style={styles.instructionNumberText}>1</ThemedText>\n              </View>\n              <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                Open the email we just sent you\n              </ThemedText>\n            </View>\n            <View style={styles.instructionItem}>\n              <View style={styles.instructionNumber}>\n                <ThemedText style={styles.instructionNumberText}>2</ThemedText>\n              </View>\n              <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                Click the reset password link\n              </ThemedText>\n            </View>\n            <View style={styles.instructionItem}>\n              <View style={styles.instructionNumber}>\n                <ThemedText style={styles.instructionNumberText}>3</ThemedText>\n              </View>\n              <ThemedText style={[styles.instructionText, { color: appColors.textPrimary }]}>\n                Create a new password\n              </ThemedText>\n            </View>\n          </View>\n\n          <TouchableOpacity style={styles.resendButton} onPress={handleResend}>\n            <ThemedText style={styles.resendText}>\n              Didn't receive the email? Resend\n            </ThemedText>\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={styles.backToLoginButton}\n            onPress={() => navigation.navigate('Login')}\n          >\n            <Ionicons name=\"arrow-back\" size={18} color={Colors.primary} />\n            <ThemedText style={styles.backToLoginText}>Back to Sign In</ThemedText>\n          </TouchableOpacity>\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        <ScrollView\n          contentContainerStyle={styles.scrollContent}\n          keyboardShouldPersistTaps=\"handled\"\n          showsVerticalScrollIndicator={false}\n        >\n          {/* Header */}\n          <View style={styles.header}>\n            <TouchableOpacity style={[styles.backButton, { backgroundColor: appColors.surfaceSecondary }]} onPress={() => navigation.goBack()}>\n              <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n            </TouchableOpacity>\n          </View>\n\n          {/* Content */}\n          <View style={styles.content}>\n            <View style={[styles.iconContainer, { backgroundColor: Colors.primary + '15' }]}>\n              <Ionicons name=\"lock-closed-outline\" size={48} color={Colors.primary} />\n            </View>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Forgot Password?</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n              No worries! Enter your email address and we'll send you instructions to reset your password.\n            </ThemedText>\n\n            {/* Email Input */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Email Address</ThemedText>\n              <View style={[styles.inputWrapper, { backgroundColor: appColors.input }, emailError ? [styles.inputError, { borderColor: appColors.error }] : null]}>\n                <Ionicons name=\"mail-outline\" size={20} color={appColors.textSecondary} />\n                <TextInput\n                  style={[styles.input, { color: appColors.textPrimary }]}\n                  placeholder=\"Enter your email\"\n                  placeholderTextColor={appColors.textSecondary}\n                  value={email}\n                  onChangeText={(text) => {\n                    setEmail(text);\n                    setEmailError('');\n                  }}\n                  keyboardType=\"email-address\"\n                  autoCapitalize=\"none\"\n                  autoComplete=\"email\"\n                  testID=\"input-forgot-email\"\n                />\n              </View>\n              {emailError ? (\n                <ThemedText style={[styles.errorText, { color: appColors.error }]}>{emailError}</ThemedText>\n              ) : null}\n            </View>\n\n            {/* Submit Button */}\n            <TouchableOpacity\n              style={[styles.submitButton, isLoading && styles.submitButtonDisabled]}\n              onPress={handleSubmit}\n              disabled={isLoading}\n              testID=\"button-send-reset\"\n            >\n              {isLoading ? (\n                <ActivityIndicator color=\"white\" />\n              ) : (\n                <ThemedText style={styles.submitButtonText}>Send Reset Link</ThemedText>\n              )}\n            </TouchableOpacity>\n\n            {/* Back to Login */}\n            <TouchableOpacity\n              style={styles.backToLoginLink}\n              onPress={() => navigation.navigate('Login')}\n            >\n              <Ionicons name=\"arrow-back\" size={16} color={Colors.primary} />\n              <ThemedText style={styles.backToLoginLinkText}>Back to Sign In</ThemedText>\n            </TouchableOpacity>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n  },\n  header: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing.xl,\n  },\n  iconContainer: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n    alignSelf: 'center',\n    marginBottom: Spacing.xl,\n  },\n  title: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.sm,\n  },\n  subtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 22,\n    marginBottom: Spacing['3xl'],\n  },\n  inputContainer: {\n    marginBottom: Spacing.xl,\n  },\n  label: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.sm,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    height: 52,\n    gap: Spacing.sm,\n    borderWidth: 1,\n    borderColor: 'transparent',\n  },\n  inputError: {\n    borderWidth: 1,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    height: '100%',\n  },\n  errorText: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  submitButton: {\n    backgroundColor: Colors.primary,\n    borderRadius: BorderRadius.md,\n    paddingVertical: Spacing.lg,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  submitButtonDisabled: {\n    opacity: 0.7,\n  },\n  submitButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  backToLoginLink: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: Spacing.xs,\n  },\n  backToLoginLinkText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n  successContent: {\n    flex: 1,\n    paddingHorizontal: Spacing.xl,\n    alignItems: 'center',\n    paddingTop: Spacing['3xl'],\n  },\n  successIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  successTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.md,\n  },\n  successMessage: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 24,\n    marginBottom: Spacing['3xl'],\n  },\n  emailHighlight: {\n    fontWeight: '600',\n  },\n  instructionsContainer: {\n    width: '100%',\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  instructionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  instructionNumber: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  instructionNumberText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '700',\n  },\n  instructionText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  resendButton: {\n    marginBottom: Spacing.xl,\n  },\n  resendText: {\n    ...Typography.body,\n    color: Colors.primary,\n  },\n  backToLoginButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  backToLoginText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n});\n","path":null,"size_bytes":11758,"size_tokens":null},"client/providers/index.ts":{"content":"// Network Provider (Offline Detection)\nexport {\n  NetworkProvider,\n  useNetwork,\n  useIsOnline,\n  OfflineAware,\n} from './NetworkProvider';\nexport { default as NetworkProviderDefault } from './NetworkProvider';\n\n// Query Provider (React Query)\nexport {\n  QueryProvider,\n  queryClient,\n  queryKeys,\n  prefetchInvestment,\n  invalidateInvestments,\n  invalidatePortfolio,\n  clearQueryCache,\n  isOnline,\n} from './QueryProvider';\nexport { default as QueryProviderDefault } from './QueryProvider';\n","path":null,"size_bytes":493,"size_tokens":null},"client/lib/video/VideoCallService.ts":{"content":"/**\n * Video Call Service\n * \n * NOTE: This is a stub implementation for Expo Go compatibility.\n * Real video calling requires native SDKs (Twilio, Agora, etc.) which\n * are not available in Expo Go. This service provides:\n * \n * 1. Interface for future native implementation\n * 2. External meeting link support (openExternalCall)\n * 3. State management patterns for video calls\n * \n * For production: Replace with Twilio SDK or similar in a development build.\n */\n\nimport { Platform, Alert } from 'react-native';\nimport * as WebBrowser from 'expo-web-browser';\n\nexport type CallType = 'audio' | 'video';\n\nexport interface CallParticipant {\n  id: string;\n  name: string;\n  avatarUrl?: string;\n  isMuted?: boolean;\n  isVideoEnabled?: boolean;\n}\n\nexport interface CallSession {\n  id: string;\n  type: CallType;\n  participants: CallParticipant[];\n  startTime: Date;\n  endTime?: Date;\n  status: 'connecting' | 'connected' | 'ended' | 'failed';\n}\n\nexport interface VideoCallConfig {\n  apiKey?: string;\n  debug?: boolean;\n}\n\nexport type CallEventType = \n  | 'connecting'\n  | 'connected'\n  | 'disconnected'\n  | 'participantJoined'\n  | 'participantLeft'\n  | 'error';\n\ntype CallEventListener = (event: { type: CallEventType; data?: unknown }) => void;\n\nclass VideoCallService {\n  private debug: boolean;\n  private currentSession: CallSession | null = null;\n  private listeners: Map<CallEventType, Set<CallEventListener>> = new Map();\n\n  constructor(config: VideoCallConfig = {}) {\n    this.debug = config.debug ?? __DEV__;\n  }\n\n  private log(message: string, data?: unknown): void {\n    if (this.debug) {\n      console.log(`[VideoCall] ${message}`, data ?? '');\n    }\n  }\n\n  private emit(type: CallEventType, data?: unknown): void {\n    const typeListeners = this.listeners.get(type);\n    if (typeListeners) {\n      typeListeners.forEach(listener => listener({ type, data }));\n    }\n  }\n\n  on(eventType: CallEventType, listener: CallEventListener): () => void {\n    if (!this.listeners.has(eventType)) {\n      this.listeners.set(eventType, new Set());\n    }\n    this.listeners.get(eventType)!.add(listener);\n    \n    return () => {\n      this.listeners.get(eventType)?.delete(listener);\n    };\n  }\n\n  off(eventType: CallEventType, listener: CallEventListener): void {\n    this.listeners.get(eventType)?.delete(listener);\n  }\n\n  async startCall(\n    participants: { id: string; name: string }[],\n    type: CallType = 'video'\n  ): Promise<CallSession> {\n    this.log('Starting call', { participants, type });\n    \n    this.emit('connecting');\n\n    const session: CallSession = {\n      id: `call_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`,\n      type,\n      participants: participants.map(p => ({\n        ...p,\n        isMuted: false,\n        isVideoEnabled: type === 'video',\n      })),\n      startTime: new Date(),\n      status: 'connecting',\n    };\n\n    this.currentSession = session;\n\n    await new Promise(resolve => setTimeout(resolve, 1500));\n    \n    session.status = 'connected';\n    this.emit('connected', session);\n    this.log('Call connected', session);\n\n    return session;\n  }\n\n  async joinCall(callId: string): Promise<CallSession | null> {\n    this.log('Joining call', { callId });\n    \n    this.emit('connecting');\n\n    const session: CallSession = {\n      id: callId,\n      type: 'video',\n      participants: [],\n      startTime: new Date(),\n      status: 'connecting',\n    };\n\n    this.currentSession = session;\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    session.status = 'connected';\n    this.emit('connected', session);\n\n    return session;\n  }\n\n  async endCall(): Promise<void> {\n    if (!this.currentSession) {\n      this.log('No active call to end');\n      return;\n    }\n\n    this.log('Ending call', { sessionId: this.currentSession.id });\n    \n    this.currentSession.status = 'ended';\n    this.currentSession.endTime = new Date();\n    \n    this.emit('disconnected', this.currentSession);\n    this.currentSession = null;\n  }\n\n  async toggleMute(): Promise<boolean> {\n    if (!this.currentSession) return false;\n    \n    const localParticipant = this.currentSession.participants[0];\n    if (localParticipant) {\n      localParticipant.isMuted = !localParticipant.isMuted;\n      this.log('Mute toggled', { isMuted: localParticipant.isMuted });\n      return localParticipant.isMuted;\n    }\n    \n    return false;\n  }\n\n  async toggleVideo(): Promise<boolean> {\n    if (!this.currentSession) return false;\n    \n    const localParticipant = this.currentSession.participants[0];\n    if (localParticipant) {\n      localParticipant.isVideoEnabled = !localParticipant.isVideoEnabled;\n      this.log('Video toggled', { isVideoEnabled: localParticipant.isVideoEnabled });\n      return localParticipant.isVideoEnabled;\n    }\n    \n    return false;\n  }\n\n  async switchCamera(): Promise<void> {\n    this.log('Switching camera');\n  }\n\n  getCurrentSession(): CallSession | null {\n    return this.currentSession;\n  }\n\n  isInCall(): boolean {\n    return this.currentSession?.status === 'connected';\n  }\n\n  async openExternalCall(meetingUrl: string): Promise<void> {\n    try {\n      if (Platform.OS === 'web') {\n        window.open(meetingUrl, '_blank');\n      } else {\n        await WebBrowser.openBrowserAsync(meetingUrl);\n      }\n    } catch (error) {\n      Alert.alert('Error', 'Failed to open video call link');\n      this.log('Failed to open external call', error);\n    }\n  }\n\n  async requestPermissions(): Promise<{ camera: boolean; microphone: boolean }> {\n    this.log('Permissions would be requested in a native build');\n    return { camera: true, microphone: true };\n  }\n}\n\nexport const videoCallService = new VideoCallService();\n\nexport default videoCallService;\n","path":null,"size_bytes":5713,"size_tokens":null},"client/types/index.ts":{"content":"/**\n * MedInvest Type Definitions\n */\n\n// =============================================================================\n// USER TYPES\n// =============================================================================\n\nexport interface User {\n  id: number | string;\n  email: string;\n  first_name?: string;\n  last_name?: string;\n  full_name?: string;\n  phone?: string;\n  specialty?: string;\n  bio?: string;\n  avatar_url?: string;\n  provider?: 'apple' | 'google' | 'github' | 'facebook' | 'mock' | 'email';\n  is_verified?: boolean;\n  is_accredited?: boolean;\n  is_premium?: boolean;\n  is_admin?: boolean;\n  subscription_tier?: SubscriptionTier;\n  points?: number;\n  level?: number;\n  login_streak?: number;\n  referral_code?: string;\n  followers_count?: number;\n  following_count?: number;\n  posts_count?: number;\n  created_at?: string;\n  updated_at?: string;\n  last_login?: string;\n}\n\nexport type SubscriptionTier = 'free' | 'premium';\n\nexport interface UserProfile extends User {\n  posts: Post[];\n  isFollowing: boolean;\n  mutualFollowers: User[];\n}\n\n// =============================================================================\n// POST TYPES\n// =============================================================================\n\nexport interface Post {\n  id: number;\n  content: string;\n  author: User;\n  room: Room | null;\n  images: string[];\n  video_url?: string;\n  is_anonymous: boolean;\n  anonymous_name?: string;\n  mentions: string[];\n  hashtags: string[];\n  upvotes: number;\n  downvotes: number;\n  comments_count: number;\n  user_vote?: VoteDirection;\n  is_bookmarked: boolean;\n  feed_score: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface Mention {\n  user_id: number;\n  username: string;\n  start_index: number;\n  end_index: number;\n}\n\nexport type VoteDirection = 'up' | 'down' | null;\n\nexport interface Comment {\n  id: number;\n  content: string;\n  author: User;\n  post_id: number;\n  parent_id?: number | null;\n  upvotes: number;\n  downvotes: number;\n  user_vote?: VoteDirection;\n  replies?: Comment[];\n  replies_count: number;\n  created_at: string;\n}\n\nexport interface CreatePostData {\n  content: string;\n  room_id: number;\n  is_anonymous?: boolean;\n  images?: string[];\n  video_url?: string;\n}\n\n// =============================================================================\n// ROOM TYPES\n// =============================================================================\n\nexport interface Room {\n  id: number;\n  name: string;\n  slug: string;\n  description: string;\n  icon: string;\n  color: string;\n  posts_count: number;\n  members_count: number;\n  is_member: boolean;\n  rules?: string[];\n  moderators?: User[];\n}\n\nexport const ROOM_CATEGORIES = [\n  { slug: 'general', name: 'General Discussion', icon: 'üí¨', color: '#6B7280' },\n  { slug: 'biotech', name: 'Biotech', icon: 'üß¨', color: '#10B981' },\n  { slug: 'medtech', name: 'MedTech', icon: 'üè•', color: '#3B82F6' },\n  { slug: 'pharma', name: 'Pharma', icon: 'üíä', color: '#8B5CF6' },\n  { slug: 'digital-health', name: 'Digital Health', icon: 'üì±', color: '#EC4899' },\n  { slug: 'diagnostics', name: 'Diagnostics', icon: 'üî¨', color: '#F59E0B' },\n  { slug: 'genomics', name: 'Genomics', icon: 'üß™', color: '#14B8A6' },\n  { slug: 'medical-devices', name: 'Medical Devices', icon: '‚öïÔ∏è', color: '#EF4444' },\n  { slug: 'healthcare-ai', name: 'Healthcare AI', icon: 'ü§ñ', color: '#6366F1' },\n  { slug: 'clinical-trials', name: 'Clinical Trials', icon: 'üìã', color: '#84CC16' },\n  { slug: 'regulatory', name: 'Regulatory & FDA', icon: 'üìú', color: '#F97316' },\n  { slug: 'investment-strategies', name: 'Investment Strategies', icon: 'üìà', color: '#0EA5E9' },\n  { slug: 'market-analysis', name: 'Market Analysis', icon: 'üìä', color: '#A855F7' },\n  { slug: 'career', name: 'Career & Networking', icon: 'ü§ù', color: '#22C55E' },\n] as const;\n\n// =============================================================================\n// FEED TYPES\n// =============================================================================\n\nexport type FeedStyle = 'algorithmic' | 'chronological' | 'discovery';\n\nexport interface FeedResponse {\n  posts: Post[];\n  has_more: boolean;\n  next_cursor?: string;\n  feed_style: FeedStyle;\n}\n\nexport interface TrendingTopic {\n  hashtag: string;\n  count: number;\n  trend: 'up' | 'down' | 'stable';\n  change_percent?: number;\n}\n\n// =============================================================================\n// NOTIFICATION TYPES\n// =============================================================================\n\nexport interface Notification {\n  id: number;\n  type: NotificationType;\n  title: string;\n  body: string;\n  data?: NotificationData;\n  is_read: boolean;\n  created_at: string;\n}\n\nexport type NotificationType = \n  | 'like'\n  | 'comment'\n  | 'follow'\n  | 'mention'\n  | 'reply'\n  | 'message'\n  | 'ama_live'\n  | 'deal_update'\n  | 'achievement'\n  | 'friend_request'\n  | 'friend_accepted'\n  | 'investment_update'\n  | 'course_update'\n  | 'event_reminder'\n  | 'system';\n\nexport interface NotificationData {\n  post_id?: number;\n  user_id?: number;\n  comment_id?: number;\n  ama_id?: number;\n  deal_id?: number;\n  achievement_id?: number;\n  course_id?: number;\n  event_id?: number;\n  investment_id?: number;\n}\n\n// =============================================================================\n// MESSAGE TYPES\n// =============================================================================\n\nexport interface Conversation {\n  id: number;\n  other_user: User;\n  last_message?: string;\n  last_message_at?: string;\n  unread_count: number;\n  is_muted: boolean;\n}\n\nexport interface Message {\n  id: number;\n  conversation_id: number;\n  content: string;\n  sender: User;\n  is_read: boolean;\n  read_at?: string;\n  created_at: string;\n}\n\n// =============================================================================\n// CONTENT TYPES\n// =============================================================================\n\n// AMA\nexport interface AMA {\n  id: number;\n  title: string;\n  description: string;\n  expert: User;\n  expert_bio: string;\n  status: AMAStatus;\n  scheduled_at: string;\n  ended_at?: string;\n  questions_count: number;\n  attendees_count: number;\n  is_attending: boolean;\n  questions?: AMAQuestion[];\n}\n\nexport type AMAStatus = 'scheduled' | 'live' | 'ended' | 'cancelled';\n\nexport interface AMAQuestion {\n  id: number;\n  question: string;\n  author: User;\n  answer?: string;\n  upvotes: number;\n  is_answered: boolean;\n  created_at: string;\n}\n\n// Deals\nexport interface Deal {\n  id: number;\n  title: string;\n  company?: string;\n  company_name: string;\n  company_logo?: string;\n  image_url?: string;\n  description: string;\n  pitch_deck_url?: string;\n  target_raise: number;\n  raised: number;\n  minimum_investment: number;\n  maximum_investment?: number;\n  valuation?: number;\n  equity_offered?: number;\n  status: DealStatus;\n  deadline: string;\n  category: string;\n  stage?: string;\n  highlights: string[];\n  risks?: string[];\n  team?: Array<{ name: string; role: string; background?: string }>;\n  documents?: Array<{ name: string; url: string }>;\n  investors_count: number;\n  featured?: boolean;\n  is_watched?: boolean;\n  is_invested?: boolean;\n  my_investment?: number;\n  created_at?: string;\n}\n\nexport type DealStatus = 'draft' | 'review' | 'active' | 'funded' | 'closed' | 'rejected';\n\n// Courses\nexport interface Course {\n  id: number;\n  title: string;\n  description: string;\n  instructor: User;\n  thumbnail_url?: string;\n  duration_minutes: number;\n  lessons_count: number;\n  lessons?: Lesson[];\n  is_premium: boolean;\n  price?: number;\n  rating: number;\n  reviews_count: number;\n  enrolled_count: number;\n  is_enrolled: boolean;\n  progress?: number;\n  completed_lessons?: number[];\n}\n\nexport interface Lesson {\n  id: number;\n  course_id: number;\n  title: string;\n  description: string;\n  video_url?: string;\n  content?: string;\n  duration_minutes: number;\n  order: number;\n  is_completed: boolean;\n}\n\n// Events\nexport interface Event {\n  id: number;\n  title: string;\n  description: string;\n  event_type: EventType;\n  starts_at: string;\n  ends_at: string;\n  location?: string;\n  virtual_url?: string;\n  is_virtual: boolean;\n  organizer: User;\n  thumbnail_url?: string;\n  attendees_count: number;\n  max_attendees?: number;\n  is_attending: boolean;\n  price?: number;\n  is_free: boolean;\n}\n\nexport type EventType = 'webinar' | 'conference' | 'meetup' | 'workshop' | 'networking';\n\n// =============================================================================\n// GAMIFICATION TYPES\n// =============================================================================\n\nexport interface LeaderboardEntry {\n  rank: number;\n  user: User;\n  points: number;\n  change?: number;\n}\n\nexport interface Achievement {\n  id: number;\n  name: string;\n  description: string;\n  icon: string;\n  points: number;\n  category: AchievementCategory;\n  unlocked: boolean;\n  unlocked_at?: string;\n  progress?: number;\n  target?: number;\n}\n\nexport type AchievementCategory = \n  | 'posting'\n  | 'engagement'\n  | 'learning'\n  | 'investing'\n  | 'social'\n  | 'streak';\n\nexport interface UserStats {\n  points: number;\n  level: number;\n  rank: number;\n  streak: number;\n  posts_created: number;\n  comments_made: number;\n  upvotes_received: number;\n  courses_completed: number;\n  achievements_unlocked: number;\n}\n\n// =============================================================================\n// SEARCH TYPES\n// =============================================================================\n\nexport interface SearchResults {\n  posts: Post[];\n  users: User[];\n  rooms: Room[];\n  hashtags: TrendingTopic[];\n  total_count: number;\n}\n\nexport type SearchType = 'all' | 'posts' | 'users' | 'rooms' | 'hashtags';\n\n// =============================================================================\n// SUBSCRIPTION TYPES\n// =============================================================================\n\nexport interface SubscriptionStatus {\n  is_premium: boolean;\n  tier: SubscriptionTier;\n  expires_at?: string;\n  will_renew: boolean;\n  stripe_subscription_id?: string;\n}\n\nexport interface PremiumFeatures {\n  exclusive_content: boolean;\n  deal_access: boolean;\n  priority_support: boolean;\n  advanced_analytics: boolean;\n  ad_free: boolean;\n  early_access: boolean;\n}\n\n// =============================================================================\n// NAVIGATION TYPES\n// =============================================================================\n\nexport type RootStackParamList = {\n  Auth: undefined;\n  Main: undefined;\n  Onboarding: undefined;\n  PostDetail: { postId: number };\n  CreatePost: { roomSlug?: string };\n  EditPost: { postId: number };\n  UserProfile: { userId: number };\n  EditProfile: undefined;\n  RoomDetail: { roomSlug: string };\n  Conversation: { userId: number };\n  NewConversation: undefined;\n  VoiceCall: { recipientId: string; recipientName: string; recipientAvatar?: string; callType: 'audio' | 'video' };\n  AMADetail: { amaId: number };\n  DealDetail: { dealId: number };\n  CourseDetail: { courseId: number };\n  LessonDetail: { courseId: number; lessonId: number };\n  LessonPlayer: { courseId: number; lessonId: number };\n  EventDetail: { eventId: number };\n  Settings: undefined;\n  Notifications: undefined;\n  Search: { query?: string; type?: SearchType };\n  Hashtag: { tag: string };\n  Followers: { userId: number; type: 'followers' | 'following' };\n  Premium: undefined;\n  Bookmarks: undefined;\n  Leaderboard: undefined;\n  Achievements: undefined;\n  Drafts: undefined;\n  AIChat: undefined;\n  ChangePassword: undefined;\n  BlockedUsers: undefined;\n  DeleteAccount: undefined;\n  BiometricSettings: undefined;\n  PrivacyPolicy: undefined;\n  TermsOfService: undefined;\n  AppearanceSettings: undefined;\n  NotificationSettings: undefined;\n  ContentPreferences: undefined;\n  Report: { type: 'post' | 'user' | 'comment'; targetId: number };\n  SavedSearches: undefined;\n  DataExport: undefined;\n};\n\nexport type MainTabParamList = {\n  Home: undefined;\n  Rooms: undefined;\n  Discover: undefined;\n  Messages: undefined;\n  Profile: undefined;\n};\n\nexport type AuthStackParamList = {\n  Login: undefined;\n  Register: undefined;\n  ForgotPassword: undefined;\n  ResetPassword: { token: string };\n  VerifyEmail: { email: string };\n};\n\n// =============================================================================\n// API/DATA TYPES\n// =============================================================================\n\nexport interface PaginatedResponse<T> {\n  data: T[];\n  page: number;\n  limit: number;\n  total: number;\n  totalPages: number;\n}\n\nexport interface Investment {\n  id: string;\n  name: string;\n  company: string;\n  description: string;\n  category: string;\n  targetAmount: number;\n  currentAmount: number;\n  minInvestment: number;\n  maxInvestment?: number;\n  returnRate?: string;\n  riskLevel: 'low' | 'medium' | 'high';\n  status: 'active' | 'funded' | 'closed';\n  deadline?: string;\n  imageUrl?: string;\n  highlights: string[];\n  documents?: string[];\n  createdAt: string;\n  updatedAt?: string;\n}\n\nexport interface InvestmentFilters {\n  category?: string;\n  riskLevel?: string;\n  status?: string;\n  minAmount?: number;\n  maxAmount?: number;\n  search?: string;\n}\n\nexport interface PortfolioInvestment {\n  id: string;\n  investmentId: string;\n  investment: Investment;\n  amount: number;\n  shares?: number;\n  purchaseDate: string;\n  currentValue?: number;\n  returnPercent?: number;\n  status: 'active' | 'matured' | 'exited';\n}\n\nexport interface PortfolioSummary {\n  totalInvested: number;\n  currentValue: number;\n  totalReturn: number;\n  returnPercent: number;\n  investmentsCount: number;\n  activeInvestments: number;\n}\n\nexport interface Transaction {\n  id: string;\n  type: 'investment' | 'dividend' | 'withdrawal' | 'deposit';\n  amount: number;\n  description: string;\n  investmentName?: string;\n  status: 'pending' | 'completed' | 'failed';\n  createdAt: string;\n}\n\nexport interface Article {\n  id: string;\n  title: string;\n  excerpt: string;\n  content?: string;\n  category: string;\n  author: {\n    id: string;\n    name: string;\n    avatarUrl?: string;\n  };\n  imageUrl?: string;\n  readTime: number;\n  isBookmarked: boolean;\n  isPremium: boolean;\n  publishedAt: string;\n  tags?: string[];\n}\n\nexport interface ArticleFilters {\n  category?: string;\n  isPremium?: boolean;\n  search?: string;\n}\n","path":null,"size_bytes":14274,"size_tokens":null},"client/services/index.ts":{"content":"export {\n  registerForPushNotifications,\n  unregisterPushNotifications,\n  getBadgeCount,\n  setBadgeCount,\n  clearAllNotifications,\n  scheduleLocalNotification,\n  usePushNotifications,\n  useNotificationPreferences,\n  type NotificationData,\n} from './notifications';\n\nexport {\n  linkingConfig,\n  parseDeepLink,\n  createDeepLink,\n  useDeepLinks,\n  shareInvestment,\n  openExternalURL,\n  openEmail,\n  openPhone,\n} from './deepLinks';\n","path":null,"size_bytes":429,"size_tokens":null},"client/components/NetworkStatus.tsx":{"content":"/**\n * Network Status Provider\n * Monitors connectivity and shows offline banner\n */\n\nimport React, { createContext, useContext, useState, useEffect, useCallback, ReactNode } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Animated,\n  TouchableOpacity,\n  ActivityIndicator,\n} from 'react-native';\nimport NetInfo, { NetInfoState } from '@react-native-community/netinfo';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\n\ninterface NetworkContextType {\n  isConnected: boolean;\n  isInternetReachable: boolean | null;\n  connectionType: string | null;\n  retry: () => Promise<void>;\n}\n\nconst NetworkContext = createContext<NetworkContextType>({\n  isConnected: true,\n  isInternetReachable: true,\n  connectionType: null,\n  retry: async () => {},\n});\n\nexport const useNetwork = () => useContext(NetworkContext);\n\ninterface NetworkProviderProps {\n  children: ReactNode;\n}\n\nexport function NetworkProvider({ children }: NetworkProviderProps) {\n  const appColors = useAppColors();\n  const [isConnected, setIsConnected] = useState(true);\n  const [isInternetReachable, setIsInternetReachable] = useState<boolean | null>(true);\n  const [connectionType, setConnectionType] = useState<string | null>(null);\n  const [showBanner, setShowBanner] = useState(false);\n  const [isRetrying, setIsRetrying] = useState(false);\n  const bannerAnim = useState(new Animated.Value(0))[0];\n\n  useEffect(() => {\n    const unsubscribe = NetInfo.addEventListener((state: NetInfoState) => {\n      const connected = state.isConnected ?? false;\n      const reachable = state.isInternetReachable;\n      \n      setIsConnected(connected);\n      setIsInternetReachable(reachable);\n      setConnectionType(state.type);\n\n      if (!connected || reachable === false) {\n        setShowBanner(true);\n        Animated.spring(bannerAnim, {\n          toValue: 1,\n          useNativeDriver: true,\n          tension: 50,\n          friction: 7,\n        }).start();\n      } else if (showBanner) {\n        Animated.timing(bannerAnim, {\n          toValue: 0,\n          duration: 300,\n          useNativeDriver: true,\n        }).start(() => setShowBanner(false));\n      }\n    });\n\n    NetInfo.fetch().then((state) => {\n      setIsConnected(state.isConnected ?? false);\n      setIsInternetReachable(state.isInternetReachable);\n      setConnectionType(state.type);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  const retry = useCallback(async () => {\n    setIsRetrying(true);\n    try {\n      const state = await NetInfo.fetch();\n      setIsConnected(state.isConnected ?? false);\n      setIsInternetReachable(state.isInternetReachable);\n      \n      if (state.isConnected && state.isInternetReachable !== false) {\n        Animated.timing(bannerAnim, {\n          toValue: 0,\n          duration: 300,\n          useNativeDriver: true,\n        }).start(() => setShowBanner(false));\n      }\n    } finally {\n      setIsRetrying(false);\n    }\n  }, [bannerAnim]);\n\n  return (\n    <NetworkContext.Provider value={{ isConnected, isInternetReachable, connectionType, retry }}>\n      {children}\n      \n      {showBanner && (\n        <Animated.View\n          style={[\n            styles.banner,\n            { backgroundColor: appColors.error },\n            {\n              transform: [\n                {\n                  translateY: bannerAnim.interpolate({\n                    inputRange: [0, 1],\n                    outputRange: [-100, 0],\n                  }),\n                },\n              ],\n              opacity: bannerAnim,\n            },\n          ]}\n        >\n          <View style={styles.bannerContent}>\n            <Ionicons name=\"cloud-offline-outline\" size={20} color=\"white\" />\n            <ThemedText style={styles.bannerText}>\n              {!isConnected \n                ? \"You're offline\" \n                : \"Limited connectivity\"}\n            </ThemedText>\n          </View>\n          <TouchableOpacity \n            style={styles.retryButton} \n            onPress={retry}\n            disabled={isRetrying}\n          >\n            {isRetrying ? (\n              <ActivityIndicator size=\"small\" color=\"white\" />\n            ) : (\n              <ThemedText style={styles.retryText}>Retry</ThemedText>\n            )}\n          </TouchableOpacity>\n        </Animated.View>\n      )}\n    </NetworkContext.Provider>\n  );\n}\n\ninterface OfflinePlaceholderProps {\n  onRetry?: () => void;\n  message?: string;\n}\n\nexport function OfflinePlaceholder({ \n  onRetry, \n  message = \"You're currently offline\" \n}: OfflinePlaceholderProps) {\n  const appColors = useAppColors();\n  const { retry, isConnected } = useNetwork();\n  const [isRetrying, setIsRetrying] = useState(false);\n\n  const handleRetry = async () => {\n    setIsRetrying(true);\n    try {\n      await retry();\n      onRetry?.();\n    } finally {\n      setIsRetrying(false);\n    }\n  };\n\n  if (isConnected) return null;\n\n  return (\n    <View style={styles.placeholder}>\n      <View style={styles.placeholderIcon}>\n        <Ionicons name=\"cloud-offline-outline\" size={48} color={appColors.textSecondary} />\n      </View>\n      <ThemedText style={[styles.placeholderTitle, { color: appColors.textPrimary }]}>No Connection</ThemedText>\n      <ThemedText style={[styles.placeholderMessage, { color: appColors.textSecondary }]}>{message}</ThemedText>\n      <TouchableOpacity \n        style={styles.placeholderButton}\n        onPress={handleRetry}\n        disabled={isRetrying}\n      >\n        {isRetrying ? (\n          <ActivityIndicator color=\"white\" />\n        ) : (\n          <>\n            <Ionicons name=\"refresh-outline\" size={18} color=\"white\" />\n            <ThemedText style={styles.placeholderButtonText}>Try Again</ThemedText>\n          </>\n        )}\n      </TouchableOpacity>\n    </View>\n  );\n}\n\ninterface ErrorStateProps {\n  error: Error | string;\n  onRetry?: () => void;\n  title?: string;\n}\n\nexport function ErrorState({ \n  error, \n  onRetry,\n  title = 'Something went wrong'\n}: ErrorStateProps) {\n  const appColors = useAppColors();\n  const [isRetrying, setIsRetrying] = useState(false);\n  const errorMessage = typeof error === 'string' ? error : error.message;\n\n  const handleRetry = async () => {\n    if (!onRetry) return;\n    setIsRetrying(true);\n    try {\n      await onRetry();\n    } finally {\n      setIsRetrying(false);\n    }\n  };\n\n  return (\n    <View style={styles.errorState}>\n      <View style={[styles.errorIcon, { backgroundColor: appColors.error + '15' }]}>\n        <Ionicons name=\"alert-circle-outline\" size={48} color={appColors.error} />\n      </View>\n      <ThemedText style={[styles.errorTitle, { color: appColors.textPrimary }]}>{title}</ThemedText>\n      <ThemedText style={[styles.errorMessage, { color: appColors.textSecondary }]}>{errorMessage}</ThemedText>\n      {onRetry && (\n        <TouchableOpacity \n          style={styles.errorButton}\n          onPress={handleRetry}\n          disabled={isRetrying}\n        >\n          {isRetrying ? (\n            <ActivityIndicator color=\"white\" />\n          ) : (\n            <>\n              <Ionicons name=\"refresh-outline\" size={18} color=\"white\" />\n              <ThemedText style={styles.errorButtonText}>Try Again</ThemedText>\n            </>\n          )}\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n}\n\ninterface RateLimitErrorProps {\n  retryAfter?: number;\n  onRetry?: () => void;\n}\n\nexport function RateLimitError({ retryAfter, onRetry }: RateLimitErrorProps) {\n  const appColors = useAppColors();\n  const [countdown, setCountdown] = useState(retryAfter || 60);\n  const [canRetry, setCanRetry] = useState(!retryAfter);\n\n  useEffect(() => {\n    if (!retryAfter || canRetry) return;\n\n    const timer = setInterval(() => {\n      setCountdown((prev) => {\n        if (prev <= 1) {\n          setCanRetry(true);\n          clearInterval(timer);\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [retryAfter, canRetry]);\n\n  return (\n    <View style={styles.rateLimitContainer}>\n      <View style={[styles.rateLimitIcon, { backgroundColor: appColors.warning + '15' }]}>\n        <Ionicons name=\"time-outline\" size={48} color={appColors.warning} />\n      </View>\n      <ThemedText style={[styles.rateLimitTitle, { color: appColors.textPrimary }]}>Slow Down</ThemedText>\n      <ThemedText style={[styles.rateLimitMessage, { color: appColors.textSecondary }]}>\n        You've made too many requests. Please wait a moment before trying again.\n      </ThemedText>\n      {!canRetry ? (\n        <View style={styles.countdownContainer}>\n          <ThemedText style={[styles.countdownText, { color: appColors.textSecondary }]}>\n            Try again in {countdown}s\n          </ThemedText>\n        </View>\n      ) : (\n        <TouchableOpacity style={styles.rateLimitButton} onPress={onRetry}>\n          <Ionicons name=\"refresh-outline\" size={18} color=\"white\" />\n          <ThemedText style={styles.rateLimitButtonText}>Try Again</ThemedText>\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  banner: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingTop: 50,\n    paddingBottom: Spacing.md,\n    paddingHorizontal: Spacing.lg,\n    zIndex: 9999,\n  },\n  bannerContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  bannerText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  retryButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    backgroundColor: 'rgba(255,255,255,0.2)',\n    borderRadius: 16,\n    minWidth: 60,\n    alignItems: 'center',\n  },\n  retryText: {\n    ...Typography.caption,\n    color: 'white',\n    fontWeight: '600',\n  },\n\n  placeholder: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  placeholderIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  placeholderTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.sm,\n  },\n  placeholderMessage: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n  },\n  placeholderButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: 24,\n    gap: Spacing.sm,\n  },\n  placeholderButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n\n  errorState: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  errorIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  errorTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.sm,\n  },\n  errorMessage: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n    lineHeight: 24,\n  },\n  errorButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: 24,\n    gap: Spacing.sm,\n  },\n  errorButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n\n  rateLimitContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  rateLimitIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  rateLimitTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.sm,\n  },\n  rateLimitMessage: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n    lineHeight: 24,\n  },\n  countdownContainer: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: 24,\n  },\n  countdownText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  rateLimitButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: 24,\n    gap: Spacing.sm,\n  },\n  rateLimitButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":12615,"size_tokens":null},"client/components/KeyboardAwareScrollViewCompat.tsx":{"content":"import { Platform, ScrollView, ScrollViewProps } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\n\ntype Props = KeyboardAwareScrollViewProps & ScrollViewProps;\n\n/**\n * KeyboardAwareScrollView that falls back to ScrollView on web.\n * Use this for any screen containing text inputs.\n */\nexport function KeyboardAwareScrollViewCompat({\n  children,\n  keyboardShouldPersistTaps = \"handled\",\n  ...props\n}: Props) {\n  if (Platform.OS === \"web\") {\n    return (\n      <ScrollView\n        keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n        {...props}\n      >\n        {children}\n      </ScrollView>\n    );\n  }\n\n  return (\n    <KeyboardAwareScrollView\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...props}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n","path":null,"size_bytes":872,"size_tokens":null},"client/screens/settings/LegalScreen.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Pressable, Linking } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport default function LegalScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n\n  const legalOptions = [\n    { id: '1', title: 'Terms of Service', url: 'https://medinvest.app/terms' },\n    { id: '2', title: 'Privacy Policy', url: 'https://medinvest.app/privacy' },\n    { id: '3', title: 'Investment Disclosure', url: 'https://medinvest.app/disclosure' },\n    { id: '4', title: 'Risk Disclaimer', url: 'https://medinvest.app/risk' },\n    { id: '5', title: 'Cookie Policy', url: 'https://medinvest.app/cookies' },\n  ];\n\n  const handlePress = (url: string) => {\n    Linking.openURL(url);\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Legal</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        {legalOptions.map((option) => (\n          <Pressable\n            key={option.id}\n            style={styles.optionItem}\n            onPress={() => handlePress(option.url)}\n          >\n            <Text style={styles.optionTitle}>{option.title}</Text>\n            <Feather name=\"external-link\" size={18} color={colors.text.tertiary} />\n          </Pressable>\n        ))}\n\n        <Text style={styles.footerText}>\n          MedInvest is a registered investment platform. All investments carry risk\n          and past performance does not guarantee future results. Please read all\n          disclosures carefully before investing.\n        </Text>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  content: {\n    flex: 1,\n    padding: spacing.lg,\n  },\n  optionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  optionTitle: {\n    ...typography.body,\n    color: colors.text.primary,\n  },\n  footerText: {\n    ...typography.caption,\n    color: colors.text.tertiary,\n    textAlign: 'center',\n    marginTop: spacing.xl,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":3344,"size_tokens":null},"client/services/deepLinks.ts":{"content":"import { useEffect } from 'react';\nimport { Linking, Platform } from 'react-native';\nimport * as ExpoLinking from 'expo-linking';\nimport { useNavigation, type NavigationContainerRef } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\n\nimport type { RootStackParamList } from '@/navigation/types';\n\n/**\n * Deep link URL scheme\n * - medinvest:// for native deep links\n * - https://medinvest.app for universal links\n */\nconst DEEP_LINK_PREFIXES = [\n  ExpoLinking.createURL('/'),\n  'medinvest://',\n  'https://medinvest.app',\n  'https://www.medinvest.app',\n];\n\n/**\n * Navigation linking configuration\n * Maps URLs to screens\n */\nexport const linkingConfig = {\n  prefixes: DEEP_LINK_PREFIXES,\n  config: {\n    screens: {\n      // Main tabs\n      Main: {\n        screens: {\n          Discover: 'discover',\n          Portfolio: 'portfolio',\n          Research: 'research',\n          Profile: 'profile',\n        },\n      },\n      \n      // Investment detail\n      InvestmentDetail: {\n        path: 'investment/:investmentId',\n        parse: {\n          investmentId: (id: string) => id,\n        },\n      },\n      \n      // Invest modal\n      InvestModal: {\n        path: 'invest/:investmentId?',\n        parse: {\n          investmentId: (id: string) => id,\n        },\n      },\n      \n      // Settings screens\n      Settings: 'settings',\n      Documents: 'documents',\n      PaymentMethods: 'payment-methods',\n      Support: 'support',\n      Legal: 'legal',\n      \n      OAuthCallback: {\n        path: 'auth',\n      },\n\n      // Auth (when not authenticated)\n      Auth: {\n        screens: {\n          Login: 'login',\n          Signup: 'signup',\n          ForgotPassword: 'forgot-password',\n          VerifyEmail: {\n            path: 'verify-email/:email',\n            parse: {\n              email: (email: string) => decodeURIComponent(email),\n            },\n          },\n        },\n      },\n    },\n  },\n};\n\n/**\n * Parse deep link URL into navigation params\n */\nexport function parseDeepLink(url: string): {\n  screen?: keyof RootStackParamList;\n  params?: Record<string, any>;\n} | null {\n  try {\n    const { path, queryParams } = ExpoLinking.parse(url);\n    \n    if (!path) return null;\n\n    // Handle different paths\n    const segments = path.split('/').filter(Boolean);\n    \n    switch (segments[0]) {\n      case 'investment':\n        return {\n          screen: 'InvestmentDetail',\n          params: { investmentId: segments[1] },\n        };\n        \n      case 'invest':\n        return {\n          screen: 'InvestModal',\n          params: segments[1] ? { investmentId: segments[1] } : undefined,\n        };\n        \n      case 'auth':\n        return {\n          screen: 'OAuthCallback' as any,\n          params: { token: queryParams?.token, error: queryParams?.error },\n        };\n\n      case 'discover':\n        return {\n          screen: 'Main',\n          params: { screen: 'Discover' },\n        };\n        \n      case 'portfolio':\n        return {\n          screen: 'Main',\n          params: { screen: 'Portfolio' },\n        };\n        \n      case 'research':\n        return {\n          screen: 'Main',\n          params: { screen: 'Research' },\n        };\n        \n      case 'profile':\n        return {\n          screen: 'Main',\n          params: { screen: 'Profile' },\n        };\n        \n      case 'settings':\n        return { screen: 'Settings' };\n        \n      default:\n        return null;\n    }\n  } catch (error) {\n    console.error('Failed to parse deep link:', error);\n    return null;\n  }\n}\n\n/**\n * Generate a deep link URL\n */\nexport function createDeepLink(\n  screen: string,\n  params?: Record<string, any>\n): string {\n  let path = '';\n  \n  switch (screen) {\n    case 'InvestmentDetail':\n      path = `investment/${params?.investmentId}`;\n      break;\n      \n    case 'InvestModal':\n      path = params?.investmentId ? `invest/${params.investmentId}` : 'invest';\n      break;\n      \n    case 'Discover':\n      path = 'discover';\n      break;\n      \n    case 'Portfolio':\n      path = 'portfolio';\n      break;\n      \n    case 'Research':\n      path = 'research';\n      break;\n      \n    case 'Profile':\n      path = 'profile';\n      break;\n      \n    default:\n      path = screen.toLowerCase();\n  }\n  \n  return ExpoLinking.createURL(path);\n}\n\n/**\n * Hook for handling deep links\n */\nexport function useDeepLinks() {\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n\n  useEffect(() => {\n    // Handle initial URL (app opened from deep link)\n    const handleInitialURL = async () => {\n      const initialUrl = await Linking.getInitialURL();\n      \n      if (initialUrl) {\n        const parsed = parseDeepLink(initialUrl);\n        \n        if (parsed?.screen) {\n          // Small delay to ensure navigation is ready\n          setTimeout(() => {\n            navigation.navigate(parsed.screen as any, parsed.params);\n          }, 100);\n        }\n      }\n    };\n\n    handleInitialURL();\n\n    // Handle deep links while app is running\n    const subscription = Linking.addEventListener('url', ({ url }) => {\n      const parsed = parseDeepLink(url);\n      \n      if (parsed?.screen) {\n        navigation.navigate(parsed.screen as any, parsed.params);\n      }\n    });\n\n    return () => {\n      subscription.remove();\n    };\n  }, [navigation]);\n}\n\n/**\n * Share an investment with deep link\n */\nexport async function shareInvestment(\n  investmentId: string,\n  investmentName: string\n): Promise<void> {\n  const url = createDeepLink('InvestmentDetail', { investmentId });\n  \n  await Linking.openURL(\n    Platform.select({\n      ios: `sms:&body=Check out ${investmentName} on MedInvest: ${url}`,\n      android: `sms:?body=Check out ${investmentName} on MedInvest: ${url}`,\n      default: url,\n    })!\n  );\n}\n\n/**\n * Open external URL safely\n */\nexport async function openExternalURL(url: string): Promise<boolean> {\n  try {\n    const supported = await Linking.canOpenURL(url);\n    \n    if (supported) {\n      await Linking.openURL(url);\n      return true;\n    }\n    \n    console.warn('Cannot open URL:', url);\n    return false;\n  } catch (error) {\n    console.error('Failed to open URL:', error);\n    return false;\n  }\n}\n\n/**\n * Open email client\n */\nexport async function openEmail(\n  to: string,\n  subject?: string,\n  body?: string\n): Promise<void> {\n  let url = `mailto:${to}`;\n  \n  const params: string[] = [];\n  if (subject) params.push(`subject=${encodeURIComponent(subject)}`);\n  if (body) params.push(`body=${encodeURIComponent(body)}`);\n  \n  if (params.length > 0) {\n    url += `?${params.join('&')}`;\n  }\n  \n  await openExternalURL(url);\n}\n\n/**\n * Open phone dialer\n */\nexport async function openPhone(number: string): Promise<void> {\n  await openExternalURL(`tel:${number}`);\n}\n","path":null,"size_bytes":6785,"size_tokens":null},"client/navigation/PortfolioStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport PortfolioScreen from \"@/screens/PortfolioScreen\";\n\nexport type PortfolioStackParamList = {\n  Portfolio: undefined;\n};\n\nconst Stack = createNativeStackNavigator<PortfolioStackParamList>();\n\nexport default function PortfolioStackNavigator() {\n  const screenOptions = useScreenOptions();\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      <Stack.Screen\n        name=\"Portfolio\"\n        component={PortfolioScreen}\n        options={{ headerShown: false }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":682,"size_tokens":null},"attached_assets/README_1768152070786.md":{"content":"# MedInvest Mobile App\n\nA production-ready React Native mobile application for the MedInvest healthcare investment community platform with AI chatbot, push notifications, and offline support.\n\n## Features\n\n### üîê Authentication\n- Email/password login and registration\n- Social login (Google, Apple)\n- Email verification flow\n- Password reset\n- Biometric authentication support\n- JWT token management with auto-refresh\n\n### üì± Social Feed\n- Algorithmic feed with time decay and personalization\n- 14 specialty healthcare rooms\n- Anonymous posting mode\n- Rich text with @mentions and #hashtags\n- Photo/video uploads (up to 10 per post)\n- Voting, commenting, and bookmarking\n- Share to social media\n\n### ü§ñ AI Assistant\n- AI-powered healthcare investment chatbot\n- Context-aware conversations\n- Investment insights and analysis\n- Due diligence assistance\n- Suggested prompts\n\n### üí¨ Messaging\n- Real-time direct messaging\n- Conversation history\n- Read receipts\n- New conversation search\n- User suggestions\n\n### üí∞ Investment Deals\n- Browse healthcare investment opportunities\n- Deal details with team, documents, highlights\n- Funding progress tracking\n- Express interest functionality\n- Category filtering\n\n### üìö Content\n- AMA (Ask Me Anything) sessions with Q&A\n- Educational courses with lessons\n- Community events with RSVP\n- Full-screen image gallery with zoom\n\n### üèÜ Gamification\n- Points and leveling system\n- 20+ achievements and badges\n- Weekly/monthly/all-time leaderboards\n- Activity streaks\n- Podium display for top users\n\n### ‚≠ê Premium Features\n- Ad-free experience\n- Extended anonymous posting\n- Priority support\n- Exclusive rooms access\n- Advanced analytics\n\n## Tech Stack\n\n- **Framework**: React Native with Expo SDK 51\n- **Navigation**: React Navigation 6 (Stack + Bottom Tabs)\n- **State Management**: TanStack Query (React Query)\n- **Styling**: StyleSheet with custom theme system\n- **Storage**: Expo SecureStore + AsyncStorage\n- **Push Notifications**: Expo Notifications\n- **Deep Linking**: Expo Linking + Universal Links\n- **Error Tracking**: Sentry\n- **Analytics**: Custom analytics service\n\n## Project Structure\n\n```\nclient/\n‚îú‚îÄ‚îÄ components/          # Reusable UI components\n‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Card.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ ErrorBoundary.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ ImageViewer.tsx      # Full-screen gallery\n‚îÇ   ‚îú‚îÄ‚îÄ PostCard.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ ReportModal.tsx      # Report content\n‚îÇ   ‚îú‚îÄ‚îÄ RichTextContent.tsx\n‚îÇ   ‚îî‚îÄ‚îÄ RoomFilter.tsx\n‚îú‚îÄ‚îÄ constants/\n‚îÇ   ‚îî‚îÄ‚îÄ theme.ts         # Colors, typography, spacing\n‚îú‚îÄ‚îÄ contexts/\n‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx  # Authentication state\n‚îú‚îÄ‚îÄ hooks/               # Custom React hooks\n‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îú‚îÄ‚îÄ api.ts           # API client (850+ lines)\n‚îÇ   ‚îú‚îÄ‚îÄ analytics.ts     # Event tracking\n‚îÇ   ‚îú‚îÄ‚îÄ deep-linking.ts  # URL handling\n‚îÇ   ‚îú‚îÄ‚îÄ error-tracking.ts # Sentry integration\n‚îÇ   ‚îú‚îÄ‚îÄ offline-persistence.ts # React Query caching\n‚îÇ   ‚îú‚îÄ‚îÄ push-notifications.ts  # Push service\n‚îÇ   ‚îú‚îÄ‚îÄ storage.ts       # Async storage helpers\n‚îÇ   ‚îî‚îÄ‚îÄ utils.ts         # Utility functions\n‚îú‚îÄ‚îÄ navigation/\n‚îÇ   ‚îî‚îÄ‚îÄ RootNavigator.tsx # Navigation configuration\n‚îú‚îÄ‚îÄ screens/             # All app screens (32 total)\n‚îî‚îÄ‚îÄ types/\n    ‚îî‚îÄ‚îÄ index.ts         # TypeScript definitions\n```\n\n## Screens (32 Total)\n\n### Authentication (4)\n| Screen | Description |\n|--------|-------------|\n| LoginScreen | Email/password + social login |\n| RegisterScreen | Registration with specialty picker |\n| ForgotPasswordScreen | Password reset request |\n| VerifyEmailScreen | Email verification flow |\n\n### Main Tabs (4)\n| Screen | Description |\n|--------|-------------|\n| HomeScreen | Algorithmic feed with room filters |\n| DealsScreen | Investment opportunities |\n| MessagesScreen | Conversations list |\n| ProfileScreen | User profile with tabs |\n\n### Content (7)\n| Screen | Description |\n|--------|-------------|\n| PostDetailScreen | Full post with comments |\n| RoomDetailScreen | Room info and feed |\n| HashtagScreen | Posts by hashtag |\n| DealDetailScreen | Investment deal details |\n| AMADetailScreen | Q&A sessions |\n| CourseDetailScreen | Learning content |\n| EventDetailScreen | Event RSVP |\n\n### Messaging (2)\n| Screen | Description |\n|--------|-------------|\n| ConversationScreen | Chat interface |\n| NewConversationScreen | Start new DM |\n\n### Profile (4)\n| Screen | Description |\n|--------|-------------|\n| UserProfileScreen | View other users |\n| EditProfileScreen | Edit own profile |\n| FollowersScreen | Followers/following |\n| BookmarksScreen | Saved posts |\n\n### Gamification (2)\n| Screen | Description |\n|--------|-------------|\n| LeaderboardScreen | Rankings with podium |\n| AchievementsScreen | Badges with progress |\n\n### Other (9)\n| Screen | Description |\n|--------|-------------|\n| CreatePostScreen | Rich post composer |\n| SearchScreen | Search everything |\n| NotificationsScreen | All notifications |\n| SettingsScreen | App settings |\n| PremiumScreen | Subscription upgrade |\n| AIChatScreen | AI assistant |\n\n## Infrastructure\n\n### üîî Push Notifications\n- Device token registration with backend\n- 9 notification types (likes, comments, follows, mentions, messages, deals, AMAs, achievements, system)\n- Android notification channels\n- Badge management\n- Background/foreground handling\n- Deep link on tap\n\n### üîó Deep Linking\n```\nURL Schemes:\n- medinvest://post/123\n- medinvest://user/456\n- https://app.medinvest.com/deal/789\n\nSupported paths:\n- posts, users, rooms, deals, AMAs, hashtags, invites, verify-email\n```\n\n### üì¥ Offline Support\n- React Query persistence to AsyncStorage\n- Network connectivity monitoring\n- Offline mutation queue with retry\n- Automatic sync on reconnect\n- 7-day cache retention\n\n### üìä Analytics\n- 30+ event types tracked\n- Screen view tracking\n- User identification\n- Session management\n- Batch event sending\n- Timing events\n\n### üêõ Error Tracking (Sentry)\n- Global error handler\n- Unhandled promise rejection handler\n- Breadcrumb logging\n- Performance monitoring\n- React Error Boundaries\n- User context attachment\n\n## Installation\n\n```bash\n# Clone repository\ngit clone <repo-url>\ncd Medinvest-Mobile\n\n# Install dependencies\nnpm install\n\n# Start development server\nnpx expo start\n\n# Run on iOS simulator\nnpx expo run:ios\n\n# Run on Android emulator\nnpx expo run:android\n```\n\n## Configuration\n\n### Environment Variables\n\nCreate `.env` file:\n\n```env\nEXPO_PUBLIC_API_URL=https://api.medinvest.com/v1\nEXPO_PUBLIC_SENTRY_DSN=your-sentry-dsn\nEXPO_PUBLIC_APP_VERSION=1.0.0\nEXPO_PUBLIC_BUILD_NUMBER=1\nEXPO_PROJECT_ID=your-expo-project-id\n```\n\n### API Configuration\n\nUpdate `client/lib/api.ts`:\n\n```typescript\nconst API_BASE_URL = __DEV__ \n  ? 'http://localhost:5000/api/v1'\n  : 'https://api.medinvest.com/api/v1';\n```\n\n## API Endpoints\n\n### Auth\n```\nPOST /auth/login\nPOST /auth/register\nPOST /auth/refresh\nPOST /auth/forgot-password\nPOST /auth/verify-email\n```\n\n### Feed & Posts\n```\nGET  /feed\nGET  /posts/:id\nPOST /posts\nPOST /posts/:id/vote\nPOST /posts/:id/bookmark\n```\n\n### Users\n```\nGET  /users/:id\nPUT  /users/me\nPOST /users/:id/follow\nGET  /users/:id/followers\n```\n\n### Messaging\n```\nGET  /conversations\nGET  /conversations/:id/messages\nPOST /conversations/:id/messages\n```\n\n### AI Chat\n```\nPOST /ai/chat\nPOST /ai/chat/stream\nPOST /ai/suggestions\n```\n\n### Deals\n```\nGET  /deals\nGET  /deals/:id\nPOST /deals/:id/interest\n```\n\n### Notifications\n```\nGET  /notifications\nPOST /notifications/push-token\nPUT  /notifications/preferences\n```\n\n## Building for Production\n\n```bash\n# Configure EAS\neas login\neas build:configure\n\n# Build for iOS\neas build --platform ios --profile production\n\n# Build for Android\neas build --platform android --profile production\n\n# Submit to stores\neas submit --platform ios\neas submit --platform android\n```\n\n## License\n\nProprietary - All rights reserved\n","path":null,"size_bytes":7930,"size_tokens":null},"client/screens/MessagesScreen.tsx":{"content":"/**\n * Messages Screen\n * Direct messaging inbox showing all conversations\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { messagesApi, Conversation } from '@/lib/api';\nimport { formatRelativeTime } from '@/lib/utils';\n\nexport default function MessagesScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n\n  const {\n    data: conversationsData,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['conversations'],\n    queryFn: async () => {\n      const response = await messagesApi.getConversations();\n      return response.data?.conversations || [];\n    },\n    refetchInterval: 30000,\n  });\n\n  const conversations = conversationsData || [];\n\n  const handleConversationPress = useCallback((userId: string) => {\n    navigation.navigate('Conversation', { userId });\n  }, [navigation]);\n\n  const handleNewMessage = useCallback(() => {\n    navigation.navigate('NewConversation');\n  }, [navigation]);\n\n  const renderConversation = ({ item }: { item: Conversation }) => (\n    <TouchableOpacity\n      style={[styles.conversationItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}\n      onPress={() => handleConversationPress(item.other_user.id)}\n    >\n      {/* Avatar */}\n      {item.other_user.avatar_url ? (\n        <Image source={{ uri: item.other_user.avatar_url }} style={styles.avatar} />\n      ) : (\n        <View style={[styles.avatar, styles.avatarPlaceholder]}>\n          <ThemedText style={styles.avatarText}>\n            {item.other_user.first_name[0]}{item.other_user.last_name[0]}\n          </ThemedText>\n        </View>\n      )}\n\n      {/* Content */}\n      <View style={styles.conversationContent}>\n        <View style={styles.conversationHeader}>\n          <View style={styles.nameContainer}>\n            <ThemedText style={[styles.userName, { color: appColors.textPrimary }]} numberOfLines={1}>\n              {item.other_user.full_name}\n            </ThemedText>\n            {item.other_user.is_verified && (\n              <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n            )}\n          </View>\n          {item.last_message_at && (\n            <ThemedText style={[styles.timestamp, { color: appColors.textSecondary }]}>\n              {formatRelativeTime(item.last_message_at)}\n            </ThemedText>\n          )}\n        </View>\n        <View style={styles.messageRow}>\n          <ThemedText\n            style={[\n              styles.lastMessage,\n              { color: appColors.textSecondary },\n              item.unread_count > 0 && { color: appColors.textPrimary, fontWeight: '500' },\n            ]}\n            numberOfLines={1}\n          >\n            {item.last_message || 'Start a conversation'}\n          </ThemedText>\n          {item.unread_count > 0 && (\n            <View style={styles.unreadBadge}>\n              <ThemedText style={styles.unreadCount}>\n                {item.unread_count > 99 ? '99+' : item.unread_count}\n              </ThemedText>\n            </View>\n          )}\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"chatbubbles-outline\" size={64} color={appColors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No messages yet</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        Start a conversation with someone!\n      </ThemedText>\n      <TouchableOpacity style={styles.emptyButton} onPress={handleNewMessage}>\n        <ThemedText style={styles.emptyButtonText}>New Message</ThemedText>\n      </TouchableOpacity>\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Messages</ThemedText>\n        <TouchableOpacity style={styles.newMessageButton} onPress={handleNewMessage}>\n          <Ionicons name=\"create-outline\" size={24} color={Colors.primary} />\n        </TouchableOpacity>\n      </View>\n\n      {/* Conversations List */}\n      <FlatList\n        data={conversations}\n        renderItem={renderConversation}\n        keyExtractor={(item) => item.id.toString()}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={conversations.length === 0 ? styles.emptyList : undefined}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  headerTitle: {\n    ...Typography.title,\n  },\n  newMessageButton: {\n    padding: Spacing.sm,\n  },\n  conversationItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  avatar: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  conversationContent: {\n    flex: 1,\n  },\n  conversationHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    marginBottom: Spacing.xs,\n  },\n  nameContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n    flex: 1,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n    flex: 1,\n  },\n  timestamp: {\n    ...Typography.small,\n  },\n  messageRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  lastMessage: {\n    ...Typography.caption,\n    flex: 1,\n  },\n  unreadBadge: {\n    backgroundColor: Colors.primary,\n    borderRadius: BorderRadius.full,\n    minWidth: 20,\n    height: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xs,\n    marginLeft: Spacing.sm,\n  },\n  unreadCount: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n    fontSize: 11,\n  },\n  emptyList: {\n    flex: 1,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n  emptyButton: {\n    marginTop: Spacing.xl,\n    backgroundColor: Colors.primary,\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  emptyButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":7776,"size_tokens":null},"client/navigation/types.ts":{"content":"import type { NavigatorScreenParams } from '@react-navigation/native';\nimport type { NativeStackScreenProps } from '@react-navigation/native-stack';\nimport type { BottomTabScreenProps } from '@react-navigation/bottom-tabs';\n\n// ============================================\n// Root Stack\n// ============================================\n\nexport type RootStackParamList = {\n  // Pre-auth\n  Onboarding: undefined;\n  Auth: NavigatorScreenParams<AuthStackParamList>;\n  \n  // Main app\n  Main: NavigatorScreenParams<MainTabParamList>;\n  \n  // Investment screens\n  InvestmentDetail: { investmentId: string };\n  InvestModal: { investmentId: string; investmentName: string; minimumInvestment: number };\n  \n  // Article screens\n  ArticleDetail: { articleId: string };\n  BookmarkedArticles: undefined;\n  \n  // Portfolio screens\n  TransactionHistory: undefined;\n  \n  // Settings screens\n  Settings: undefined;\n  EditProfile: undefined;\n  NotificationsSettings: undefined;\n  Documents: undefined;\n  PaymentMethods: undefined;\n  Support: undefined;\n  Legal: undefined;\n};\n\nexport type RootStackScreenProps<T extends keyof RootStackParamList> = \n  NativeStackScreenProps<RootStackParamList, T>;\n\n// ============================================\n// Auth Stack\n// ============================================\n\nexport type AuthStackParamList = {\n  Login: undefined;\n  Signup: undefined;\n  ForgotPassword: undefined;\n  VerifyEmail: { email: string };\n};\n\nexport type AuthStackScreenProps<T extends keyof AuthStackParamList> = \n  NativeStackScreenProps<AuthStackParamList, T>;\n\n// ============================================\n// Main Tab Navigator\n// ============================================\n\nexport type MainTabParamList = {\n  Discover: NavigatorScreenParams<DiscoverStackParamList>;\n  Portfolio: NavigatorScreenParams<PortfolioStackParamList>;\n  Research: NavigatorScreenParams<ResearchStackParamList>;\n  Profile: NavigatorScreenParams<ProfileStackParamList>;\n};\n\nexport type MainTabScreenProps<T extends keyof MainTabParamList> = \n  BottomTabScreenProps<MainTabParamList, T>;\n\n// ============================================\n// Discover Stack\n// ============================================\n\nexport type DiscoverStackParamList = {\n  DiscoverHome: undefined;\n  Category: { category: string };\n  Search: { query?: string };\n};\n\nexport type DiscoverStackScreenProps<T extends keyof DiscoverStackParamList> = \n  NativeStackScreenProps<DiscoverStackParamList, T>;\n\n// ============================================\n// Portfolio Stack\n// ============================================\n\nexport type PortfolioStackParamList = {\n  PortfolioHome: undefined;\n  PortfolioDetail: { investmentId: string };\n};\n\nexport type PortfolioStackScreenProps<T extends keyof PortfolioStackParamList> = \n  NativeStackScreenProps<PortfolioStackParamList, T>;\n\n// ============================================\n// Research Stack\n// ============================================\n\nexport type ResearchStackParamList = {\n  ResearchHome: undefined;\n  ArticleCategory: { category: string };\n};\n\nexport type ResearchStackScreenProps<T extends keyof ResearchStackParamList> = \n  NativeStackScreenProps<ResearchStackParamList, T>;\n\n// ============================================\n// Profile Stack\n// ============================================\n\nexport type ProfileStackParamList = {\n  ProfileHome: undefined;\n};\n\nexport type ProfileStackScreenProps<T extends keyof ProfileStackParamList> = \n  NativeStackScreenProps<ProfileStackParamList, T>;\n\n// ============================================\n// Screen Params Helpers\n// ============================================\n\nexport interface InvestmentParams {\n  investmentId: string;\n}\n\nexport interface ArticleParams {\n  articleId: string;\n}\n\nexport interface InvestModalParams {\n  investmentId: string;\n  investmentName: string;\n  minimumInvestment: number;\n}\n\n// ============================================\n// Global Type Declaration\n// ============================================\n\ndeclare global {\n  namespace ReactNavigation {\n    interface RootParamList extends RootStackParamList {}\n  }\n}\n","path":null,"size_bytes":4083,"size_tokens":null},"client/screens/modals/InvestModalScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  TextInput,\n  Switch,\n  Alert,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport type { RouteProp } from '@react-navigation/native';\nimport Animated, { FadeInDown } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { RootStackParamList } from '@/navigation/types';\n\n// Types\ninterface PaymentMethod {\n  id: string;\n  type: 'bank' | 'card';\n  name: string;\n  last4: string;\n  isDefault: boolean;\n}\n\n// Mock data\nconst MOCK_PAYMENT_METHODS: PaymentMethod[] = [\n  { id: '1', type: 'bank', name: 'Chase Checking', last4: '4567', isDefault: true },\n  { id: '2', type: 'card', name: 'Visa', last4: '1234', isDefault: false },\n];\n\nconst MOCK_INVESTMENT = {\n  id: '1',\n  name: 'NeuroLink Diagnostics',\n  category: 'Digital Health',\n  minimumInvestment: 1000,\n  expectedROI: '15-22%',\n};\n\n// Preset amounts\nconst PRESET_AMOUNTS = [1000, 5000, 10000, 25000];\n\n/**\n * Invest Modal Screen\n */\nexport default function InvestModalScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const route = useRoute<RouteProp<RootStackParamList, 'InvestModal'>>();\n\n  const [amount, setAmount] = useState('');\n  const [selectedPaymentId, setSelectedPaymentId] = useState(\n    MOCK_PAYMENT_METHODS.find((p) => p.isDefault)?.id || ''\n  );\n  const [riskAcknowledged, setRiskAcknowledged] = useState(false);\n  const [termsAccepted, setTermsAccepted] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const numericAmount = parseFloat(amount.replace(/[^0-9.]/g, '')) || 0;\n  const isValidAmount = numericAmount >= MOCK_INVESTMENT.minimumInvestment;\n  const canSubmit = isValidAmount && selectedPaymentId && riskAcknowledged && termsAccepted;\n\n  const handleClose = useCallback(() => {\n    navigation.goBack();\n  }, [navigation]);\n\n  const handleAmountChange = (text: string) => {\n    // Remove non-numeric characters except decimal\n    const cleaned = text.replace(/[^0-9.]/g, '');\n    // Prevent multiple decimals\n    const parts = cleaned.split('.');\n    const formatted = parts.length > 2 ? parts[0] + '.' + parts.slice(1).join('') : cleaned;\n    setAmount(formatted);\n  };\n\n  const handlePresetAmount = (preset: number) => {\n    setAmount(preset.toString());\n  };\n\n  const handleSubmit = useCallback(async () => {\n    if (!canSubmit) return;\n\n    setIsSubmitting(true);\n\n    try {\n      // TODO: Submit investment to API\n      await new Promise((resolve) => setTimeout(resolve, 2000));\n\n      Alert.alert(\n        'Investment Submitted!',\n        `Your investment of $${numericAmount.toLocaleString()} in ${MOCK_INVESTMENT.name} has been submitted for processing.`,\n        [\n          {\n            text: 'View Portfolio',\n            onPress: () => {\n              navigation.goBack();\n              // Navigate to portfolio\n            },\n          },\n        ]\n      );\n    } catch (error) {\n      Alert.alert('Error', 'Failed to submit investment. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [canSubmit, numericAmount, navigation]);\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(value);\n  };\n\n  return (\n    <KeyboardAvoidingView\n      style={styles.container}\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n    >\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable onPress={handleClose}>\n          <Text style={styles.cancelButton}>Cancel</Text>\n        </Pressable>\n        <Text style={styles.headerTitle}>Invest</Text>\n        <Pressable\n          onPress={handleSubmit}\n          disabled={!canSubmit || isSubmitting}\n        >\n          <Text\n            style={[\n              styles.reviewButton,\n              (!canSubmit || isSubmitting) && styles.reviewButtonDisabled,\n            ]}\n          >\n            {isSubmitting ? 'Processing...' : 'Review'}\n          </Text>\n        </Pressable>\n      </View>\n\n      <ScrollView\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingBottom: insets.bottom + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n        keyboardShouldPersistTaps=\"handled\"\n      >\n        {/* Project Summary */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(100)}\n          style={styles.summaryCard}\n        >\n          <View style={styles.summaryIcon}>\n            <Feather name=\"activity\" size={24} color={colors.primary.main} />\n          </View>\n          <View style={styles.summaryContent}>\n            <Text style={styles.summaryName}>{MOCK_INVESTMENT.name}</Text>\n            <Text style={styles.summaryCategory}>{MOCK_INVESTMENT.category}</Text>\n          </View>\n          <View style={styles.summaryROI}>\n            <Text style={styles.roiLabel}>Expected ROI</Text>\n            <Text style={styles.roiValue}>{MOCK_INVESTMENT.expectedROI}</Text>\n          </View>\n        </Animated.View>\n\n        {/* Amount Input */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(200)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Investment Amount</Text>\n          <View style={styles.amountInputContainer}>\n            <Text style={styles.currencySymbol}>$</Text>\n            <TextInput\n              style={styles.amountInput}\n              value={amount}\n              onChangeText={handleAmountChange}\n              keyboardType=\"decimal-pad\"\n              placeholder=\"0\"\n              placeholderTextColor={colors.text.tertiary}\n            />\n          </View>\n          <Text style={styles.minimumText}>\n            Minimum investment: {formatCurrency(MOCK_INVESTMENT.minimumInvestment)}\n          </Text>\n\n          {/* Preset Amounts */}\n          <View style={styles.presetContainer}>\n            {PRESET_AMOUNTS.map((preset) => (\n              <Pressable\n                key={preset}\n                style={[\n                  styles.presetButton,\n                  numericAmount === preset && styles.presetButtonActive,\n                ]}\n                onPress={() => handlePresetAmount(preset)}\n              >\n                <Text\n                  style={[\n                    styles.presetText,\n                    numericAmount === preset && styles.presetTextActive,\n                  ]}\n                >\n                  {formatCurrency(preset)}\n                </Text>\n              </Pressable>\n            ))}\n          </View>\n        </Animated.View>\n\n        {/* Payment Method */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(300)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Payment Method</Text>\n          {MOCK_PAYMENT_METHODS.map((method) => (\n            <Pressable\n              key={method.id}\n              style={[\n                styles.paymentMethod,\n                selectedPaymentId === method.id && styles.paymentMethodSelected,\n              ]}\n              onPress={() => setSelectedPaymentId(method.id)}\n            >\n              <View style={styles.paymentIcon}>\n                <Feather\n                  name={method.type === 'bank' ? 'home' : 'credit-card'}\n                  size={20}\n                  color={colors.primary.main}\n                />\n              </View>\n              <View style={styles.paymentInfo}>\n                <Text style={styles.paymentName}>{method.name}</Text>\n                <Text style={styles.paymentLast4}>‚Ä¢‚Ä¢‚Ä¢‚Ä¢ {method.last4}</Text>\n              </View>\n              <View\n                style={[\n                  styles.radioOuter,\n                  selectedPaymentId === method.id && styles.radioOuterSelected,\n                ]}\n              >\n                {selectedPaymentId === method.id && (\n                  <View style={styles.radioInner} />\n                )}\n              </View>\n            </Pressable>\n          ))}\n          <Pressable style={styles.addPaymentButton}>\n            <Feather name=\"plus\" size={20} color={colors.primary.main} />\n            <Text style={styles.addPaymentText}>Add Payment Method</Text>\n          </Pressable>\n        </Animated.View>\n\n        {/* Acknowledgements */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(400)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Acknowledgements</Text>\n          \n          {/* Risk Acknowledgment */}\n          <View style={styles.checkboxRow}>\n            <Switch\n              value={riskAcknowledged}\n              onValueChange={setRiskAcknowledged}\n              trackColor={{\n                false: colors.border.medium,\n                true: colors.primary.light,\n              }}\n              thumbColor={riskAcknowledged ? colors.primary.main : colors.surface.primary}\n            />\n            <Text style={styles.checkboxText}>\n              I understand that this investment carries risk and I may lose some or all of my investment.\n            </Text>\n          </View>\n\n          {/* Terms Acceptance */}\n          <View style={styles.checkboxRow}>\n            <Switch\n              value={termsAccepted}\n              onValueChange={setTermsAccepted}\n              trackColor={{\n                false: colors.border.medium,\n                true: colors.primary.light,\n              }}\n              thumbColor={termsAccepted ? colors.primary.main : colors.surface.primary}\n            />\n            <Text style={styles.checkboxText}>\n              I have read and agree to the{' '}\n              <Text style={styles.linkText}>Terms of Service</Text> and{' '}\n              <Text style={styles.linkText}>Investment Agreement</Text>.\n            </Text>\n          </View>\n        </Animated.View>\n\n        {/* Summary */}\n        {isValidAmount && (\n          <Animated.View\n            entering={FadeInDown.duration(400).delay(500)}\n            style={styles.totalCard}\n          >\n            <View style={styles.totalRow}>\n              <Text style={styles.totalLabel}>Investment Amount</Text>\n              <Text style={styles.totalValue}>{formatCurrency(numericAmount)}</Text>\n            </View>\n            <View style={styles.totalRow}>\n              <Text style={styles.totalLabel}>Processing Fee</Text>\n              <Text style={styles.totalValue}>$0</Text>\n            </View>\n            <View style={styles.totalDivider} />\n            <View style={styles.totalRow}>\n              <Text style={styles.totalLabelBold}>Total</Text>\n              <Text style={styles.totalValueBold}>{formatCurrency(numericAmount)}</Text>\n            </View>\n          </Animated.View>\n        )}\n      </ScrollView>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Header\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  cancelButton: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  reviewButton: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n  reviewButtonDisabled: {\n    color: colors.text.tertiary,\n  },\n\n  // Scroll View\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    padding: spacing.lg,\n  },\n\n  // Summary Card\n  summaryCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    marginBottom: spacing.xl,\n  },\n  summaryIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  summaryContent: {\n    flex: 1,\n  },\n  summaryName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  summaryCategory: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  summaryROI: {\n    alignItems: 'flex-end',\n  },\n  roiLabel: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  roiValue: {\n    ...typography.bodyMedium,\n    color: colors.semantic.success,\n  },\n\n  // Sections\n  section: {\n    marginBottom: spacing.xl,\n  },\n  sectionTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.md,\n  },\n\n  // Amount Input\n  amountInputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 2,\n    borderColor: colors.border.light,\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.md,\n  },\n  currencySymbol: {\n    ...typography.hero,\n    color: colors.text.tertiary,\n    marginRight: spacing.sm,\n  },\n  amountInput: {\n    flex: 1,\n    ...typography.hero,\n    color: colors.text.primary,\n  },\n  minimumText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    marginTop: spacing.sm,\n  },\n  presetContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: spacing.sm,\n    marginTop: spacing.md,\n  },\n  presetButton: {\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.sm,\n    borderRadius: layout.radiusFull,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  presetButtonActive: {\n    borderColor: colors.primary.main,\n    backgroundColor: colors.transparent.primary10,\n  },\n  presetText: {\n    ...typography.captionMedium,\n    color: colors.text.secondary,\n  },\n  presetTextActive: {\n    color: colors.primary.main,\n  },\n\n  // Payment Method\n  paymentMethod: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    marginBottom: spacing.sm,\n  },\n  paymentMethodSelected: {\n    borderColor: colors.primary.main,\n    backgroundColor: colors.transparent.primary10,\n  },\n  paymentIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  paymentInfo: {\n    flex: 1,\n  },\n  paymentName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  paymentLast4: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  radioOuter: {\n    width: 22,\n    height: 22,\n    borderRadius: 11,\n    borderWidth: 2,\n    borderColor: colors.border.medium,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  radioOuterSelected: {\n    borderColor: colors.primary.main,\n  },\n  radioInner: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    backgroundColor: colors.primary.main,\n  },\n  addPaymentButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    paddingVertical: spacing.md,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.primary.main,\n    borderStyle: 'dashed',\n  },\n  addPaymentText: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n\n  // Checkboxes\n  checkboxRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: spacing.md,\n  },\n  checkboxText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    flex: 1,\n    marginLeft: spacing.md,\n    lineHeight: 20,\n  },\n  linkText: {\n    color: colors.primary.main,\n    textDecorationLine: 'underline',\n  },\n\n  // Total Card\n  totalCard: {\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  totalRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: spacing.sm,\n  },\n  totalLabel: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n  totalValue: {\n    ...typography.body,\n    color: colors.text.primary,\n  },\n  totalDivider: {\n    height: 1,\n    backgroundColor: colors.border.light,\n    marginVertical: spacing.md,\n  },\n  totalLabelBold: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  totalValueBold: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n});\n","path":null,"size_bytes":17268,"size_tokens":null},"client/hooks/useForm.ts":{"content":"import { useState, useCallback, useMemo, useRef } from 'react';\nimport { z } from 'zod';\n\n// ============================================\n// Types\n// ============================================\n\nexport interface FieldState {\n  value: any;\n  error?: string;\n  touched: boolean;\n  dirty: boolean;\n}\n\nexport interface FormState<T extends Record<string, any>> {\n  values: T;\n  errors: Partial<Record<keyof T, string>>;\n  touched: Partial<Record<keyof T, boolean>>;\n  dirty: Partial<Record<keyof T, boolean>>;\n  isValid: boolean;\n  isSubmitting: boolean;\n  submitCount: number;\n}\n\nexport interface UseFormOptions<T extends Record<string, any>> {\n  /** Initial form values */\n  initialValues: T;\n  /** Zod schema for validation */\n  schema?: z.ZodSchema<T>;\n  /** Validate on change */\n  validateOnChange?: boolean;\n  /** Validate on blur */\n  validateOnBlur?: boolean;\n  /** Submit handler */\n  onSubmit?: (values: T) => void | Promise<void>;\n}\n\nexport interface UseFormReturn<T extends Record<string, any>> {\n  // State\n  values: T;\n  errors: Partial<Record<keyof T, string>>;\n  touched: Partial<Record<keyof T, boolean>>;\n  isValid: boolean;\n  isSubmitting: boolean;\n  isDirty: boolean;\n\n  // Field handlers\n  setValue: <K extends keyof T>(field: K, value: T[K]) => void;\n  setValues: (values: Partial<T>) => void;\n  setError: <K extends keyof T>(field: K, error: string | undefined) => void;\n  setErrors: (errors: Partial<Record<keyof T, string>>) => void;\n  setTouched: <K extends keyof T>(field: K, touched?: boolean) => void;\n  \n  // Field props helper\n  getFieldProps: <K extends keyof T>(field: K) => {\n    value: T[K];\n    onChangeText: (value: string) => void;\n    onBlur: () => void;\n    error: string | undefined;\n  };\n\n  // Form actions\n  handleSubmit: () => Promise<void>;\n  validate: () => boolean;\n  validateField: <K extends keyof T>(field: K) => string | undefined;\n  reset: (values?: Partial<T>) => void;\n  resetField: <K extends keyof T>(field: K) => void;\n}\n\n// ============================================\n// useForm Hook\n// ============================================\n\nexport function useForm<T extends Record<string, any>>(\n  options: UseFormOptions<T>\n): UseFormReturn<T> {\n  const {\n    initialValues,\n    schema,\n    validateOnChange = true,\n    validateOnBlur = true,\n    onSubmit,\n  } = options;\n\n  // Store initial values for reset\n  const initialValuesRef = useRef(initialValues);\n\n  // Form state\n  const [values, setValuesState] = useState<T>(initialValues);\n  const [errors, setErrorsState] = useState<Partial<Record<keyof T, string>>>({});\n  const [touched, setTouchedState] = useState<Partial<Record<keyof T, boolean>>>({});\n  const [dirty, setDirtyState] = useState<Partial<Record<keyof T, boolean>>>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitCount, setSubmitCount] = useState(0);\n\n  // Computed state\n  const isValid = useMemo(() => {\n    if (!schema) return true;\n    const result = schema.safeParse(values);\n    return result.success;\n  }, [schema, values]);\n\n  const isDirty = useMemo(() => {\n    return Object.values(dirty).some(Boolean);\n  }, [dirty]);\n\n  // Validate entire form\n  const validate = useCallback((): boolean => {\n    if (!schema) return true;\n\n    const result = schema.safeParse(values);\n\n    if (result.success) {\n      setErrorsState({});\n      return true;\n    }\n\n    const newErrors: Partial<Record<keyof T, string>> = {};\n    \n    for (const error of result.error.errors) {\n      const path = error.path[0] as keyof T;\n      if (!newErrors[path]) {\n        newErrors[path] = error.message;\n      }\n    }\n\n    setErrorsState(newErrors);\n    return false;\n  }, [schema, values]);\n\n  // Validate single field\n  const validateField = useCallback(\n    <K extends keyof T>(field: K): string | undefined => {\n      if (!schema) return undefined;\n\n      const result = schema.safeParse(values);\n\n      if (result.success) {\n        setErrorsState((prev) => {\n          const next = { ...prev };\n          delete next[field];\n          return next;\n        });\n        return undefined;\n      }\n\n      const fieldError = result.error.errors.find(\n        (err) => err.path[0] === field\n      );\n\n      const errorMessage = fieldError?.message;\n\n      setErrorsState((prev) => ({\n        ...prev,\n        [field]: errorMessage,\n      }));\n\n      return errorMessage;\n    },\n    [schema, values]\n  );\n\n  // Set single value\n  const setValue = useCallback(\n    <K extends keyof T>(field: K, value: T[K]) => {\n      setValuesState((prev) => ({ ...prev, [field]: value }));\n      setDirtyState((prev) => ({ ...prev, [field]: true }));\n\n      if (validateOnChange) {\n        // Defer validation to next tick to use updated values\n        setTimeout(() => validateField(field), 0);\n      }\n    },\n    [validateOnChange, validateField]\n  );\n\n  // Set multiple values\n  const setValues = useCallback((newValues: Partial<T>) => {\n    setValuesState((prev) => ({ ...prev, ...newValues }));\n    \n    const newDirty: Partial<Record<keyof T, boolean>> = {};\n    for (const key of Object.keys(newValues) as Array<keyof T>) {\n      newDirty[key] = true;\n    }\n    setDirtyState((prev) => ({ ...prev, ...newDirty }));\n  }, []);\n\n  // Set single error\n  const setError = useCallback(\n    <K extends keyof T>(field: K, error: string | undefined) => {\n      setErrorsState((prev) => {\n        if (error === undefined) {\n          const next = { ...prev };\n          delete next[field];\n          return next;\n        }\n        return { ...prev, [field]: error };\n      });\n    },\n    []\n  );\n\n  // Set multiple errors\n  const setErrors = useCallback(\n    (newErrors: Partial<Record<keyof T, string>>) => {\n      setErrorsState(newErrors);\n    },\n    []\n  );\n\n  // Set touched state\n  const setTouched = useCallback(\n    <K extends keyof T>(field: K, isTouched = true) => {\n      setTouchedState((prev) => ({ ...prev, [field]: isTouched }));\n\n      if (validateOnBlur && isTouched) {\n        validateField(field);\n      }\n    },\n    [validateOnBlur, validateField]\n  );\n\n  // Get field props for Input component\n  const getFieldProps = useCallback(\n    <K extends keyof T>(field: K) => ({\n      value: values[field],\n      onChangeText: (value: string) => setValue(field, value as T[K]),\n      onBlur: () => setTouched(field, true),\n      error: touched[field] ? errors[field] : undefined,\n    }),\n    [values, errors, touched, setValue, setTouched]\n  );\n\n  // Handle form submission\n  const handleSubmit = useCallback(async () => {\n    setSubmitCount((prev) => prev + 1);\n\n    // Mark all fields as touched\n    const allTouched: Partial<Record<keyof T, boolean>> = {};\n    for (const key of Object.keys(values) as Array<keyof T>) {\n      allTouched[key] = true;\n    }\n    setTouchedState(allTouched);\n\n    // Validate\n    const isFormValid = validate();\n    if (!isFormValid) return;\n\n    // Submit\n    if (onSubmit) {\n      setIsSubmitting(true);\n      try {\n        await onSubmit(values);\n      } finally {\n        setIsSubmitting(false);\n      }\n    }\n  }, [values, validate, onSubmit]);\n\n  // Reset form\n  const reset = useCallback((newValues?: Partial<T>) => {\n    setValuesState({ ...initialValuesRef.current, ...newValues });\n    setErrorsState({});\n    setTouchedState({});\n    setDirtyState({});\n    setSubmitCount(0);\n  }, []);\n\n  // Reset single field\n  const resetField = useCallback(<K extends keyof T>(field: K) => {\n    setValuesState((prev) => ({\n      ...prev,\n      [field]: initialValuesRef.current[field],\n    }));\n    setErrorsState((prev) => {\n      const next = { ...prev };\n      delete next[field];\n      return next;\n    });\n    setTouchedState((prev) => {\n      const next = { ...prev };\n      delete next[field];\n      return next;\n    });\n    setDirtyState((prev) => {\n      const next = { ...prev };\n      delete next[field];\n      return next;\n    });\n  }, []);\n\n  return {\n    values,\n    errors,\n    touched,\n    isValid,\n    isSubmitting,\n    isDirty,\n    setValue,\n    setValues,\n    setError,\n    setErrors,\n    setTouched,\n    getFieldProps,\n    handleSubmit,\n    validate,\n    validateField,\n    reset,\n    resetField,\n  };\n}\n\n// ============================================\n// useField Hook (for individual fields)\n// ============================================\n\nexport interface UseFieldOptions<T> {\n  name: string;\n  validate?: (value: T) => string | undefined;\n  initialValue?: T;\n}\n\nexport function useField<T = string>(options: UseFieldOptions<T>) {\n  const { name, validate, initialValue } = options;\n\n  const [value, setValue] = useState<T | undefined>(initialValue);\n  const [error, setError] = useState<string | undefined>();\n  const [touched, setTouched] = useState(false);\n\n  const handleChange = useCallback(\n    (newValue: T) => {\n      setValue(newValue);\n      if (validate && touched) {\n        setError(validate(newValue));\n      }\n    },\n    [validate, touched]\n  );\n\n  const handleBlur = useCallback(() => {\n    setTouched(true);\n    if (validate && value !== undefined) {\n      setError(validate(value));\n    }\n  }, [validate, value]);\n\n  const reset = useCallback(() => {\n    setValue(initialValue);\n    setError(undefined);\n    setTouched(false);\n  }, [initialValue]);\n\n  return {\n    name,\n    value,\n    error: touched ? error : undefined,\n    touched,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    reset,\n    props: {\n      value,\n      onChangeText: handleChange,\n      onBlur: handleBlur,\n      error: touched ? error : undefined,\n    },\n  };\n}\n\nexport default useForm;\n","path":null,"size_bytes":9517,"size_tokens":null},"client/screens/main/DiscoverScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  TextInput,\n  Pressable,\n  RefreshControl,\n  Image,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport Animated, {\n  FadeIn,\n  FadeInDown,\n  Layout,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { RootStackParamList } from '@/navigation/types';\n\n// Types\ninterface Investment {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  fundingGoal: number;\n  fundingCurrent: number;\n  expectedROI: string;\n  daysRemaining: number;\n  imageUrl?: string;\n  riskLevel: 'Low' | 'Medium' | 'High';\n}\n\ninterface Category {\n  id: string;\n  name: string;\n  icon: keyof typeof Feather.glyphMap;\n}\n\n// Mock data\nconst CATEGORIES: Category[] = [\n  { id: '1', name: 'All', icon: 'grid' },\n  { id: '2', name: 'Biotech', icon: 'activity' },\n  { id: '3', name: 'Medical Devices', icon: 'cpu' },\n  { id: '4', name: 'Digital Health', icon: 'smartphone' },\n  { id: '5', name: 'Pharmaceuticals', icon: 'package' },\n  { id: '6', name: 'Research', icon: 'search' },\n];\n\nconst MOCK_INVESTMENTS: Investment[] = [\n  {\n    id: '1',\n    name: 'NeuroLink Diagnostics',\n    description: 'AI-powered early detection of neurological disorders',\n    category: 'Digital Health',\n    fundingGoal: 2500000,\n    fundingCurrent: 1875000,\n    expectedROI: '15-22%',\n    daysRemaining: 45,\n    riskLevel: 'Medium',\n  },\n  {\n    id: '2',\n    name: 'CardioSense Implant',\n    description: 'Next-gen cardiac monitoring implant with 10-year battery',\n    category: 'Medical Devices',\n    fundingGoal: 5000000,\n    fundingCurrent: 3250000,\n    expectedROI: '18-25%',\n    daysRemaining: 30,\n    riskLevel: 'Medium',\n  },\n  {\n    id: '3',\n    name: 'GeneCure Therapeutics',\n    description: 'CRISPR-based treatment for rare genetic diseases',\n    category: 'Biotech',\n    fundingGoal: 10000000,\n    fundingCurrent: 4500000,\n    expectedROI: '25-35%',\n    daysRemaining: 60,\n    riskLevel: 'High',\n  },\n  {\n    id: '4',\n    name: 'MindWell App',\n    description: 'Mental health platform with AI therapy assistance',\n    category: 'Digital Health',\n    fundingGoal: 1000000,\n    fundingCurrent: 850000,\n    expectedROI: '12-18%',\n    daysRemaining: 15,\n    riskLevel: 'Low',\n  },\n];\n\n/**\n * Discover Screen\n * Browse investment opportunities\n */\nexport default function DiscoverScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  \n  const [searchQuery, setSearchQuery] = useState('');\n  const [selectedCategory, setSelectedCategory] = useState('1');\n  const [refreshing, setRefreshing] = useState(false);\n  const [investments] = useState<Investment[]>(MOCK_INVESTMENTS);\n\n  const handleRefresh = useCallback(async () => {\n    setRefreshing(true);\n    // TODO: Fetch investments from API\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    setRefreshing(false);\n  }, []);\n\n  const handleInvestmentPress = useCallback(\n    (investment: Investment) => {\n      navigation.navigate('InvestmentDetail', { investmentId: investment.id });\n    },\n    [navigation]\n  );\n\n  const filteredInvestments = investments.filter((inv) => {\n    const matchesSearch = inv.name\n      .toLowerCase()\n      .includes(searchQuery.toLowerCase());\n    const matchesCategory =\n      selectedCategory === '1' ||\n      CATEGORIES.find((c) => c.id === selectedCategory)?.name === inv.category;\n    return matchesSearch && matchesCategory;\n  });\n\n  const renderHeader = () => (\n    <View style={styles.headerContent}>\n      {/* Search Bar */}\n      <View style={styles.searchContainer}>\n        <Feather\n          name=\"search\"\n          size={20}\n          color={colors.text.secondary}\n          style={styles.searchIcon}\n        />\n        <TextInput\n          style={styles.searchInput}\n          placeholder=\"Search investments...\"\n          placeholderTextColor={colors.text.tertiary}\n          value={searchQuery}\n          onChangeText={setSearchQuery}\n        />\n        {searchQuery.length > 0 && (\n          <Pressable onPress={() => setSearchQuery('')}>\n            <Feather name=\"x\" size={20} color={colors.text.secondary} />\n          </Pressable>\n        )}\n        <Pressable style={styles.filterButton}>\n          <Feather name=\"sliders\" size={20} color={colors.primary.main} />\n        </Pressable>\n      </View>\n\n      {/* Category Chips */}\n      <FlatList\n        horizontal\n        data={CATEGORIES}\n        keyExtractor={(item) => item.id}\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.categoriesContainer}\n        renderItem={({ item }) => (\n          <Pressable\n            style={[\n              styles.categoryChip,\n              selectedCategory === item.id && styles.categoryChipActive,\n            ]}\n            onPress={() => setSelectedCategory(item.id)}\n          >\n            <Feather\n              name={item.icon}\n              size={16}\n              color={\n                selectedCategory === item.id\n                  ? colors.text.inverse\n                  : colors.text.secondary\n              }\n            />\n            <Text\n              style={[\n                styles.categoryChipText,\n                selectedCategory === item.id && styles.categoryChipTextActive,\n              ]}\n            >\n              {item.name}\n            </Text>\n          </Pressable>\n        )}\n      />\n    </View>\n  );\n\n  const renderInvestmentCard = ({\n    item,\n    index,\n  }: {\n    item: Investment;\n    index: number;\n  }) => {\n    const progress = (item.fundingCurrent / item.fundingGoal) * 100;\n\n    return (\n      <Animated.View\n        entering={FadeInDown.duration(400).delay(index * 100)}\n        layout={Layout.springify()}\n      >\n        <Pressable\n          style={styles.investmentCard}\n          onPress={() => handleInvestmentPress(item)}\n        >\n          <LinearGradient\n            colors={colors.gradient.colors as unknown as string[]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.cardGradient}\n          >\n            {/* Card Header */}\n            <View style={styles.cardHeader}>\n              <View style={styles.categoryBadge}>\n                <Text style={styles.categoryBadgeText}>{item.category}</Text>\n              </View>\n              <View\n                style={[\n                  styles.riskBadge,\n                  item.riskLevel === 'High' && styles.riskBadgeHigh,\n                  item.riskLevel === 'Low' && styles.riskBadgeLow,\n                ]}\n              >\n                <Text style={styles.riskBadgeText}>{item.riskLevel} Risk</Text>\n              </View>\n            </View>\n\n            {/* Card Content */}\n            <View style={styles.cardContent}>\n              <Text style={styles.investmentName}>{item.name}</Text>\n              <Text style={styles.investmentDescription} numberOfLines={2}>\n                {item.description}\n              </Text>\n            </View>\n\n            {/* Progress Bar */}\n            <View style={styles.progressContainer}>\n              <View style={styles.progressBar}>\n                <View\n                  style={[styles.progressFill, { width: `${progress}%` }]}\n                />\n              </View>\n              <View style={styles.progressLabels}>\n                <Text style={styles.progressText}>\n                  ${(item.fundingCurrent / 1000000).toFixed(1)}M raised\n                </Text>\n                <Text style={styles.progressText}>\n                  {progress.toFixed(0)}% funded\n                </Text>\n              </View>\n            </View>\n\n            {/* Card Footer */}\n            <View style={styles.cardFooter}>\n              <View style={styles.metric}>\n                <Feather\n                  name=\"trending-up\"\n                  size={14}\n                  color={colors.text.inverse}\n                />\n                <Text style={styles.metricText}>{item.expectedROI} ROI</Text>\n              </View>\n              <View style={styles.metric}>\n                <Feather name=\"clock\" size={14} color={colors.text.inverse} />\n                <Text style={styles.metricText}>\n                  {item.daysRemaining} days left\n                </Text>\n              </View>\n            </View>\n          </LinearGradient>\n        </Pressable>\n      </Animated.View>\n    );\n  };\n\n  const renderEmptyState = () => (\n    <Animated.View entering={FadeIn.duration(400)} style={styles.emptyState}>\n      <View style={styles.emptyIcon}>\n        <Feather name=\"search\" size={48} color={colors.text.tertiary} />\n      </View>\n      <Text style={styles.emptyTitle}>No investments found</Text>\n      <Text style={styles.emptyDescription}>\n        Try adjusting your search or filters to find investment opportunities.\n      </Text>\n    </Animated.View>\n  );\n\n  return (\n    <View style={styles.container}>\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Text style={styles.screenTitle}>Discover</Text>\n      </View>\n\n      {/* Content */}\n      <FlatList\n        data={filteredInvestments}\n        keyExtractor={(item) => item.id}\n        renderItem={renderInvestmentCard}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmptyState}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: layout.tabBarHeight + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={handleRefresh}\n            tintColor={colors.primary.main}\n          />\n        }\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  \n  // Header\n  header: {\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    backgroundColor: colors.background.primary,\n  },\n  screenTitle: {\n    ...typography.title,\n    color: colors.text.primary,\n  },\n\n  // Header Content (Search + Categories)\n  headerContent: {\n    paddingBottom: spacing.lg,\n  },\n\n  // Search\n  searchContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusLarge,\n    paddingHorizontal: spacing.md,\n    marginHorizontal: spacing.lg,\n    marginBottom: spacing.lg,\n    height: layout.inputHeight,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  searchIcon: {\n    marginRight: spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    ...typography.body,\n    color: colors.text.primary,\n  },\n  filterButton: {\n    marginLeft: spacing.sm,\n    padding: spacing.xs,\n  },\n\n  // Categories\n  categoriesContainer: {\n    paddingHorizontal: spacing.lg,\n    gap: spacing.sm,\n  },\n  categoryChip: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.sm,\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusFull,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  categoryChipActive: {\n    backgroundColor: colors.primary.main,\n    borderColor: colors.primary.main,\n  },\n  categoryChipText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  categoryChipTextActive: {\n    color: colors.text.inverse,\n  },\n\n  // List\n  listContent: {\n    paddingTop: spacing.md,\n  },\n\n  // Investment Card\n  investmentCard: {\n    marginHorizontal: spacing.lg,\n    marginBottom: spacing.lg,\n    borderRadius: layout.radiusLarge,\n    overflow: 'hidden',\n    ...shadows.elevated,\n  },\n  cardGradient: {\n    padding: spacing.lg,\n  },\n  cardHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: spacing.md,\n  },\n  categoryBadge: {\n    backgroundColor: colors.transparent.white20,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusSmall,\n  },\n  categoryBadgeText: {\n    ...typography.small,\n    color: colors.text.inverse,\n  },\n  riskBadge: {\n    backgroundColor: colors.transparent.white20,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusSmall,\n  },\n  riskBadgeHigh: {\n    backgroundColor: 'rgba(220, 38, 38, 0.3)',\n  },\n  riskBadgeLow: {\n    backgroundColor: 'rgba(0, 168, 107, 0.3)',\n  },\n  riskBadgeText: {\n    ...typography.small,\n    color: colors.text.inverse,\n  },\n  cardContent: {\n    marginBottom: spacing.lg,\n  },\n  investmentName: {\n    ...typography.heading,\n    color: colors.text.inverse,\n    marginBottom: spacing.xs,\n  },\n  investmentDescription: {\n    ...typography.caption,\n    color: colors.transparent.white50,\n    lineHeight: 20,\n  },\n\n  // Progress\n  progressContainer: {\n    marginBottom: spacing.md,\n  },\n  progressBar: {\n    height: layout.progressBarHeight,\n    backgroundColor: colors.transparent.white20,\n    borderRadius: layout.progressBarHeight / 2,\n    overflow: 'hidden',\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: colors.text.inverse,\n    borderRadius: layout.progressBarHeight / 2,\n  },\n  progressLabels: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginTop: spacing.xs,\n  },\n  progressText: {\n    ...typography.small,\n    color: colors.transparent.white50,\n  },\n\n  // Footer\n  cardFooter: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  metric: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n  },\n  metricText: {\n    ...typography.captionMedium,\n    color: colors.text.inverse,\n  },\n\n  // Empty State\n  emptyState: {\n    alignItems: 'center',\n    paddingVertical: spacing['3xl'],\n    paddingHorizontal: spacing.xl,\n  },\n  emptyIcon: {\n    marginBottom: spacing.lg,\n  },\n  emptyTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  emptyDescription: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":14403,"size_tokens":null},"client/api/index.ts":{"content":"export { apiClient, isApiError, type ApiError } from './client';\nexport * from './hooks';\n","path":null,"size_bytes":90,"size_tokens":null},"client/components/EmptyState.tsx":{"content":"import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Image,\n  type ImageSourcePropType,\n  type StyleProp,\n  type ViewStyle,\n} from 'react-native';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, { FadeIn } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport Button, { type ButtonProps } from './Button';\n\nexport interface EmptyStateProps {\n  /** Title text */\n  title: string;\n  /** Description text */\n  description?: string;\n  /** Image source */\n  image?: ImageSourcePropType;\n  /** Icon name (Feather) - used if no image */\n  icon?: keyof typeof Feather.glyphMap;\n  /** Icon size */\n  iconSize?: number;\n  /** Icon color */\n  iconColor?: string;\n  /** Primary action button */\n  primaryAction?: {\n    label: string;\n    onPress: () => void;\n  } & Partial<ButtonProps>;\n  /** Secondary action button */\n  secondaryAction?: {\n    label: string;\n    onPress: () => void;\n  } & Partial<ButtonProps>;\n  /** Animate on mount */\n  animated?: boolean;\n  /** Compact mode (smaller spacing) */\n  compact?: boolean;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function EmptyState({\n  title,\n  description,\n  image,\n  icon,\n  iconSize = 64,\n  iconColor,\n  primaryAction,\n  secondaryAction,\n  animated = true,\n  compact = false,\n  style,\n}: EmptyStateProps) {\n  const Container = animated ? Animated.View : View;\n  const animationProps = animated\n    ? { entering: FadeIn.duration(400) }\n    : {};\n\n  return (\n    <Container\n      style={[\n        styles.container,\n        compact && styles.containerCompact,\n        style,\n      ]}\n      {...animationProps}\n    >\n      {/* Image or Icon */}\n      {image ? (\n        <Image\n          source={image}\n          style={[\n            styles.image,\n            compact && styles.imageCompact,\n          ]}\n          resizeMode=\"contain\"\n        />\n      ) : icon ? (\n        <View\n          style={[\n            styles.iconContainer,\n            compact && styles.iconContainerCompact,\n          ]}\n        >\n          <Feather\n            name={icon}\n            size={iconSize}\n            color={iconColor || colors.text.tertiary}\n          />\n        </View>\n      ) : null}\n\n      {/* Text Content */}\n      <View style={styles.textContainer}>\n        <Text\n          style={[\n            styles.title,\n            compact && styles.titleCompact,\n          ]}\n        >\n          {title}\n        </Text>\n        \n        {description && (\n          <Text\n            style={[\n              styles.description,\n              compact && styles.descriptionCompact,\n            ]}\n          >\n            {description}\n          </Text>\n        )}\n      </View>\n\n      {/* Actions */}\n      {(primaryAction || secondaryAction) && (\n        <View\n          style={[\n            styles.actionsContainer,\n            compact && styles.actionsContainerCompact,\n          ]}\n        >\n          {primaryAction && (\n            <Button\n              variant=\"primary\"\n              size={compact ? 'sm' : 'md'}\n              {...primaryAction}\n              onPress={primaryAction.onPress}\n            >\n              {primaryAction.label}\n            </Button>\n          )}\n          \n          {secondaryAction && (\n            <Button\n              variant=\"ghost\"\n              size={compact ? 'sm' : 'md'}\n              {...secondaryAction}\n              onPress={secondaryAction.onPress}\n              style={primaryAction ? styles.secondaryButton : undefined}\n            >\n              {secondaryAction.label}\n            </Button>\n          )}\n        </View>\n      )}\n    </Container>\n  );\n}\n\n// Preset Empty States\nexport function EmptySearchState({\n  query,\n  onClear,\n  ...props\n}: Omit<EmptyStateProps, 'title' | 'description' | 'icon'> & {\n  query?: string;\n  onClear?: () => void;\n}) {\n  return (\n    <EmptyState\n      icon=\"search\"\n      title=\"No results found\"\n      description={\n        query\n          ? `We couldn't find anything matching \"${query}\". Try adjusting your search.`\n          : 'Try searching for something else.'\n      }\n      primaryAction={\n        onClear\n          ? { label: 'Clear search', onPress: onClear, variant: 'outline' }\n          : undefined\n      }\n      {...props}\n    />\n  );\n}\n\nexport function EmptyListState({\n  itemName = 'items',\n  onCreate,\n  ...props\n}: Omit<EmptyStateProps, 'title' | 'description' | 'icon'> & {\n  itemName?: string;\n  onCreate?: () => void;\n}) {\n  return (\n    <EmptyState\n      icon=\"inbox\"\n      title={`No ${itemName} yet`}\n      description={`When you have ${itemName}, they'll appear here.`}\n      primaryAction={\n        onCreate\n          ? { label: `Add ${itemName}`, onPress: onCreate }\n          : undefined\n      }\n      {...props}\n    />\n  );\n}\n\nexport function EmptyNetworkState({\n  onRetry,\n  ...props\n}: Omit<EmptyStateProps, 'title' | 'description' | 'icon'> & {\n  onRetry?: () => void;\n}) {\n  return (\n    <EmptyState\n      icon=\"wifi-off\"\n      title=\"No connection\"\n      description=\"Please check your internet connection and try again.\"\n      primaryAction={\n        onRetry\n          ? { label: 'Try again', onPress: onRetry }\n          : undefined\n      }\n      {...props}\n    />\n  );\n}\n\nexport function EmptyErrorState({\n  error,\n  onRetry,\n  ...props\n}: Omit<EmptyStateProps, 'title' | 'description' | 'icon'> & {\n  error?: string;\n  onRetry?: () => void;\n}) {\n  return (\n    <EmptyState\n      icon=\"alert-circle\"\n      iconColor={colors.semantic.error}\n      title=\"Something went wrong\"\n      description={error || \"We couldn't load this content. Please try again.\"}\n      primaryAction={\n        onRetry\n          ? { label: 'Try again', onPress: onRetry }\n          : undefined\n      }\n      {...props}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: spacing.xl,\n    paddingVertical: spacing['3xl'],\n  },\n  containerCompact: {\n    paddingVertical: spacing.xl,\n  },\n\n  // Image\n  image: {\n    width: 200,\n    height: 160,\n    marginBottom: spacing.xl,\n  },\n  imageCompact: {\n    width: 120,\n    height: 96,\n    marginBottom: spacing.lg,\n  },\n\n  // Icon\n  iconContainer: {\n    marginBottom: spacing.xl,\n    opacity: 0.8,\n  },\n  iconContainerCompact: {\n    marginBottom: spacing.lg,\n  },\n\n  // Text\n  textContainer: {\n    alignItems: 'center',\n  },\n  title: {\n    ...typography.heading,\n    color: colors.text.primary,\n    textAlign: 'center',\n    marginBottom: spacing.sm,\n  },\n  titleCompact: {\n    ...typography.bodyMedium,\n    marginBottom: spacing.xs,\n  },\n  description: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n    lineHeight: 24,\n    maxWidth: 280,\n  },\n  descriptionCompact: {\n    ...typography.caption,\n    lineHeight: 20,\n    maxWidth: 240,\n  },\n\n  // Actions\n  actionsContainer: {\n    marginTop: spacing.xl,\n    alignItems: 'center',\n    gap: spacing.sm,\n  },\n  actionsContainerCompact: {\n    marginTop: spacing.lg,\n  },\n  secondaryButton: {\n    marginTop: spacing.xs,\n  },\n});\n\nexport default EmptyState;\n","path":null,"size_bytes":7122,"size_tokens":null},"client/screens/RegisterScreen.tsx":{"content":"/**\n * Register Screen\n * New user registration with validation\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Picker } from '@react-native-picker/picker';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { isValidEmail, validatePassword } from '@/lib/utils';\n\nconst SPECIALTIES = [\n  'Select your specialty',\n  // Primary Care\n  'Family Medicine',\n  'Internal Medicine',\n  'Pediatrics',\n  'Emergency Medicine',\n  'Geriatric Medicine',\n  // Medical Specialties\n  'Allergy & Immunology',\n  'Cardiology',\n  'Dermatology',\n  'Endocrinology',\n  'Gastroenterology',\n  'Hematology',\n  'Infectious Disease',\n  'Nephrology',\n  'Neurology',\n  'Oncology',\n  'Pulmonology',\n  'Rheumatology',\n  // Surgical Specialties\n  'General Surgery',\n  'Cardiothoracic Surgery',\n  'Colorectal Surgery',\n  'Neurological Surgery',\n  'Obstetrics & Gynecology',\n  'Ophthalmology',\n  'Oral & Maxillofacial Surgery',\n  'Orthopedic Surgery',\n  'Otolaryngology (ENT)',\n  'Pediatric Surgery',\n  'Plastic Surgery',\n  'Transplant Surgery',\n  'Trauma Surgery',\n  'Urology',\n  'Vascular Surgery',\n  // Diagnostic Specialties\n  'Pathology',\n  'Radiology',\n  'Nuclear Medicine',\n  // Other Medical Specialties\n  'Anesthesiology',\n  'Critical Care Medicine',\n  'Hospice & Palliative Medicine',\n  'Pain Medicine',\n  'Physical Medicine & Rehabilitation',\n  'Preventive Medicine',\n  'Sleep Medicine',\n  'Sports Medicine',\n  // Psychiatry & Mental Health\n  'Psychiatry',\n  'Child & Adolescent Psychiatry',\n  'Addiction Medicine',\n  // Other Healthcare\n  'Neonatology',\n  'Genetics & Genomics',\n  'Medical Toxicology',\n  'Aerospace Medicine',\n  'Occupational Medicine',\n  // Non-Clinical Roles\n  'Investor',\n  'Venture Capital',\n  'Private Equity',\n  'Healthcare Executive',\n  'Hospital Administrator',\n  'Pharmaceutical Industry',\n  'Medical Device Industry',\n  'Biotechnology',\n  'Researcher',\n  'Academic Medicine',\n  'Public Health',\n  'Health Policy',\n  'Medical Student',\n  'Resident/Fellow',\n  'Nurse Practitioner',\n  'Physician Assistant',\n  'Other Healthcare Professional',\n  'Other',\n];\n\nexport default function RegisterScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { register, isLoading, error, clearError } = useAuth();\n\n  const [firstName, setFirstName] = useState('');\n  const [lastName, setLastName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [specialty, setSpecialty] = useState('');\n  const [referralCode, setReferralCode] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [showSpecialtyPicker, setShowSpecialtyPicker] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    clearError();\n\n    if (!firstName.trim()) {\n      newErrors.firstName = 'First name is required';\n    }\n\n    if (!lastName.trim()) {\n      newErrors.lastName = 'Last name is required';\n    }\n\n    if (!email) {\n      newErrors.email = 'Email is required';\n    } else if (!isValidEmail(email)) {\n      newErrors.email = 'Please enter a valid email';\n    }\n\n    const passwordValidation = validatePassword(password);\n    if (!passwordValidation.isValid) {\n      newErrors.password = passwordValidation.errors[0];\n    }\n\n    if (password !== confirmPassword) {\n      newErrors.confirmPassword = 'Passwords do not match';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleRegister = async () => {\n    if (!validateForm()) return;\n\n    const success = await register({\n      email,\n      password,\n      first_name: firstName.trim(),\n      last_name: lastName.trim(),\n      specialty: specialty && specialty !== 'Select your specialty' ? specialty : undefined,\n      referral_code: referralCode.trim() || undefined,\n    });\n\n    if (!success && error) {\n      Alert.alert('Registration Failed', error);\n    }\n  };\n\n  const handleLogin = () => {\n    navigation.navigate('Login');\n  };\n\n  const clearFieldError = (field: string) => {\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        <ScrollView\n          contentContainerStyle={styles.scrollContent}\n          keyboardShouldPersistTaps=\"handled\"\n          showsVerticalScrollIndicator={false}\n        >\n          {/* Header */}\n          <View style={styles.header}>\n            <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n              <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n            </TouchableOpacity>\n            <LinearGradient\n              colors={[Colors.primary, Colors.secondary]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.logoContainer}\n            >\n              <Ionicons name=\"medical\" size={32} color=\"white\" />\n            </LinearGradient>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Create Account</ThemedText>\n            <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n              Join the MedInvest community\n            </ThemedText>\n          </View>\n\n          {/* Form */}\n          <View style={styles.form}>\n            {/* Name Row */}\n            <View style={styles.nameRow}>\n              <View style={[styles.inputContainer, { flex: 1 }]}>\n                <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>First Name</ThemedText>\n                <View style={[styles.inputWrapper, { backgroundColor: appColors.background }, errors.firstName && { borderColor: appColors.error }]}>\n                  <TextInput\n                    style={[styles.input, { color: appColors.textPrimary }]}\n                    placeholder=\"First\"\n                    placeholderTextColor={appColors.textSecondary}\n                    value={firstName}\n                    onChangeText={(text) => {\n                      setFirstName(text);\n                      clearFieldError('firstName');\n                    }}\n                    autoCapitalize=\"words\"\n                  />\n                </View>\n                {errors.firstName && (\n                  <ThemedText style={[styles.errorText, { color: appColors.error }]}>{errors.firstName}</ThemedText>\n                )}\n              </View>\n\n              <View style={[styles.inputContainer, { flex: 1, marginLeft: Spacing.md }]}>\n                <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Last Name</ThemedText>\n                <View style={[styles.inputWrapper, { backgroundColor: appColors.background }, errors.lastName && { borderColor: appColors.error }]}>\n                  <TextInput\n                    style={[styles.input, { color: appColors.textPrimary }]}\n                    placeholder=\"Last\"\n                    placeholderTextColor={appColors.textSecondary}\n                    value={lastName}\n                    onChangeText={(text) => {\n                      setLastName(text);\n                      clearFieldError('lastName');\n                    }}\n                    autoCapitalize=\"words\"\n                  />\n                </View>\n                {errors.lastName && (\n                  <ThemedText style={[styles.errorText, { color: appColors.error }]}>{errors.lastName}</ThemedText>\n                )}\n              </View>\n            </View>\n\n            {/* Email */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Email</ThemedText>\n              <View style={[styles.inputWrapper, { backgroundColor: appColors.background }, errors.email && { borderColor: appColors.error }]}>\n                <Ionicons name=\"mail-outline\" size={20} color={appColors.textSecondary} />\n                <TextInput\n                  style={[styles.input, { color: appColors.textPrimary }]}\n                  placeholder=\"Enter your email\"\n                  placeholderTextColor={appColors.textSecondary}\n                  value={email}\n                  onChangeText={(text) => {\n                    setEmail(text);\n                    clearFieldError('email');\n                  }}\n                  keyboardType=\"email-address\"\n                  autoCapitalize=\"none\"\n                  autoComplete=\"email\"\n                />\n              </View>\n              {errors.email && (\n                <ThemedText style={[styles.errorText, { color: appColors.error }]}>{errors.email}</ThemedText>\n              )}\n            </View>\n\n            {/* Password */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Password</ThemedText>\n              <View style={[styles.inputWrapper, { backgroundColor: appColors.background }, errors.password && { borderColor: appColors.error }]}>\n                <Ionicons name=\"lock-closed-outline\" size={20} color={appColors.textSecondary} />\n                <TextInput\n                  style={[styles.input, { color: appColors.textPrimary }]}\n                  placeholder=\"Create a password\"\n                  placeholderTextColor={appColors.textSecondary}\n                  value={password}\n                  onChangeText={(text) => {\n                    setPassword(text);\n                    clearFieldError('password');\n                  }}\n                  secureTextEntry={!showPassword}\n                  autoCapitalize=\"none\"\n                />\n                <TouchableOpacity onPress={() => setShowPassword(!showPassword)}>\n                  <Ionicons\n                    name={showPassword ? 'eye-off-outline' : 'eye-outline'}\n                    size={20}\n                    color={appColors.textSecondary}\n                  />\n                </TouchableOpacity>\n              </View>\n              {errors.password && (\n                <ThemedText style={[styles.errorText, { color: appColors.error }]}>{errors.password}</ThemedText>\n              )}\n              <ThemedText style={[styles.passwordHint, { color: appColors.textSecondary }]}>\n                Min 8 chars, uppercase, lowercase, and number\n              </ThemedText>\n            </View>\n\n            {/* Confirm Password */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Confirm Password</ThemedText>\n              <View style={[styles.inputWrapper, { backgroundColor: appColors.background }, errors.confirmPassword && { borderColor: appColors.error }]}>\n                <Ionicons name=\"lock-closed-outline\" size={20} color={appColors.textSecondary} />\n                <TextInput\n                  style={[styles.input, { color: appColors.textPrimary }]}\n                  placeholder=\"Confirm your password\"\n                  placeholderTextColor={appColors.textSecondary}\n                  value={confirmPassword}\n                  onChangeText={(text) => {\n                    setConfirmPassword(text);\n                    clearFieldError('confirmPassword');\n                  }}\n                  secureTextEntry={!showConfirmPassword}\n                  autoCapitalize=\"none\"\n                />\n                <TouchableOpacity onPress={() => setShowConfirmPassword(!showConfirmPassword)}>\n                  <Ionicons\n                    name={showConfirmPassword ? 'eye-off-outline' : 'eye-outline'}\n                    size={20}\n                    color={appColors.textSecondary}\n                  />\n                </TouchableOpacity>\n              </View>\n              {errors.confirmPassword && (\n                <ThemedText style={[styles.errorText, { color: appColors.error }]}>{errors.confirmPassword}</ThemedText>\n              )}\n            </View>\n\n            {/* Specialty */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Specialty (Optional)</ThemedText>\n              <TouchableOpacity\n                style={[styles.inputWrapper, { backgroundColor: appColors.background }]}\n                onPress={() => setShowSpecialtyPicker(!showSpecialtyPicker)}\n              >\n                <Ionicons name=\"briefcase-outline\" size={20} color={appColors.textSecondary} />\n                <ThemedText style={[styles.pickerText, !specialty && { color: appColors.textSecondary }, specialty ? { color: appColors.textPrimary } : null]}>\n                  {specialty || 'Select your specialty'}\n                </ThemedText>\n                <Ionicons name=\"chevron-down\" size={20} color={appColors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n\n            {showSpecialtyPicker ? (\n              <View style={[styles.pickerContainer, { backgroundColor: appColors.background }]}>\n                <Picker\n                  selectedValue={specialty}\n                  onValueChange={(value) => {\n                    setSpecialty(value);\n                    setShowSpecialtyPicker(false);\n                  }}\n                >\n                  {SPECIALTIES.map((s) => (\n                    <Picker.Item key={s} label={s} value={s === 'Select your specialty' ? '' : s} />\n                  ))}\n                </Picker>\n              </View>\n            ) : null}\n\n            {/* Referral Code */}\n            <View style={styles.inputContainer}>\n              <ThemedText style={[styles.label, { color: appColors.textPrimary }]}>Referral Code (Optional)</ThemedText>\n              <View style={[styles.inputWrapper, { backgroundColor: appColors.background }]}>\n                <Ionicons name=\"gift-outline\" size={20} color={appColors.textSecondary} />\n                <TextInput\n                  style={[styles.input, { color: appColors.textPrimary }]}\n                  placeholder=\"Enter referral code\"\n                  placeholderTextColor={appColors.textSecondary}\n                  value={referralCode}\n                  onChangeText={setReferralCode}\n                  autoCapitalize=\"characters\"\n                />\n              </View>\n            </View>\n\n            {/* Register Button */}\n            <TouchableOpacity\n              style={[styles.registerButton, isLoading && styles.registerButtonDisabled]}\n              onPress={handleRegister}\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <ActivityIndicator color=\"white\" />\n              ) : (\n                <ThemedText style={styles.registerButtonText}>Create Account</ThemedText>\n              )}\n            </TouchableOpacity>\n\n            {/* Terms */}\n            <ThemedText style={[styles.terms, { color: appColors.textSecondary }]}>\n              By creating an account, you agree to our{' '}\n              <ThemedText style={styles.termsLink}>Terms of Service</ThemedText> and{' '}\n              <ThemedText style={styles.termsLink}>Privacy Policy</ThemedText>\n            </ThemedText>\n          </View>\n\n          {/* Login Link */}\n          <View style={styles.footer}>\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>Already have an account?</ThemedText>\n            <TouchableOpacity onPress={handleLogin}>\n              <ThemedText style={styles.loginText}> Sign In</ThemedText>\n            </TouchableOpacity>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    padding: Spacing.xl,\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  backButton: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    padding: Spacing.sm,\n  },\n  logoContainer: {\n    width: 64,\n    height: 64,\n    borderRadius: 16,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.lg,\n  },\n  title: {\n    ...Typography.title,\n    marginBottom: Spacing.xs,\n  },\n  subtitle: {\n    ...Typography.body,\n  },\n  form: {\n    flex: 1,\n  },\n  nameRow: {\n    flexDirection: 'row',\n  },\n  inputContainer: {\n    marginBottom: Spacing.md,\n  },\n  label: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.xs,\n  },\n  inputWrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    height: 48,\n    gap: Spacing.sm,\n    borderWidth: 1,\n    borderColor: 'transparent',\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    height: '100%',\n  },\n  pickerText: {\n    flex: 1,\n    ...Typography.body,\n  },\n  pickerContainer: {\n    borderRadius: BorderRadius.md,\n    marginTop: -Spacing.sm,\n    marginBottom: Spacing.md,\n  },\n  errorText: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  passwordHint: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  registerButton: {\n    backgroundColor: Colors.primary,\n    borderRadius: BorderRadius.md,\n    paddingVertical: Spacing.lg,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginTop: Spacing.md,\n    ...Shadows.button,\n  },\n  registerButtonDisabled: {\n    opacity: 0.7,\n  },\n  registerButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  terms: {\n    ...Typography.small,\n    textAlign: 'center',\n    marginTop: Spacing.lg,\n    lineHeight: 20,\n  },\n  termsLink: {\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n  footer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: Spacing.xl,\n    paddingBottom: Spacing.xl,\n  },\n  footerText: {\n    ...Typography.body,\n  },\n  loginText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":18873,"size_tokens":null},"server/routes/portfolio.ts":{"content":"import { Router, Request, Response } from 'express';\nimport {\n  db,\n  portfolioInvestments,\n  investments,\n  transactions,\n  paymentMethods,\n} from '../db';\nimport { eq, and, desc, sql } from 'drizzle-orm';\nimport { authMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\n// All portfolio routes require authentication\nrouter.use(authMiddleware);\n\n/**\n * GET /api/portfolio/summary\n * Get portfolio summary with totals\n */\nrouter.get('/summary', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n\n    // Get all user's portfolio investments\n    const userInvestments = await db\n      .select({\n        amountInvested: portfolioInvestments.amountInvested,\n        currentValue: portfolioInvestments.currentValue,\n        status: portfolioInvestments.status,\n      })\n      .from(portfolioInvestments)\n      .where(eq(portfolioInvestments.userId, userId));\n\n    // Calculate totals\n    let totalInvested = 0;\n    let totalValue = 0;\n    let activeCount = 0;\n    let completedCount = 0;\n    let pendingCount = 0;\n\n    for (const inv of userInvestments) {\n      const invested = parseFloat(inv.amountInvested);\n      const current = parseFloat(inv.currentValue);\n      \n      totalInvested += invested;\n      totalValue += current;\n\n      switch (inv.status) {\n        case 'active':\n          activeCount++;\n          break;\n        case 'completed':\n          completedCount++;\n          break;\n        case 'pending':\n          pendingCount++;\n          break;\n      }\n    }\n\n    const totalGainLoss = totalValue - totalInvested;\n    const gainLossPercent = totalInvested > 0\n      ? (totalGainLoss / totalInvested) * 100\n      : 0;\n\n    res.json({\n      totalValue,\n      totalInvested,\n      totalGainLoss,\n      gainLossPercent: Math.round(gainLossPercent * 100) / 100,\n      activeInvestments: activeCount,\n      completedInvestments: completedCount,\n      pendingInvestments: pendingCount,\n    });\n  } catch (error) {\n    console.error('Get portfolio summary error:', error);\n    res.status(500).json({ message: 'Failed to fetch portfolio summary' });\n  }\n});\n\n/**\n * GET /api/portfolio/investments\n * Get user's investments with pagination\n */\nrouter.get('/investments', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n    const { page = '1', limit = '20', status } = req.query;\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Build conditions\n    const conditions = [eq(portfolioInvestments.userId, userId)];\n    \n    if (status) {\n      conditions.push(eq(portfolioInvestments.status, status as any));\n    }\n\n    const whereClause = and(...conditions);\n\n    // Fetch investments with investment details\n    const [userInvestments, [countResult]] = await Promise.all([\n      db\n        .select({\n          id: portfolioInvestments.id,\n          investmentId: portfolioInvestments.investmentId,\n          amountInvested: portfolioInvestments.amountInvested,\n          currentValue: portfolioInvestments.currentValue,\n          status: portfolioInvestments.status,\n          investedAt: portfolioInvestments.investedAt,\n          name: investments.name,\n          category: investments.category,\n          imageUrl: investments.imageUrl,\n        })\n        .from(portfolioInvestments)\n        .innerJoin(investments, eq(portfolioInvestments.investmentId, investments.id))\n        .where(whereClause)\n        .orderBy(desc(portfolioInvestments.investedAt))\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(portfolioInvestments)\n        .where(whereClause),\n    ]);\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    // Format response\n    const data = userInvestments.map((inv) => {\n      const amountInvested = parseFloat(inv.amountInvested);\n      const currentValue = parseFloat(inv.currentValue);\n      const gainLossPercent = amountInvested > 0\n        ? ((currentValue - amountInvested) / amountInvested) * 100\n        : 0;\n\n      return {\n        id: inv.id,\n        investmentId: inv.investmentId,\n        name: inv.name,\n        category: inv.category,\n        imageUrl: inv.imageUrl,\n        amountInvested,\n        currentValue,\n        gainLossPercent: Math.round(gainLossPercent * 100) / 100,\n        status: inv.status,\n        investedAt: inv.investedAt,\n      };\n    });\n\n    res.json({\n      data,\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('Get portfolio investments error:', error);\n    res.status(500).json({ message: 'Failed to fetch portfolio investments' });\n  }\n});\n\n/**\n * POST /api/portfolio/invest\n * Create new investment\n */\nrouter.post('/invest', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n    const { investmentId, amount, paymentMethodId } = req.body;\n\n    // Validate input\n    if (!investmentId || !amount || !paymentMethodId) {\n      res.status(400).json({ \n        message: 'Investment ID, amount, and payment method are required' \n      });\n      return;\n    }\n\n    const investmentAmount = parseFloat(amount);\n    \n    if (isNaN(investmentAmount) || investmentAmount <= 0) {\n      res.status(400).json({ message: 'Invalid investment amount' });\n      return;\n    }\n\n    // Check investment exists and is active\n    const [investment] = await db\n      .select()\n      .from(investments)\n      .where(eq(investments.id, investmentId))\n      .limit(1);\n\n    if (!investment) {\n      res.status(404).json({ message: 'Investment not found' });\n      return;\n    }\n\n    if (investment.status !== 'active') {\n      res.status(400).json({ message: 'Investment is not currently accepting funds' });\n      return;\n    }\n\n    // Check minimum investment\n    const minimumInvestment = parseFloat(investment.minimumInvestment);\n    if (investmentAmount < minimumInvestment) {\n      res.status(400).json({ \n        message: `Minimum investment is $${minimumInvestment.toLocaleString()}` \n      });\n      return;\n    }\n\n    // Check payment method belongs to user\n    const [paymentMethod] = await db\n      .select()\n      .from(paymentMethods)\n      .where(\n        and(\n          eq(paymentMethods.id, paymentMethodId),\n          eq(paymentMethods.userId, userId)\n        )\n      )\n      .limit(1);\n\n    if (!paymentMethod) {\n      res.status(404).json({ message: 'Payment method not found' });\n      return;\n    }\n\n    // Check if user already has an investment in this opportunity\n    const [existingInvestment] = await db\n      .select()\n      .from(portfolioInvestments)\n      .where(\n        and(\n          eq(portfolioInvestments.userId, userId),\n          eq(portfolioInvestments.investmentId, investmentId)\n        )\n      )\n      .limit(1);\n\n    let portfolioInvestment;\n\n    if (existingInvestment) {\n      // Update existing investment\n      const newAmount = parseFloat(existingInvestment.amountInvested) + investmentAmount;\n      \n      [portfolioInvestment] = await db\n        .update(portfolioInvestments)\n        .set({\n          amountInvested: newAmount.toString(),\n          currentValue: newAmount.toString(), // Initially same as invested\n          updatedAt: new Date(),\n        })\n        .where(eq(portfolioInvestments.id, existingInvestment.id))\n        .returning();\n    } else {\n      // Create new portfolio investment\n      [portfolioInvestment] = await db\n        .insert(portfolioInvestments)\n        .values({\n          userId,\n          investmentId,\n          amountInvested: investmentAmount.toString(),\n          currentValue: investmentAmount.toString(),\n          status: 'pending',\n        })\n        .returning();\n    }\n\n    // Create transaction record\n    const [transaction] = await db\n      .insert(transactions)\n      .values({\n        userId,\n        portfolioInvestmentId: portfolioInvestment.id,\n        type: 'investment',\n        amount: investmentAmount.toString(),\n        status: 'pending',\n        paymentMethodId,\n      })\n      .returning();\n\n    // Update investment funding and investor count\n    await db\n      .update(investments)\n      .set({\n        fundingCurrent: sql`${investments.fundingCurrent} + ${investmentAmount}`,\n        investorCount: existingInvestment \n          ? investments.investorCount \n          : sql`${investments.investorCount} + 1`,\n        updatedAt: new Date(),\n      })\n      .where(eq(investments.id, investmentId));\n\n    res.status(201).json({\n      message: 'Investment submitted successfully',\n      portfolioInvestment: {\n        id: portfolioInvestment.id,\n        investmentId: portfolioInvestment.investmentId,\n        amountInvested: parseFloat(portfolioInvestment.amountInvested),\n        status: portfolioInvestment.status,\n      },\n      transaction: {\n        id: transaction.id,\n        amount: parseFloat(transaction.amount),\n        status: transaction.status,\n      },\n    });\n  } catch (error) {\n    console.error('Create investment error:', error);\n    res.status(500).json({ message: 'Failed to process investment' });\n  }\n});\n\n/**\n * GET /api/portfolio/transactions\n * Get user's transaction history\n */\nrouter.get('/transactions', async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n    const { page = '1', limit = '20', type } = req.query;\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Build conditions\n    const conditions = [eq(transactions.userId, userId)];\n    \n    if (type) {\n      conditions.push(eq(transactions.type, type as any));\n    }\n\n    const whereClause = and(...conditions);\n\n    // Fetch transactions with investment details\n    const [userTransactions, [countResult]] = await Promise.all([\n      db\n        .select({\n          id: transactions.id,\n          type: transactions.type,\n          amount: transactions.amount,\n          status: transactions.status,\n          createdAt: transactions.createdAt,\n          completedAt: transactions.completedAt,\n          investmentName: investments.name,\n        })\n        .from(transactions)\n        .leftJoin(\n          portfolioInvestments,\n          eq(transactions.portfolioInvestmentId, portfolioInvestments.id)\n        )\n        .leftJoin(investments, eq(portfolioInvestments.investmentId, investments.id))\n        .where(whereClause)\n        .orderBy(desc(transactions.createdAt))\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(transactions)\n        .where(whereClause),\n    ]);\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    res.json({\n      data: userTransactions.map((t) => ({\n        id: t.id,\n        type: t.type,\n        amount: parseFloat(t.amount),\n        status: t.status,\n        investmentName: t.investmentName,\n        createdAt: t.createdAt,\n        completedAt: t.completedAt,\n      })),\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('Get transactions error:', error);\n    res.status(500).json({ message: 'Failed to fetch transactions' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":11554,"size_tokens":null},"replit.md":{"content":"# MedInvest Mobile App\n\n## Overview\n\nMedInvest is a React Native/Expo mobile application that enables users to invest in medical innovations, research, and healthcare ventures. The app bridges healthcare advancement with financial opportunity, featuring a professional yet approachable design with medical blue and investment green accent colors.\n\nThe application follows a full-stack architecture with an Expo-based mobile frontend (supporting iOS, Android, and web) and an Express.js backend server. Data persistence uses PostgreSQL with Drizzle ORM.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React Native with Expo SDK 54, using the new architecture and React 19.\n\n**Navigation Structure**: \n- Root stack navigator handles authentication flow (Login vs Main)\n- Bottom tab navigator with 4 tabs: Discover, Portfolio, Research, Profile\n- Each tab has its own native stack navigator for nested screens\n- Floating action button for primary \"Invest\" action opens as modal\n\n**State Management**:\n- TanStack React Query for server state and API caching\n- React Context for authentication state (AuthContext)\n- AsyncStorage for local persistence (user data, investments, bookmarks)\n\n**UI/Styling Approach**:\n- Custom theme system with light/dark mode support via `useTheme` hook\n- Centralized design tokens in `client/constants/theme.ts` (Colors, Spacing, BorderRadius, Typography)\n- Reanimated for animations with spring physics\n- Linear gradients for accent cards (medical blue to investment green)\n- Platform-specific adjustments for iOS, Android, and web\n\n**Key Directories**:\n- `client/screens/` - Screen components\n- `client/navigation/` - Navigation configuration\n- `client/components/` - Reusable UI components\n- `client/contexts/` - React context providers\n- `client/hooks/` - Custom hooks\n- `client/lib/` - Utilities, API client, mock data\n\n### Backend Architecture\n\n**Framework**: Express.js with TypeScript running via tsx.\n\n**API Design**: RESTful endpoints prefixed with `/api` (routes defined in `server/routes.ts`).\n\n**Storage Layer**: Abstract `IStorage` interface in `server/storage.ts` with in-memory implementation (`MemStorage`). Designed for easy swap to database-backed storage.\n\n**Database Schema**: Drizzle ORM with PostgreSQL dialect. Schema defined in `shared/schema.ts` using drizzle-zod for validation. Currently contains a `users` table with id, username, and password fields.\n\n**CORS Configuration**: Dynamic origin allowlist based on Replit domains plus localhost for development.\n\n### Project Structure\n\n```\nclient/           # React Native/Expo frontend\nserver/           # Express.js backend\nshared/           # Shared types and schema (Drizzle ORM)\npackages/shared/  # @medinvest/shared - Shared types, validators, utils for web & mobile sync\nmigrations/       # Database migrations (generated by drizzle-kit)\nassets/           # Static assets (images, fonts)\nscripts/          # Build and deployment scripts\ndocs/             # Documentation (API guide, sync architecture, testing checklist)\n```\n\n### Path Aliases\n\n- `@/` maps to `./client/`\n- `@shared/` maps to `./shared/`\n- `@medinvest/shared` maps to `./packages/shared/src/`\n\n### Web & Mobile Sync Architecture\n\nThe `packages/shared` directory contains code shared between web and mobile apps:\n- **types/** - TypeScript interfaces for User, Post, Message, Deal, etc.\n- **validators/** - Zod schemas for form and API validation\n- **utils/** - Common utilities (date formatting, number formatting, text parsing)\n- **api/** - Shared API client class with platform-specific configuration\n- **constants/** - Shared constants (limits, timeouts, error codes, storage keys)\n\nUsage:\n```typescript\nimport { User, Post, loginSchema, formatRelativeTime } from '@medinvest/shared';\n```\n\n## External Dependencies\n\n### Database\n- **PostgreSQL** with Drizzle ORM for schema definition and migrations\n- Database URL configured via `DATABASE_URL` environment variable\n- Migrations managed with `drizzle-kit push`\n\n### Authentication\n- **Email/Password Registration**: POST /api/auth/register endpoint for traditional signup\n- **Apple Sign-In**: Native iOS integration via expo-apple-authentication\n- **Google Sign-In**: OAuth 2.0 via expo-auth-session\n- **GitHub Sign-In**: OAuth 2.0 via expo-auth-session with backend token exchange\n\n**Google Sign-In Production Setup** (required for production):\n1. Go to [Google Cloud Console](https://console.cloud.google.com/apis/credentials)\n2. Create OAuth 2.0 Client IDs for each platform:\n   - **Web**: Set authorized redirect URI to `https://{your-production-domain}/`\n   - **iOS**: Set bundle ID to `com.medinvest.app`\n   - **Android**: Set package name to `com.medinvest.app` and provide SHA-1 fingerprint\n   - **Expo Go**: Set redirect URI to `https://auth.expo.io/@{expo-username}/medinvest`\n3. Set environment variables:\n   - `EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID` - Web OAuth client ID\n   - `EXPO_PUBLIC_GOOGLE_IOS_CLIENT_ID` - iOS OAuth client ID  \n   - `EXPO_PUBLIC_GOOGLE_ANDROID_CLIENT_ID` - Android OAuth client ID\n   - `EXPO_PUBLIC_GOOGLE_EXPO_CLIENT_ID` - Expo Go OAuth client ID\n\n**GitHub Sign-In Production Setup** (requires separate apps for web and mobile):\n\n**Web OAuth App:**\n1. Go to [GitHub Developer Settings](https://github.com/settings/developers)\n2. Create OAuth App for web with callback URL: `https://{your-production-domain}`\n3. Set environment variables:\n   - `EXPO_PUBLIC_GITHUB_CLIENT_ID` - Web GitHub client ID\n   - `GITHUB_CLIENT_ID` - Same as above (for backend)\n   - `GITHUB_CLIENT_SECRET` - Web GitHub client secret\n\n**Mobile OAuth App:**\n1. Create a second OAuth App for mobile with callback URL: `medinvest://`\n2. Set environment variables:\n   - `EXPO_PUBLIC_GITHUB_MOBILE_CLIENT_ID` - Mobile GitHub client ID\n   - `GITHUB_MOBILE_CLIENT_ID` - Same as above (for backend)\n   - `GITHUB_MOBILE_CLIENT_SECRET` - Mobile GitHub client secret\n\n**Apple Sign-In Production Setup** (required for iOS):\n1. Enable \"Sign In with Apple\" capability in Apple Developer Portal\n2. Configure the app identifier with Sign In with Apple\n3. The bundle identifier `com.medinvest.app` must match your Apple Developer account\n\n### Third-Party Services\n- **Expo** ecosystem: splash-screen, haptics, linear-gradient, blur, image, web-browser\n- **React Navigation** for routing (bottom-tabs, native-stack)\n- **TanStack React Query** for data fetching and caching\n- **React Native Reanimated** for animations\n- **React Native Keyboard Controller** for keyboard handling\n\n### Environment Variables\n- `DATABASE_URL` - PostgreSQL connection string\n- `EXPO_PUBLIC_DOMAIN` - API server domain for client requests\n- `REPLIT_DEV_DOMAIN` - Development domain (Replit-specific)\n- `REPLIT_DOMAINS` - Production domains (Replit-specific)","path":null,"size_bytes":6848,"size_tokens":null},"client/components/Toast.tsx":{"content":"import React, {\n  createContext,\n  useContext,\n  useState,\n  useCallback,\n  useRef,\n  useEffect,\n} from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Pressable,\n  Dimensions,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  withTiming,\n  runOnJS,\n  SlideInUp,\n  SlideOutUp,\n  FadeIn,\n  FadeOut,\n  Layout,\n} from 'react-native-reanimated';\nimport { Gesture, GestureDetector } from 'react-native-gesture-handler';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\n\nexport type ToastType = 'success' | 'error' | 'warning' | 'info';\nexport type ToastPosition = 'top' | 'bottom';\n\nexport interface ToastConfig {\n  /** Toast message */\n  message: string;\n  /** Toast type */\n  type?: ToastType;\n  /** Title (optional) */\n  title?: string;\n  /** Duration in ms (0 for persistent) */\n  duration?: number;\n  /** Position on screen */\n  position?: ToastPosition;\n  /** Action button */\n  action?: {\n    label: string;\n    onPress: () => void;\n  };\n  /** Called when toast is dismissed */\n  onDismiss?: () => void;\n}\n\ninterface ToastState extends ToastConfig {\n  id: string;\n}\n\ninterface ToastContextValue {\n  show: (config: ToastConfig) => string;\n  hide: (id: string) => void;\n  hideAll: () => void;\n  success: (message: string, options?: Partial<ToastConfig>) => string;\n  error: (message: string, options?: Partial<ToastConfig>) => string;\n  warning: (message: string, options?: Partial<ToastConfig>) => string;\n  info: (message: string, options?: Partial<ToastConfig>) => string;\n}\n\nconst ToastContext = createContext<ToastContextValue | null>(null);\n\nconst TOAST_CONFIG: Record<\n  ToastType,\n  { icon: keyof typeof Feather.glyphMap; backgroundColor: string; iconColor: string }\n> = {\n  success: {\n    icon: 'check-circle',\n    backgroundColor: colors.semantic.success,\n    iconColor: colors.text.inverse,\n  },\n  error: {\n    icon: 'x-circle',\n    backgroundColor: colors.semantic.error,\n    iconColor: colors.text.inverse,\n  },\n  warning: {\n    icon: 'alert-triangle',\n    backgroundColor: colors.semantic.warning,\n    iconColor: '#000000',\n  },\n  info: {\n    icon: 'info',\n    backgroundColor: '#3B82F6',\n    iconColor: colors.text.inverse,\n  },\n};\n\nconst DEFAULT_DURATION = 4000;\n\n// Individual Toast Component\ninterface ToastItemProps extends ToastState {\n  onDismiss: (id: string) => void;\n  position: ToastPosition;\n}\n\nfunction ToastItem({\n  id,\n  message,\n  type = 'info',\n  title,\n  duration = DEFAULT_DURATION,\n  action,\n  onDismiss,\n  position,\n}: ToastItemProps) {\n  const translateX = useSharedValue(0);\n  const config = TOAST_CONFIG[type];\n  const timeoutRef = useRef<NodeJS.Timeout>();\n\n  // Auto-dismiss timer\n  useEffect(() => {\n    if (duration > 0) {\n      timeoutRef.current = setTimeout(() => {\n        onDismiss(id);\n      }, duration);\n    }\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, [id, duration, onDismiss]);\n\n  // Swipe to dismiss gesture\n  const panGesture = Gesture.Pan()\n    .onUpdate((event) => {\n      translateX.value = event.translationX;\n    })\n    .onEnd((event) => {\n      if (Math.abs(event.translationX) > SCREEN_WIDTH * 0.3) {\n        translateX.value = withTiming(\n          event.translationX > 0 ? SCREEN_WIDTH : -SCREEN_WIDTH,\n          { duration: 200 },\n          () => {\n            runOnJS(onDismiss)(id);\n          }\n        );\n      } else {\n        translateX.value = withSpring(0, { damping: 15 });\n      }\n    });\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ translateX: translateX.value }],\n    opacity: 1 - Math.abs(translateX.value) / SCREEN_WIDTH,\n  }));\n\n  return (\n    <GestureDetector gesture={panGesture}>\n      <Animated.View\n        entering={position === 'top' ? SlideInUp.springify() : FadeIn}\n        exiting={position === 'top' ? SlideOutUp : FadeOut}\n        layout={Layout.springify()}\n        style={[\n          styles.toast,\n          { backgroundColor: config.backgroundColor },\n          animatedStyle,\n        ]}\n      >\n        {/* Icon */}\n        <View style={styles.iconContainer}>\n          <Feather name={config.icon} size={20} color={config.iconColor} />\n        </View>\n\n        {/* Content */}\n        <View style={styles.content}>\n          {title && (\n            <Text\n              style={[styles.title, { color: config.iconColor }]}\n              numberOfLines={1}\n            >\n              {title}\n            </Text>\n          )}\n          <Text\n            style={[styles.message, { color: config.iconColor }]}\n            numberOfLines={2}\n          >\n            {message}\n          </Text>\n        </View>\n\n        {/* Action or Close Button */}\n        {action ? (\n          <Pressable\n            style={styles.actionButton}\n            onPress={() => {\n              action.onPress();\n              onDismiss(id);\n            }}\n          >\n            <Text style={[styles.actionText, { color: config.iconColor }]}>\n              {action.label}\n            </Text>\n          </Pressable>\n        ) : (\n          <Pressable\n            style={styles.closeButton}\n            onPress={() => onDismiss(id)}\n            hitSlop={8}\n          >\n            <Feather name=\"x\" size={18} color={config.iconColor} />\n          </Pressable>\n        )}\n      </Animated.View>\n    </GestureDetector>\n  );\n}\n\n// Toast Provider Component\nexport function ToastProvider({ children }: { children: React.ReactNode }) {\n  const insets = useSafeAreaInsets();\n  const [toasts, setToasts] = useState<ToastState[]>([]);\n  const toastIdRef = useRef(0);\n\n  const show = useCallback((config: ToastConfig): string => {\n    const id = `toast-${++toastIdRef.current}`;\n    const toast: ToastState = {\n      id,\n      type: 'info',\n      duration: DEFAULT_DURATION,\n      position: 'top',\n      ...config,\n    };\n\n    setToasts((prev) => [...prev, toast]);\n    return id;\n  }, []);\n\n  const hide = useCallback((id: string) => {\n    setToasts((prev) => {\n      const toast = prev.find((t) => t.id === id);\n      if (toast?.onDismiss) {\n        toast.onDismiss();\n      }\n      return prev.filter((t) => t.id !== id);\n    });\n  }, []);\n\n  const hideAll = useCallback(() => {\n    setToasts((prev) => {\n      prev.forEach((toast) => toast.onDismiss?.());\n      return [];\n    });\n  }, []);\n\n  const success = useCallback(\n    (message: string, options?: Partial<ToastConfig>) =>\n      show({ message, type: 'success', ...options }),\n    [show]\n  );\n\n  const error = useCallback(\n    (message: string, options?: Partial<ToastConfig>) =>\n      show({ message, type: 'error', ...options }),\n    [show]\n  );\n\n  const warning = useCallback(\n    (message: string, options?: Partial<ToastConfig>) =>\n      show({ message, type: 'warning', ...options }),\n    [show]\n  );\n\n  const info = useCallback(\n    (message: string, options?: Partial<ToastConfig>) =>\n      show({ message, type: 'info', ...options }),\n    [show]\n  );\n\n  const contextValue: ToastContextValue = {\n    show,\n    hide,\n    hideAll,\n    success,\n    error,\n    warning,\n    info,\n  };\n\n  // Separate toasts by position\n  const topToasts = toasts.filter((t) => t.position === 'top');\n  const bottomToasts = toasts.filter((t) => t.position === 'bottom');\n\n  return (\n    <ToastContext.Provider value={contextValue}>\n      {children}\n\n      {/* Top Toasts */}\n      <View\n        style={[\n          styles.container,\n          styles.topContainer,\n          { top: insets.top + spacing.sm },\n        ]}\n        pointerEvents=\"box-none\"\n      >\n        {topToasts.map((toast) => (\n          <ToastItem\n            key={toast.id}\n            {...toast}\n            position=\"top\"\n            onDismiss={hide}\n          />\n        ))}\n      </View>\n\n      {/* Bottom Toasts */}\n      <View\n        style={[\n          styles.container,\n          styles.bottomContainer,\n          { bottom: insets.bottom + spacing.lg },\n        ]}\n        pointerEvents=\"box-none\"\n      >\n        {bottomToasts.map((toast) => (\n          <ToastItem\n            key={toast.id}\n            {...toast}\n            position=\"bottom\"\n            onDismiss={hide}\n          />\n        ))}\n      </View>\n    </ToastContext.Provider>\n  );\n}\n\n// Hook to use toast\nexport function useToast(): ToastContextValue {\n  const context = useContext(ToastContext);\n\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n\n  return context;\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    position: 'absolute',\n    left: spacing.md,\n    right: spacing.md,\n    zIndex: 9999,\n  },\n  topContainer: {\n    alignItems: 'center',\n  },\n  bottomContainer: {\n    alignItems: 'center',\n  },\n  toast: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n    maxWidth: 400,\n    paddingVertical: spacing.md,\n    paddingHorizontal: spacing.md,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    ...shadows.elevated,\n  },\n  iconContainer: {\n    marginRight: spacing.sm,\n  },\n  content: {\n    flex: 1,\n    marginRight: spacing.sm,\n  },\n  title: {\n    ...typography.captionMedium,\n    marginBottom: spacing.xs / 2,\n  },\n  message: {\n    ...typography.caption,\n    lineHeight: 18,\n  },\n  actionButton: {\n    paddingVertical: spacing.xs,\n    paddingHorizontal: spacing.sm,\n  },\n  actionText: {\n    ...typography.captionMedium,\n    textDecorationLine: 'underline',\n  },\n  closeButton: {\n    padding: spacing.xs,\n  },\n});\n\nexport default ToastProvider;\n","path":null,"size_bytes":9638,"size_tokens":null},"metro.config.js":{"content":"const { getDefaultConfig } = require('expo/metro-config');\nconst http = require('http');\n\nconst config = getDefaultConfig(__dirname);\n\nconfig.server = {\n  ...config.server,\n  enhanceMiddleware: (middleware) => {\n    return (req, res, next) => {\n      if (req.url.startsWith('/api/')) {\n        const options = {\n          hostname: 'localhost',\n          port: 5000,\n          path: req.url,\n          method: req.method,\n          headers: {\n            ...req.headers,\n            host: 'localhost:5000',\n          },\n        };\n\n        const proxyReq = http.request(options, (proxyRes) => {\n          res.writeHead(proxyRes.statusCode, proxyRes.headers);\n          proxyRes.pipe(res);\n        });\n\n        proxyReq.on('error', (err) => {\n          console.error('[Metro Proxy] Error:', err.message);\n          res.writeHead(502, { 'Content-Type': 'application/json' });\n          res.end(JSON.stringify({ message: 'Backend unavailable' }));\n        });\n\n        req.pipe(proxyReq);\n        return;\n      }\n      middleware(req, res, next);\n    };\n  },\n};\n\nmodule.exports = config;\n","path":null,"size_bytes":1085,"size_tokens":null},"client/screens/HomeScreen.tsx":{"content":"/**\n * Home Feed Screen\n * Main social feed with posts, trending topics, and room filters\n */\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  RefreshControl,\n  TouchableOpacity,\n  ActivityIndicator,\n  Animated,\n  Dimensions,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useInfiniteQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { ThemedView } from '@/components/ThemedView';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { feedApi, postsApi, roomsApi, notificationsApi } from '@/lib/api';\nimport { Post, Room, FeedStyle, TrendingTopic } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\nimport PostCard from '@/components/PostCard';\nimport TrendingSidebar from '@/components/TrendingSidebar';\nimport RoomFilter from '@/components/RoomFilter';\nimport { NotificationBell } from '@/components/NotificationsDropdown';\nimport NotificationsDropdown from '@/components/NotificationsDropdown';\nimport HeaderMenu, { MenuButton } from '@/components/HeaderMenu';\nimport PeopleYouMayKnow from '@/components/PeopleYouMayKnow';\n\nconst { width } = Dimensions.get('window');\n\nexport default function HomeScreen() {\n  const navigation = useNavigation<any>();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  const scrollY = useRef(new Animated.Value(0)).current;\n  const appColors = useAppColors();\n\n  const [feedStyle, setFeedStyle] = useState<FeedStyle>('algorithmic');\n  const [selectedRoom, setSelectedRoom] = useState<string | null>(null);\n  const [showTrending, setShowTrending] = useState(false);\n  const [showNotifications, setShowNotifications] = useState(false);\n  const [showMenu, setShowMenu] = useState(false);\n\n  // Fetch unread count\n  const { data: notificationData } = useQuery({\n    queryKey: ['notifications', 'unread'],\n    queryFn: async () => {\n      const response = await notificationsApi.getNotifications(1);\n      return { unread_count: response.data?.unread_count || 0 };\n    },\n    refetchInterval: 30000,\n  });\n\n  // Fetch rooms\n  const { data: roomsData } = useQuery({\n    queryKey: ['rooms'],\n    queryFn: async () => {\n      const response = await roomsApi.getRooms();\n      return response.data?.rooms || [];\n    },\n  });\n\n  // Fetch trending topics\n  const { data: trendingData } = useQuery({\n    queryKey: ['trending'],\n    queryFn: async () => {\n      const response = await feedApi.getTrending();\n      return response.data?.topics || [];\n    },\n    refetchInterval: 60000,\n  });\n\n  // Infinite scroll feed\n  const {\n    data: feedData,\n    fetchNextPage,\n    hasNextPage,\n    isFetchingNextPage,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useInfiniteQuery({\n    queryKey: ['feed', feedStyle, selectedRoom],\n    queryFn: async ({ pageParam }) => {\n      if (selectedRoom) {\n        const response = await feedApi.getRoomFeed(selectedRoom, pageParam);\n        return response.data;\n      }\n      const response = await feedApi.getFeed(pageParam, feedStyle);\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => lastPage?.next_cursor,\n    initialPageParam: undefined as string | undefined,\n  });\n\n  const posts = feedData?.pages.flatMap(page => page?.posts || []) || [];\n\n  // Vote mutation\n  const voteMutation = useMutation({\n    mutationFn: async ({ postId, direction }: { postId: number; direction: 'up' | 'down' }) => {\n      return postsApi.vote(postId, direction);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['feed'] });\n    },\n  });\n\n  // Bookmark mutation\n  const bookmarkMutation = useMutation({\n    mutationFn: async ({ postId, isBookmarked }: { postId: number; isBookmarked: boolean }) => {\n      if (isBookmarked) {\n        return postsApi.removeBookmark(postId);\n      }\n      return postsApi.bookmark(postId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['feed'] });\n    },\n  });\n\n  const handleRefresh = useCallback(() => {\n    refetch();\n    queryClient.invalidateQueries({ queryKey: ['trending'] });\n  }, [refetch, queryClient]);\n\n  const handleLoadMore = useCallback(() => {\n    if (hasNextPage && !isFetchingNextPage) {\n      fetchNextPage();\n    }\n  }, [hasNextPage, isFetchingNextPage, fetchNextPage]);\n\n  const handleVote = useCallback((postId: number, direction: 'up' | 'down') => {\n    voteMutation.mutate({ postId, direction });\n  }, [voteMutation]);\n\n  const handleBookmark = useCallback((postId: number, isBookmarked: boolean) => {\n    bookmarkMutation.mutate({ postId, isBookmarked });\n  }, [bookmarkMutation]);\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const handleHashtagPress = useCallback((tag: string) => {\n    navigation.navigate('Hashtag', { tag });\n  }, [navigation]);\n\n  const handleCreatePost = useCallback(() => {\n    navigation.navigate('CreatePost', { roomSlug: selectedRoom });\n  }, [navigation, selectedRoom]);\n\n  // Header animation\n  const headerTranslate = scrollY.interpolate({\n    inputRange: [0, 100],\n    outputRange: [0, -50],\n    extrapolate: 'clamp',\n  });\n\n  const renderPost = useCallback(({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item.id)}\n      onUserPress={() => handleUserPress(Number(item.author.id))}\n      onVote={(direction) => direction && handleVote(item.id, direction)}\n      onBookmark={() => handleBookmark(item.id, item.is_bookmarked)}\n      onHashtagPress={handleHashtagPress}\n      onMentionPress={handleUserPress}\n    />\n  ), [handlePostPress, handleUserPress, handleVote, handleBookmark, handleHashtagPress]);\n\n  const renderHeader = () => (\n    <View style={[styles.feedHeader, { backgroundColor: appColors.surface }]}>\n      {/* Feed Style Selector */}\n      <View style={styles.feedStyleContainer}>\n        <TouchableOpacity\n          style={[styles.feedStyleButton, feedStyle === 'algorithmic' && styles.feedStyleActive]}\n          onPress={() => setFeedStyle('algorithmic')}\n        >\n          <Ionicons \n            name=\"sparkles\" \n            size={16} \n            color={feedStyle === 'algorithmic' ? Colors.primary : appColors.textSecondary} \n          />\n          <ThemedText style={[\n            styles.feedStyleText,\n            { color: appColors.textSecondary },\n            feedStyle === 'algorithmic' && styles.feedStyleTextActive\n          ]}>\n            For You\n          </ThemedText>\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={[styles.feedStyleButton, feedStyle === 'chronological' && styles.feedStyleActive]}\n          onPress={() => setFeedStyle('chronological')}\n        >\n          <Ionicons \n            name=\"time-outline\" \n            size={16} \n            color={feedStyle === 'chronological' ? Colors.primary : appColors.textSecondary} \n          />\n          <ThemedText style={[\n            styles.feedStyleText,\n            { color: appColors.textSecondary },\n            feedStyle === 'chronological' && styles.feedStyleTextActive\n          ]}>\n            Latest\n          </ThemedText>\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={[styles.feedStyleButton, feedStyle === 'discovery' && styles.feedStyleActive]}\n          onPress={() => setFeedStyle('discovery')}\n        >\n          <Ionicons \n            name=\"compass-outline\" \n            size={16} \n            color={feedStyle === 'discovery' ? Colors.primary : appColors.textSecondary} \n          />\n          <ThemedText style={[\n            styles.feedStyleText,\n            { color: appColors.textSecondary },\n            feedStyle === 'discovery' && styles.feedStyleTextActive\n          ]}>\n            Discover\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n\n      {/* Room Filter */}\n      <RoomFilter\n        rooms={roomsData || []}\n        selectedRoom={selectedRoom}\n        onSelectRoom={setSelectedRoom}\n      />\n    </View>\n  );\n\n  const renderFooter = () => {\n    if (!isFetchingNextPage) return null;\n    return (\n      <View style={styles.loadingFooter}>\n        <ActivityIndicator size=\"small\" color={Colors.primary} />\n      </View>\n    );\n  };\n\n  const renderEmpty = () => {\n    if (isLoading) return null;\n    return (\n      <View style={styles.emptyContainer}>\n        <MaterialCommunityIcons name=\"post-outline\" size={64} color={appColors.textSecondary} />\n        <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No posts yet</ThemedText>\n        <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n          {selectedRoom \n            ? 'Be the first to post in this room!'\n            : 'Follow people and join rooms to see posts here'}\n        </ThemedText>\n        <TouchableOpacity style={styles.emptyButton} onPress={handleCreatePost}>\n          <ThemedText style={styles.emptyButtonText}>Create Post</ThemedText>\n        </TouchableOpacity>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Animated Header */}\n      <Animated.View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }, { transform: [{ translateY: headerTranslate }] }]}>\n        <View style={styles.headerContent}>\n          <ThemedText style={styles.headerTitle}>MedInvest</ThemedText>\n          <View style={styles.headerActions}>\n            <TouchableOpacity \n              style={styles.headerButton}\n              onPress={() => setShowTrending(!showTrending)}\n            >\n              <Ionicons name=\"trending-up\" size={24} color={appColors.textPrimary} />\n            </TouchableOpacity>\n            <TouchableOpacity \n              style={styles.headerButton}\n              onPress={() => navigation.navigate('Search')}\n            >\n              <Ionicons name=\"search\" size={24} color={appColors.textPrimary} />\n            </TouchableOpacity>\n            <NotificationBell \n              unreadCount={notificationData?.unread_count || 0}\n              onPress={() => setShowNotifications(true)}\n            />\n            <MenuButton onPress={() => setShowMenu(true)} />\n          </View>\n        </View>\n      </Animated.View>\n\n      {/* Notifications Dropdown */}\n      <NotificationsDropdown\n        visible={showNotifications}\n        onClose={() => setShowNotifications(false)}\n        anchorPosition={{ top: 100, right: 16 }}\n      />\n\n      {/* Header Menu */}\n      <HeaderMenu\n        visible={showMenu}\n        onClose={() => setShowMenu(false)}\n      />\n\n      {/* Main Content */}\n      <View style={styles.content}>\n        {/* Feed */}\n        <Animated.FlatList\n          data={posts}\n          renderItem={renderPost}\n          keyExtractor={(item) => item.id.toString()}\n          ListHeaderComponent={renderHeader}\n          ListFooterComponent={renderFooter}\n          ListEmptyComponent={renderEmpty}\n          refreshControl={\n            <RefreshControl\n              refreshing={isRefetching}\n              onRefresh={handleRefresh}\n              tintColor={Colors.primary}\n            />\n          }\n          onEndReached={handleLoadMore}\n          onEndReachedThreshold={0.5}\n          onScroll={Animated.event(\n            [{ nativeEvent: { contentOffset: { y: scrollY } } }],\n            { useNativeDriver: true }\n          )}\n          showsVerticalScrollIndicator={false}\n          contentContainerStyle={styles.feedContent}\n        />\n\n        {/* Trending Sidebar (shown on larger screens or as modal) */}\n        {showTrending && (\n          <TrendingSidebar\n            topics={trendingData || []}\n            onTopicPress={handleHashtagPress}\n            onClose={() => setShowTrending(false)}\n          />\n        )}\n      </View>\n\n      {/* Floating Action Button */}\n      <TouchableOpacity style={styles.fab} onPress={handleCreatePost}>\n        <Ionicons name=\"add\" size={28} color={Colors.light.buttonText} />\n      </TouchableOpacity>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    borderBottomWidth: 1,\n    zIndex: 10,\n  },\n  headerContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  headerTitle: {\n    ...Typography.title,\n    color: Colors.primary,\n    fontWeight: '700',\n  },\n  headerActions: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  headerButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n    flexDirection: 'row',\n  },\n  feedContent: {\n    paddingBottom: 100,\n  },\n  feedHeader: {\n    paddingBottom: Spacing.md,\n  },\n  feedStyleContainer: {\n    flexDirection: 'row',\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.md,\n    gap: Spacing.md,\n  },\n  feedStyleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n    gap: Spacing.xs,\n  },\n  feedStyleActive: {\n    backgroundColor: Colors.primary + '15',\n  },\n  feedStyleText: {\n    ...Typography.caption,\n  },\n  feedStyleTextActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  loadingFooter: {\n    paddingVertical: Spacing.xl,\n    alignItems: 'center',\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n  emptyButton: {\n    marginTop: Spacing.xl,\n    backgroundColor: Colors.primary,\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  emptyButtonText: {\n    ...Typography.body,\n    color: Colors.light.buttonText,\n    fontWeight: '600',\n  },\n  fab: {\n    position: 'absolute',\n    bottom: Spacing.xl,\n    right: Spacing.xl,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...Shadows.fab,\n  },\n});\n","path":null,"size_bytes":14817,"size_tokens":null},"client/constants/auth.ts":{"content":"export const AUTH_TOKEN_KEY = '@medinvest/auth_token';\nexport const USER_DATA_KEY = '@medinvest/user_data';\n","path":null,"size_bytes":108,"size_tokens":null},"client/providers/NetworkProvider.tsx":{"content":"import React, { createContext, useContext, useEffect, useState, useCallback } from 'react';\nimport { View, Text, StyleSheet, Pressable } from 'react-native';\nimport NetInfo, { type NetInfoState } from '@react-native-community/netinfo';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withTiming,\n  withSpring,\n  interpolate,\n  Extrapolation,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing } from '@/theme';\n\n// ============================================\n// Network Context\n// ============================================\n\ninterface NetworkState {\n  isConnected: boolean;\n  isInternetReachable: boolean | null;\n  type: string | null;\n  isWifi: boolean;\n  isCellular: boolean;\n}\n\ninterface NetworkContextValue extends NetworkState {\n  refresh: () => Promise<void>;\n}\n\nconst NetworkContext = createContext<NetworkContextValue | null>(null);\n\nexport function NetworkProvider({ children }: { children: React.ReactNode }) {\n  const [networkState, setNetworkState] = useState<NetworkState>({\n    isConnected: true,\n    isInternetReachable: true,\n    type: null,\n    isWifi: false,\n    isCellular: false,\n  });\n\n  const updateNetworkState = useCallback((state: NetInfoState) => {\n    setNetworkState({\n      isConnected: state.isConnected ?? false,\n      isInternetReachable: state.isInternetReachable,\n      type: state.type,\n      isWifi: state.type === 'wifi',\n      isCellular: state.type === 'cellular',\n    });\n  }, []);\n\n  const refresh = useCallback(async () => {\n    const state = await NetInfo.fetch();\n    updateNetworkState(state);\n  }, [updateNetworkState]);\n\n  useEffect(() => {\n    // Get initial state\n    NetInfo.fetch().then(updateNetworkState);\n\n    // Subscribe to changes\n    const unsubscribe = NetInfo.addEventListener(updateNetworkState);\n\n    return () => {\n      unsubscribe();\n    };\n  }, [updateNetworkState]);\n\n  const value: NetworkContextValue = {\n    ...networkState,\n    refresh,\n  };\n\n  return (\n    <NetworkContext.Provider value={value}>\n      {children}\n      <OfflineBanner />\n    </NetworkContext.Provider>\n  );\n}\n\nexport function useNetwork(): NetworkContextValue {\n  const context = useContext(NetworkContext);\n  \n  if (!context) {\n    throw new Error('useNetwork must be used within a NetworkProvider');\n  }\n  \n  return context;\n}\n\n// Simple hook for just checking connection\nexport function useIsOnline(): boolean {\n  const { isConnected, isInternetReachable } = useNetwork();\n  return isConnected && isInternetReachable !== false;\n}\n\n// ============================================\n// Offline Banner Component\n// ============================================\n\nfunction OfflineBanner() {\n  const insets = useSafeAreaInsets();\n  const { isConnected, isInternetReachable, refresh } = useNetwork();\n  const [wasOffline, setWasOffline] = useState(false);\n  const [showReconnected, setShowReconnected] = useState(false);\n  \n  const isOffline = !isConnected || isInternetReachable === false;\n  const translateY = useSharedValue(-100);\n  const opacity = useSharedValue(0);\n\n  useEffect(() => {\n    if (isOffline) {\n      setWasOffline(true);\n      translateY.value = withSpring(0, { damping: 15 });\n      opacity.value = withTiming(1, { duration: 200 });\n    } else if (wasOffline) {\n      // Show \"Back online\" message briefly\n      setShowReconnected(true);\n      \n      setTimeout(() => {\n        translateY.value = withTiming(-100, { duration: 300 });\n        opacity.value = withTiming(0, { duration: 300 });\n        \n        setTimeout(() => {\n          setShowReconnected(false);\n          setWasOffline(false);\n        }, 300);\n      }, 2000);\n    } else {\n      translateY.value = -100;\n      opacity.value = 0;\n    }\n  }, [isOffline, wasOffline, translateY, opacity]);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ translateY: translateY.value }],\n    opacity: opacity.value,\n  }));\n\n  if (!isOffline && !showReconnected) {\n    return null;\n  }\n\n  const isReconnecting = showReconnected && !isOffline;\n\n  return (\n    <Animated.View\n      style={[\n        styles.banner,\n        {\n          paddingTop: insets.top + spacing.sm,\n          backgroundColor: isReconnecting\n            ? colors.semantic.success\n            : colors.semantic.error,\n        },\n        animatedStyle,\n      ]}\n    >\n      <Feather\n        name={isReconnecting ? 'wifi' : 'wifi-off'}\n        size={18}\n        color={colors.text.inverse}\n        style={styles.bannerIcon}\n      />\n      <Text style={styles.bannerText}>\n        {isReconnecting ? 'Back online' : 'No internet connection'}\n      </Text>\n      {!isReconnecting && (\n        <Pressable onPress={refresh} style={styles.retryButton} hitSlop={8}>\n          <Feather name=\"refresh-cw\" size={16} color={colors.text.inverse} />\n        </Pressable>\n      )}\n    </Animated.View>\n  );\n}\n\n// ============================================\n// Offline-aware wrapper component\n// ============================================\n\ninterface OfflineAwareProps {\n  children: React.ReactNode;\n  /** Content to show when offline */\n  offlineContent?: React.ReactNode;\n  /** Show offline content inline vs overlay */\n  inline?: boolean;\n}\n\nexport function OfflineAware({\n  children,\n  offlineContent,\n  inline = false,\n}: OfflineAwareProps) {\n  const isOnline = useIsOnline();\n\n  if (!isOnline && offlineContent) {\n    return <>{offlineContent}</>;\n  }\n\n  if (!isOnline && !inline) {\n    return (\n      <View style={styles.offlineContainer}>\n        {children}\n        <View style={styles.offlineOverlay}>\n          <Feather name=\"cloud-off\" size={48} color={colors.text.tertiary} />\n          <Text style={styles.offlineTitle}>You're offline</Text>\n          <Text style={styles.offlineMessage}>\n            This content requires an internet connection.\n          </Text>\n        </View>\n      </View>\n    );\n  }\n\n  return <>{children}</>;\n}\n\n// ============================================\n// Styles\n// ============================================\n\nconst styles = StyleSheet.create({\n  banner: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingBottom: spacing.sm,\n    paddingHorizontal: spacing.md,\n    zIndex: 9999,\n  },\n  bannerIcon: {\n    marginRight: spacing.sm,\n  },\n  bannerText: {\n    ...typography.captionMedium,\n    color: colors.text.inverse,\n  },\n  retryButton: {\n    marginLeft: spacing.md,\n    padding: spacing.xs,\n  },\n\n  // Offline aware\n  offlineContainer: {\n    flex: 1,\n    position: 'relative',\n  },\n  offlineOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(255, 255, 255, 0.95)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: spacing.xl,\n  },\n  offlineTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginTop: spacing.lg,\n    marginBottom: spacing.sm,\n  },\n  offlineMessage: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n  },\n});\n\nexport default NetworkProvider;\n","path":null,"size_bytes":7138,"size_tokens":null},"client/screens/ReportScreen.tsx":{"content":"/**\n * Report Screen\n * Report users, posts, comments, or messages\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  ActivityIndicator,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { api } from '@/lib/api';\n\n// Report types\nexport type ReportType = 'user' | 'post' | 'comment' | 'message';\n\nexport interface ReportParams {\n  type: ReportType;\n  targetId: number;\n  targetName?: string; // For display purposes\n}\n\n// Report reasons by type\nconst REPORT_REASONS = {\n  user: [\n    { id: 'spam', label: 'Spam or fake account', icon: 'warning-outline' },\n    { id: 'harassment', label: 'Harassment or bullying', icon: 'alert-circle-outline' },\n    { id: 'impersonation', label: 'Impersonation', icon: 'person-outline' },\n    { id: 'inappropriate', label: 'Inappropriate content', icon: 'eye-off-outline' },\n    { id: 'scam', label: 'Scam or fraud', icon: 'shield-outline' },\n    { id: 'other', label: 'Other', icon: 'ellipsis-horizontal-outline' },\n  ],\n  post: [\n    { id: 'spam', label: 'Spam', icon: 'warning-outline' },\n    { id: 'harassment', label: 'Harassment or hate speech', icon: 'alert-circle-outline' },\n    { id: 'misinformation', label: 'False information', icon: 'information-circle-outline' },\n    { id: 'violence', label: 'Violence or dangerous content', icon: 'skull-outline' },\n    { id: 'inappropriate', label: 'Nudity or sexual content', icon: 'eye-off-outline' },\n    { id: 'copyright', label: 'Copyright violation', icon: 'document-outline' },\n    { id: 'other', label: 'Other', icon: 'ellipsis-horizontal-outline' },\n  ],\n  comment: [\n    { id: 'spam', label: 'Spam', icon: 'warning-outline' },\n    { id: 'harassment', label: 'Harassment or hate speech', icon: 'alert-circle-outline' },\n    { id: 'misinformation', label: 'False information', icon: 'information-circle-outline' },\n    { id: 'inappropriate', label: 'Inappropriate content', icon: 'eye-off-outline' },\n    { id: 'other', label: 'Other', icon: 'ellipsis-horizontal-outline' },\n  ],\n  message: [\n    { id: 'spam', label: 'Spam', icon: 'warning-outline' },\n    { id: 'harassment', label: 'Harassment or threatening', icon: 'alert-circle-outline' },\n    { id: 'scam', label: 'Scam or fraud', icon: 'shield-outline' },\n    { id: 'inappropriate', label: 'Inappropriate content', icon: 'eye-off-outline' },\n    { id: 'other', label: 'Other', icon: 'ellipsis-horizontal-outline' },\n  ],\n};\n\nconst TYPE_TITLES: Record<ReportType, string> = {\n  user: 'Report User',\n  post: 'Report Post',\n  comment: 'Report Comment',\n  message: 'Report Message',\n};\n\ntype ReportScreenRouteProp = RouteProp<{ Report: ReportParams }, 'Report'>;\n\nexport default function ReportScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<ReportScreenRouteProp>();\n  const { colors } = useThemeContext();\n  \n  const { type, targetId, targetName } = route.params;\n  const [selectedReason, setSelectedReason] = useState<string | null>(null);\n  const [additionalDetails, setAdditionalDetails] = useState('');\n  const [step, setStep] = useState<'reason' | 'details' | 'submitted'>('reason');\n\n  const reasons = REPORT_REASONS[type];\n\n  // Submit report mutation\n  const submitMutation = useMutation({\n    mutationFn: async () => {\n      return api.post('/reports', {\n        type,\n        target_id: targetId,\n        reason: selectedReason,\n        details: additionalDetails.trim() || undefined,\n      });\n    },\n    onSuccess: () => {\n      haptics.success();\n      setStep('submitted');\n    },\n    onError: (error) => {\n      haptics.error();\n      Alert.alert('Error', 'Failed to submit report. Please try again.');\n    },\n  });\n\n  const handleSelectReason = useCallback((reasonId: string) => {\n    haptics.selection();\n    setSelectedReason(reasonId);\n  }, []);\n\n  const handleContinue = useCallback(() => {\n    if (!selectedReason) return;\n    haptics.buttonPress();\n    setStep('details');\n  }, [selectedReason]);\n\n  const handleSubmit = useCallback(() => {\n    if (!selectedReason) return;\n    haptics.buttonPress();\n    submitMutation.mutate();\n  }, [selectedReason, submitMutation]);\n\n  const handleDone = useCallback(() => {\n    navigation.goBack();\n  }, [navigation]);\n\n  // Render reason selection step\n  const renderReasonStep = () => (\n    <>\n      <View style={styles.stepHeader}>\n        <ThemedText style={[styles.stepTitle, { color: colors.textPrimary }]}>\n          Why are you reporting this {type}?\n        </ThemedText>\n        <ThemedText style={[styles.stepSubtitle, { color: colors.textSecondary }]}>\n          Select the reason that best describes the issue\n        </ThemedText>\n      </View>\n\n      <View style={[styles.reasonsContainer, { backgroundColor: colors.surface }]}>\n        {reasons.map((reason, index) => (\n          <TouchableOpacity\n            key={reason.id}\n            style={[\n              styles.reasonItem,\n              index < reasons.length - 1 && { borderBottomWidth: 1, borderBottomColor: colors.border },\n              selectedReason === reason.id && { backgroundColor: colors.primary + '10' },\n            ]}\n            onPress={() => handleSelectReason(reason.id)}\n          >\n            <Ionicons \n              name={reason.icon as any} \n              size={22} \n              color={selectedReason === reason.id ? colors.primary : colors.textSecondary} \n            />\n            <ThemedText \n              style={[\n                styles.reasonLabel, \n                { color: selectedReason === reason.id ? colors.primary : colors.textPrimary }\n              ]}\n            >\n              {reason.label}\n            </ThemedText>\n            {selectedReason === reason.id && (\n              <Ionicons name=\"checkmark-circle\" size={22} color={colors.primary} />\n            )}\n          </TouchableOpacity>\n        ))}\n      </View>\n\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[\n            styles.continueButton,\n            { backgroundColor: selectedReason ? colors.primary : colors.border },\n          ]}\n          onPress={handleContinue}\n          disabled={!selectedReason}\n        >\n          <ThemedText style={[styles.continueButtonText, { color: selectedReason ? 'white' : colors.textSecondary }]}>\n            Continue\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n    </>\n  );\n\n  // Render details step\n  const renderDetailsStep = () => (\n    <KeyboardAvoidingView \n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      style={styles.detailsContainer}\n    >\n      <View style={styles.stepHeader}>\n        <ThemedText style={[styles.stepTitle, { color: colors.textPrimary }]}>\n          Add more details (optional)\n        </ThemedText>\n        <ThemedText style={[styles.stepSubtitle, { color: colors.textSecondary }]}>\n          Provide any additional information that might help us review this report\n        </ThemedText>\n      </View>\n\n      <View style={[styles.inputContainer, { backgroundColor: colors.surface }]}>\n        <TextInput\n          style={[styles.detailsInput, { color: colors.textPrimary }]}\n          placeholder=\"Describe the issue in more detail...\"\n          placeholderTextColor={colors.textSecondary}\n          multiline\n          numberOfLines={6}\n          maxLength={1000}\n          value={additionalDetails}\n          onChangeText={setAdditionalDetails}\n          textAlignVertical=\"top\"\n        />\n        <ThemedText style={[styles.charCount, { color: colors.textSecondary }]}>\n          {additionalDetails.length}/1000\n        </ThemedText>\n      </View>\n\n      <View style={styles.infoBox}>\n        <Ionicons name=\"shield-checkmark-outline\" size={20} color={colors.primary} />\n        <ThemedText style={[styles.infoText, { color: colors.textSecondary }]}>\n          Your report is confidential. The reported user won't know who submitted this report.\n        </ThemedText>\n      </View>\n\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[styles.backButton, { borderColor: colors.border }]}\n          onPress={() => setStep('reason')}\n        >\n          <ThemedText style={[styles.backButtonText, { color: colors.textPrimary }]}>\n            Back\n          </ThemedText>\n        </TouchableOpacity>\n        \n        <TouchableOpacity\n          style={[styles.submitButton, { backgroundColor: colors.primary }]}\n          onPress={handleSubmit}\n          disabled={submitMutation.isPending}\n        >\n          {submitMutation.isPending ? (\n            <ActivityIndicator size=\"small\" color=\"white\" />\n          ) : (\n            <ThemedText style={styles.submitButtonText}>Submit Report</ThemedText>\n          )}\n        </TouchableOpacity>\n      </View>\n    </KeyboardAvoidingView>\n  );\n\n  // Render submitted confirmation\n  const renderSubmittedStep = () => (\n    <View style={styles.submittedContainer}>\n      <View style={[styles.successIcon, { backgroundColor: colors.success + '20' }]}>\n        <Ionicons name=\"checkmark-circle\" size={64} color={colors.success} />\n      </View>\n      \n      <ThemedText style={[styles.successTitle, { color: colors.textPrimary }]}>\n        Report Submitted\n      </ThemedText>\n      \n      <ThemedText style={[styles.successMessage, { color: colors.textSecondary }]}>\n        Thank you for helping keep MedInvest safe. Our team will review this report and take appropriate action.\n      </ThemedText>\n\n      <View style={[styles.nextStepsContainer, { backgroundColor: colors.surface }]}>\n        <ThemedText style={[styles.nextStepsTitle, { color: colors.textPrimary }]}>\n          What happens next?\n        </ThemedText>\n        <View style={styles.nextStepItem}>\n          <View style={[styles.stepNumber, { backgroundColor: colors.primary }]}>\n            <ThemedText style={styles.stepNumberText}>1</ThemedText>\n          </View>\n          <ThemedText style={[styles.nextStepText, { color: colors.textSecondary }]}>\n            Our team reviews the report within 24-48 hours\n          </ThemedText>\n        </View>\n        <View style={styles.nextStepItem}>\n          <View style={[styles.stepNumber, { backgroundColor: colors.primary }]}>\n            <ThemedText style={styles.stepNumberText}>2</ThemedText>\n          </View>\n          <ThemedText style={[styles.nextStepText, { color: colors.textSecondary }]}>\n            If the content violates our guidelines, action will be taken\n          </ThemedText>\n        </View>\n        <View style={styles.nextStepItem}>\n          <View style={[styles.stepNumber, { backgroundColor: colors.primary }]}>\n            <ThemedText style={styles.stepNumberText}>3</ThemedText>\n          </View>\n          <ThemedText style={[styles.nextStepText, { color: colors.textSecondary }]}>\n            You may receive a notification about the outcome\n          </ThemedText>\n        </View>\n      </View>\n\n      <TouchableOpacity\n        style={[styles.doneButton, { backgroundColor: colors.primary }]}\n        onPress={handleDone}\n      >\n        <ThemedText style={styles.doneButtonText}>Done</ThemedText>\n      </TouchableOpacity>\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.closeButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"close\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          {TYPE_TITLES[type]}\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      {/* Target info */}\n      {targetName && step !== 'submitted' && (\n        <View style={[styles.targetInfo, { backgroundColor: colors.backgroundSecondary }]}>\n          <Ionicons \n            name={type === 'user' ? 'person-circle-outline' : 'document-text-outline'} \n            size={20} \n            color={colors.textSecondary} \n          />\n          <ThemedText style={[styles.targetName, { color: colors.textPrimary }]} numberOfLines={1}>\n            {targetName}\n          </ThemedText>\n        </View>\n      )}\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {step === 'reason' && renderReasonStep()}\n        {step === 'details' && renderDetailsStep()}\n        {step === 'submitted' && renderSubmittedStep()}\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  closeButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  targetInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    gap: Spacing.sm,\n  },\n  targetName: {\n    ...Typography.body,\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n  },\n  stepHeader: {\n    padding: Spacing.lg,\n  },\n  stepTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.xs,\n  },\n  stepSubtitle: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  reasonsContainer: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  reasonItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  reasonLabel: {\n    ...Typography.body,\n    flex: 1,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  continueButton: {\n    flex: 1,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  continueButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  detailsContainer: {\n    flex: 1,\n  },\n  inputContainer: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    ...Shadows.card,\n  },\n  detailsInput: {\n    ...Typography.body,\n    minHeight: 150,\n  },\n  charCount: {\n    ...Typography.small,\n    textAlign: 'right',\n    marginTop: Spacing.sm,\n  },\n  infoBox: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    padding: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  infoText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 18,\n  },\n  backButton: {\n    paddingVertical: Spacing.lg,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n  },\n  backButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  submitButton: {\n    flex: 1,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  submitButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  submittedContainer: {\n    flex: 1,\n    alignItems: 'center',\n    padding: Spacing.xl,\n  },\n  successIcon: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginTop: Spacing.xl,\n  },\n  successTitle: {\n    ...Typography.title,\n    marginTop: Spacing.lg,\n  },\n  successMessage: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  nextStepsContainer: {\n    width: '100%',\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    marginTop: Spacing.xl,\n    ...Shadows.card,\n  },\n  nextStepsTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n  },\n  nextStepItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginTop: Spacing.md,\n    gap: Spacing.md,\n  },\n  stepNumber: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  stepNumberText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '700',\n  },\n  nextStepText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  doneButton: {\n    width: '100%',\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    marginTop: Spacing.xl,\n  },\n  doneButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n});\n","path":null,"size_bytes":16878,"size_tokens":null},"client/screens/ProfileScreen.tsx":{"content":"import React from 'react';\nimport { View, StyleSheet, ScrollView, Pressable, Platform, Alert } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport { Image } from 'expo-image';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { ThemedView } from '@/components/ThemedView';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Spacing, BorderRadius, Shadows } from '@/constants/theme';\nimport { RootStackParamList } from '@/types';\n\ntype NavigationProp = NativeStackNavigationProp<RootStackParamList>;\n\nexport default function ProfileScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NavigationProp>();\n  const { colors } = useThemeContext();\n  const { user, signOut } = useAuth();\n\n  const menuItems = [\n    { icon: 'bookmark', label: 'Bookmarks', screen: 'Bookmarks' as const },\n    { icon: 'award', label: 'Achievements', screen: 'Achievements' as const },\n    { icon: 'bar-chart-2', label: 'Leaderboard', screen: 'Leaderboard' as const },\n    { icon: 'settings', label: 'Settings', screen: 'Settings' as const },\n  ];\n\n  const handleLogout = () => {\n    if (Platform.OS === 'web') {\n      const confirmed = window.confirm('Are you sure you want to sign out?');\n      if (confirmed) {\n        signOut();\n      }\n    } else {\n      Alert.alert(\n        'Sign Out',\n        'Are you sure you want to sign out?',\n        [\n          { text: 'Cancel', style: 'cancel' },\n          { text: 'Sign Out', style: 'destructive', onPress: () => signOut() },\n        ]\n      );\n    }\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      <ScrollView\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingTop: insets.top + Spacing.xl, paddingBottom: insets.bottom + Spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n      >\n        <View style={styles.header}>\n          <ThemedText type=\"title\">Profile</ThemedText>\n          <Pressable\n            onPress={() => navigation.navigate('Settings')}\n            style={({ pressed }) => [\n              styles.headerButton,\n              { backgroundColor: colors.backgroundSecondary, opacity: pressed ? 0.7 : 1 },\n            ]}\n          >\n            <Feather name=\"settings\" size={20} color={colors.textPrimary} />\n          </Pressable>\n        </View>\n\n        <View style={[styles.profileCard, { backgroundColor: colors.surface }, Shadows.card]}>\n          {user?.avatar_url ? (\n            <Image\n              source={{ uri: user.avatar_url }}\n              style={styles.avatarImage}\n              contentFit=\"cover\"\n            />\n          ) : (\n            <View style={[styles.avatar, { backgroundColor: colors.primary + '20' }]}>\n              <ThemedText type=\"title\" style={{ color: colors.primary }}>\n                {user?.first_name?.[0] || user?.email?.[0]?.toUpperCase() || 'U'}\n              </ThemedText>\n            </View>\n          )}\n          <ThemedText type=\"heading\" style={styles.userName}>\n            {user?.full_name || user?.email || 'User'}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: colors.textSecondary }}>\n            {user?.email || ''}\n          </ThemedText>\n          <Pressable\n            onPress={() => navigation.navigate('EditProfile')}\n            style={({ pressed }) => [\n              styles.editButton,\n              { backgroundColor: colors.primary, opacity: pressed ? 0.9 : 1 },\n            ]}\n          >\n            <Feather name=\"edit-2\" size={16} color=\"#FFFFFF\" />\n            <ThemedText type=\"body\" style={{ color: '#FFFFFF', marginLeft: Spacing.xs }}>\n              Edit Profile\n            </ThemedText>\n          </Pressable>\n        </View>\n\n        <View style={[styles.menuSection, { backgroundColor: colors.surface }, Shadows.card]}>\n          {menuItems.map((item, index) => (\n            <Pressable\n              key={item.screen}\n              onPress={() => navigation.navigate(item.screen)}\n              style={({ pressed }) => [\n                styles.menuItem,\n                { opacity: pressed ? 0.7 : 1 },\n                index < menuItems.length - 1 && {\n                  borderBottomWidth: 1,\n                  borderBottomColor: colors.border,\n                },\n              ]}\n            >\n              <View style={[styles.menuIcon, { backgroundColor: colors.primary + '15' }]}>\n                <Feather name={item.icon as any} size={20} color={colors.primary} />\n              </View>\n              <ThemedText type=\"heading\" style={styles.menuLabel}>\n                {item.label}\n              </ThemedText>\n              <Feather name=\"chevron-right\" size={20} color={colors.textSecondary} />\n            </Pressable>\n          ))}\n        </View>\n\n        <Pressable\n          onPress={handleLogout}\n          style={({ pressed }) => [\n            styles.logoutButton,\n            { backgroundColor: colors.error + '15', opacity: pressed ? 0.7 : 1 },\n          ]}\n        >\n          <Feather name=\"log-out\" size={20} color={colors.error} />\n          <ThemedText type=\"heading\" style={{ color: colors.error, marginLeft: Spacing.sm }}>\n            Sign Out\n          </ThemedText>\n        </Pressable>\n      </ScrollView>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollContent: {\n    padding: Spacing.lg,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  headerButton: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.sm,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  profileCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    alignItems: 'center',\n    marginBottom: Spacing.lg,\n  },\n  avatar: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.md,\n  },\n  avatarImage: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    marginBottom: Spacing.md,\n  },\n  userName: {\n    marginBottom: Spacing.xs,\n  },\n  editButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    marginTop: Spacing.lg,\n  },\n  menuSection: {\n    borderRadius: BorderRadius.lg,\n    marginBottom: Spacing.lg,\n    overflow: 'hidden',\n  },\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n  },\n  menuIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.sm,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  menuLabel: {\n    flex: 1,\n  },\n  logoutButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n  },\n});\n","path":null,"size_bytes":7138,"size_tokens":null},"client/screens/main/InvestmentDetailScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  Share,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport type { RouteProp } from '@react-navigation/native';\nimport Animated, { FadeIn, FadeInDown } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { RootStackParamList } from '@/navigation/types';\n\n// Types\ninterface InvestmentDetail {\n  id: string;\n  name: string;\n  description: string;\n  longDescription: string;\n  category: string;\n  fundingGoal: number;\n  fundingCurrent: number;\n  minimumInvestment: number;\n  expectedROI: string;\n  daysRemaining: number;\n  imageUrl?: string;\n  riskLevel: 'Low' | 'Medium' | 'High';\n  investors: number;\n  documents: { name: string; type: string }[];\n  team: { name: string; role: string }[];\n  milestones: { title: string; completed: boolean }[];\n}\n\n// Mock data\nconst MOCK_INVESTMENT: InvestmentDetail = {\n  id: '1',\n  name: 'NeuroLink Diagnostics',\n  description: 'AI-powered early detection of neurological disorders',\n  longDescription:\n    'NeuroLink Diagnostics is pioneering the use of artificial intelligence for early detection of neurological conditions including Alzheimer\\'s, Parkinson\\'s, and multiple sclerosis. Our proprietary algorithms analyze brain imaging data with 94% accuracy, enabling intervention years earlier than traditional methods.\\n\\nThe global neurological diagnostics market is projected to reach $12B by 2028, and NeuroLink is positioned to capture significant market share with our FDA-cleared technology platform.',\n  category: 'Digital Health',\n  fundingGoal: 2500000,\n  fundingCurrent: 1875000,\n  minimumInvestment: 1000,\n  expectedROI: '15-22%',\n  daysRemaining: 45,\n  riskLevel: 'Medium',\n  investors: 342,\n  documents: [\n    { name: 'Pitch Deck', type: 'pdf' },\n    { name: 'Financial Projections', type: 'xlsx' },\n    { name: 'FDA Clearance Letter', type: 'pdf' },\n    { name: 'Term Sheet', type: 'pdf' },\n  ],\n  team: [\n    { name: 'Dr. Sarah Chen', role: 'CEO & Co-founder' },\n    { name: 'Dr. Michael Park', role: 'CTO & Co-founder' },\n    { name: 'Jennifer Liu', role: 'Chief Medical Officer' },\n  ],\n  milestones: [\n    { title: 'FDA 510(k) Clearance', completed: true },\n    { title: 'Series A Funding ($5M)', completed: true },\n    { title: 'First Hospital Partnership', completed: true },\n    { title: '10,000 Scans Processed', completed: false },\n    { title: 'Series B Funding', completed: false },\n  ],\n};\n\n/**\n * Investment Detail Screen\n */\nexport default function InvestmentDetailScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const route = useRoute<RouteProp<RootStackParamList, 'InvestmentDetail'>>();\n  \n  const [investment] = useState<InvestmentDetail>(MOCK_INVESTMENT);\n\n  const handleBack = useCallback(() => {\n    navigation.goBack();\n  }, [navigation]);\n\n  const handleShare = useCallback(async () => {\n    try {\n      await Share.share({\n        message: `Check out ${investment.name} on MedInvest - ${investment.description}`,\n        title: investment.name,\n      });\n    } catch (error) {\n      console.error('Share error:', error);\n    }\n  }, [investment]);\n\n  const handleInvest = useCallback(() => {\n    navigation.navigate('InvestModal', { investmentId: investment.id });\n  }, [navigation, investment.id]);\n\n  const formatCurrency = (value: number) => {\n    if (value >= 1000000) {\n      return `$${(value / 1000000).toFixed(1)}M`;\n    }\n    if (value >= 1000) {\n      return `$${(value / 1000).toFixed(0)}K`;\n    }\n    return `$${value}`;\n  };\n\n  const progress = (investment.fundingCurrent / investment.fundingGoal) * 100;\n\n  return (\n    <View style={styles.container}>\n      {/* Scrollable Content */}\n      <ScrollView\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingBottom: 80 + insets.bottom + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Hero Section */}\n        <Animated.View entering={FadeIn.duration(400)}>\n          <LinearGradient\n            colors={colors.gradient.colors as unknown as string[]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={[styles.hero, { paddingTop: insets.top }]}\n          >\n            {/* Header */}\n            <View style={styles.header}>\n              <Pressable style={styles.headerButton} onPress={handleBack}>\n                <Feather name=\"arrow-left\" size={24} color={colors.text.inverse} />\n              </Pressable>\n              <Pressable style={styles.headerButton} onPress={handleShare}>\n                <Feather name=\"share-2\" size={24} color={colors.text.inverse} />\n              </Pressable>\n            </View>\n\n            {/* Hero Content */}\n            <View style={styles.heroContent}>\n              <View style={styles.categoryBadge}>\n                <Text style={styles.categoryText}>{investment.category}</Text>\n              </View>\n              <Text style={styles.heroTitle}>{investment.name}</Text>\n              <Text style={styles.heroDescription}>{investment.description}</Text>\n            </View>\n          </LinearGradient>\n        </Animated.View>\n\n        {/* Funding Progress Card */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(100)}\n          style={styles.card}\n        >\n          <View style={styles.progressHeader}>\n            <Text style={styles.progressAmount}>\n              {formatCurrency(investment.fundingCurrent)}\n            </Text>\n            <Text style={styles.progressGoal}>\n              of {formatCurrency(investment.fundingGoal)} goal\n            </Text>\n          </View>\n\n          <View style={styles.progressBar}>\n            <View style={[styles.progressFill, { width: `${progress}%` }]} />\n          </View>\n\n          <View style={styles.progressStats}>\n            <View style={styles.progressStat}>\n              <Text style={styles.progressStatValue}>{progress.toFixed(0)}%</Text>\n              <Text style={styles.progressStatLabel}>Funded</Text>\n            </View>\n            <View style={styles.progressStat}>\n              <Text style={styles.progressStatValue}>{investment.investors}</Text>\n              <Text style={styles.progressStatLabel}>Investors</Text>\n            </View>\n            <View style={styles.progressStat}>\n              <Text style={styles.progressStatValue}>{investment.daysRemaining}</Text>\n              <Text style={styles.progressStatLabel}>Days Left</Text>\n            </View>\n          </View>\n        </Animated.View>\n\n        {/* Key Metrics Grid */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(200)}\n          style={styles.metricsGrid}\n        >\n          <View style={styles.metricCard}>\n            <Feather name=\"trending-up\" size={20} color={colors.primary.main} />\n            <Text style={styles.metricValue}>{investment.expectedROI}</Text>\n            <Text style={styles.metricLabel}>Expected ROI</Text>\n          </View>\n          <View style={styles.metricCard}>\n            <Feather name=\"dollar-sign\" size={20} color={colors.primary.main} />\n            <Text style={styles.metricValue}>\n              {formatCurrency(investment.minimumInvestment)}\n            </Text>\n            <Text style={styles.metricLabel}>Min. Investment</Text>\n          </View>\n          <View style={styles.metricCard}>\n            <Feather name=\"alert-triangle\" size={20} color={colors.semantic.warning} />\n            <Text style={styles.metricValue}>{investment.riskLevel}</Text>\n            <Text style={styles.metricLabel}>Risk Level</Text>\n          </View>\n        </Animated.View>\n\n        {/* Description */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(300)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>About</Text>\n          <Text style={styles.descriptionText}>{investment.longDescription}</Text>\n        </Animated.View>\n\n        {/* Team */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(400)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Team</Text>\n          {investment.team.map((member, index) => (\n            <View key={index} style={styles.teamMember}>\n              <View style={styles.teamAvatar}>\n                <Text style={styles.teamAvatarText}>\n                  {member.name.split(' ').map((n) => n[0]).join('')}\n                </Text>\n              </View>\n              <View>\n                <Text style={styles.teamName}>{member.name}</Text>\n                <Text style={styles.teamRole}>{member.role}</Text>\n              </View>\n            </View>\n          ))}\n        </Animated.View>\n\n        {/* Milestones */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(500)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Milestones</Text>\n          {investment.milestones.map((milestone, index) => (\n            <View key={index} style={styles.milestone}>\n              <View\n                style={[\n                  styles.milestoneIcon,\n                  milestone.completed && styles.milestoneIconCompleted,\n                ]}\n              >\n                {milestone.completed ? (\n                  <Feather name=\"check\" size={14} color={colors.text.inverse} />\n                ) : (\n                  <View style={styles.milestoneIconPending} />\n                )}\n              </View>\n              <Text\n                style={[\n                  styles.milestoneText,\n                  milestone.completed && styles.milestoneTextCompleted,\n                ]}\n              >\n                {milestone.title}\n              </Text>\n            </View>\n          ))}\n        </Animated.View>\n\n        {/* Documents */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(600)}\n          style={styles.section}\n        >\n          <Text style={styles.sectionTitle}>Documents</Text>\n          {investment.documents.map((doc, index) => (\n            <Pressable key={index} style={styles.documentItem}>\n              <View style={styles.documentIcon}>\n                <Feather name=\"file-text\" size={20} color={colors.primary.main} />\n              </View>\n              <Text style={styles.documentName}>{doc.name}</Text>\n              <Feather name=\"download\" size={20} color={colors.text.tertiary} />\n            </Pressable>\n          ))}\n        </Animated.View>\n\n        {/* Risk Assessment */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(700)}\n          style={styles.riskCard}\n        >\n          <View style={styles.riskHeader}>\n            <Feather name=\"alert-circle\" size={20} color={colors.semantic.warning} />\n            <Text style={styles.riskTitle}>Risk Assessment</Text>\n          </View>\n          <Text style={styles.riskText}>\n            This investment carries {investment.riskLevel.toLowerCase()} risk. Medical\n            technology investments are subject to regulatory approval, market adoption,\n            and competitive pressures. Past performance does not guarantee future results.\n            Please review all documents carefully before investing.\n          </Text>\n        </Animated.View>\n      </ScrollView>\n\n      {/* Floating Invest Button */}\n      <View style={[styles.floatingButton, { paddingBottom: insets.bottom + spacing.lg }]}>\n        <Pressable onPress={handleInvest} style={styles.investButton}>\n          <LinearGradient\n            colors={colors.gradient.colors as unknown as string[]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={styles.investButtonGradient}\n          >\n            <Text style={styles.investButtonText}>Invest Now</Text>\n            <Feather name=\"arrow-right\" size={20} color={colors.text.inverse} />\n          </LinearGradient>\n        </Pressable>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingBottom: spacing.xl,\n  },\n\n  // Hero\n  hero: {\n    paddingBottom: spacing.xl,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.md,\n  },\n  headerButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.white20,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  heroContent: {\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.lg,\n  },\n  categoryBadge: {\n    alignSelf: 'flex-start',\n    backgroundColor: colors.transparent.white20,\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusFull,\n    marginBottom: spacing.md,\n  },\n  categoryText: {\n    ...typography.caption,\n    color: colors.text.inverse,\n  },\n  heroTitle: {\n    ...typography.hero,\n    color: colors.text.inverse,\n    marginBottom: spacing.sm,\n  },\n  heroDescription: {\n    ...typography.body,\n    color: colors.transparent.white50,\n  },\n\n  // Card\n  card: {\n    backgroundColor: colors.surface.primary,\n    marginHorizontal: spacing.lg,\n    marginTop: -spacing.xl,\n    padding: spacing.lg,\n    borderRadius: layout.radiusLarge,\n    ...shadows.elevated,\n  },\n  progressHeader: {\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    marginBottom: spacing.md,\n  },\n  progressAmount: {\n    ...typography.title,\n    color: colors.text.primary,\n  },\n  progressGoal: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    marginLeft: spacing.sm,\n  },\n  progressBar: {\n    height: layout.progressBarHeight,\n    backgroundColor: colors.border.light,\n    borderRadius: layout.progressBarHeight / 2,\n    overflow: 'hidden',\n    marginBottom: spacing.lg,\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: colors.primary.main,\n    borderRadius: layout.progressBarHeight / 2,\n  },\n  progressStats: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n  },\n  progressStat: {\n    alignItems: 'center',\n  },\n  progressStatValue: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  progressStatLabel: {\n    ...typography.small,\n    color: colors.text.secondary,\n  },\n\n  // Metrics Grid\n  metricsGrid: {\n    flexDirection: 'row',\n    paddingHorizontal: spacing.lg,\n    marginTop: spacing.lg,\n    gap: spacing.sm,\n  },\n  metricCard: {\n    flex: 1,\n    backgroundColor: colors.surface.primary,\n    padding: spacing.md,\n    borderRadius: layout.radiusMedium,\n    alignItems: 'center',\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  metricValue: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginTop: spacing.sm,\n  },\n  metricLabel: {\n    ...typography.small,\n    color: colors.text.secondary,\n    marginTop: spacing.xs,\n  },\n\n  // Sections\n  section: {\n    paddingHorizontal: spacing.lg,\n    marginTop: spacing.xl,\n  },\n  sectionTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.md,\n  },\n  descriptionText: {\n    ...typography.body,\n    color: colors.text.secondary,\n    lineHeight: 24,\n  },\n\n  // Team\n  teamMember: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: spacing.md,\n  },\n  teamAvatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: colors.transparent.primary20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  teamAvatarText: {\n    ...typography.captionMedium,\n    color: colors.primary.main,\n  },\n  teamName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  teamRole: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n\n  // Milestones\n  milestone: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: spacing.md,\n  },\n  milestoneIcon: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    backgroundColor: colors.border.light,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  milestoneIconCompleted: {\n    backgroundColor: colors.semantic.success,\n  },\n  milestoneIconPending: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: colors.text.tertiary,\n  },\n  milestoneText: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n  milestoneTextCompleted: {\n    color: colors.text.primary,\n  },\n\n  // Documents\n  documentItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.md,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  documentIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  documentName: {\n    ...typography.body,\n    color: colors.text.primary,\n    flex: 1,\n  },\n\n  // Risk Card\n  riskCard: {\n    backgroundColor: colors.transparent.black10,\n    marginHorizontal: spacing.lg,\n    marginTop: spacing.xl,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n  },\n  riskHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n    marginBottom: spacing.sm,\n  },\n  riskTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  riskText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    lineHeight: 20,\n  },\n\n  // Floating Button\n  floatingButton: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.md,\n    backgroundColor: colors.background.primary,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  investButton: {\n    borderRadius: layout.radiusMedium,\n    overflow: 'hidden',\n  },\n  investButtonGradient: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    paddingVertical: spacing.lg,\n  },\n  investButtonText: {\n    ...typography.button.large,\n    color: colors.text.inverse,\n  },\n});\n","path":null,"size_bytes":18662,"size_tokens":null},"client/screens/EditPostScreen.tsx":{"content":"/**\n * Edit Post Screen\n * Edit existing posts\n */\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  ScrollView,\n  Alert,\n  ActivityIndicator,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\n\ntype EditPostRouteParams = {\n  EditPost: {\n    postId: number;\n  };\n};\n\nconst MAX_CONTENT_LENGTH = 5000;\n\nexport default function EditPostScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<EditPostRouteParams, 'EditPost'>>();\n  const { postId } = route.params;\n  const queryClient = useQueryClient();\n  const { colors } = useThemeContext();\n\n  const [content, setContent] = useState('');\n  const [originalContent, setOriginalContent] = useState('');\n  const [hasChanges, setHasChanges] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const loadPost = async () => {\n      setIsLoading(true);\n      try {\n        setContent('This is sample post content for editing.');\n        setOriginalContent('This is sample post content for editing.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    loadPost();\n  }, [postId]);\n\n  useEffect(() => {\n    setHasChanges(content !== originalContent);\n  }, [content, originalContent]);\n\n  const handleSave = useCallback(() => {\n    if (!hasChanges) {\n      navigation.goBack();\n      return;\n    }\n    \n    Alert.alert('Success', 'Post updated successfully');\n    queryClient.invalidateQueries({ queryKey: ['post', postId] });\n    queryClient.invalidateQueries({ queryKey: ['feed'] });\n    navigation.goBack();\n  }, [hasChanges, navigation, queryClient, postId]);\n\n  const handleCancel = useCallback(() => {\n    if (hasChanges) {\n      Alert.alert(\n        'Discard Changes?',\n        'You have unsaved changes. Are you sure you want to discard them?',\n        [\n          { text: 'Keep Editing', style: 'cancel' },\n          { text: 'Discard', style: 'destructive', onPress: () => navigation.goBack() },\n        ]\n      );\n    } else {\n      navigation.goBack();\n    }\n  }, [hasChanges, navigation]);\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: colors.background }]}>\n        <ActivityIndicator size=\"large\" color={colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        <View style={[styles.header, { borderBottomColor: colors.border }]}>\n          <TouchableOpacity style={styles.cancelButton} onPress={handleCancel}>\n            <ThemedText style={[styles.cancelText, { color: colors.textSecondary }]}>Cancel</ThemedText>\n          </TouchableOpacity>\n          \n          <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>Edit Post</ThemedText>\n          \n          <TouchableOpacity\n            style={[\n              styles.saveButton,\n              hasChanges \n                ? { backgroundColor: colors.primary } \n                : { backgroundColor: colors.backgroundSecondary }\n            ]}\n            onPress={handleSave}\n            disabled={!hasChanges}\n          >\n            <ThemedText style={[\n              styles.saveText,\n              { color: hasChanges ? '#FFFFFF' : colors.textTertiary }\n            ]}>\n              Save\n            </ThemedText>\n          </TouchableOpacity>\n        </View>\n\n        <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>\n          <View style={[styles.inputContainer, { backgroundColor: colors.surface }]}>\n            <TextInput\n              style={[styles.textInput, { color: colors.textPrimary }]}\n              value={content}\n              onChangeText={setContent}\n              placeholder=\"What's on your mind?\"\n              placeholderTextColor={colors.textTertiary}\n              multiline\n              maxLength={MAX_CONTENT_LENGTH}\n              textAlignVertical=\"top\"\n            />\n          </View>\n\n          <View style={styles.characterCount}>\n            <ThemedText style={[\n              styles.characterCountText,\n              { color: content.length > MAX_CONTENT_LENGTH * 0.9 ? colors.warning : colors.textTertiary }\n            ]}>\n              {content.length}/{MAX_CONTENT_LENGTH}\n            </ThemedText>\n          </View>\n\n          <View style={[styles.noticeCard, { backgroundColor: colors.info + '15' }]}>\n            <Ionicons name=\"information-circle\" size={20} color={colors.info} />\n            <View style={styles.noticeContent}>\n              <ThemedText style={[styles.noticeTitle, { color: colors.textPrimary }]}>\n                Note\n              </ThemedText>\n              <ThemedText style={[styles.noticeText, { color: colors.textSecondary }]}>\n                Editing a post won't change the time it was posted. Images and videos cannot be modified.\n              </ThemedText>\n            </View>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  cancelButton: {\n    padding: Spacing.sm,\n  },\n  cancelText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  headerTitle: {\n    ...Typography.heading,\n    fontSize: 17,\n    fontWeight: '600',\n  },\n  saveButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  saveText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  scrollView: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  inputContainer: {\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    minHeight: 200,\n  },\n  textInput: {\n    ...Typography.body,\n    minHeight: 150,\n    lineHeight: 24,\n  },\n  characterCount: {\n    alignItems: 'flex-end',\n    marginTop: Spacing.sm,\n    paddingRight: Spacing.sm,\n  },\n  characterCountText: {\n    ...Typography.caption,\n  },\n  noticeCard: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginTop: Spacing.lg,\n    gap: Spacing.md,\n  },\n  noticeContent: {\n    flex: 1,\n  },\n  noticeTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.xs,\n  },\n  noticeText: {\n    ...Typography.small,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":7265,"size_tokens":null},"client/lib/analytics.ts":{"content":"/**\n * Analytics Service\n * Track user events and screen views\n */\n\nimport { Platform } from 'react-native';\n\n// Event types for type safety\nexport type AnalyticsEvent =\n  | 'app_open'\n  | 'screen_view'\n  | 'login'\n  | 'logout'\n  | 'signup'\n  | 'post_create'\n  | 'post_view'\n  | 'post_like'\n  | 'post_comment'\n  | 'post_share'\n  | 'post_bookmark'\n  | 'user_follow'\n  | 'user_unfollow'\n  | 'user_profile_view'\n  | 'message_send'\n  | 'conversation_start'\n  | 'deal_view'\n  | 'deal_invest_click'\n  | 'ama_view'\n  | 'ama_question'\n  | 'course_view'\n  | 'course_enroll'\n  | 'event_view'\n  | 'event_rsvp'\n  | 'search'\n  | 'notification_open'\n  | 'ai_chat_message'\n  | 'premium_view'\n  | 'premium_subscribe'\n  | 'room_join'\n  | 'room_leave'\n  | 'achievement_unlock'\n  | 'error';\n\nexport interface AnalyticsProperties {\n  [key: string]: string | number | boolean | null | undefined;\n}\n\nexport interface UserTraits {\n  userId?: number;\n  email?: string;\n  name?: string;\n  specialty?: string;\n  isPremium?: boolean;\n  level?: number;\n  createdAt?: string;\n}\n\nclass AnalyticsService {\n  private isEnabled: boolean = true;\n  private userId: string | null = null;\n  private sessionId: string;\n  private queue: Array<{ event: string; properties: AnalyticsProperties; timestamp: number }> = [];\n  private flushInterval: ReturnType<typeof setInterval> | null = null;\n\n  constructor() {\n    this.sessionId = this.generateSessionId();\n    this.startFlushInterval();\n  }\n\n  /**\n   * Generate unique session ID\n   */\n  private generateSessionId(): string {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  /**\n   * Start periodic flush of queued events\n   */\n  private startFlushInterval(): void {\n    this.flushInterval = setInterval(() => {\n      this.flush();\n    }, 30000); // Flush every 30 seconds\n  }\n\n  /**\n   * Enable/disable analytics\n   */\n  setEnabled(enabled: boolean): void {\n    this.isEnabled = enabled;\n  }\n\n  /**\n   * Identify user for analytics\n   */\n  identify(userId: string, traits?: UserTraits): void {\n    this.userId = userId;\n    \n    if (!this.isEnabled) return;\n\n    this.queueEvent('identify', {\n      userId,\n      ...traits,\n    });\n\n    // Also send to any third-party analytics\n    this.sendToProviders('identify', { userId, traits });\n  }\n\n  /**\n   * Clear user identity (on logout)\n   */\n  reset(): void {\n    this.userId = null;\n    this.sessionId = this.generateSessionId();\n  }\n\n  /**\n   * Track an event\n   */\n  track(event: AnalyticsEvent, properties?: AnalyticsProperties): void {\n    if (!this.isEnabled) return;\n\n    const enrichedProperties = this.enrichProperties(properties);\n    \n    this.queueEvent(event, enrichedProperties);\n    this.sendToProviders('track', { event, properties: enrichedProperties });\n  }\n\n  /**\n   * Track screen view\n   */\n  screen(screenName: string, properties?: AnalyticsProperties): void {\n    if (!this.isEnabled) return;\n\n    const enrichedProperties = {\n      screen_name: screenName,\n      ...this.enrichProperties(properties),\n    };\n\n    this.queueEvent('screen_view', enrichedProperties);\n    this.sendToProviders('screen', { screenName, properties: enrichedProperties });\n  }\n\n  /**\n   * Enrich properties with common data\n   */\n  private enrichProperties(properties?: AnalyticsProperties): AnalyticsProperties {\n    return {\n      ...properties,\n      session_id: this.sessionId,\n      user_id: this.userId,\n      platform: Platform.OS,\n      platform_version: Platform.Version,\n      timestamp: Date.now(),\n      app_version: process.env.EXPO_PUBLIC_APP_VERSION || '1.0.0',\n    };\n  }\n\n  /**\n   * Queue event for batch sending\n   */\n  private queueEvent(event: string, properties: AnalyticsProperties): void {\n    this.queue.push({\n      event,\n      properties,\n      timestamp: Date.now(),\n    });\n\n    // Auto-flush if queue is too large\n    if (this.queue.length >= 20) {\n      this.flush();\n    }\n  }\n\n  /**\n   * Flush queued events to server\n   */\n  async flush(): Promise<void> {\n    if (this.queue.length === 0) return;\n\n    const events = [...this.queue];\n    this.queue = [];\n\n    try {\n      // Send to your analytics backend\n      // await analyticsApi.trackBatch(events);\n      \n      if (__DEV__) {\n        console.log('[Analytics] Flushed', events.length, 'events');\n      }\n    } catch (error) {\n      // Re-queue failed events\n      this.queue = [...events, ...this.queue];\n      console.error('[Analytics] Flush failed:', error);\n    }\n  }\n\n  /**\n   * Send to third-party analytics providers\n   */\n  private sendToProviders(\n    type: 'identify' | 'track' | 'screen',\n    data: Record<string, unknown>\n  ): void {\n    // Integrate with providers here:\n    // - Mixpanel\n    // - Amplitude\n    // - Segment\n    // - Firebase Analytics\n    // - etc.\n\n    if (__DEV__) {\n      console.log(`[Analytics] ${type}:`, data);\n    }\n  }\n\n  /**\n   * Track timing events\n   */\n  timing(category: string, variable: string, value: number, label?: string): void {\n    this.track('timing' as AnalyticsEvent, {\n      timing_category: category,\n      timing_variable: variable,\n      timing_value: value,\n      timing_label: label,\n    });\n  }\n\n  /**\n   * Track errors\n   */\n  trackError(error: Error, context?: AnalyticsProperties): void {\n    this.track('error', {\n      error_name: error.name,\n      error_message: error.message,\n      error_stack: error.stack?.substring(0, 500),\n      ...context,\n    });\n  }\n\n  /**\n   * Get current session ID\n   */\n  getSessionId(): string {\n    return this.sessionId;\n  }\n\n  /**\n   * Cleanup\n   */\n  destroy(): void {\n    if (this.flushInterval) {\n      clearInterval(this.flushInterval);\n    }\n    this.flush();\n  }\n}\n\n// Common event tracking helpers\nexport const analytics = new AnalyticsService();\n\n// Convenience methods\nexport const trackPostCreate = (postId: number, roomSlug?: string, isAnonymous?: boolean) => {\n  analytics.track('post_create', { post_id: postId, room_slug: roomSlug, is_anonymous: isAnonymous });\n};\n\nexport const trackPostView = (postId: number) => {\n  analytics.track('post_view', { post_id: postId });\n};\n\nexport const trackPostLike = (postId: number) => {\n  analytics.track('post_like', { post_id: postId });\n};\n\nexport const trackPostComment = (postId: number) => {\n  analytics.track('post_comment', { post_id: postId });\n};\n\nexport const trackPostShare = (postId: number, method: string) => {\n  analytics.track('post_share', { post_id: postId, share_method: method });\n};\n\nexport const trackUserFollow = (userId: number) => {\n  analytics.track('user_follow', { followed_user_id: userId });\n};\n\nexport const trackSearch = (query: string, resultCount: number, type: string) => {\n  analytics.track('search', { query, result_count: resultCount, search_type: type });\n};\n\nexport const trackDealView = (dealId: number, category: string) => {\n  analytics.track('deal_view', { deal_id: dealId, deal_category: category });\n};\n\nexport const trackAIChatMessage = (messageLength: number) => {\n  analytics.track('ai_chat_message', { message_length: messageLength });\n};\n\nexport const trackPremiumView = (source: string) => {\n  analytics.track('premium_view', { source });\n};\n\nexport const trackNotificationOpen = (notificationType: string) => {\n  analytics.track('notification_open', { notification_type: notificationType });\n};\n","path":null,"size_bytes":7284,"size_tokens":null},"server/db/seed.ts":{"content":"import { db } from './index';\nimport {\n  investments,\n  investmentDocuments,\n  investmentTeamMembers,\n  investmentMilestones,\n  articles,\n} from './schema';\n\n/**\n * Seed database with sample data\n */\nexport async function seed() {\n  console.log('üå± Seeding database...');\n\n  // Clear existing data (in reverse order of dependencies)\n  await db.delete(investmentMilestones);\n  await db.delete(investmentTeamMembers);\n  await db.delete(investmentDocuments);\n  await db.delete(investments);\n  await db.delete(articles);\n  console.log('  Cleared existing data');\n\n  // Seed investments\n  const investmentData = [\n    {\n      name: 'NeuroLink Diagnostics',\n      description: 'AI-powered early detection of neurological disorders',\n      longDescription: `NeuroLink Diagnostics is pioneering the use of artificial intelligence for early detection of neurological conditions including Alzheimer's, Parkinson's, and multiple sclerosis.\n\nOur proprietary algorithms analyze brain imaging data with 94% accuracy, enabling intervention years earlier than traditional methods.\n\nThe global neurological diagnostics market is projected to reach $12B by 2028, and NeuroLink is positioned to capture significant market share with our FDA-cleared technology platform.`,\n      category: 'Digital Health' as const,\n      fundingGoal: '2500000',\n      fundingCurrent: '1875000',\n      minimumInvestment: '1000',\n      expectedRoiMin: '15',\n      expectedRoiMax: '22',\n      riskLevel: 'Medium' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-10-01'),\n      endDate: new Date('2025-03-01'),\n      investorCount: 342,\n    },\n    {\n      name: 'CardioSense Implant',\n      description: 'Next-gen cardiac monitoring implant with 10-year battery',\n      longDescription: `CardioSense is developing a revolutionary cardiac monitoring implant that combines continuous ECG monitoring with advanced arrhythmia detection.\n\nOur device features a 10-year battery life, eliminating the need for frequent replacement surgeries that burden patients and healthcare systems.\n\nWith over 6 million Americans living with arrhythmias, the market opportunity exceeds $8B annually.`,\n      category: 'Medical Devices' as const,\n      fundingGoal: '5000000',\n      fundingCurrent: '3250000',\n      minimumInvestment: '2500',\n      expectedRoiMin: '18',\n      expectedRoiMax: '25',\n      riskLevel: 'Medium' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-09-15'),\n      endDate: new Date('2025-02-15'),\n      investorCount: 156,\n    },\n    {\n      name: 'GeneCure Therapeutics',\n      description: 'CRISPR-based treatment for rare genetic diseases',\n      longDescription: `GeneCure Therapeutics is at the forefront of gene therapy, developing CRISPR-based treatments for rare genetic disorders that currently have no cure.\n\nOur lead candidate targets Duchenne muscular dystrophy, affecting 1 in 3,500 boys worldwide. Phase 2 trials have shown remarkable efficacy with minimal off-target effects.\n\nThe rare disease market represents a $200B+ opportunity, with gene therapies commanding premium pricing due to their curative potential.`,\n      category: 'Biotech' as const,\n      fundingGoal: '10000000',\n      fundingCurrent: '7500000',\n      minimumInvestment: '5000',\n      expectedRoiMin: '25',\n      expectedRoiMax: '40',\n      riskLevel: 'High' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-08-01'),\n      endDate: new Date('2025-04-01'),\n      investorCount: 89,\n    },\n    {\n      name: 'MindWell Digital',\n      description: 'FDA-cleared digital therapeutic for anxiety and depression',\n      longDescription: `MindWell Digital has developed the first FDA-cleared digital therapeutic specifically designed for treatment-resistant anxiety and depression.\n\nOur platform combines CBT, mindfulness, and AI-driven personalization to deliver clinically validated outcomes. In trials, 67% of patients showed significant symptom reduction within 8 weeks.\n\nWith 1 in 5 adults experiencing mental health conditions, and a severe shortage of therapists, MindWell addresses a critical unmet need.`,\n      category: 'Digital Health' as const,\n      fundingGoal: '3000000',\n      fundingCurrent: '2100000',\n      minimumInvestment: '1000',\n      expectedRoiMin: '12',\n      expectedRoiMax: '18',\n      riskLevel: 'Low' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-11-01'),\n      endDate: new Date('2025-05-01'),\n      investorCount: 428,\n    },\n    {\n      name: 'PharmaFlow Analytics',\n      description: 'AI platform optimizing pharmaceutical supply chains',\n      longDescription: `PharmaFlow Analytics uses machine learning to predict and prevent drug shortages before they impact patient care.\n\nOur platform integrates with hospital systems, distributors, and manufacturers to provide real-time visibility across the entire pharmaceutical supply chain.\n\nDrug shortages cost the US healthcare system $230M annually in labor costs alone. PharmaFlow has already partnered with 3 of the top 10 hospital systems.`,\n      category: 'Pharmaceuticals' as const,\n      fundingGoal: '4000000',\n      fundingCurrent: '1200000',\n      minimumInvestment: '2000',\n      expectedRoiMin: '14',\n      expectedRoiMax: '20',\n      riskLevel: 'Medium' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-12-01'),\n      endDate: new Date('2025-06-01'),\n      investorCount: 67,\n    },\n    {\n      name: 'BioScan Wearable',\n      description: 'Non-invasive glucose monitoring smartwatch',\n      longDescription: `BioScan has achieved a breakthrough in non-invasive glucose monitoring, eliminating the need for painful finger pricks for the 37 million Americans with diabetes.\n\nOur proprietary optical sensor technology achieves clinical-grade accuracy through the skin, with readings every 5 minutes synced to a companion app.\n\nThe continuous glucose monitoring market is growing at 15% CAGR and expected to reach $15B by 2030.`,\n      category: 'Medical Devices' as const,\n      fundingGoal: '6000000',\n      fundingCurrent: '4800000',\n      minimumInvestment: '2500',\n      expectedRoiMin: '20',\n      expectedRoiMax: '30',\n      riskLevel: 'Medium' as const,\n      status: 'active' as const,\n      startDate: new Date('2024-07-01'),\n      endDate: new Date('2025-01-31'),\n      investorCount: 234,\n    },\n  ];\n\n  const insertedInvestments = await db\n    .insert(investments)\n    .values(investmentData)\n    .returning();\n  console.log(`  Inserted ${insertedInvestments.length} investments`);\n\n  // Seed team members for first investment\n  const teamMembersData = [\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'Dr. Sarah Chen',\n      role: 'CEO & Co-Founder',\n      sortOrder: 0,\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'Dr. Michael Roberts',\n      role: 'Chief Medical Officer',\n      sortOrder: 1,\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'Jennifer Walsh',\n      role: 'VP of Engineering',\n      sortOrder: 2,\n    },\n    {\n      investmentId: insertedInvestments[1].id,\n      name: 'Dr. James Liu',\n      role: 'Founder & CEO',\n      sortOrder: 0,\n    },\n    {\n      investmentId: insertedInvestments[1].id,\n      name: 'Dr. Emily Park',\n      role: 'Chief Science Officer',\n      sortOrder: 1,\n    },\n  ];\n\n  await db.insert(investmentTeamMembers).values(teamMembersData);\n  console.log(`  Inserted ${teamMembersData.length} team members`);\n\n  // Seed milestones\n  const milestonesData = [\n    {\n      investmentId: insertedInvestments[0].id,\n      title: 'FDA 510(k) Clearance',\n      description: 'Received FDA clearance for diagnostic platform',\n      completed: true,\n      completedAt: new Date('2024-06-15'),\n      sortOrder: 0,\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      title: 'Series A Funding',\n      description: 'Closed $5M Series A round',\n      completed: true,\n      completedAt: new Date('2024-09-01'),\n      sortOrder: 1,\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      title: 'First Hospital Partnership',\n      description: 'Launch pilot program with major health system',\n      completed: false,\n      targetDate: new Date('2025-02-01'),\n      sortOrder: 2,\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      title: 'Commercial Launch',\n      description: 'Full commercial availability',\n      completed: false,\n      targetDate: new Date('2025-06-01'),\n      sortOrder: 3,\n    },\n  ];\n\n  await db.insert(investmentMilestones).values(milestonesData);\n  console.log(`  Inserted ${milestonesData.length} milestones`);\n\n  // Seed documents\n  const documentsData = [\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'Investment Prospectus',\n      type: 'pdf',\n      url: '/documents/neurolink-prospectus.pdf',\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'Financial Projections',\n      type: 'xlsx',\n      url: '/documents/neurolink-financials.xlsx',\n    },\n    {\n      investmentId: insertedInvestments[0].id,\n      name: 'FDA Clearance Letter',\n      type: 'pdf',\n      url: '/documents/neurolink-fda.pdf',\n    },\n  ];\n\n  await db.insert(investmentDocuments).values(documentsData);\n  console.log(`  Inserted ${documentsData.length} documents`);\n\n  // Seed articles\n  const articlesData = [\n    {\n      title: 'AI in Healthcare: The Next Frontier of Diagnostics',\n      summary: 'How artificial intelligence is transforming early disease detection and what it means for investors.',\n      content: `Artificial intelligence is revolutionizing healthcare diagnostics, offering unprecedented accuracy and speed in detecting diseases from cancer to cardiovascular conditions.\n\nThe global AI in healthcare market is projected to reach $45.2 billion by 2026, growing at a CAGR of 44.9%. This explosive growth is driven by advances in machine learning, increased healthcare data availability, and the pressing need for more efficient diagnostic tools.\n\nKey areas of innovation include:\n- Medical imaging analysis\n- Predictive analytics for disease risk\n- Drug discovery optimization\n- Personalized treatment recommendations\n\nFor investors, this represents a significant opportunity to participate in technologies that not only generate returns but also meaningfully improve patient outcomes.`,\n      source: 'MedInvest Research',\n      author: 'Dr. Rachel Martinez',\n      category: 'AI & Healthcare' as const,\n      tags: JSON.stringify(['AI', 'Diagnostics', 'Investment']),\n      readTime: 8,\n      isFeatured: true,\n      publishedAt: new Date('2025-01-10'),\n    },\n    {\n      title: 'Gene Therapy Breakthroughs: A New Era in Medicine',\n      summary: 'Recent advances in CRISPR and gene editing are opening new treatment possibilities for previously incurable diseases.',\n      content: `The past year has seen remarkable progress in gene therapy, with several new treatments receiving regulatory approval and dozens more in late-stage clinical trials.\n\nCRISPR technology continues to mature, with improved precision and reduced off-target effects making it increasingly viable for therapeutic applications.\n\nNotable developments include successful trials for sickle cell disease, beta-thalassemia, and certain forms of inherited blindness.`,\n      source: 'Nature Biotechnology',\n      author: 'Dr. James Wilson',\n      category: 'Biotech' as const,\n      tags: JSON.stringify(['Gene Therapy', 'CRISPR', 'Biotech']),\n      readTime: 12,\n      isFeatured: false,\n      publishedAt: new Date('2025-01-08'),\n    },\n    {\n      title: 'Digital Health Funding Hits Record Highs',\n      summary: 'Investment in digital health companies reached $29.1 billion in 2024, signaling continued confidence in the sector.',\n      content: `Digital health investment continues its upward trajectory, with 2024 seeing record funding levels despite broader market uncertainties.\n\nKey areas attracting capital include telehealth platforms, remote patient monitoring, digital therapeutics, and AI-powered clinical decision support tools.\n\nThe pandemic-driven acceleration of digital health adoption has proven durable, with both patients and providers embracing virtual care models.`,\n      source: 'Rock Health',\n      category: 'Digital Health' as const,\n      tags: JSON.stringify(['Funding', 'Digital Health', 'Telehealth']),\n      readTime: 6,\n      isFeatured: false,\n      publishedAt: new Date('2025-01-05'),\n    },\n    {\n      title: 'FDA Approvals: What\\'s Coming in 2025',\n      summary: 'A look at the most anticipated drug and device approvals expected this year.',\n      content: `The FDA\\'s approval calendar for 2025 includes several potentially transformative therapies across oncology, rare diseases, and cardiovascular health.\n\nAnalysts are particularly watching late-stage trials for novel cancer immunotherapies and the first wave of AI-powered diagnostic devices seeking clearance.`,\n      source: 'FDA Weekly',\n      category: 'Regulations' as const,\n      tags: JSON.stringify(['FDA', 'Approvals', 'Regulatory']),\n      readTime: 10,\n      isFeatured: false,\n      publishedAt: new Date('2025-01-03'),\n    },\n    {\n      title: 'Medical Device Innovation: Trends to Watch',\n      summary: 'From wearables to surgical robots, the medical device industry is undergoing rapid transformation.',\n      content: `The medical device sector is experiencing a wave of innovation driven by advances in materials science, miniaturization, and artificial intelligence.\n\nWearable devices are moving beyond fitness tracking to clinical-grade monitoring, while surgical robotics are becoming more precise and accessible.\n\nKey trends include the rise of combination products, increased focus on cybersecurity, and growing adoption of 3D printing for custom implants.`,\n      source: 'MedTech Dive',\n      category: 'Medical Devices' as const,\n      tags: JSON.stringify(['Medical Devices', 'Wearables', 'Innovation']),\n      readTime: 7,\n      isFeatured: true,\n      publishedAt: new Date('2024-12-28'),\n    },\n    {\n      title: 'The Rise of Precision Medicine',\n      summary: 'How genomics and data analytics are enabling truly personalized healthcare.',\n      content: `Precision medicine is moving from concept to clinical reality, with treatments increasingly tailored to individual genetic profiles.\n\nThe cost of genome sequencing has dropped dramatically, making it feasible to incorporate genetic information into routine medical decisions.\n\nThis shift has profound implications for drug development, clinical trial design, and healthcare delivery models.`,\n      source: 'Genomics Today',\n      category: 'Research' as const,\n      tags: JSON.stringify(['Precision Medicine', 'Genomics', 'Personalized Healthcare']),\n      readTime: 9,\n      isFeatured: false,\n      publishedAt: new Date('2024-12-20'),\n    },\n  ];\n\n  await db.insert(articles).values(articlesData);\n  console.log(`  Inserted ${articlesData.length} articles`);\n\n  console.log('‚úÖ Seeding complete!');\n}\n\n// Run seed if called directly\nseed().catch(console.error);\n","path":null,"size_bytes":15106,"size_tokens":null},"client/screens/DeleteAccountScreen.tsx":{"content":"/**\n * DeleteAccount Screen\n * Permanent account deletion (App Store requirement)\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  ActivityIndicator,\n  Alert,\n  ScrollView,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { authApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\n\nexport default function DeleteAccountScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { user, logout } = useAuth();\n\n  const [password, setPassword] = useState('');\n  const [confirmText, setConfirmText] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [understoodConsequences, setUnderstoodConsequences] = useState(false);\n\n  const CONFIRM_PHRASE = 'DELETE MY ACCOUNT';\n  const isConfirmValid = confirmText === CONFIRM_PHRASE;\n  const canDelete = password.length > 0 && isConfirmValid && understoodConsequences;\n\n  const deleteAccountMutation = useMutation({\n    mutationFn: async () => {\n      const response = await authApi.deleteAccount(password);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to delete account');\n      }\n      return response.data;\n    },\n    onSuccess: async () => {\n      await logout();\n      Alert.alert(\n        'Account Deleted',\n        'Your account has been permanently deleted. We\\'re sorry to see you go.',\n        [{ text: 'OK' }]\n      );\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const handleDelete = useCallback(() => {\n    if (!canDelete) return;\n\n    Alert.alert(\n      'Final Confirmation',\n      'This action cannot be undone. Are you absolutely sure you want to delete your account?',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Delete Forever',\n          style: 'destructive',\n          onPress: () => deleteAccountMutation.mutate(),\n        },\n      ]\n    );\n  }, [canDelete, deleteAccountMutation]);\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.error }]}>Delete Account</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Warning Banner */}\n        <View style={[styles.warningBanner, { borderColor: appColors.error + '30' }]}>\n          <Ionicons name=\"warning\" size={32} color={appColors.error} />\n          <ThemedText style={[styles.warningTitle, { color: appColors.error }]}>This action is permanent</ThemedText>\n          <ThemedText style={[styles.warningText, { color: appColors.textSecondary }]}>\n            Deleting your account will permanently remove all your data. This cannot be undone.\n          </ThemedText>\n        </View>\n\n        {/* What will be deleted */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>What will be deleted:</ThemedText>\n          <View style={styles.deleteList}>\n            {[\n              'Your profile and all personal information',\n              'All posts, comments, and reactions',\n              'Your message history',\n              'Investment interest submissions',\n              'Achievements, points, and leaderboard ranking',\n              'Premium subscription (no refund)',\n              'All bookmarks and saved content',\n            ].map((item, index) => (\n              <View key={index} style={styles.deleteItem}>\n                <Ionicons name=\"close-circle\" size={16} color={appColors.error} />\n                <ThemedText style={[styles.deleteItemText, { color: appColors.textSecondary }]}>{item}</ThemedText>\n              </View>\n            ))}\n          </View>\n        </View>\n\n        {/* Alternatives */}\n        <View style={[styles.alternativeSection, { backgroundColor: appColors.surface }]}>\n          <ThemedText style={[styles.alternativeTitle, { color: appColors.textPrimary }]}>\n            Before you go, consider these alternatives:\n          </ThemedText>\n          <TouchableOpacity style={[styles.alternativeItem, { borderBottomColor: appColors.border }]}>\n            <Ionicons name=\"pause-circle-outline\" size={24} color={Colors.primary} />\n            <View style={styles.alternativeContent}>\n              <ThemedText style={styles.alternativeItemTitle}>Deactivate instead</ThemedText>\n              <ThemedText style={[styles.alternativeItemText, { color: appColors.textSecondary }]}>\n                Temporarily hide your profile without deleting data\n              </ThemedText>\n            </View>\n            <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n          </TouchableOpacity>\n          <TouchableOpacity \n            style={[styles.alternativeItem, { borderBottomColor: appColors.border }]}\n            onPress={() => navigation.navigate('Settings')}\n          >\n            <Ionicons name=\"notifications-off-outline\" size={24} color={Colors.primary} />\n            <View style={styles.alternativeContent}>\n              <ThemedText style={styles.alternativeItemTitle}>Adjust notifications</ThemedText>\n              <ThemedText style={[styles.alternativeItemText, { color: appColors.textSecondary }]}>\n                Reduce emails and push notifications\n              </ThemedText>\n            </View>\n            <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Confirmation Section */}\n        <View style={styles.confirmSection}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Confirm Deletion</ThemedText>\n\n          <TouchableOpacity\n            style={styles.checkboxRow}\n            onPress={() => setUnderstoodConsequences(!understoodConsequences)}\n          >\n            <View style={[styles.checkbox, { borderColor: appColors.border }, understoodConsequences && [styles.checkboxChecked, { backgroundColor: appColors.error, borderColor: appColors.error }]]}>\n              {understoodConsequences && (\n                <Ionicons name=\"checkmark\" size={16} color=\"white\" />\n              )}\n            </View>\n            <ThemedText style={[styles.checkboxText, { color: appColors.textPrimary }]}>\n              I understand that deleting my account is permanent and cannot be undone\n            </ThemedText>\n          </TouchableOpacity>\n\n          <ThemedText style={[styles.inputLabel, { color: appColors.textSecondary }]}>Enter your password</ThemedText>\n          <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <TextInput\n              style={[styles.input, { color: appColors.textPrimary }]}\n              placeholder=\"Password\"\n              placeholderTextColor={appColors.textSecondary}\n              value={password}\n              onChangeText={setPassword}\n              secureTextEntry={!showPassword}\n              autoCapitalize=\"none\"\n            />\n            <TouchableOpacity\n              style={styles.eyeButton}\n              onPress={() => setShowPassword(!showPassword)}\n            >\n              <Ionicons\n                name={showPassword ? 'eye-off-outline' : 'eye-outline'}\n                size={20}\n                color={appColors.textSecondary}\n              />\n            </TouchableOpacity>\n          </View>\n\n          <ThemedText style={[styles.inputLabel, { color: appColors.textSecondary }]}>\n            Type <ThemedText style={[styles.confirmPhrase, { color: appColors.error }]}>{CONFIRM_PHRASE}</ThemedText> to confirm\n          </ThemedText>\n          <TextInput\n            style={[styles.input, styles.confirmInput, { color: appColors.textPrimary, backgroundColor: appColors.surface, borderColor: appColors.border }]}\n            placeholder={CONFIRM_PHRASE}\n            placeholderTextColor={appColors.textSecondary}\n            value={confirmText}\n            onChangeText={setConfirmText}\n            autoCapitalize=\"characters\"\n          />\n          {confirmText.length > 0 && !isConfirmValid && (\n            <ThemedText style={[styles.errorText, { color: appColors.error }]}>\n              Please type exactly: {CONFIRM_PHRASE}\n            </ThemedText>\n          )}\n        </View>\n\n        {/* Delete Button */}\n        <TouchableOpacity\n          style={[styles.deleteButton, { backgroundColor: appColors.error }, !canDelete && [styles.deleteButtonDisabled, { backgroundColor: appColors.textSecondary }]]}\n          onPress={handleDelete}\n          disabled={!canDelete || deleteAccountMutation.isPending}\n        >\n          {deleteAccountMutation.isPending ? (\n            <ActivityIndicator color=\"white\" />\n          ) : (\n            <>\n              <Ionicons name=\"trash-outline\" size={20} color=\"white\" />\n              <ThemedText style={styles.deleteButtonText}>Delete My Account Forever</ThemedText>\n            </>\n          )}\n        </TouchableOpacity>\n\n        {/* Cancel */}\n        <TouchableOpacity style={styles.cancelButton} onPress={() => navigation.goBack()}>\n          <ThemedText style={[styles.cancelButtonText, { color: appColors.textSecondary }]}>Cancel</ThemedText>\n        </TouchableOpacity>\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  content: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  warningBanner: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n    borderWidth: 1,\n  },\n  warningTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.sm,\n  },\n  warningText: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n  },\n  deleteList: {\n    gap: Spacing.sm,\n  },\n  deleteItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    gap: Spacing.sm,\n  },\n  deleteItemText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  alternativeSection: {\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  alternativeTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n  },\n  alternativeItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n    gap: Spacing.md,\n  },\n  alternativeContent: {\n    flex: 1,\n  },\n  alternativeItemTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: Colors.primary,\n  },\n  alternativeItemText: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  confirmSection: {\n    marginBottom: Spacing.xl,\n  },\n  checkboxRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.xl,\n    gap: Spacing.md,\n  },\n  checkbox: {\n    width: 24,\n    height: 24,\n    borderRadius: 4,\n    borderWidth: 2,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  checkboxChecked: {},\n  checkboxText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  inputLabel: {\n    ...Typography.caption,\n    marginBottom: Spacing.sm,\n  },\n  confirmPhrase: {\n    fontWeight: '700',\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    marginBottom: Spacing.lg,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    padding: Spacing.md,\n  },\n  confirmInput: {\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n  },\n  eyeButton: {\n    padding: Spacing.md,\n  },\n  errorText: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  deleteButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n    marginBottom: Spacing.md,\n  },\n  deleteButtonDisabled: {\n    opacity: 0.5,\n  },\n  deleteButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  cancelButton: {\n    alignItems: 'center',\n    paddingVertical: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  cancelButtonText: {\n    ...Typography.body,\n  },\n});\n","path":null,"size_bytes":13542,"size_tokens":null},"docs/FEATURE_PARITY.md":{"content":"# MedInvest Feature Parity: Web vs Mobile\n\n## Overview\n\nThis document tracks feature parity between the MedInvest web application and React Native mobile app. It helps identify gaps, prioritize development, and ensure consistent user experience across platforms.\n\n**Last Updated**: January 2026\n\n---\n\n## Legend\n\n| Symbol | Meaning |\n|--------|---------|\n| ‚úÖ | Fully implemented |\n| üöß | In progress / Partial |\n| ‚ùå | Not implemented |\n| N/A | Not applicable to platform |\n\n---\n\n## Authentication & Onboarding\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Email/Password Login | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Email/Password Registration | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Google OAuth | ‚úÖ | ‚úÖ | ‚úÖ | Uses expo-auth-session |\n| GitHub OAuth | ‚úÖ | ‚úÖ | ‚úÖ | Token exchange via backend |\n| Apple Sign-In | N/A | ‚úÖ | ‚úÖ | iOS only via expo-apple-authentication |\n| Facebook OAuth | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Password Reset | ‚úÖ | üöß | ‚úÖ | ForgotPasswordScreen exists |\n| Email Verification | ‚úÖ | üöß | ‚úÖ | VerifyEmailScreen exists |\n| Biometric Login | N/A | ‚úÖ | N/A | FaceID/TouchID via expo-local-authentication |\n| Session Persistence | ‚úÖ | ‚úÖ | ‚úÖ | JWT tokens |\n| Logout | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Logout All Devices | ‚úÖ | üöß | ‚úÖ | API exists |\n| Onboarding Flow | ‚úÖ | ‚úÖ | N/A | OnboardingScreen |\n\n---\n\n## Main Navigation\n\n| Feature | Web | Mobile | Notes |\n|---------|-----|--------|-------|\n| Discover Tab | ‚úÖ | ‚úÖ | Investment opportunities feed |\n| Portfolio Tab | ‚úÖ | ‚úÖ | User's investments |\n| Research Tab | ‚úÖ | ‚úÖ | Articles and news |\n| Profile Tab | ‚úÖ | ‚úÖ | User profile and settings |\n| Notifications Tab | ‚úÖ | ‚úÖ | Alerts for all notification types |\n| Floating Invest Button | N/A | ‚úÖ | Mobile FAB for quick investment |\n\n---\n\n## Investment Discovery\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Browse Investments | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Investment Categories | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Search Investments | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Investment Detail View | ‚úÖ | ‚úÖ | ‚úÖ | InvestmentDetailScreen |\n| Filter by Category | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Sort Options | ‚úÖ | üöß | ‚úÖ | |\n| Watchlist | ‚úÖ | üöß | ‚úÖ | |\n| Express Interest | ‚úÖ | ‚úÖ | ‚úÖ | InvestModalScreen |\n\n---\n\n## Portfolio Management\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Portfolio Summary | ‚úÖ | ‚úÖ | ‚úÖ | Total value, returns |\n| Investment List | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Investment Performance | ‚úÖ | ‚úÖ | ‚úÖ | Charts and metrics |\n| Transaction History | ‚úÖ | üöß | ‚úÖ | TransactionHistoryScreen exists |\n| Make Investment | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Dividend Tracking | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Research & Articles\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Article Feed | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Article Categories | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Article Detail | ‚úÖ | ‚úÖ | ‚úÖ | ArticleDetailScreen |\n| Bookmark Articles | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Bookmarked Articles List | ‚úÖ | ‚úÖ | ‚úÖ | BookmarkedArticlesScreen |\n| Search Articles | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Social Features\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| User Profile View | ‚úÖ | ‚úÖ | ‚úÖ | UserProfileScreen |\n| Edit Profile | ‚úÖ | ‚úÖ | ‚úÖ | EditProfileScreen |\n| Avatar Upload | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Follow Users | ‚úÖ | üöß | ‚úÖ | |\n| Followers/Following List | ‚úÖ | üöß | ‚úÖ | FollowersScreen exists |\n| Block Users | ‚úÖ | üöß | ‚úÖ | BlockedUsersScreen exists |\n\n---\n\n## Posts & Feed\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Create Post | ‚úÖ | üöß | ‚úÖ | CreatePostScreen exists |\n| Edit Post | ‚úÖ | üöß | ‚úÖ | EditPostScreen exists |\n| Delete Post | ‚úÖ | üöß | ‚úÖ | |\n| Post Detail | ‚úÖ | üöß | ‚úÖ | PostDetailScreen exists |\n| Like/React | ‚úÖ | üöß | ‚úÖ | |\n| Comments | ‚úÖ | üöß | ‚úÖ | |\n| Share Post | ‚úÖ | üöß | ‚úÖ | |\n| Bookmark Post | ‚úÖ | üöß | ‚úÖ | BookmarksScreen exists |\n| Hashtags | ‚úÖ | üöß | ‚úÖ | HashtagScreen exists |\n| Drafts | ‚úÖ | üöß | ‚úÖ | DraftsScreen exists |\n\n---\n\n## Rooms (Healthcare Specialty Communities)\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Browse Rooms | ‚úÖ | üöß | ‚úÖ | RoomsScreen exists |\n| Room Detail | ‚úÖ | üöß | ‚úÖ | RoomDetailScreen exists |\n| Join/Leave Room | ‚úÖ | üöß | ‚úÖ | |\n| Room Posts | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Messaging\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Conversations List | ‚úÖ | ‚úÖ | ‚úÖ | MessagesScreen |\n| Direct Messages | ‚úÖ | ‚úÖ | ‚úÖ | ConversationScreen |\n| New Conversation | ‚úÖ | ‚úÖ | ‚úÖ | NewConversationScreen |\n| Unread Count | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Voice Calls | ‚úÖ | üöß | ‚úÖ | VoiceCallScreen exists |\n| Video Calls | ‚úÖ | üöß | ‚úÖ | |\n| Typing Indicators | ‚úÖ | üöß | ‚úÖ | WebSocket |\n| Read Receipts | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Notifications\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Notifications List | ‚úÖ | ‚úÖ | ‚úÖ | NotificationsScreen |\n| Mark as Read | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Mark All as Read | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Filter by Type | ‚úÖ | ‚úÖ | N/A | All/Unread/Mentions |\n| Push Notifications | N/A | üöß | ‚úÖ | expo-notifications |\n| Notification Settings | ‚úÖ | ‚úÖ | ‚úÖ | NotificationSettingsScreen |\n| **Notification Types** |\n| Like | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Comment | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Follow | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Mention | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Reply | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Message | ‚úÖ | ‚úÖ | ‚úÖ | |\n| AMA Live | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Deal Update | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Achievement | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Friend Request | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Friend Accepted | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Investment Update | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Course Update | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Event Reminder | ‚úÖ | ‚úÖ | ‚úÖ | |\n| System | ‚úÖ | ‚úÖ | ‚úÖ | |\n\n---\n\n## Deals & Investment Opportunities\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Deals List | ‚úÖ | üöß | ‚úÖ | DealsScreen exists |\n| Deal Detail | ‚úÖ | üöß | ‚úÖ | DealDetailScreen exists |\n| Filter Deals | ‚úÖ | üöß | ‚úÖ | |\n| Watch Deal | ‚úÖ | üöß | ‚úÖ | |\n| Invest in Deal | ‚úÖ | ‚úÖ | ‚úÖ | InvestModalScreen |\n\n---\n\n## Courses & Learning\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Course List | ‚úÖ | üöß | ‚úÖ | |\n| Course Detail | ‚úÖ | üöß | ‚úÖ | CourseDetailScreen exists |\n| Lesson Player | ‚úÖ | üöß | ‚úÖ | LessonPlayerScreen exists |\n| Progress Tracking | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Events & AMAs\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Event List | ‚úÖ | üöß | ‚úÖ | |\n| Event Detail | ‚úÖ | üöß | ‚úÖ | EventDetailScreen exists |\n| AMA Sessions | ‚úÖ | üöß | ‚úÖ | AMADetailScreen exists |\n| RSVP to Event | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Gamification\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Achievements | ‚úÖ | üöß | ‚úÖ | AchievementsScreen exists |\n| Leaderboard | ‚úÖ | üöß | ‚úÖ | LeaderboardScreen exists |\n| Points System | ‚úÖ | üöß | ‚úÖ | |\n| Badges | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## AI Features\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| AI Chat Assistant | ‚úÖ | üöß | ‚úÖ | AIChatScreen exists |\n| Deal Analysis | ‚úÖ | üöß | ‚úÖ | OpenAI integration |\n| Content Moderation | ‚úÖ | ‚úÖ | ‚úÖ | |\n| Search Enhancement | ‚úÖ | üöß | ‚úÖ | |\n| Recommendations | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Settings\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Settings Menu | ‚úÖ | ‚úÖ | N/A | SettingsScreen |\n| Edit Profile | ‚úÖ | ‚úÖ | ‚úÖ | EditProfileScreen |\n| Change Password | ‚úÖ | üöß | ‚úÖ | ChangePasswordScreen exists |\n| Notification Preferences | ‚úÖ | ‚úÖ | ‚úÖ | NotificationsSettingsScreen |\n| Appearance/Theme | ‚úÖ | üöß | N/A | AppearanceSettingsScreen exists |\n| Biometric Settings | N/A | üöß | N/A | BiometricSettingsScreen exists |\n| Content Preferences | ‚úÖ | üöß | ‚úÖ | ContentPreferencesScreen exists |\n| Privacy Policy | ‚úÖ | üöß | N/A | PrivacyPolicyScreen exists |\n| Terms of Service | ‚úÖ | üöß | N/A | TermsOfServiceScreen exists |\n| Delete Account | ‚úÖ | üöß | ‚úÖ | DeleteAccountScreen exists |\n| Data Export | ‚úÖ | üöß | ‚úÖ | DataExportScreen exists |\n| Payment Methods | ‚úÖ | üöß | ‚úÖ | PaymentMethodsScreen exists |\n| Documents | ‚úÖ | üöß | ‚úÖ | DocumentsScreen exists |\n| Support | ‚úÖ | üöß | ‚úÖ | SupportScreen exists |\n| Legal | ‚úÖ | üöß | N/A | LegalScreen exists |\n\n---\n\n## Premium/Subscription\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Premium Features | ‚úÖ | üöß | ‚úÖ | PremiumScreen exists |\n| Subscription Management | ‚úÖ | üöß | ‚úÖ | |\n| In-App Purchase | N/A | üöß | N/A | Requires native build |\n\n---\n\n## Search\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Global Search | ‚úÖ | üöß | ‚úÖ | SearchScreen exists |\n| Search History | ‚úÖ | üöß | ‚úÖ | SavedSearchesScreen exists |\n| Filter Results | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Reporting\n\n| Feature | Web | Mobile | API | Notes |\n|---------|-----|--------|-----|-------|\n| Report Content | ‚úÖ | üöß | ‚úÖ | ReportScreen exists |\n| Report User | ‚úÖ | üöß | ‚úÖ | |\n\n---\n\n## Platform-Specific Features\n\n### Mobile Only\n\n| Feature | Status | Notes |\n|---------|--------|-------|\n| Biometric Authentication | ‚úÖ | FaceID/TouchID |\n| Push Notifications | üöß | expo-notifications |\n| Haptic Feedback | ‚úÖ | expo-haptics |\n| Pull to Refresh | ‚úÖ | Native gesture |\n| Swipe Navigation | ‚úÖ | React Navigation |\n| Camera Access | ‚úÖ | expo-camera/image-picker |\n| Offline Support | üöß | AsyncStorage caching |\n| Deep Linking | üöß | Expo linking |\n\n### Web Only\n\n| Feature | Status | Notes |\n|---------|--------|-------|\n| Keyboard Shortcuts | ‚úÖ | |\n| Browser Notifications | üöß | |\n| Desktop Layout | ‚úÖ | Responsive design |\n| Print Support | ‚úÖ | |\n\n---\n\n## API Coverage\n\nAll API endpoints are available for both web and mobile:\n\n| Route Group | Endpoints | Mobile Integration |\n|-------------|-----------|-------------------|\n| `/api/auth/*` | 9 endpoints | ‚úÖ Fully integrated |\n| `/api/users/*` | 10 endpoints | ‚úÖ Fully integrated |\n| `/api/investments/*` | 4 endpoints | ‚úÖ Fully integrated |\n| `/api/portfolio/*` | 4 endpoints | ‚úÖ Fully integrated |\n| `/api/articles/*` | 5 endpoints | ‚úÖ Fully integrated |\n| `/api/messages/*` | 5 endpoints | ‚úÖ Fully integrated |\n| `/api/ai/*` | 6 endpoints | üöß Partial integration |\n\n---\n\n## Priority Gaps to Address\n\n### High Priority (Core User Journey)\n\n1. **Push Notifications** - Critical for engagement\n2. **Offline Support** - Essential for mobile UX\n3. **Deep Linking** - Required for notification tap handling\n\n### Medium Priority (Feature Completion)\n\n1. **Posts & Feed** - Connect existing screens to API\n2. **Rooms** - Connect RoomsScreen to API\n3. **AI Chat** - Connect AIChatScreen to backend\n4. **Deals** - Connect DealsScreen to API\n\n### Low Priority (Polish)\n\n1. **Settings screens** - Connect remaining settings to API\n2. **Gamification** - Connect achievements/leaderboard\n3. **Courses** - Connect learning features\n\n---\n\n## Sync Architecture\n\nBoth platforms use:\n- **Shared Types**: `@medinvest/shared` package\n- **Shared Validators**: Zod schemas for form/API validation\n- **Shared Utilities**: Date formatting, number formatting, text parsing\n- **Common API Client**: Platform-specific token storage, unified request handling\n\nSee `docs/SYNC_ARCHITECTURE.md` for detailed implementation.\n\n---\n\n## Testing Matrix\n\nSee `docs/TESTING_CHECKLIST.md` for comprehensive test cases covering all features.\n","path":null,"size_bytes":11907,"size_tokens":null},"client/screens/NotificationsScreen.tsx":{"content":"/**\n * Notifications Screen\n * Shows all user notifications with filtering\n */\n\nimport React, { useCallback, useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  RefreshControl,\n  Image,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { notificationsApi } from '@/lib/api';\nimport { Notification, NotificationType } from '@/types';\nimport { formatRelativeTime } from '@/lib/utils';\n\nconst NOTIFICATION_ICONS: Record<NotificationType, { name: string; color: string }> = {\n  like: { name: 'heart', color: '#EF4444' },\n  comment: { name: 'chatbubble', color: '#3B82F6' },\n  follow: { name: 'person-add', color: '#8B5CF6' },\n  mention: { name: 'at', color: '#10B981' },\n  reply: { name: 'arrow-undo', color: '#F59E0B' },\n  message: { name: 'mail', color: '#06B6D4' },\n  ama_live: { name: 'mic', color: '#EC4899' },\n  deal_update: { name: 'trending-up', color: '#22C55E' },\n  achievement: { name: 'trophy', color: '#F97316' },\n  friend_request: { name: 'people', color: '#8B5CF6' },\n  friend_accepted: { name: 'checkmark-circle', color: '#22C55E' },\n  investment_update: { name: 'cash', color: '#00A86B' },\n  course_update: { name: 'school', color: '#3B82F6' },\n  event_reminder: { name: 'calendar', color: '#F59E0B' },\n  system: { name: 'information-circle', color: '#6B7280' },\n};\n\ntype FilterType = 'all' | 'unread' | 'mentions';\n\nexport default function NotificationsScreen() {\n  const navigation = useNavigation<any>();\n  const queryClient = useQueryClient();\n  const [filter, setFilter] = useState<FilterType>('all');\n  const appColors = useAppColors();\n\n  const {\n    data: notificationsData,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['notifications'],\n    queryFn: async () => {\n      const response = await notificationsApi.getNotifications();\n      return response.data;\n    },\n  });\n\n  const notifications = notificationsData?.notifications || [];\n  const unreadCount = notificationsData?.unread_count || 0;\n\n  // Filter notifications\n  const filteredNotifications = notifications.filter(n => {\n    if (filter === 'unread') return !n.is_read;\n    if (filter === 'mentions') return n.type === 'mention';\n    return true;\n  });\n\n  // Mark as read mutation\n  const markAsReadMutation = useMutation({\n    mutationFn: (id: number) => notificationsApi.markAsRead(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['notifications'] });\n    },\n  });\n\n  // Mark all as read mutation\n  const markAllAsReadMutation = useMutation({\n    mutationFn: () => notificationsApi.markAllAsRead(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['notifications'] });\n    },\n  });\n\n  const handleNotificationPress = useCallback((notification: Notification) => {\n    // Mark as read\n    if (!notification.is_read) {\n      markAsReadMutation.mutate(notification.id);\n    }\n\n    // Navigate based on type\n    const { data } = notification;\n    switch (notification.type) {\n      case 'like':\n      case 'comment':\n      case 'mention':\n      case 'reply':\n        if (data?.post_id) {\n          navigation.navigate('PostDetail', { postId: data.post_id });\n        }\n        break;\n      case 'follow':\n        if (data?.user_id) {\n          navigation.navigate('UserProfile', { userId: data.user_id });\n        }\n        break;\n      case 'message':\n        if (data?.user_id) {\n          navigation.navigate('Conversation', { userId: data.user_id });\n        }\n        break;\n      case 'ama_live':\n        if (data?.ama_id) {\n          navigation.navigate('AMADetail', { amaId: data.ama_id });\n        }\n        break;\n      case 'deal_update':\n        if (data?.deal_id) {\n          navigation.navigate('DealDetail', { dealId: data.deal_id });\n        }\n        break;\n      case 'achievement':\n        navigation.navigate('Achievements');\n        break;\n      case 'friend_request':\n      case 'friend_accepted':\n        if (data?.user_id) {\n          navigation.navigate('UserProfile', { userId: data.user_id });\n        }\n        break;\n      case 'investment_update':\n        if (data?.deal_id) {\n          navigation.navigate('DealDetail', { dealId: data.deal_id });\n        } else {\n          navigation.getParent()?.navigate('PortfolioTab');\n        }\n        break;\n      case 'course_update':\n        if (data?.course_id) {\n          navigation.navigate('CourseDetail', { courseId: data.course_id });\n        }\n        break;\n      case 'event_reminder':\n        if (data?.event_id) {\n          navigation.navigate('EventDetail', { eventId: data.event_id });\n        }\n        break;\n      case 'system':\n        break;\n    }\n  }, [navigation, markAsReadMutation]);\n\n  const getNotificationIcon = (type: NotificationType) => {\n    const config = NOTIFICATION_ICONS[type] || { name: 'notifications', color: Colors.primary };\n    return (\n      <View style={[styles.iconContainer, { backgroundColor: config.color + '20' }]}>\n        <Ionicons name={config.name as any} size={20} color={config.color} />\n      </View>\n    );\n  };\n\n  const renderNotification = ({ item }: { item: Notification }) => (\n    <TouchableOpacity\n      style={[styles.notificationItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }, !item.is_read && styles.notificationUnread]}\n      onPress={() => handleNotificationPress(item)}\n    >\n      {getNotificationIcon(item.type)}\n      <View style={styles.notificationContent}>\n        <ThemedText style={[styles.notificationTitle, { color: appColors.textPrimary }]} numberOfLines={2}>\n          {item.title}\n        </ThemedText>\n        <ThemedText style={[styles.notificationBody, { color: appColors.textSecondary }]} numberOfLines={2}>\n          {item.body}\n        </ThemedText>\n        <ThemedText style={[styles.notificationTime, { color: appColors.textSecondary }]}>\n          {formatRelativeTime(item.created_at)}\n        </ThemedText>\n      </View>\n      {!item.is_read && <View style={styles.unreadDot} />}\n    </TouchableOpacity>\n  );\n\n  const renderHeader = () => (\n    <View style={[styles.filterContainer, { backgroundColor: appColors.surface }]}>\n      {(['all', 'unread', 'mentions'] as FilterType[]).map((f) => (\n        <TouchableOpacity\n          key={f}\n          style={[styles.filterButton, filter === f && styles.filterButtonActive]}\n          onPress={() => setFilter(f)}\n        >\n          <ThemedText style={[styles.filterText, { color: appColors.textSecondary }, filter === f && styles.filterTextActive]}>\n            {f.charAt(0).toUpperCase() + f.slice(1)}\n            {f === 'unread' && unreadCount > 0 && ` (${unreadCount})`}\n          </ThemedText>\n        </TouchableOpacity>\n      ))}\n    </View>\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"notifications-off-outline\" size={64} color={appColors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No notifications</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        {filter === 'unread' \n          ? \"You're all caught up!\"\n          : filter === 'mentions'\n          ? \"No one has mentioned you yet\"\n          : \"When you get notifications, they'll appear here\"}\n      </ThemedText>\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Notifications</ThemedText>\n        {unreadCount > 0 && (\n          <TouchableOpacity \n            style={styles.markAllButton}\n            onPress={() => markAllAsReadMutation.mutate()}\n          >\n            <ThemedText style={styles.markAllText}>Mark all read</ThemedText>\n          </TouchableOpacity>\n        )}\n      </View>\n\n      {/* Notifications List */}\n      <FlatList\n        data={filteredNotifications}\n        renderItem={renderNotification}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={filteredNotifications.length === 0 ? styles.emptyList : undefined}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n    marginRight: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.title,\n    flex: 1,\n  },\n  markAllButton: {\n    padding: Spacing.sm,\n  },\n  markAllText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  filterContainer: {\n    flexDirection: 'row',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n  },\n  filterButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  filterButtonActive: {\n    backgroundColor: Colors.primary + '15',\n  },\n  filterText: {\n    ...Typography.caption,\n  },\n  filterTextActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  notificationItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  notificationUnread: {\n    backgroundColor: Colors.primary + '05',\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  notificationContent: {\n    flex: 1,\n  },\n  notificationTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  notificationBody: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  notificationTime: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  unreadDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: Colors.primary,\n    marginLeft: Spacing.sm,\n    marginTop: Spacing.xs,\n  },\n  emptyList: {\n    flex: 1,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":11408,"size_tokens":null},";.ts":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, serial, integer, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\nexport const conversations = pgTable(\"conversations\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  conversationId: integer(\"conversation_id\").notNull().references(() => conversations.id, { onDelete: \"cascade\" }),\n  role: text(\"role\").notNull(),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const insertConversationSchema = createInsertSchema(conversations).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\n","path":null,"size_bytes":1659,"size_tokens":null},"client/components/MentionInput.tsx":{"content":"/**\n * Mention Autocomplete Component\n * @user suggestions while typing\n */\n\nimport React, { useState, useCallback, useEffect, useRef, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  Keyboard,\n  Platform,\n  TextInputProps,\n  NativeSyntheticEvent,\n  TextInputSelectionChangeEventData,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\nimport Animated, {\n  useAnimatedStyle,\n  withTiming,\n  useSharedValue,\n} from 'react-native-reanimated';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { usersApi } from '@/lib/api';\nimport { haptics } from '@/lib/haptics';\n\n// User suggestion type\ninterface UserSuggestion {\n  id: number;\n  full_name: string;\n  username?: string;\n  avatar_url?: string;\n  specialty?: string;\n}\n\ninterface MentionInputProps extends Omit<TextInputProps, 'onChangeText'> {\n  value: string;\n  onChangeText: (text: string) => void;\n  onMentionSelect?: (user: UserSuggestion) => void;\n  suggestionsPosition?: 'above' | 'below';\n  maxSuggestions?: number;\n}\n\nexport default function MentionInput({\n  value,\n  onChangeText,\n  onMentionSelect,\n  suggestionsPosition = 'above',\n  maxSuggestions = 5,\n  ...textInputProps\n}: MentionInputProps) {\n  const { colors } = useThemeContext();\n  const inputRef = useRef<TextInput>(null);\n  \n  const [mentionQuery, setMentionQuery] = useState<string | null>(null);\n  const [mentionStartIndex, setMentionStartIndex] = useState<number>(-1);\n  const [cursorPosition, setCursorPosition] = useState<number>(0);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  \n  const suggestionsHeight = useSharedValue(0);\n\n  // Search for users when mention query changes\n  const { data: suggestions = [], isLoading } = useQuery({\n    queryKey: ['mentionSuggestions', mentionQuery],\n    queryFn: async () => {\n      if (!mentionQuery || mentionQuery.length < 1) return [];\n      const response = await usersApi.search(mentionQuery);\n      return (response.data?.users || []).slice(0, maxSuggestions);\n    },\n    enabled: !!mentionQuery && mentionQuery.length >= 1,\n    staleTime: 30000,\n  });\n\n  // Detect @ mentions while typing\n  const detectMention = useCallback((text: string, cursor: number) => {\n    // Find the @ before cursor\n    let atIndex = -1;\n    for (let i = cursor - 1; i >= 0; i--) {\n      const char = text[i];\n      if (char === '@') {\n        atIndex = i;\n        break;\n      }\n      // Stop if we hit a space or newline (not part of mention)\n      if (char === ' ' || char === '\\n') {\n        break;\n      }\n    }\n\n    if (atIndex !== -1) {\n      const query = text.substring(atIndex + 1, cursor);\n      // Valid mention query (no spaces, reasonable length)\n      if (query.length <= 30 && !/\\s/.test(query)) {\n        setMentionQuery(query);\n        setMentionStartIndex(atIndex);\n        setShowSuggestions(true);\n        return;\n      }\n    }\n\n    // No valid mention found\n    setMentionQuery(null);\n    setMentionStartIndex(-1);\n    setShowSuggestions(false);\n  }, []);\n\n  // Handle text changes\n  const handleChangeText = useCallback((text: string) => {\n    onChangeText(text);\n    detectMention(text, cursorPosition);\n  }, [onChangeText, detectMention, cursorPosition]);\n\n  // Handle cursor position changes\n  const handleSelectionChange = useCallback((\n    event: NativeSyntheticEvent<TextInputSelectionChangeEventData>\n  ) => {\n    const { start } = event.nativeEvent.selection;\n    setCursorPosition(start);\n    detectMention(value, start);\n  }, [value, detectMention]);\n\n  // Handle selecting a mention\n  const handleSelectMention = useCallback((user: UserSuggestion) => {\n    haptics.selection();\n    \n    const username = user.username || user.full_name.toLowerCase().replace(/\\s+/g, '');\n    const beforeMention = value.substring(0, mentionStartIndex);\n    const afterMention = value.substring(cursorPosition);\n    const newText = `${beforeMention}@${username} ${afterMention}`;\n    \n    onChangeText(newText);\n    setShowSuggestions(false);\n    setMentionQuery(null);\n    \n    onMentionSelect?.(user);\n    \n    // Move cursor after the mention\n    const newCursorPosition = mentionStartIndex + username.length + 2; // +2 for @ and space\n    setTimeout(() => {\n      inputRef.current?.setNativeProps({\n        selection: { start: newCursorPosition, end: newCursorPosition },\n      });\n    }, 50);\n  }, [value, mentionStartIndex, cursorPosition, onChangeText, onMentionSelect]);\n\n  // Close suggestions when keyboard hides\n  useEffect(() => {\n    const hideListener = Keyboard.addListener('keyboardDidHide', () => {\n      setShowSuggestions(false);\n    });\n    return () => hideListener.remove();\n  }, []);\n\n  // Animate suggestions container\n  useEffect(() => {\n    const targetHeight = showSuggestions && suggestions.length > 0 \n      ? Math.min(suggestions.length * 56, 280) \n      : 0;\n    suggestionsHeight.value = withTiming(targetHeight, { duration: 200 });\n  }, [showSuggestions, suggestions.length]);\n\n  const animatedSuggestionsStyle = useAnimatedStyle(() => ({\n    height: suggestionsHeight.value,\n    opacity: suggestionsHeight.value > 0 ? 1 : 0,\n  }));\n\n  const renderSuggestion = useCallback(({ item }: { item: UserSuggestion }) => (\n    <MentionSuggestionItem\n      user={item}\n      onPress={() => handleSelectMention(item)}\n      colors={colors}\n    />\n  ), [handleSelectMention, colors]);\n\n  return (\n    <View style={styles.container}>\n      {/* Suggestions (above input) */}\n      {suggestionsPosition === 'above' && (\n        <Animated.View \n          style={[\n            styles.suggestionsContainer,\n            styles.suggestionsAbove,\n            { backgroundColor: colors.surface },\n            animatedSuggestionsStyle,\n          ]}\n        >\n          <FlatList\n            data={suggestions}\n            renderItem={renderSuggestion}\n            keyExtractor={(item) => item.id.toString()}\n            keyboardShouldPersistTaps=\"always\"\n            showsVerticalScrollIndicator={false}\n          />\n        </Animated.View>\n      )}\n\n      {/* Text Input */}\n      <TextInput\n        ref={inputRef}\n        value={value}\n        onChangeText={handleChangeText}\n        onSelectionChange={handleSelectionChange}\n        style={[\n          styles.input,\n          { color: colors.textPrimary },\n          textInputProps.style,\n        ]}\n        placeholderTextColor={colors.textSecondary}\n        {...textInputProps}\n      />\n\n      {/* Suggestions (below input) */}\n      {suggestionsPosition === 'below' && (\n        <Animated.View \n          style={[\n            styles.suggestionsContainer,\n            styles.suggestionsBelow,\n            { backgroundColor: colors.surface },\n            animatedSuggestionsStyle,\n          ]}\n        >\n          <FlatList\n            data={suggestions}\n            renderItem={renderSuggestion}\n            keyExtractor={(item) => item.id.toString()}\n            keyboardShouldPersistTaps=\"always\"\n            showsVerticalScrollIndicator={false}\n          />\n        </Animated.View>\n      )}\n    </View>\n  );\n}\n\n// Individual suggestion item\ninterface MentionSuggestionItemProps {\n  user: UserSuggestion;\n  onPress: () => void;\n  colors: any;\n}\n\nconst MentionSuggestionItem = memo(function MentionSuggestionItem({\n  user,\n  onPress,\n  colors,\n}: MentionSuggestionItemProps) {\n  return (\n    <TouchableOpacity\n      style={[styles.suggestionItem, { borderBottomColor: colors.border }]}\n      onPress={onPress}\n    >\n      {user.avatar_url ? (\n        <Image source={{ uri: user.avatar_url }} style={styles.avatar} />\n      ) : (\n        <View style={[styles.avatar, styles.avatarPlaceholder, { backgroundColor: colors.primary + '20' }]}>\n          <ThemedText style={[styles.avatarText, { color: colors.primary }]}>\n            {user.full_name.split(' ').map(n => n[0]).join('').toUpperCase()}\n          </ThemedText>\n        </View>\n      )}\n      <View style={styles.userInfo}>\n        <ThemedText style={[styles.userName, { color: colors.textPrimary }]}>\n          {user.full_name}\n        </ThemedText>\n        {user.specialty && (\n          <ThemedText style={[styles.userSpecialty, { color: colors.textSecondary }]}>\n            {user.specialty}\n          </ThemedText>\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n});\n\n// Utility to parse mentions in text\nexport function parseMentions(text: string): { type: 'text' | 'mention'; content: string }[] {\n  const parts: { type: 'text' | 'mention'; content: string }[] = [];\n  const mentionRegex = /@(\\w+)/g;\n  let lastIndex = 0;\n  let match;\n\n  while ((match = mentionRegex.exec(text)) !== null) {\n    // Add text before mention\n    if (match.index > lastIndex) {\n      parts.push({ type: 'text', content: text.substring(lastIndex, match.index) });\n    }\n    // Add mention\n    parts.push({ type: 'mention', content: match[1] });\n    lastIndex = match.index + match[0].length;\n  }\n\n  // Add remaining text\n  if (lastIndex < text.length) {\n    parts.push({ type: 'text', content: text.substring(lastIndex) });\n  }\n\n  return parts;\n}\n\n// Render text with highlighted mentions\ninterface RichMentionTextProps {\n  text: string;\n  onMentionPress?: (username: string) => void;\n  style?: any;\n  mentionStyle?: any;\n}\n\nexport function RichMentionText({\n  text,\n  onMentionPress,\n  style,\n  mentionStyle,\n}: RichMentionTextProps) {\n  const { colors } = useThemeContext();\n  const parts = parseMentions(text);\n\n  return (\n    <ThemedText style={style}>\n      {parts.map((part, index) => {\n        if (part.type === 'mention') {\n          return (\n            <ThemedText\n              key={index}\n              style={[\n                { color: colors.primary, fontWeight: '600' },\n                mentionStyle,\n              ]}\n              onPress={() => onMentionPress?.(part.content)}\n            >\n              @{part.content}\n            </ThemedText>\n          );\n        }\n        return <ThemedText key={index}>{part.content}</ThemedText>;\n      })}\n    </ThemedText>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    position: 'relative',\n  },\n  input: {\n    ...Typography.body,\n    minHeight: 100,\n    textAlignVertical: 'top',\n    padding: Spacing.md,\n  },\n  suggestionsContainer: {\n    overflow: 'hidden',\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  suggestionsAbove: {\n    marginBottom: Spacing.sm,\n  },\n  suggestionsBelow: {\n    marginTop: Spacing.sm,\n  },\n  suggestionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  avatar: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  userInfo: {\n    flex: 1,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userSpecialty: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n});\n","path":null,"size_bytes":11147,"size_tokens":null},"client/screens/EventDetailScreen.tsx":{"content":"/**\n * EventDetail Screen\n * View event info and RSVP\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n  Linking,\n  Share,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { contentApi } from '@/lib/api';\nimport { Event } from '@/types';\nimport { formatDate, formatNumber } from '@/lib/utils';\n\ntype EventDetailRouteParams = {\n  EventDetail: {\n    eventId: number;\n  };\n};\n\nexport default function EventDetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<EventDetailRouteParams, 'EventDetail'>>();\n  const { eventId } = route.params;\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  // Fetch event details\n  const {\n    data: event,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['event', eventId],\n    queryFn: async () => {\n      const response = await contentApi.getEvent(eventId);\n      return response.data;\n    },\n  });\n\n  // Attend/Unattend mutation\n  const attendMutation = useMutation({\n    mutationFn: async () => {\n      if (event?.is_attending) {\n        return contentApi.unattendEvent(eventId);\n      }\n      return contentApi.attendEvent(eventId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['event', eventId] });\n    },\n  });\n\n  const handleAttend = useCallback(() => {\n    attendMutation.mutate();\n  }, [attendMutation]);\n\n  const handleShare = useCallback(async () => {\n    if (!event) return;\n    try {\n      await Share.share({\n        message: `Check out this event: ${event.title}`,\n        url: event.external_url || undefined,\n      });\n    } catch (error) {\n      console.error('Share error:', error);\n    }\n  }, [event]);\n\n  const handleOpenMap = useCallback(() => {\n    if (!event?.location) return;\n    const url = `https://maps.google.com/?q=${encodeURIComponent(event.location)}`;\n    Linking.openURL(url);\n  }, [event]);\n\n  const handleHostPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const getEventTypeColor = (type: string) => {\n    switch (type) {\n      case 'virtual': return Colors.primary;\n      case 'in-person': return Colors.secondary;\n      case 'hybrid': return appColors.warning;\n      default: return Colors.primary;\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  if (!event) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ThemedText>Event not found</ThemedText>\n      </SafeAreaView>\n    );\n  }\n\n  const eventDate = new Date(event.start_time);\n  const isPast = eventDate < new Date();\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Event</ThemedText>\n        <TouchableOpacity style={styles.shareButton} onPress={handleShare}>\n          <Ionicons name=\"share-outline\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Cover */}\n        {event.cover_image ? (\n          <Image source={{ uri: event.cover_image }} style={styles.coverImage} />\n        ) : (\n          <LinearGradient\n            colors={[Colors.primary, Colors.secondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.coverPlaceholder}\n          >\n            <MaterialCommunityIcons name=\"calendar-star\" size={64} color=\"white\" />\n          </LinearGradient>\n        )}\n\n        {/* Event Info */}\n        <View style={[styles.eventInfo, { backgroundColor: appColors.surface }]}>\n          {/* Type Badge */}\n          <View style={[styles.typeBadge, { backgroundColor: getEventTypeColor(event.type) + '20' }]}>\n            <Ionicons\n              name={event.type === 'virtual' ? 'videocam' : event.type === 'hybrid' ? 'git-merge' : 'location'}\n              size={14}\n              color={getEventTypeColor(event.type)}\n            />\n            <ThemedText style={[styles.typeText, { color: getEventTypeColor(event.type) }]}>\n              {event.type.charAt(0).toUpperCase() + event.type.slice(1)}\n            </ThemedText>\n          </View>\n\n          <ThemedText style={[styles.eventTitle, { color: appColors.textPrimary }]}>{event.title}</ThemedText>\n\n          {/* Date & Time */}\n          <View style={styles.dateTimeSection}>\n            <View style={styles.dateBox}>\n              <ThemedText style={styles.dateMonth}>\n                {eventDate.toLocaleString('default', { month: 'short' }).toUpperCase()}\n              </ThemedText>\n              <ThemedText style={styles.dateDay}>{eventDate.getDate()}</ThemedText>\n            </View>\n            <View style={styles.timeInfo}>\n              <ThemedText style={[styles.timeText, { color: appColors.textPrimary }]}>\n                {eventDate.toLocaleString('default', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}\n              </ThemedText>\n              <ThemedText style={[styles.timeDetail, { color: appColors.textSecondary }]}>\n                {eventDate.toLocaleTimeString('default', { hour: '2-digit', minute: '2-digit' })}\n                {event.end_time && ` - ${new Date(event.end_time).toLocaleTimeString('default', { hour: '2-digit', minute: '2-digit' })}`}\n              </ThemedText>\n            </View>\n          </View>\n\n          {/* Location */}\n          {event.location && (\n            <TouchableOpacity style={styles.locationSection} onPress={handleOpenMap}>\n              <View style={styles.locationIcon}>\n                <Ionicons name=\"location-outline\" size={20} color={Colors.primary} />\n              </View>\n              <View style={styles.locationInfo}>\n                <ThemedText style={[styles.locationLabel, { color: appColors.textSecondary }]}>Location</ThemedText>\n                <ThemedText style={[styles.locationText, { color: appColors.textPrimary }]}>{event.location}</ThemedText>\n              </View>\n              <Ionicons name=\"open-outline\" size={18} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          )}\n\n          {/* Virtual Link */}\n          {event.meeting_url && (\n            <TouchableOpacity\n              style={styles.virtualSection}\n              onPress={() => Linking.openURL(event.meeting_url!)}\n            >\n              <View style={[styles.locationIcon, { backgroundColor: Colors.primary + '15' }]}>\n                <Ionicons name=\"videocam-outline\" size={20} color={Colors.primary} />\n              </View>\n              <View style={styles.locationInfo}>\n                <ThemedText style={[styles.locationLabel, { color: appColors.textSecondary }]}>Join Online</ThemedText>\n                <ThemedText style={styles.virtualLink}>Click to join meeting</ThemedText>\n              </View>\n              <Ionicons name=\"open-outline\" size={18} color={Colors.primary} />\n            </TouchableOpacity>\n          )}\n\n          {/* Attendees */}\n          <View style={styles.attendeesSection}>\n            <View style={styles.attendeesAvatars}>\n              {/* Placeholder for attendee avatars */}\n              <View style={[styles.attendeeAvatar, { backgroundColor: Colors.primary + '20', borderColor: appColors.surface }]} />\n              <View style={[styles.attendeeAvatar, { backgroundColor: Colors.secondary + '20', marginLeft: -8, borderColor: appColors.surface }]} />\n              <View style={[styles.attendeeAvatar, { backgroundColor: Colors.warning + '20', marginLeft: -8, borderColor: appColors.surface }]} />\n            </View>\n            <ThemedText style={[styles.attendeesText, { color: appColors.textSecondary }]}>\n              {formatNumber(event.attendees_count)} attending\n            </ThemedText>\n          </View>\n\n          {/* Host */}\n          <TouchableOpacity\n            style={styles.hostSection}\n            onPress={() => handleHostPress(event.host.id)}\n          >\n            {event.host.avatar_url ? (\n              <Image source={{ uri: event.host.avatar_url }} style={styles.hostAvatar} />\n            ) : (\n              <View style={[styles.hostAvatar, styles.hostAvatarPlaceholder]}>\n                <ThemedText style={styles.hostAvatarText}>\n                  {event.host.first_name[0]}{event.host.last_name[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={styles.hostInfo}>\n              <ThemedText style={[styles.hostLabel, { color: appColors.textSecondary }]}>Hosted by</ThemedText>\n              <ThemedText style={[styles.hostName, { color: appColors.textPrimary }]}>{event.host.full_name}</ThemedText>\n            </View>\n            <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Description */}\n        <View style={[styles.descriptionSection, { backgroundColor: appColors.surface }]}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>About This Event</ThemedText>\n          <ThemedText style={[styles.descriptionText, { color: appColors.textSecondary }]}>{event.description}</ThemedText>\n        </View>\n\n        {/* Tags */}\n        {event.tags && event.tags.length > 0 && (\n          <View style={[styles.tagsSection, { backgroundColor: appColors.surface }]}>\n            <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Topics</ThemedText>\n            <View style={styles.tagsContainer}>\n              {event.tags.map((tag, index) => (\n                <View key={index} style={styles.tag}>\n                  <ThemedText style={[styles.tagText, { color: appColors.textSecondary }]}>#{tag}</ThemedText>\n                </View>\n              ))}\n            </View>\n          </View>\n        )}\n      </ScrollView>\n\n      {/* RSVP Button */}\n      {!isPast && (\n        <View style={[styles.footer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <TouchableOpacity\n            style={[\n              styles.rsvpButton,\n              event.is_attending && styles.rsvpButtonAttending,\n            ]}\n            onPress={handleAttend}\n            disabled={attendMutation.isPending}\n          >\n            {attendMutation.isPending ? (\n              <ActivityIndicator color={event.is_attending ? appColors.textSecondary : 'white'} />\n            ) : (\n              <>\n                <Ionicons\n                  name={event.is_attending ? 'checkmark-circle' : 'calendar-outline'}\n                  size={20}\n                  color={event.is_attending ? Colors.secondary : 'white'}\n                />\n                <ThemedText style={[\n                  styles.rsvpButtonText,\n                  event.is_attending && styles.rsvpButtonTextAttending,\n                ]}>\n                  {event.is_attending ? \"You're Attending\" : 'RSVP - Attend Event'}\n                </ThemedText>\n              </>\n            )}\n          </TouchableOpacity>\n        </View>\n      )}\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  shareButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  coverImage: {\n    width: '100%',\n    height: 200,\n    resizeMode: 'cover',\n  },\n  coverPlaceholder: {\n    width: '100%',\n    height: 200,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  eventInfo: {\n    padding: Spacing.lg,\n  },\n  typeBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    alignSelf: 'flex-start',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n    marginBottom: Spacing.md,\n  },\n  typeText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  eventTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.lg,\n  },\n  dateTimeSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.lg,\n  },\n  dateBox: {\n    width: 56,\n    height: 56,\n    borderRadius: BorderRadius.md,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  dateMonth: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  dateDay: {\n    ...Typography.heading,\n    color: Colors.primary,\n    fontWeight: '700',\n  },\n  timeInfo: {\n    flex: 1,\n  },\n  timeText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  timeDetail: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  locationSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.md,\n  },\n  locationIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: Colors.secondary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  locationInfo: {\n    flex: 1,\n  },\n  locationLabel: {\n    ...Typography.small,\n  },\n  locationText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  virtualSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.md,\n  },\n  virtualLink: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n  attendeesSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.lg,\n  },\n  attendeesAvatars: {\n    flexDirection: 'row',\n    marginRight: Spacing.sm,\n  },\n  attendeeAvatar: {\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    borderWidth: 2,\n  },\n  attendeesText: {\n    ...Typography.caption,\n  },\n  hostSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n  },\n  hostAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  hostAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  hostAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  hostInfo: {\n    flex: 1,\n  },\n  hostLabel: {\n    ...Typography.small,\n  },\n  hostName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  descriptionSection: {\n    padding: Spacing.lg,\n    marginTop: Spacing.md,\n  },\n  sectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.md,\n  },\n  descriptionText: {\n    ...Typography.body,\n    lineHeight: 24,\n  },\n  tagsSection: {\n    padding: Spacing.lg,\n    marginTop: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: Spacing.sm,\n  },\n  tag: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n  },\n  tagText: {\n    ...Typography.caption,\n  },\n  footer: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  rsvpButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n    ...Shadows.button,\n  },\n  rsvpButtonAttending: {\n    backgroundColor: Colors.secondary + '15',\n  },\n  rsvpButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '700',\n  },\n  rsvpButtonTextAttending: {\n    color: Colors.secondary,\n  },\n});\n","path":null,"size_bytes":17456,"size_tokens":null},"client/components/Reactions.tsx":{"content":"/**\n * Reactions Component\n * Emoji reactions beyond upvote/downvote\n */\n\nimport React, { useState, useCallback, memo, useRef, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Pressable,\n  Modal,\n  Animated,\n  PanResponder,\n  Image,\n  Dimensions,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { postsApi } from '@/lib/api';\n\n// Available reactions\nexport const REACTIONS = [\n  { id: 'like', emoji: 'üëç', label: 'Like' },\n  { id: 'love', emoji: '‚ù§Ô∏è', label: 'Love' },\n  { id: 'laugh', emoji: 'üòÇ', label: 'Haha' },\n  { id: 'wow', emoji: 'üòÆ', label: 'Wow' },\n  { id: 'sad', emoji: 'üò¢', label: 'Sad' },\n  { id: 'fire', emoji: 'üî•', label: 'Fire' },\n  { id: 'thinking', emoji: 'ü§î', label: 'Thinking' },\n  { id: 'clap', emoji: 'üëè', label: 'Clap' },\n] as const;\n\nexport type ReactionType = typeof REACTIONS[number]['id'];\n\n// Types\nexport interface ReactionCount {\n  type: ReactionType;\n  count: number;\n}\n\nexport interface UserReaction {\n  type: ReactionType;\n  userId: number;\n  userName: string;\n  avatar?: string;\n}\n\ninterface ReactionsProps {\n  postId: number;\n  reactions: ReactionCount[];\n  userReaction?: ReactionType;\n  totalReactions: number;\n  onReactionChange?: (reaction: ReactionType | null) => void;\n  size?: 'small' | 'medium' | 'large';\n  showCount?: boolean;\n}\n\ninterface ReactionPickerProps {\n  visible: boolean;\n  onClose: () => void;\n  onSelect: (reaction: ReactionType) => void;\n  currentReaction?: ReactionType;\n  anchorPosition?: { x: number; y: number };\n}\n\ninterface ReactionSummaryProps {\n  reactions: ReactionCount[];\n  totalReactions: number;\n  onPress?: () => void;\n}\n\n// =============================================================================\n// REACTION PICKER (Floating emoji selector)\n// =============================================================================\n\nexport const ReactionPicker = memo(function ReactionPicker({\n  visible,\n  onClose,\n  onSelect,\n  currentReaction,\n  anchorPosition,\n}: ReactionPickerProps) {\n  const { colors } = useThemeContext();\n  const scaleAnims = useRef(REACTIONS.map(() => new Animated.Value(0))).current;\n  const containerAnim = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    if (visible) {\n      // Animate container in\n      Animated.spring(containerAnim, {\n        toValue: 1,\n        friction: 8,\n        tension: 100,\n        useNativeDriver: true,\n      }).start();\n\n      // Stagger emoji animations\n      REACTIONS.forEach((_, index) => {\n        Animated.sequence([\n          Animated.delay(index * 30),\n          Animated.spring(scaleAnims[index], {\n            toValue: 1,\n            friction: 5,\n            tension: 150,\n            useNativeDriver: true,\n          }),\n        ]).start();\n      });\n    } else {\n      // Reset animations\n      containerAnim.setValue(0);\n      scaleAnims.forEach(anim => anim.setValue(0));\n    }\n  }, [visible]);\n\n  const handleSelect = (reaction: ReactionType) => {\n    haptics.selection();\n    onSelect(reaction);\n    onClose();\n  };\n\n  if (!visible) return null;\n\n  return (\n    <Modal transparent visible={visible} onRequestClose={onClose}>\n      <Pressable style={styles.pickerOverlay} onPress={onClose}>\n        <Animated.View\n          style={[\n            styles.pickerContainer,\n            {\n              backgroundColor: colors.surface,\n              transform: [{ scale: containerAnim }],\n              opacity: containerAnim,\n            },\n          ]}\n        >\n          {REACTIONS.map((reaction, index) => (\n            <Animated.View\n              key={reaction.id}\n              style={{\n                transform: [{ scale: scaleAnims[index] }],\n              }}\n            >\n              <TouchableOpacity\n                style={[\n                  styles.reactionOption,\n                  currentReaction === reaction.id && {\n                    backgroundColor: colors.primary + '20',\n                  },\n                ]}\n                onPress={() => handleSelect(reaction.id)}\n                activeOpacity={0.7}\n              >\n                <ThemedText style={styles.reactionEmoji}>{reaction.emoji}</ThemedText>\n              </TouchableOpacity>\n            </Animated.View>\n          ))}\n        </Animated.View>\n      </Pressable>\n    </Modal>\n  );\n});\n\n// =============================================================================\n// REACTION BUTTON (Main interaction point)\n// =============================================================================\n\nexport const ReactionButton = memo(function ReactionButton({\n  postId,\n  reactions,\n  userReaction,\n  totalReactions,\n  onReactionChange,\n  size = 'medium',\n  showCount = true,\n}: ReactionsProps) {\n  const { colors } = useThemeContext();\n  const queryClient = useQueryClient();\n  const [showPicker, setShowPicker] = useState(false);\n  const [localReaction, setLocalReaction] = useState<ReactionType | undefined>(userReaction);\n  const longPressTimer = useRef<NodeJS.Timeout | null>(null);\n  const buttonRef = useRef<View>(null);\n\n  // React mutation\n  const reactMutation = useMutation({\n    mutationFn: async (type: ReactionType | null) => {\n      if (type) {\n        return postsApi.react(postId, type);\n      } else {\n        return postsApi.removeReaction(postId);\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['post', postId] });\n      queryClient.invalidateQueries({ queryKey: ['feed'] });\n    },\n  });\n\n  const handlePress = () => {\n    haptics.like();\n    \n    if (localReaction) {\n      // Remove reaction\n      setLocalReaction(undefined);\n      onReactionChange?.(null);\n      reactMutation.mutate(null);\n    } else {\n      // Quick like\n      setLocalReaction('like');\n      onReactionChange?.('like');\n      reactMutation.mutate('like');\n    }\n  };\n\n  const handleLongPress = () => {\n    haptics.longPress();\n    setShowPicker(true);\n  };\n\n  const handleSelectReaction = (type: ReactionType) => {\n    if (type === localReaction) {\n      // Remove if same\n      setLocalReaction(undefined);\n      onReactionChange?.(null);\n      reactMutation.mutate(null);\n    } else {\n      setLocalReaction(type);\n      onReactionChange?.(type);\n      reactMutation.mutate(type);\n    }\n  };\n\n  const currentReaction = REACTIONS.find(r => r.id === localReaction);\n  const iconSize = size === 'small' ? 18 : size === 'large' ? 26 : 22;\n\n  return (\n    <>\n      <TouchableOpacity\n        ref={buttonRef}\n        style={styles.reactionButton}\n        onPress={handlePress}\n        onLongPress={handleLongPress}\n        delayLongPress={300}\n        activeOpacity={0.7}\n      >\n        {localReaction ? (\n          <ThemedText style={[styles.activeReaction, { fontSize: iconSize }]}>\n            {currentReaction?.emoji}\n          </ThemedText>\n        ) : (\n          <Ionicons name=\"heart-outline\" size={iconSize} color={colors.textSecondary} />\n        )}\n        {showCount && totalReactions > 0 && (\n          <ThemedText\n            style={[\n              styles.reactionCount,\n              { color: localReaction ? colors.primary : colors.textSecondary },\n            ]}\n          >\n            {totalReactions}\n          </ThemedText>\n        )}\n      </TouchableOpacity>\n\n      <ReactionPicker\n        visible={showPicker}\n        onClose={() => setShowPicker(false)}\n        onSelect={handleSelectReaction}\n        currentReaction={localReaction}\n      />\n    </>\n  );\n});\n\n// =============================================================================\n// REACTION SUMMARY (Shows who reacted)\n// =============================================================================\n\nexport const ReactionSummary = memo(function ReactionSummary({\n  reactions,\n  totalReactions,\n  onPress,\n}: ReactionSummaryProps) {\n  const { colors } = useThemeContext();\n\n  if (totalReactions === 0) return null;\n\n  // Get top 3 reactions by count\n  const topReactions = [...reactions]\n    .sort((a, b) => b.count - a.count)\n    .slice(0, 3);\n\n  return (\n    <TouchableOpacity style={styles.summaryContainer} onPress={onPress} activeOpacity={0.7}>\n      <View style={styles.emojiStack}>\n        {topReactions.map((reaction, index) => {\n          const reactionData = REACTIONS.find(r => r.id === reaction.type);\n          return (\n            <View\n              key={reaction.type}\n              style={[\n                styles.stackedEmoji,\n                {\n                  backgroundColor: colors.surface,\n                  marginLeft: index > 0 ? -6 : 0,\n                  zIndex: 3 - index,\n                },\n              ]}\n            >\n              <ThemedText style={styles.smallEmoji}>{reactionData?.emoji}</ThemedText>\n            </View>\n          );\n        })}\n      </View>\n      <ThemedText style={[styles.summaryText, { color: colors.textSecondary }]}>\n        {totalReactions}\n      </ThemedText>\n    </TouchableOpacity>\n  );\n});\n\n// =============================================================================\n// REACTION DETAILS MODAL (Shows all who reacted)\n// =============================================================================\n\ninterface ReactionDetailsModalProps {\n  visible: boolean;\n  onClose: () => void;\n  reactions: UserReaction[];\n  postId: number;\n}\n\nexport const ReactionDetailsModal = memo(function ReactionDetailsModal({\n  visible,\n  onClose,\n  reactions,\n  postId,\n}: ReactionDetailsModalProps) {\n  const { colors } = useThemeContext();\n  const [activeTab, setActiveTab] = useState<ReactionType | 'all'>('all');\n\n  // Group by reaction type\n  const grouped = REACTIONS.reduce((acc, r) => {\n    acc[r.id] = reactions.filter(ur => ur.type === r.id);\n    return acc;\n  }, {} as Record<ReactionType, UserReaction[]>);\n\n  const displayReactions = activeTab === 'all' \n    ? reactions \n    : grouped[activeTab] || [];\n\n  // Count per type\n  const counts = REACTIONS.map(r => ({\n    ...r,\n    count: grouped[r.id]?.length || 0,\n  })).filter(r => r.count > 0);\n\n  return (\n    <Modal visible={visible} animationType=\"slide\" presentationStyle=\"pageSheet\" onRequestClose={onClose}>\n      <View style={[styles.modalContainer, { backgroundColor: colors.background }]}>\n        {/* Header */}\n        <View style={[styles.modalHeader, { borderBottomColor: colors.border }]}>\n          <ThemedText style={[styles.modalTitle, { color: colors.textPrimary }]}>\n            Reactions\n          </ThemedText>\n          <TouchableOpacity onPress={onClose}>\n            <Ionicons name=\"close\" size={24} color={colors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Tabs */}\n        <View style={[styles.tabsContainer, { borderBottomColor: colors.border }]}>\n          <TouchableOpacity\n            style={[styles.tab, activeTab === 'all' && { borderBottomColor: colors.primary }]}\n            onPress={() => setActiveTab('all')}\n          >\n            <ThemedText\n              style={[\n                styles.tabText,\n                { color: activeTab === 'all' ? colors.primary : colors.textSecondary },\n              ]}\n            >\n              All {reactions.length}\n            </ThemedText>\n          </TouchableOpacity>\n          {counts.map(r => (\n            <TouchableOpacity\n              key={r.id}\n              style={[styles.tab, activeTab === r.id && { borderBottomColor: colors.primary }]}\n              onPress={() => setActiveTab(r.id)}\n            >\n              <ThemedText style={styles.tabEmoji}>{r.emoji}</ThemedText>\n              <ThemedText\n                style={[\n                  styles.tabCount,\n                  { color: activeTab === r.id ? colors.primary : colors.textSecondary },\n                ]}\n              >\n                {r.count}\n              </ThemedText>\n            </TouchableOpacity>\n          ))}\n        </View>\n\n        {/* User list */}\n        <View style={styles.userList}>\n          {displayReactions.map((reaction, index) => {\n            const reactionData = REACTIONS.find(r => r.id === reaction.type);\n            return (\n              <View\n                key={`${reaction.userId}-${reaction.type}`}\n                style={[styles.userRow, { borderBottomColor: colors.border }]}\n              >\n                {reaction.avatar ? (\n                  <Image source={{ uri: reaction.avatar }} style={styles.userAvatar} />\n                ) : (\n                  <View style={[styles.userAvatar, styles.avatarPlaceholder, { backgroundColor: colors.primary }]}>\n                    <ThemedText style={styles.avatarText}>\n                      {reaction.userName[0]}\n                    </ThemedText>\n                  </View>\n                )}\n                <ThemedText style={[styles.userName, { color: colors.textPrimary }]}>\n                  {reaction.userName}\n                </ThemedText>\n                <ThemedText style={styles.userReactionEmoji}>\n                  {reactionData?.emoji}\n                </ThemedText>\n              </View>\n            );\n          })}\n        </View>\n      </View>\n    </Modal>\n  );\n});\n\n// =============================================================================\n// QUICK REACTION BAR (For inline use)\n// =============================================================================\n\ninterface QuickReactionBarProps {\n  postId: number;\n  userReaction?: ReactionType;\n  onReact: (type: ReactionType | null) => void;\n  compact?: boolean;\n}\n\nexport const QuickReactionBar = memo(function QuickReactionBar({\n  postId,\n  userReaction,\n  onReact,\n  compact = false,\n}: QuickReactionBarProps) {\n  const { colors } = useThemeContext();\n\n  const handleReact = (type: ReactionType) => {\n    haptics.selection();\n    if (type === userReaction) {\n      onReact(null);\n    } else {\n      onReact(type);\n    }\n  };\n\n  const displayReactions = compact ? REACTIONS.slice(0, 5) : REACTIONS;\n\n  return (\n    <View style={[styles.quickBar, { backgroundColor: colors.surface }]}>\n      {displayReactions.map(reaction => (\n        <TouchableOpacity\n          key={reaction.id}\n          style={[\n            styles.quickReaction,\n            userReaction === reaction.id && {\n              backgroundColor: colors.primary + '20',\n            },\n          ]}\n          onPress={() => handleReact(reaction.id)}\n        >\n          <ThemedText style={styles.quickEmoji}>{reaction.emoji}</ThemedText>\n        </TouchableOpacity>\n      ))}\n    </View>\n  );\n});\n\nconst styles = StyleSheet.create({\n  // Picker\n  pickerOverlay: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'rgba(0,0,0,0.3)',\n  },\n  pickerContainer: {\n    flexDirection: 'row',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    ...Shadows.card,\n  },\n  reactionOption: {\n    padding: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  reactionEmoji: {\n    fontSize: 28,\n  },\n\n  // Button\n  reactionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  activeReaction: {\n    lineHeight: 26,\n  },\n  reactionCount: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n\n  // Summary\n  summaryContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  emojiStack: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  stackedEmoji: {\n    width: 22,\n    height: 22,\n    borderRadius: 11,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 1.5,\n    borderColor: 'white',\n  },\n  smallEmoji: {\n    fontSize: 12,\n  },\n  summaryText: {\n    ...Typography.small,\n  },\n\n  // Modal\n  modalContainer: {\n    flex: 1,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  modalTitle: {\n    ...Typography.heading,\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 2,\n    borderBottomColor: 'transparent',\n    gap: 4,\n  },\n  tabText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  tabEmoji: {\n    fontSize: 18,\n  },\n  tabCount: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  userList: {\n    flex: 1,\n  },\n  userRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  userAvatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n  },\n  avatarPlaceholder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    color: 'white',\n    fontWeight: '600',\n  },\n  userName: {\n    ...Typography.body,\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  userReactionEmoji: {\n    fontSize: 20,\n  },\n\n  // Quick bar\n  quickBar: {\n    flexDirection: 'row',\n    borderRadius: BorderRadius.full,\n    padding: Spacing.xs,\n    ...Shadows.card,\n  },\n  quickReaction: {\n    padding: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  quickEmoji: {\n    fontSize: 22,\n  },\n});\n","path":null,"size_bytes":17363,"size_tokens":null},"client/screens/settings/DocumentsScreen.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Pressable } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport default function DocumentsScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n\n  const documents = [\n    { id: '1', name: 'Tax Documents 2024', type: 'pdf', date: 'Jan 15, 2025' },\n    { id: '2', name: 'Investment Statements Q4', type: 'pdf', date: 'Jan 1, 2025' },\n    { id: '3', name: 'Account Verification', type: 'pdf', date: 'Dec 15, 2024' },\n  ];\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Documents</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        {documents.map((doc) => (\n          <Pressable key={doc.id} style={styles.documentItem}>\n            <View style={styles.documentIcon}>\n              <Feather name=\"file-text\" size={20} color={colors.primary.main} />\n            </View>\n            <View style={styles.documentInfo}>\n              <Text style={styles.documentName}>{doc.name}</Text>\n              <Text style={styles.documentDate}>{doc.date}</Text>\n            </View>\n            <Feather name=\"download\" size={20} color={colors.text.tertiary} />\n          </Pressable>\n        ))}\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  content: {\n    flex: 1,\n    padding: spacing.lg,\n  },\n  documentItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  documentIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  documentInfo: {\n    flex: 1,\n  },\n  documentName: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  documentDate: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n});\n","path":null,"size_bytes":3165,"size_tokens":null},"client/screens/settings/EditProfileScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  TextInput,\n  Alert,\n  ActivityIndicator,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport * as ImagePicker from 'expo-image-picker';\nimport Animated, { FadeInDown } from 'react-native-reanimated';\nimport { Image } from 'expo-image';\n\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport { useUserProfile, useUpdateProfile, useUploadAvatar } from '@/api/hooks';\nimport { useAuth } from '@/contexts/AuthContext';\nimport type { User } from '@/types';\nimport { getApiUrl } from '@/lib/query-client';\n\nexport default function EditProfileScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n  const { refreshUser } = useAuth();\n  \n  const { data: user, isLoading: isLoadingUser } = useUserProfile();\n  const updateProfile = useUpdateProfile();\n  const uploadAvatar = useUploadAvatar();\n\n  const getAvatarUrl = (avatarUrl?: string) => {\n    if (!avatarUrl) return null;\n    if (avatarUrl.startsWith('http')) return avatarUrl;\n    return `${getApiUrl()}${avatarUrl}`;\n  };\n\n  // Form state\n  const [firstName, setFirstName] = useState(user?.firstName || '');\n  const [lastName, setLastName] = useState(user?.lastName || '');\n  const [phone, setPhone] = useState(user?.phone || '');\n  const [hasChanges, setHasChanges] = useState(false);\n\n  // Initialize form when user data loads\n  React.useEffect(() => {\n    if (user) {\n      setFirstName(user.firstName || '');\n      setLastName(user.lastName || '');\n      setPhone(user.phone || '');\n    }\n  }, [user]);\n\n  const handleFieldChange = useCallback(\n    (setter: (value: string) => void) => (value: string) => {\n      setter(value);\n      setHasChanges(true);\n    },\n    []\n  );\n\n  const handlePickImage = useCallback(async () => {\n    // Request permission\n    const { status } = await ImagePicker.requestMediaLibraryPermissionsAsync();\n    \n    if (status !== 'granted') {\n      Alert.alert(\n        'Permission Required',\n        'Please allow access to your photo library to change your avatar.'\n      );\n      return;\n    }\n\n    // Pick image\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\n      allowsEditing: true,\n      aspect: [1, 1],\n      quality: 0.8,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      try {\n        await uploadAvatar.mutateAsync(result.assets[0].uri);\n        await refreshUser();\n        Alert.alert('Success', 'Avatar updated successfully!');\n      } catch (error) {\n        Alert.alert('Error', 'Failed to upload avatar. Please try again.');\n      }\n    }\n  }, [uploadAvatar, refreshUser]);\n\n  const handleSave = useCallback(async () => {\n    if (!hasChanges) return;\n\n    try {\n      const updatedData = {\n        firstName: firstName.trim(),\n        lastName: lastName.trim(),\n        phone: phone.trim() || undefined,\n      };\n      await updateProfile.mutateAsync(updatedData);\n      await refreshUser();\n      Alert.alert('Success', 'Profile updated successfully!');\n      setHasChanges(false);\n    } catch (error) {\n      Alert.alert('Error', 'Failed to update profile. Please try again.');\n    }\n  }, [firstName, lastName, phone, hasChanges, updateProfile, refreshUser]);\n\n  const getInitials = () => {\n    if (firstName && lastName) {\n      return `${firstName[0]}${lastName[0]}`.toUpperCase();\n    }\n    if (user?.email) {\n      return user.email[0].toUpperCase();\n    }\n    return 'U';\n  };\n\n  if (isLoadingUser) {\n    return (\n      <View style={[styles.container, styles.loadingContainer]}>\n        <ActivityIndicator size=\"large\" color={colors.primary.main} />\n      </View>\n    );\n  }\n\n  return (\n    <KeyboardAvoidingView\n      style={styles.container}\n      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n    >\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"x\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Edit Profile</Text>\n        <Pressable\n          style={styles.saveButton}\n          onPress={handleSave}\n          disabled={!hasChanges || updateProfile.isPending}\n        >\n          {updateProfile.isPending ? (\n            <ActivityIndicator size=\"small\" color={colors.primary.main} />\n          ) : (\n            <Text\n              style={[\n                styles.saveButtonText,\n                !hasChanges && styles.saveButtonTextDisabled,\n              ]}\n            >\n              Save\n            </Text>\n          )}\n        </Pressable>\n      </View>\n\n      <ScrollView\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingBottom: insets.bottom + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n        keyboardShouldPersistTaps=\"handled\"\n      >\n        {/* Avatar Section */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(100)}\n          style={styles.avatarSection}\n        >\n          <Pressable style={styles.avatarContainer} onPress={handlePickImage}>\n            <View style={styles.avatar}>\n              {user?.avatarUrl ? (\n                <Image\n                  source={{ uri: getAvatarUrl(user.avatarUrl) ?? undefined }}\n                  style={styles.avatarImage}\n                  contentFit=\"cover\"\n                  transition={200}\n                />\n              ) : (\n                <Text style={styles.avatarText}>{getInitials()}</Text>\n              )}\n            </View>\n            <View style={styles.editAvatarBadge}>\n              {uploadAvatar.isPending ? (\n                <ActivityIndicator size=\"small\" color={colors.text.inverse} />\n              ) : (\n                <Feather name=\"camera\" size={16} color={colors.text.inverse} />\n              )}\n            </View>\n          </Pressable>\n          <Text style={styles.avatarHint}>Tap to change photo</Text>\n        </Animated.View>\n\n        {/* Form Fields */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(200)}\n          style={styles.formSection}\n        >\n          {/* First Name */}\n          <View style={styles.fieldContainer}>\n            <Text style={styles.fieldLabel}>First Name</Text>\n            <TextInput\n              style={styles.textInput}\n              value={firstName}\n              onChangeText={handleFieldChange(setFirstName)}\n              placeholder=\"Enter your first name\"\n              placeholderTextColor={colors.text.tertiary}\n              autoCapitalize=\"words\"\n              autoCorrect={false}\n            />\n          </View>\n\n          {/* Last Name */}\n          <View style={styles.fieldContainer}>\n            <Text style={styles.fieldLabel}>Last Name</Text>\n            <TextInput\n              style={styles.textInput}\n              value={lastName}\n              onChangeText={handleFieldChange(setLastName)}\n              placeholder=\"Enter your last name\"\n              placeholderTextColor={colors.text.tertiary}\n              autoCapitalize=\"words\"\n              autoCorrect={false}\n            />\n          </View>\n\n          {/* Email (Read-only) */}\n          <View style={styles.fieldContainer}>\n            <Text style={styles.fieldLabel}>Email</Text>\n            <View style={[styles.textInput, styles.textInputDisabled]}>\n              <Text style={styles.disabledText}>{user?.email}</Text>\n              <Feather name=\"lock\" size={16} color={colors.text.tertiary} />\n            </View>\n            <Text style={styles.fieldHint}>\n              Email cannot be changed for security reasons\n            </Text>\n          </View>\n\n          {/* Phone */}\n          <View style={styles.fieldContainer}>\n            <Text style={styles.fieldLabel}>Phone Number</Text>\n            <TextInput\n              style={styles.textInput}\n              value={phone}\n              onChangeText={handleFieldChange(setPhone)}\n              placeholder=\"+1 (555) 000-0000\"\n              placeholderTextColor={colors.text.tertiary}\n              keyboardType=\"phone-pad\"\n              autoCorrect={false}\n            />\n            <Text style={styles.fieldHint}>\n              Used for account verification and security\n            </Text>\n          </View>\n        </Animated.View>\n\n        {/* Verification Status */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(300)}\n          style={styles.verificationSection}\n        >\n          <View style={styles.verificationCard}>\n            <View style={styles.verificationHeader}>\n              <Feather\n                name={user?.isVerified ? 'check-circle' : 'alert-circle'}\n                size={24}\n                color={\n                  user?.isVerified\n                    ? colors.semantic.success\n                    : colors.semantic.warning\n                }\n              />\n              <Text style={styles.verificationTitle}>\n                {user?.isVerified ? 'Verified Investor' : 'Verification Pending'}\n              </Text>\n            </View>\n            <Text style={styles.verificationText}>\n              {user?.isVerified\n                ? 'Your account is fully verified. You have access to all investment opportunities.'\n                : 'Complete verification to access all investment opportunities and higher investment limits.'}\n            </Text>\n            {!user?.isVerified && (\n              <Pressable style={styles.verifyButton}>\n                <Text style={styles.verifyButtonText}>Complete Verification</Text>\n                <Feather name=\"arrow-right\" size={16} color={colors.primary.main} />\n              </Pressable>\n            )}\n          </View>\n        </Animated.View>\n\n        {/* Danger Zone */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(400)}\n          style={styles.dangerSection}\n        >\n          <Text style={styles.dangerTitle}>Danger Zone</Text>\n          <Pressable\n            style={styles.dangerButton}\n            onPress={() => {\n              Alert.alert(\n                'Delete Account',\n                'Are you sure you want to delete your account? This action cannot be undone.',\n                [\n                  { text: 'Cancel', style: 'cancel' },\n                  {\n                    text: 'Delete',\n                    style: 'destructive',\n                    onPress: () => {\n                      // TODO: Implement account deletion\n                    },\n                  },\n                ]\n              );\n            }}\n          >\n            <Feather name=\"trash-2\" size={20} color={colors.semantic.error} />\n            <Text style={styles.dangerButtonText}>Delete Account</Text>\n          </Pressable>\n        </Animated.View>\n      </ScrollView>\n    </KeyboardAvoidingView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  loadingContainer: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n\n  // Header\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  saveButton: {\n    padding: spacing.xs,\n    minWidth: 50,\n    alignItems: 'flex-end',\n  },\n  saveButtonText: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n  saveButtonTextDisabled: {\n    color: colors.text.tertiary,\n  },\n\n  // Scroll View\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    padding: spacing.lg,\n  },\n\n  // Avatar Section\n  avatarSection: {\n    alignItems: 'center',\n    marginBottom: spacing.xl,\n  },\n  avatarContainer: {\n    position: 'relative',\n    marginBottom: spacing.sm,\n  },\n  avatar: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    backgroundColor: colors.primary.main,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  avatarText: {\n    ...typography.hero,\n    color: colors.text.inverse,\n  },\n  avatarImage: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n  },\n  editAvatarBadge: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: colors.primary.main,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 3,\n    borderColor: colors.background.primary,\n  },\n  avatarHint: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n\n  // Form Section\n  formSection: {\n    marginBottom: spacing.xl,\n  },\n  fieldContainer: {\n    marginBottom: spacing.lg,\n  },\n  fieldLabel: {\n    ...typography.captionMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  textInput: {\n    backgroundColor: colors.surface.primary,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    borderRadius: layout.radiusMedium,\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.md,\n    ...typography.body,\n    color: colors.text.primary,\n  },\n  textInputDisabled: {\n    backgroundColor: colors.background.secondary,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  disabledText: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n  fieldHint: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    marginTop: spacing.xs,\n  },\n\n  // Verification Section\n  verificationSection: {\n    marginBottom: spacing.xl,\n  },\n  verificationCard: {\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusMedium,\n    padding: spacing.lg,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  verificationHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n    marginBottom: spacing.sm,\n  },\n  verificationTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  verificationText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    lineHeight: 20,\n  },\n  verifyButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    marginTop: spacing.md,\n    paddingVertical: spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  verifyButtonText: {\n    ...typography.bodyMedium,\n    color: colors.primary.main,\n  },\n\n  // Danger Section\n  dangerSection: {\n    paddingTop: spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  dangerTitle: {\n    ...typography.captionMedium,\n    color: colors.semantic.error,\n    marginBottom: spacing.md,\n  },\n  dangerButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    paddingVertical: spacing.md,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.semantic.error,\n  },\n  dangerButtonText: {\n    ...typography.bodyMedium,\n    color: colors.semantic.error,\n  },\n});\n","path":null,"size_bytes":15463,"size_tokens":null},"client/screens/LoginScreen.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Image, Platform, Alert, Pressable, Text } from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport * as Haptics from \"expo-haptics\";\nimport { useNavigation } from \"@react-navigation/native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Colors, Spacing, BorderRadius } from \"@/constants/theme\";\nimport { useAppColors } from '@/hooks/useAppColors';\n\nexport default function LoginScreen() {\n  const insets = useSafeAreaInsets();\n  const { theme } = useTheme();\n  const appColors = useAppColors();\n  const navigation = useNavigation<any>();\n  const { signInWithApple, signInWithGoogle, signInWithGithub, signInWithFacebook, isAppleAuthAvailable, isLoading, error } = useAuth();\n\n  const handleAppleSignIn = async () => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    await signInWithApple();\n  };\n\n  const handleGoogleSignIn = async () => {\n    console.log('handleGoogleSignIn clicked!');\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    await signInWithGoogle();\n  };\n\n  const handleGithubSignIn = async () => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    await signInWithGithub();\n  };\n\n  const handleFacebookSignIn = async () => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    await signInWithFacebook();\n  };\n\n  const handleEmailSignIn = () => {\n    navigation.navigate('Register');\n  };\n\n  return (\n    <View\n      style={[\n        styles.container,\n        {\n          backgroundColor: theme.backgroundRoot,\n          paddingTop: insets.top + Spacing.xl,\n          paddingBottom: insets.bottom + Spacing.xl,\n        },\n      ]}\n    >\n      <View style={styles.content}>\n        <View style={styles.logoContainer}>\n          <LinearGradient\n            colors={[Colors.gradient.start, Colors.gradient.end]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.logoGradient}\n          >\n            <Image\n              source={require(\"../../assets/images/splash-icon.png\")}\n              style={styles.logo}\n              resizeMode=\"contain\"\n            />\n          </LinearGradient>\n        </View>\n\n        <ThemedText type=\"hero\" style={styles.title}>\n          MedInvest\n        </ThemedText>\n        <ThemedText type=\"body\" style={[styles.subtitle, { color: theme.textSecondary }]}>\n          Invest in the future of healthcare\n        </ThemedText>\n\n        <View style={styles.features}>\n          <FeatureItem\n            icon=\"compass\"\n            text=\"Discover groundbreaking medical innovations\"\n          />\n          <FeatureItem\n            icon=\"pie-chart\"\n            text=\"Build a portfolio in healthcare ventures\"\n          />\n          <FeatureItem\n            icon=\"trending-up\"\n            text=\"Track your investments and returns\"\n          />\n        </View>\n      </View>\n\n      <View style={styles.buttonContainer}>\n        {isAppleAuthAvailable && Platform.OS === 'ios' ? (\n          <Button onPress={handleAppleSignIn} style={styles.signInButton} disabled={isLoading}>\n            {\"Sign In with Apple\"}\n          </Button>\n        ) : null}\n        <Pressable\n          onPress={handleGoogleSignIn}\n          style={[styles.socialButton, { backgroundColor: theme.backgroundSecondary, borderColor: appColors.border }]}\n          disabled={isLoading}\n          testID=\"button-google-signin\"\n        >\n          <Text style={{ color: theme.text, fontSize: 16 }}>\n            {isLoading ? 'Signing in...' : 'Sign In with Google'}\n          </Text>\n        </Pressable>\n        <Pressable\n          onPress={handleGithubSignIn}\n          style={[styles.socialButton, { backgroundColor: theme.backgroundSecondary, borderColor: appColors.border }]}\n          disabled={isLoading}\n          testID=\"button-github-signin\"\n        >\n          <Text style={{ color: theme.text, fontSize: 16 }}>\n            {isLoading ? 'Signing in...' : 'Sign In with GitHub'}\n          </Text>\n        </Pressable>\n        <Pressable\n          onPress={handleFacebookSignIn}\n          style={[styles.socialButton, { backgroundColor: theme.backgroundSecondary, borderColor: appColors.border }]}\n          disabled={isLoading}\n          testID=\"button-facebook-signin\"\n        >\n          <Text style={{ color: theme.text, fontSize: 16 }}>\n            {isLoading ? 'Signing in...' : 'Sign In with Facebook'}\n          </Text>\n        </Pressable>\n        <Button\n          onPress={handleEmailSignIn}\n          style={[styles.socialButton, { backgroundColor: 'transparent', borderWidth: 1, borderColor: appColors.border }]}\n        >\n          {\"Sign Up with Email\"}\n        </Button>\n\n        {error ? (\n          <ThemedText type=\"small\" style={[styles.errorText, { color: appColors.error }]}>\n            {error}\n          </ThemedText>\n        ) : null}\n\n        <ThemedText\n          type=\"small\"\n          style={[styles.terms, { color: theme.textSecondary }]}\n        >\n          By signing in, you agree to our Terms of Service and Privacy Policy\n        </ThemedText>\n      </View>\n    </View>\n  );\n}\n\nfunction FeatureItem({ icon, text }: { icon: string; text: string }) {\n  const { theme } = useTheme();\n  const Feather = require(\"@expo/vector-icons\").Feather;\n\n  return (\n    <View style={styles.featureItem}>\n      <View style={[styles.featureIcon, { backgroundColor: Colors.primary + \"15\" }]}>\n        <Feather name={icon} size={20} color={Colors.primary} />\n      </View>\n      <ThemedText type=\"caption\" style={[styles.featureText, { color: theme.textSecondary }]}>\n        {text}\n      </ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingHorizontal: Spacing.xl,\n  },\n  content: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  logoContainer: {\n    marginBottom: Spacing[\"3xl\"],\n  },\n  logoGradient: {\n    width: 100,\n    height: 100,\n    borderRadius: BorderRadius.lg,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  logo: {\n    width: 60,\n    height: 60,\n    tintColor: \"#FFFFFF\",\n  },\n  title: {\n    marginBottom: Spacing.sm,\n    textAlign: \"center\",\n  },\n  subtitle: {\n    textAlign: \"center\",\n    marginBottom: Spacing[\"4xl\"],\n  },\n  features: {\n    width: \"100%\",\n    gap: Spacing.lg,\n  },\n  featureItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n  },\n  featureIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.xs,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  featureText: {\n    flex: 1,\n  },\n  buttonContainer: {\n    gap: Spacing.md,\n  },\n  signInButton: {\n    backgroundColor: Colors.primary,\n  },\n  socialButton: {\n    borderWidth: 1,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  terms: {\n    textAlign: \"center\",\n    marginTop: Spacing.lg,\n  },\n  errorText: {\n    textAlign: \"center\",\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":7358,"size_tokens":null},"client/screens/index.ts":{"content":"/**\n * Screens Index\n * Export all screens for easy imports\n */\n\n// Auth Screens\nexport { default as LoginScreen } from './LoginScreenNew';\nexport { default as RegisterScreen } from './RegisterScreen';\nexport { default as ForgotPasswordScreen } from './ForgotPasswordScreen';\nexport { default as VerifyEmailScreen } from './VerifyEmailScreen';\n\n// Onboarding\nexport { default as OnboardingScreen, hasCompletedOnboarding, resetOnboarding } from './OnboardingScreen';\n\n// Main Tab Screens\nexport { default as HomeScreen } from './HomeScreen';\nexport { default as MessagesScreen } from './MessagesScreen';\nexport { default as ProfileScreen } from './ProfileScreen';\nexport { default as DealsScreen } from './DealsScreen';\n\n// Post Screens\nexport { default as CreatePostScreen } from './CreatePostScreen';\nexport { default as PostDetailScreen } from './PostDetailScreen';\n\n// Messaging Screens\nexport { default as ConversationScreen } from './ConversationScreen';\nexport { default as NewConversationScreen } from './NewConversationScreen';\n\n// Discovery Screens\nexport { default as SearchScreen } from './SearchScreen';\nexport { default as HashtagScreen } from './HashtagScreen';\nexport { default as RoomDetailScreen } from './RoomDetailScreen';\n\n// Profile Screens\nexport { default as UserProfileScreen } from './UserProfileScreen';\nexport { default as EditProfileScreen } from './EditProfileScreen';\nexport { default as FollowersScreen } from './FollowersScreen';\nexport { default as BookmarksScreen } from './BookmarksScreen';\n\n// Gamification Screens\nexport { default as LeaderboardScreen } from './LeaderboardScreen';\nexport { default as AchievementsScreen } from './AchievementsScreen';\n\n// Settings & Account\nexport { default as SettingsScreen } from './SettingsScreen';\nexport { default as PremiumScreen } from './PremiumScreen';\nexport { default as ChangePasswordScreen } from './ChangePasswordScreen';\nexport { default as BlockedUsersScreen } from './BlockedUsersScreen';\nexport { default as DeleteAccountScreen } from './DeleteAccountScreen';\nexport { default as BiometricSettingsScreen } from './BiometricSettingsScreen';\nexport { default as PrivacyPolicyScreen } from './PrivacyPolicyScreen';\nexport { default as TermsOfServiceScreen } from './TermsOfServiceScreen';\n\n// Notifications\nexport { default as NotificationsScreen } from './NotificationsScreen';\n\n// Content Detail Screens\nexport { default as AMADetailScreen } from './AMADetailScreen';\nexport { default as CourseDetailScreen } from './CourseDetailScreen';\nexport { default as EventDetailScreen } from './EventDetailScreen';\nexport { default as DealDetailScreen } from './DealDetailScreen';\nexport { default as LessonPlayerScreen } from './LessonPlayerScreen';\n\n// AI Chat\nexport { default as AIChatScreen } from './AIChatScreen';\n\n// Additional Settings Screens\nexport { default as ContentPreferencesScreen } from './ContentPreferencesScreen';\nexport { default as DataExportScreen } from './DataExportScreen';\nexport { default as NotificationSettingsScreen } from './NotificationSettingsScreen';\nexport { default as ReportScreen } from './ReportScreen';\nexport { default as SavedSearchesScreen } from './SavedSearchesScreen';\nexport { default as AppearanceSettingsScreen } from './AppearanceSettingsScreen';\nexport { default as DraftsScreen } from './DraftsScreen';\nexport { default as EditPostScreen } from './EditPostScreen';\n","path":null,"size_bytes":3399,"size_tokens":null},"packages/shared/src/api/index.ts":{"content":"/**\n * @medinvest/shared - API Client\n * \n * Base API client that works on both web and mobile.\n * Each platform provides its own configuration (token storage, base URL).\n */\n\nimport type {\n  User,\n  UserProfile,\n  Post,\n  Comment,\n  Room,\n  Conversation,\n  Message,\n  Notification,\n  Deal,\n  SearchResults,\n  SearchFilters,\n  PaginatedResponse,\n  LoginRequest,\n  LoginResponse,\n  RegisterRequest,\n  RegisterResponse,\n  NotificationSettings,\n  ContentPreferences,\n  PrivacySettings,\n} from '../types';\nimport type {\n  CreatePostInput,\n  UpdatePostInput,\n  CreateCommentInput,\n  SendMessageInput,\n  MuteUserInput,\n  CreateReportInput,\n  UpdateProfileInput,\n  ChangePasswordInput,\n  ExpressInterestInput,\n} from '../validators';\n\n// =============================================================================\n// TYPES\n// =============================================================================\n\nexport interface ApiClientConfig {\n  /** Base URL for API requests */\n  baseUrl: string;\n  \n  /** Function to get the current auth token */\n  getToken: () => Promise<string | null>;\n  \n  /** Callback when receiving 401 Unauthorized */\n  onUnauthorized?: () => void;\n  \n  /** Callback when receiving any error */\n  onError?: (error: ApiClientError) => void;\n  \n  /** Default timeout in milliseconds */\n  timeout?: number;\n}\n\nexport interface ApiClientError {\n  status: number;\n  code: string;\n  message: string;\n  details?: Record<string, string[]>;\n}\n\nexport interface RequestOptions {\n  /** Skip auth header */\n  noAuth?: boolean;\n  \n  /** Custom timeout */\n  timeout?: number;\n  \n  /** Custom headers */\n  headers?: Record<string, string>;\n}\n\n// =============================================================================\n// API CLIENT CLASS\n// =============================================================================\n\nexport class ApiClient {\n  private config: ApiClientConfig;\n\n  constructor(config: ApiClientConfig) {\n    this.config = {\n      timeout: 30000,\n      ...config,\n    };\n  }\n\n  // ===========================================================================\n  // PRIVATE METHODS\n  // ===========================================================================\n\n  private async request<T>(\n    method: string,\n    path: string,\n    body?: unknown,\n    options: RequestOptions = {}\n  ): Promise<T> {\n    const url = `${this.config.baseUrl}${path}`;\n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    // Add auth token\n    if (!options.noAuth) {\n      const token = await this.config.getToken();\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n    }\n\n    // Create abort controller for timeout\n    const controller = new AbortController();\n    const timeout = options.timeout || this.config.timeout;\n    const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n    try {\n      const response = await fetch(url, {\n        method,\n        headers,\n        body: body ? JSON.stringify(body) : undefined,\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      // Handle errors\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        \n        const error: ApiClientError = {\n          status: response.status,\n          code: errorData.error?.code || 'UNKNOWN_ERROR',\n          message: errorData.error?.message || response.statusText,\n          details: errorData.error?.details,\n        };\n\n        if (response.status === 401) {\n          this.config.onUnauthorized?.();\n        }\n\n        this.config.onError?.(error);\n        throw error;\n      }\n\n      // Handle empty responses\n      if (response.status === 204) {\n        return undefined as T;\n      }\n\n      return response.json();\n    } catch (error) {\n      clearTimeout(timeoutId);\n      \n      if (error instanceof Error && error.name === 'AbortError') {\n        const timeoutError: ApiClientError = {\n          status: 0,\n          code: 'TIMEOUT',\n          message: 'Request timed out',\n        };\n        this.config.onError?.(timeoutError);\n        throw timeoutError;\n      }\n      \n      throw error;\n    }\n  }\n\n  private get<T>(path: string, options?: RequestOptions): Promise<T> {\n    return this.request<T>('GET', path, undefined, options);\n  }\n\n  private post<T>(path: string, body?: unknown, options?: RequestOptions): Promise<T> {\n    return this.request<T>('POST', path, body, options);\n  }\n\n  private put<T>(path: string, body?: unknown, options?: RequestOptions): Promise<T> {\n    return this.request<T>('PUT', path, body, options);\n  }\n\n  private patch<T>(path: string, body?: unknown, options?: RequestOptions): Promise<T> {\n    return this.request<T>('PATCH', path, body, options);\n  }\n\n  private delete<T>(path: string, options?: RequestOptions): Promise<T> {\n    return this.request<T>('DELETE', path, undefined, options);\n  }\n\n  // ===========================================================================\n  // AUTH\n  // ===========================================================================\n\n  async login(data: LoginRequest): Promise<LoginResponse> {\n    return this.post('/auth/login', data, { noAuth: true });\n  }\n\n  async register(data: RegisterRequest): Promise<RegisterResponse> {\n    return this.post('/auth/register', data, { noAuth: true });\n  }\n\n  async logout(): Promise<void> {\n    return this.post('/auth/logout');\n  }\n\n  async refreshToken(refreshToken: string): Promise<{ token: string; refresh_token: string }> {\n    return this.post('/auth/refresh', { refresh_token: refreshToken }, { noAuth: true });\n  }\n\n  async forgotPassword(email: string): Promise<{ message: string }> {\n    return this.post('/auth/forgot-password', { email }, { noAuth: true });\n  }\n\n  async resetPassword(token: string, password: string): Promise<{ message: string }> {\n    return this.post('/auth/reset-password', { token, password }, { noAuth: true });\n  }\n\n  async verifyEmail(token: string): Promise<{ message: string }> {\n    return this.post('/auth/verify-email', { token }, { noAuth: true });\n  }\n\n  async resendVerification(email: string): Promise<{ message: string }> {\n    return this.post('/auth/resend-verification', { email }, { noAuth: true });\n  }\n\n  // ===========================================================================\n  // USERS\n  // ===========================================================================\n\n  async getCurrentUser(): Promise<User> {\n    return this.get('/users/me');\n  }\n\n  async updateProfile(data: UpdateProfileInput): Promise<User> {\n    return this.put('/users/me', data);\n  }\n\n  async changePassword(data: ChangePasswordInput): Promise<{ message: string }> {\n    return this.put('/users/me/password', data);\n  }\n\n  async getUser(id: number): Promise<UserProfile> {\n    return this.get(`/users/${id}`);\n  }\n\n  async getUserByUsername(username: string): Promise<UserProfile> {\n    return this.get(`/users/username/${username}`);\n  }\n\n  async followUser(id: number): Promise<void> {\n    return this.post(`/users/${id}/follow`);\n  }\n\n  async unfollowUser(id: number): Promise<void> {\n    return this.delete(`/users/${id}/follow`);\n  }\n\n  async getFollowers(id: number, page = 1, limit = 20): Promise<PaginatedResponse<User>> {\n    return this.get(`/users/${id}/followers?page=${page}&limit=${limit}`);\n  }\n\n  async getFollowing(id: number, page = 1, limit = 20): Promise<PaginatedResponse<User>> {\n    return this.get(`/users/${id}/following?page=${page}&limit=${limit}`);\n  }\n\n  async blockUser(id: number): Promise<void> {\n    return this.post(`/users/${id}/block`);\n  }\n\n  async unblockUser(id: number): Promise<void> {\n    return this.delete(`/users/${id}/block`);\n  }\n\n  async getBlockedUsers(): Promise<User[]> {\n    return this.get('/users/blocked');\n  }\n\n  async muteUser(id: number, settings: MuteUserInput): Promise<void> {\n    return this.post(`/users/${id}/mute`, settings);\n  }\n\n  async unmuteUser(id: number): Promise<void> {\n    return this.delete(`/users/${id}/mute`);\n  }\n\n  async getMutedUsers(): Promise<User[]> {\n    return this.get('/users/muted');\n  }\n\n  // ===========================================================================\n  // POSTS\n  // ===========================================================================\n\n  async getFeed(page = 1, limit = 20, roomId?: number): Promise<PaginatedResponse<Post>> {\n    let url = `/posts/feed?page=${page}&limit=${limit}`;\n    if (roomId) url += `&room_id=${roomId}`;\n    return this.get(url);\n  }\n\n  async getPost(id: number): Promise<Post> {\n    return this.get(`/posts/${id}`);\n  }\n\n  async getUserPosts(userId: number, page = 1, limit = 20): Promise<PaginatedResponse<Post>> {\n    return this.get(`/users/${userId}/posts?page=${page}&limit=${limit}`);\n  }\n\n  async createPost(data: CreatePostInput): Promise<Post> {\n    return this.post('/posts', data);\n  }\n\n  async updatePost(id: number, data: UpdatePostInput): Promise<Post> {\n    return this.put(`/posts/${id}`, data);\n  }\n\n  async deletePost(id: number): Promise<void> {\n    return this.delete(`/posts/${id}`);\n  }\n\n  async likePost(id: number): Promise<void> {\n    return this.post(`/posts/${id}/like`);\n  }\n\n  async unlikePost(id: number): Promise<void> {\n    return this.delete(`/posts/${id}/like`);\n  }\n\n  async reactToPost(id: number, type: string): Promise<void> {\n    return this.post(`/posts/${id}/react`, { type });\n  }\n\n  async removeReaction(id: number): Promise<void> {\n    return this.delete(`/posts/${id}/react`);\n  }\n\n  async bookmarkPost(id: number): Promise<void> {\n    return this.post(`/posts/${id}/bookmark`);\n  }\n\n  async unbookmarkPost(id: number): Promise<void> {\n    return this.delete(`/posts/${id}/bookmark`);\n  }\n\n  async getBookmarks(page = 1, limit = 20): Promise<PaginatedResponse<Post>> {\n    return this.get(`/posts/bookmarks?page=${page}&limit=${limit}`);\n  }\n\n  async pinPost(id: number): Promise<void> {\n    return this.post(`/posts/${id}/pin`);\n  }\n\n  async unpinPost(id: number): Promise<void> {\n    return this.delete(`/posts/${id}/pin`);\n  }\n\n  async getPinnedPosts(userId: number): Promise<Post[]> {\n    return this.get(`/users/${userId}/pinned-posts`);\n  }\n\n  async reportPost(id: number, data: Omit<CreateReportInput, 'type' | 'target_id'>): Promise<void> {\n    return this.post(`/posts/${id}/report`, data);\n  }\n\n  // ===========================================================================\n  // COMMENTS\n  // ===========================================================================\n\n  async getComments(postId: number, page = 1, limit = 20): Promise<PaginatedResponse<Comment>> {\n    return this.get(`/posts/${postId}/comments?page=${page}&limit=${limit}`);\n  }\n\n  async createComment(postId: number, data: CreateCommentInput): Promise<Comment> {\n    return this.post(`/posts/${postId}/comments`, data);\n  }\n\n  async updateComment(id: number, content: string): Promise<Comment> {\n    return this.put(`/comments/${id}`, { content });\n  }\n\n  async deleteComment(id: number): Promise<void> {\n    return this.delete(`/comments/${id}`);\n  }\n\n  async likeComment(id: number): Promise<void> {\n    return this.post(`/comments/${id}/like`);\n  }\n\n  async unlikeComment(id: number): Promise<void> {\n    return this.delete(`/comments/${id}/like`);\n  }\n\n  // ===========================================================================\n  // POLLS\n  // ===========================================================================\n\n  async votePoll(postId: number, pollId: string, optionIds: string[]): Promise<void> {\n    return this.post(`/posts/${postId}/polls/${pollId}/vote`, { option_ids: optionIds });\n  }\n\n  // ===========================================================================\n  // ROOMS\n  // ===========================================================================\n\n  async getRooms(): Promise<Room[]> {\n    return this.get('/rooms');\n  }\n\n  async getRoom(id: number): Promise<Room> {\n    return this.get(`/rooms/${id}`);\n  }\n\n  async getRoomPosts(id: number, page = 1, limit = 20): Promise<PaginatedResponse<Post>> {\n    return this.get(`/rooms/${id}/posts?page=${page}&limit=${limit}`);\n  }\n\n  async joinRoom(id: number): Promise<void> {\n    return this.post(`/rooms/${id}/join`);\n  }\n\n  async leaveRoom(id: number): Promise<void> {\n    return this.delete(`/rooms/${id}/join`);\n  }\n\n  async getJoinedRooms(): Promise<Room[]> {\n    return this.get('/rooms/joined');\n  }\n\n  // ===========================================================================\n  // MESSAGES\n  // ===========================================================================\n\n  async getConversations(page = 1, limit = 20): Promise<PaginatedResponse<Conversation>> {\n    return this.get(`/conversations?page=${page}&limit=${limit}`);\n  }\n\n  async getConversation(id: number): Promise<Conversation> {\n    return this.get(`/conversations/${id}`);\n  }\n\n  async createConversation(userId: number): Promise<Conversation> {\n    return this.post('/conversations', { user_id: userId });\n  }\n\n  async deleteConversation(id: number): Promise<void> {\n    return this.delete(`/conversations/${id}`);\n  }\n\n  async getMessages(conversationId: number, page = 1, limit = 50): Promise<PaginatedResponse<Message>> {\n    return this.get(`/conversations/${conversationId}/messages?page=${page}&limit=${limit}`);\n  }\n\n  async sendMessage(conversationId: number, data: SendMessageInput): Promise<Message> {\n    return this.post(`/conversations/${conversationId}/messages`, data);\n  }\n\n  async markConversationRead(id: number): Promise<void> {\n    return this.post(`/conversations/${id}/read`);\n  }\n\n  async muteConversation(id: number): Promise<void> {\n    return this.post(`/conversations/${id}/mute`);\n  }\n\n  async unmuteConversation(id: number): Promise<void> {\n    return this.delete(`/conversations/${id}/mute`);\n  }\n\n  // ===========================================================================\n  // NOTIFICATIONS\n  // ===========================================================================\n\n  async getNotifications(page = 1, limit = 20): Promise<PaginatedResponse<Notification> & { unread_count: number }> {\n    return this.get(`/notifications?page=${page}&limit=${limit}`);\n  }\n\n  async markNotificationRead(id: number): Promise<void> {\n    return this.post(`/notifications/${id}/read`);\n  }\n\n  async markAllNotificationsRead(): Promise<void> {\n    return this.post('/notifications/read-all');\n  }\n\n  async getUnreadCount(): Promise<{ count: number }> {\n    return this.get('/notifications/unread-count');\n  }\n\n  // ===========================================================================\n  // SEARCH\n  // ===========================================================================\n\n  async search(query: string, filters?: SearchFilters, page = 1, limit = 20): Promise<SearchResults> {\n    const params = new URLSearchParams({ query, page: String(page), limit: String(limit) });\n    if (filters?.type) params.append('type', filters.type);\n    if (filters?.room_id) params.append('room_id', String(filters.room_id));\n    if (filters?.date_from) params.append('date_from', filters.date_from);\n    if (filters?.date_to) params.append('date_to', filters.date_to);\n    if (filters?.sort_by) params.append('sort_by', filters.sort_by);\n    return this.get(`/search?${params}`);\n  }\n\n  async getTrending(): Promise<{ topics: { tag: string; post_count: number }[] }> {\n    return this.get('/search/trending');\n  }\n\n  async getAutocomplete(query: string): Promise<{\n    suggestions: string[];\n    users: User[];\n    hashtags: string[];\n  }> {\n    return this.get(`/search/autocomplete?q=${encodeURIComponent(query)}`);\n  }\n\n  // ===========================================================================\n  // DEALS\n  // ===========================================================================\n\n  async getDeals(page = 1, limit = 20, filters?: {\n    stage?: string;\n    sector?: string;\n    min_investment?: number;\n  }): Promise<PaginatedResponse<Deal>> {\n    const params = new URLSearchParams({ page: String(page), limit: String(limit) });\n    if (filters?.stage) params.append('stage', filters.stage);\n    if (filters?.sector) params.append('sector', filters.sector);\n    if (filters?.min_investment) params.append('min_investment', String(filters.min_investment));\n    return this.get(`/deals?${params}`);\n  }\n\n  async getDeal(id: number): Promise<Deal> {\n    return this.get(`/deals/${id}`);\n  }\n\n  async watchDeal(id: number): Promise<void> {\n    return this.post(`/deals/${id}/watch`);\n  }\n\n  async unwatchDeal(id: number): Promise<void> {\n    return this.delete(`/deals/${id}/watch`);\n  }\n\n  async expressInterest(id: number, data: ExpressInterestInput): Promise<void> {\n    return this.post(`/deals/${id}/interest`, data);\n  }\n\n  // ===========================================================================\n  // SETTINGS\n  // ===========================================================================\n\n  async getNotificationSettings(): Promise<NotificationSettings> {\n    return this.get('/settings/notifications');\n  }\n\n  async updateNotificationSettings(settings: Partial<NotificationSettings>): Promise<NotificationSettings> {\n    return this.put('/settings/notifications', settings);\n  }\n\n  async getContentPreferences(): Promise<ContentPreferences> {\n    return this.get('/settings/content');\n  }\n\n  async updateContentPreferences(preferences: Partial<ContentPreferences>): Promise<ContentPreferences> {\n    return this.put('/settings/content', preferences);\n  }\n\n  async getPrivacySettings(): Promise<PrivacySettings> {\n    return this.get('/settings/privacy');\n  }\n\n  async updatePrivacySettings(settings: Partial<PrivacySettings>): Promise<PrivacySettings> {\n    return this.put('/settings/privacy', settings);\n  }\n\n  // ===========================================================================\n  // ACCOUNT\n  // ===========================================================================\n\n  async requestDataExport(categories: string[], format: 'json' | 'csv' | 'html'): Promise<{ export_id: string }> {\n    return this.post('/account/export', { categories, format });\n  }\n\n  async getExportStatus(id: string): Promise<{\n    status: string;\n    progress: number;\n    download_url?: string;\n  }> {\n    return this.get(`/account/export/${id}/status`);\n  }\n\n  async deleteAccount(password: string): Promise<void> {\n    return this.delete('/account', { headers: { 'X-Password': password } });\n  }\n\n  // ===========================================================================\n  // DEVICES (Push Notifications)\n  // ===========================================================================\n\n  async registerDevice(token: string, platform: 'ios' | 'android'): Promise<void> {\n    return this.post('/devices/register', { token, platform });\n  }\n\n  async unregisterDevice(token: string): Promise<void> {\n    return this.delete(`/devices/${token}`);\n  }\n\n  // ===========================================================================\n  // REPORTS\n  // ===========================================================================\n\n  async createReport(data: CreateReportInput): Promise<void> {\n    return this.post('/reports', data);\n  }\n\n  // ===========================================================================\n  // APP VERSION\n  // ===========================================================================\n\n  async checkAppVersion(\n    currentVersion: string,\n    platform: 'ios' | 'android'\n  ): Promise<{\n    latest_version: string;\n    minimum_version: string;\n    update_required: boolean;\n    update_recommended: boolean;\n    release_notes?: string[];\n  }> {\n    return this.get(`/app/version?currentVersion=${currentVersion}&platform=${platform}`);\n  }\n}\n\n// =============================================================================\n// FACTORY FUNCTION\n// =============================================================================\n\nexport function createApiClient(config: ApiClientConfig): ApiClient {\n  return new ApiClient(config);\n}\n","path":null,"size_bytes":19974,"size_tokens":null},"client/components/PostCard.tsx":{"content":"/**\n * PostCard Component\n * Displays a single post with voting, comments, and interactions\n */\n\nimport React, { memo, useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  Pressable,\n  Dimensions,\n} from 'react-native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { Post, VoteDirection } from '@/types';\nimport { formatRelativeTime, formatNumber } from '@/lib/utils';\nimport RichTextContent from './RichTextContent';\n\nconst { width } = Dimensions.get('window');\nconst IMAGE_SIZE = width - Spacing.lg * 2;\n\ninterface PostCardProps {\n  post: Post;\n  onPress: () => void;\n  onUserPress: () => void;\n  onVote: (direction: VoteDirection) => void;\n  onBookmark: () => void;\n  onHashtagPress?: (tag: string) => void;\n  onMentionPress?: (userId: number) => void;\n  showFullContent?: boolean;\n}\n\nfunction PostCard({\n  post,\n  onPress,\n  onUserPress,\n  onVote,\n  onBookmark,\n  onHashtagPress,\n  onMentionPress,\n  showFullContent = false,\n}: PostCardProps) {\n  const appColors = useAppColors();\n  const [imageError, setImageError] = useState(false);\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n\n  const score = post.upvotes - post.downvotes;\n  const hasMultipleImages = post.images && post.images.length > 1;\n\n  const handleUpvote = () => {\n    onVote(post.user_vote === 'up' ? null : 'up');\n  };\n\n  const handleDownvote = () => {\n    onVote(post.user_vote === 'down' ? null : 'down');\n  };\n\n  const renderAuthor = () => {\n    if (post.is_anonymous) {\n      return (\n        <View style={styles.authorContainer}>\n          <View style={[styles.avatar, styles.anonymousAvatar]}>\n            <Ionicons name=\"person\" size={20} color={appColors.textSecondary} />\n          </View>\n          <View style={styles.authorInfo}>\n            <ThemedText style={[styles.authorName, { color: appColors.textPrimary }]}>\n              {post.anonymous_name || 'Anonymous'}\n            </ThemedText>\n            <ThemedText style={[styles.timestamp, { color: appColors.textSecondary }]}>\n              {formatRelativeTime(post.created_at)}\n            </ThemedText>\n          </View>\n        </View>\n      );\n    }\n\n    return (\n      <TouchableOpacity style={styles.authorContainer} onPress={onUserPress}>\n        {post.author.avatar_url ? (\n          <Image source={{ uri: post.author.avatar_url }} style={styles.avatar} />\n        ) : (\n          <View style={[styles.avatar, styles.avatarPlaceholder]}>\n            <ThemedText style={styles.avatarText}>\n              {post.author.first_name[0]}{post.author.last_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View style={styles.authorInfo}>\n          <View style={styles.authorNameRow}>\n            <ThemedText style={[styles.authorName, { color: appColors.textPrimary }]}>{post.author.full_name}</ThemedText>\n            {post.author.is_verified && (\n              <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n            )}\n            {post.author.is_premium && (\n              <MaterialCommunityIcons name=\"crown\" size={14} color={appColors.warning} />\n            )}\n          </View>\n          <View style={styles.authorMeta}>\n            {post.author.specialty && (\n              <ThemedText style={[styles.specialty, { color: appColors.textSecondary }]}>{post.author.specialty}</ThemedText>\n            )}\n            <ThemedText style={[styles.timestamp, { color: appColors.textSecondary }]}>\n              ¬∑ {formatRelativeTime(post.created_at)}\n            </ThemedText>\n          </View>\n        </View>\n      </TouchableOpacity>\n    );\n  };\n\n  const renderRoom = () => (\n    <View style={[styles.roomBadge, { backgroundColor: post.room.color + '20' }]}>\n      <ThemedText style={styles.roomIcon}>{post.room.icon}</ThemedText>\n      <ThemedText style={[styles.roomName, { color: post.room.color }]}>\n        {post.room.name}\n      </ThemedText>\n    </View>\n  );\n\n  const renderImages = () => {\n    if (!post.images || post.images.length === 0 || imageError) return null;\n\n    if (post.images.length === 1) {\n      return (\n        <TouchableOpacity onPress={onPress} style={styles.imageContainer}>\n          <Image\n            source={{ uri: post.images[0] }}\n            style={styles.singleImage}\n            resizeMode=\"cover\"\n            onError={() => setImageError(true)}\n          />\n        </TouchableOpacity>\n      );\n    }\n\n    return (\n      <View style={styles.imageGallery}>\n        <Image\n          source={{ uri: post.images[currentImageIndex] }}\n          style={styles.galleryImage}\n          resizeMode=\"cover\"\n        />\n        <View style={styles.imageIndicators}>\n          {post.images.map((_, index) => (\n            <TouchableOpacity\n              key={index}\n              style={[\n                styles.imageIndicator,\n                index === currentImageIndex && styles.imageIndicatorActive,\n              ]}\n              onPress={() => setCurrentImageIndex(index)}\n            />\n          ))}\n        </View>\n        <View style={styles.imageCounter}>\n          <ThemedText style={styles.imageCounterText}>\n            {currentImageIndex + 1}/{post.images.length}\n          </ThemedText>\n        </View>\n      </View>\n    );\n  };\n\n  const renderActions = () => (\n    <View style={styles.actions}>\n      {/* Voting */}\n      <View style={styles.voteContainer}>\n        <TouchableOpacity\n          style={[styles.voteButton, post.user_vote === 'up' && styles.voteButtonActive]}\n          onPress={handleUpvote}\n        >\n          <Ionicons\n            name={post.user_vote === 'up' ? 'arrow-up' : 'arrow-up-outline'}\n            size={20}\n            color={post.user_vote === 'up' ? Colors.secondary : appColors.textSecondary}\n          />\n        </TouchableOpacity>\n        <ThemedText\n          style={[\n            styles.voteScore,\n            { color: appColors.textPrimary },\n            score > 0 && styles.voteScorePositive,\n            score < 0 && { color: appColors.error },\n          ]}\n        >\n          {formatNumber(score)}\n        </ThemedText>\n        <TouchableOpacity\n          style={[styles.voteButton, post.user_vote === 'down' && styles.voteButtonActive]}\n          onPress={handleDownvote}\n        >\n          <Ionicons\n            name={post.user_vote === 'down' ? 'arrow-down' : 'arrow-down-outline'}\n            size={20}\n            color={post.user_vote === 'down' ? appColors.error : appColors.textSecondary}\n          />\n        </TouchableOpacity>\n      </View>\n\n      {/* Comments */}\n      <TouchableOpacity style={styles.actionButton} onPress={onPress}>\n        <Ionicons name=\"chatbubble-outline\" size={20} color={appColors.textSecondary} />\n        <ThemedText style={[styles.actionText, { color: appColors.textSecondary }]}>\n          {formatNumber(post.comments_count)}\n        </ThemedText>\n      </TouchableOpacity>\n\n      {/* Share */}\n      <TouchableOpacity style={styles.actionButton}>\n        <Ionicons name=\"share-outline\" size={20} color={appColors.textSecondary} />\n      </TouchableOpacity>\n\n      {/* Bookmark */}\n      <TouchableOpacity style={styles.actionButton} onPress={onBookmark}>\n        <Ionicons\n          name={post.is_bookmarked ? 'bookmark' : 'bookmark-outline'}\n          size={20}\n          color={post.is_bookmarked ? Colors.primary : appColors.textSecondary}\n        />\n      </TouchableOpacity>\n    </View>\n  );\n\n  return (\n    <Pressable style={[styles.container, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]} onPress={onPress}>\n      <View style={styles.header}>\n        {renderAuthor()}\n        {renderRoom()}\n      </View>\n\n      <RichTextContent\n        content={post.content}\n        mentions={post.mentions}\n        hashtags={post.hashtags}\n        onHashtagPress={onHashtagPress}\n        onMentionPress={onMentionPress}\n        numberOfLines={showFullContent ? undefined : 5}\n        style={styles.content}\n      />\n\n      {renderImages()}\n      {renderActions()}\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    marginBottom: Spacing.sm,\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n    marginBottom: Spacing.md,\n  },\n  authorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  avatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  anonymousAvatar: {\n    backgroundColor: Colors.light.backgroundTertiary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  authorInfo: {\n    flex: 1,\n  },\n  authorNameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  authorName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  authorMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: 2,\n  },\n  specialty: {\n    ...Typography.small,\n  },\n  timestamp: {\n    ...Typography.small,\n    marginLeft: Spacing.xs,\n  },\n  roomBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  roomIcon: {\n    fontSize: 12,\n  },\n  roomName: {\n    ...Typography.small,\n    fontWeight: '500',\n  },\n  content: {\n    marginBottom: Spacing.md,\n  },\n  imageContainer: {\n    marginBottom: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    overflow: 'hidden',\n  },\n  singleImage: {\n    width: '100%',\n    height: IMAGE_SIZE * 0.75,\n    borderRadius: BorderRadius.sm,\n  },\n  imageGallery: {\n    marginBottom: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  galleryImage: {\n    width: '100%',\n    height: IMAGE_SIZE * 0.75,\n  },\n  imageIndicators: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    position: 'absolute',\n    bottom: Spacing.md,\n    left: 0,\n    right: 0,\n    gap: Spacing.xs,\n  },\n  imageIndicator: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: 'rgba(255,255,255,0.5)',\n  },\n  imageIndicatorActive: {\n    backgroundColor: 'white',\n    width: 16,\n  },\n  imageCounter: {\n    position: 'absolute',\n    top: Spacing.md,\n    right: Spacing.md,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n  },\n  imageCounterText: {\n    ...Typography.small,\n    color: 'white',\n  },\n  actions: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.sm,\n  },\n  voteContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.full,\n    marginRight: Spacing.md,\n  },\n  voteButton: {\n    padding: Spacing.sm,\n  },\n  voteButtonActive: {\n    backgroundColor: Colors.light.backgroundTertiary,\n    borderRadius: BorderRadius.full,\n  },\n  voteScore: {\n    ...Typography.body,\n    fontWeight: '600',\n    minWidth: 32,\n    textAlign: 'center',\n  },\n  voteScorePositive: {\n    color: Colors.secondary,\n  },\n  actionButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  actionText: {\n    ...Typography.caption,\n  },\n});\n\nexport default memo(PostCard);\n","path":null,"size_bytes":11843,"size_tokens":null},"client/components/AIChat/AIChatSheet.tsx":{"content":"import React, { useState, useCallback, useRef, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  FlatList,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n  Keyboard,\n} from 'react-native';\nimport { BlurView } from 'expo-blur';\nimport { Feather } from '@expo/vector-icons';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  withTiming,\n  runOnJS,\n} from 'react-native-reanimated';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { getApiUrl } from '@/lib/query-client';\nimport { useAuth } from '@/contexts/AuthContext';\n\nconst TypographySizes = {\n  xs: 10,\n  sm: 12,\n  md: 14,\n  lg: 16,\n  xl: 18,\n  xxl: 20,\n};\n\ninterface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n}\n\ninterface AIChatSheetProps {\n  visible: boolean;\n  onClose: () => void;\n  title?: string;\n  placeholder?: string;\n  systemPrompt?: string;\n}\n\nconst SPRING_CONFIG = {\n  damping: 20,\n  stiffness: 300,\n  mass: 0.8,\n};\n\nexport default function AIChatSheet({\n  visible,\n  onClose,\n  title = 'MedInvest AI',\n  placeholder = 'Ask about investments, healthcare trends...',\n  systemPrompt = 'You are a helpful AI assistant for MedInvest, a healthcare investment platform. Help users understand investments, healthcare trends, and market opportunities.',\n}: AIChatSheetProps) {\n  const { isDark, colors: themeColors } = useThemeContext();\n  const { token } = useAuth();\n  const appColors = useAppColors();\n  const colors = {\n    primary: appColors.primary,\n    text: appColors.textPrimary,\n    textSecondary: appColors.textSecondary,\n    background: appColors.background,\n    cardBackground: appColors.surface,\n    border: appColors.border,\n  };\n  const insets = useSafeAreaInsets();\n  \n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputText, setInputText] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const flatListRef = useRef<FlatList>(null);\n  \n  const translateY = useSharedValue(1000);\n  const opacity = useSharedValue(0);\n\n  useEffect(() => {\n    if (visible) {\n      opacity.value = withTiming(1, { duration: 200 });\n      translateY.value = withSpring(0, SPRING_CONFIG);\n    } else {\n      opacity.value = withTiming(0, { duration: 150 });\n      translateY.value = withSpring(1000, SPRING_CONFIG);\n    }\n  }, [visible, opacity, translateY]);\n\n  const handleClose = useCallback(() => {\n    Keyboard.dismiss();\n    opacity.value = withTiming(0, { duration: 150 });\n    translateY.value = withSpring(1000, SPRING_CONFIG, () => {\n      runOnJS(onClose)();\n    });\n  }, [opacity, translateY, onClose]);\n\n  const sendMessage = useCallback(async () => {\n    if (!inputText.trim() || isLoading) return;\n\n    const userMessage: Message = {\n      id: `msg_${Date.now()}`,\n      role: 'user',\n      content: inputText.trim(),\n      timestamp: new Date(),\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInputText('');\n    setIsLoading(true);\n\n    try {\n      const apiUrl = new URL('/api/ai/chat', getApiUrl()).toString();\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: { \n          'Content-Type': 'application/json',\n          ...(token ? { 'Authorization': `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({\n          messages: [...messages, userMessage].map(m => ({\n            role: m.role,\n            content: m.content,\n          })),\n          systemPrompt,\n        }),\n      });\n\n      if (!response.ok) throw new Error('Failed to get response');\n\n      const data = await response.json();\n      \n      const assistantMessage: Message = {\n        id: `msg_${Date.now()}_assistant`,\n        role: 'assistant',\n        content: data.content || data.message || 'I apologize, I could not generate a response.',\n        timestamp: new Date(),\n      };\n\n      setMessages(prev => [...prev, assistantMessage]);\n    } catch (error) {\n      const errorMessage: Message = {\n        id: `msg_${Date.now()}_error`,\n        role: 'assistant',\n        content: 'I apologize, there was an error processing your request. Please try again.',\n        timestamp: new Date(),\n      };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [inputText, isLoading, messages, systemPrompt, token]);\n\n  const renderMessage = useCallback(({ item }: { item: Message }) => {\n    const isUser = item.role === 'user';\n    \n    return (\n      <View\n        style={[\n          styles.messageContainer,\n          isUser ? styles.userMessageContainer : styles.assistantMessageContainer,\n        ]}\n      >\n        <View\n          style={[\n            styles.messageBubble,\n            isUser\n              ? { backgroundColor: colors.primary }\n              : { backgroundColor: colors.cardBackground },\n          ]}\n        >\n          <Text\n            style={[\n              styles.messageText,\n              { color: isUser ? '#FFFFFF' : colors.text },\n            ]}\n          >\n            {item.content}\n          </Text>\n        </View>\n      </View>\n    );\n  }, [colors]);\n\n  const backdropStyle = useAnimatedStyle(() => ({\n    opacity: opacity.value,\n  }));\n\n  const sheetStyle = useAnimatedStyle(() => ({\n    transform: [{ translateY: translateY.value }],\n  }));\n\n  if (!visible) return null;\n\n  return (\n    <View style={StyleSheet.absoluteFill}>\n      <Animated.View style={[styles.backdrop, backdropStyle]}>\n        <Pressable style={StyleSheet.absoluteFill} onPress={handleClose} />\n      </Animated.View>\n\n      <Animated.View\n        style={[\n          styles.sheet,\n          sheetStyle,\n          { paddingBottom: insets.bottom },\n        ]}\n      >\n        <BlurView\n          intensity={80}\n          tint={isDark ? 'dark' : 'light'}\n          style={StyleSheet.absoluteFill}\n        />\n        \n        <View style={[styles.content, { backgroundColor: colors.background + 'F0' }]}>\n          <View style={styles.header}>\n            <View style={styles.handle} />\n            <View style={styles.headerContent}>\n              <View style={styles.aiIcon}>\n                <Feather name=\"cpu\" size={20} color={colors.primary} />\n              </View>\n              <Text style={[styles.title, { color: colors.text }]}>{title}</Text>\n              <Pressable onPress={handleClose} style={styles.closeButton}>\n                <Feather name=\"x\" size={24} color={colors.textSecondary} />\n              </Pressable>\n            </View>\n          </View>\n\n          <KeyboardAvoidingView\n            style={styles.chatContainer}\n            behavior={Platform.OS === 'ios' ? 'padding' : undefined}\n            keyboardVerticalOffset={Platform.OS === 'ios' ? 100 : 0}\n          >\n            <FlatList\n              ref={flatListRef}\n              data={messages}\n              renderItem={renderMessage}\n              keyExtractor={item => item.id}\n              contentContainerStyle={styles.messagesList}\n              onContentSizeChange={() => {\n                flatListRef.current?.scrollToEnd({ animated: true });\n              }}\n              ListEmptyComponent={\n                <View style={styles.emptyState}>\n                  <Feather name=\"message-circle\" size={48} color={colors.textSecondary} />\n                  <Text style={[styles.emptyTitle, { color: colors.text }]}>\n                    How can I help you today?\n                  </Text>\n                  <Text style={[styles.emptySubtitle, { color: colors.textSecondary }]}>\n                    Ask me about investments, healthcare trends, or market analysis.\n                  </Text>\n                </View>\n              }\n            />\n\n            <View style={[styles.inputContainer, { borderTopColor: colors.border }]}>\n              <TextInput\n                style={[\n                  styles.input,\n                  {\n                    backgroundColor: colors.cardBackground,\n                    color: colors.text,\n                  },\n                ]}\n                placeholder={placeholder}\n                placeholderTextColor={colors.textSecondary}\n                value={inputText}\n                onChangeText={setInputText}\n                multiline\n                maxLength={1000}\n                editable={!isLoading}\n                onSubmitEditing={sendMessage}\n              />\n              <Pressable\n                style={[\n                  styles.sendButton,\n                  {\n                    backgroundColor: inputText.trim() && !isLoading\n                      ? colors.primary\n                      : colors.border,\n                  },\n                ]}\n                onPress={sendMessage}\n                disabled={!inputText.trim() || isLoading}\n              >\n                {isLoading ? (\n                  <ActivityIndicator size=\"small\" color=\"#FFFFFF\" />\n                ) : (\n                  <Feather name=\"send\" size={20} color=\"#FFFFFF\" />\n                )}\n              </Pressable>\n            </View>\n          </KeyboardAvoidingView>\n        </View>\n      </Animated.View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  backdrop: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n  },\n  sheet: {\n    position: 'absolute',\n    left: 0,\n    right: 0,\n    bottom: 0,\n    height: '85%',\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    overflow: 'hidden',\n  },\n  content: {\n    flex: 1,\n  },\n  header: {\n    alignItems: 'center',\n    paddingTop: Spacing.sm,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: StyleSheet.hairlineWidth,\n  },\n  handle: {\n    width: 36,\n    height: 4,\n    borderRadius: 2,\n    backgroundColor: 'rgba(128, 128, 128, 0.4)',\n    marginBottom: Spacing.sm,\n  },\n  headerContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n    paddingHorizontal: Spacing.lg,\n  },\n  aiIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: BorderRadius.md,\n    backgroundColor: 'rgba(0, 102, 204, 0.1)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.sm,\n  },\n  title: {\n    flex: 1,\n    fontSize: Typography.heading.fontSize,\n    fontWeight: Typography.heading.fontWeight,\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  chatContainer: {\n    flex: 1,\n  },\n  messagesList: {\n    padding: Spacing.md,\n    flexGrow: 1,\n  },\n  messageContainer: {\n    marginBottom: Spacing.sm,\n  },\n  userMessageContainer: {\n    alignItems: 'flex-end',\n  },\n  assistantMessageContainer: {\n    alignItems: 'flex-start',\n  },\n  messageBubble: {\n    maxWidth: '80%',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.lg,\n  },\n  messageText: {\n    fontSize: Typography.body.fontSize,\n    lineHeight: 22,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    padding: Spacing.md,\n    borderTopWidth: StyleSheet.hairlineWidth,\n    gap: Spacing.sm,\n  },\n  input: {\n    flex: 1,\n    minHeight: 44,\n    maxHeight: 120,\n    borderRadius: BorderRadius.lg,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    fontSize: Typography.body.fontSize,\n  },\n  sendButton: {\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.lg,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  emptyState: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing['3xl'] * 2,\n  },\n  emptyTitle: {\n    fontSize: Typography.heading.fontSize,\n    fontWeight: Typography.heading.fontWeight,\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.xs,\n  },\n  emptySubtitle: {\n    fontSize: Typography.body.fontSize,\n    textAlign: 'center',\n    lineHeight: 22,\n  },\n});\n","path":null,"size_bytes":11926,"size_tokens":null},"app.config.js":{"content":"const appJson = require('./app.json');\n\nfunction getApiBaseUrl() {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    return `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n  }\n\n  if (process.env.OAUTH_CALLBACK_DOMAIN) {\n    return `https://${process.env.OAUTH_CALLBACK_DOMAIN}`;\n  }\n\n  const domain = process.env.EXPO_PUBLIC_DOMAIN \n    || process.env.REPLIT_DEV_DOMAIN;\n  \n  if (domain) {\n    const cleanDomain = domain.replace(/:5000$/, '');\n    const protocol = cleanDomain.includes('localhost') ? 'http' : 'https';\n    return `${protocol}://${cleanDomain}`;\n  }\n  \n  return 'http://localhost:5000';\n}\n\nmodule.exports = {\n  ...appJson,\n  expo: {\n    ...appJson.expo,\n    extra: {\n      ...appJson.expo?.extra,\n      apiBaseUrl: getApiBaseUrl(),\n    },\n  },\n};\n","path":null,"size_bytes":770,"size_tokens":null},"server/routes/rooms.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { authMiddleware, optionalAuthMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\nconst ROOMS = [\n  { \n    id: 1, \n    name: 'Cardiology', \n    slug: 'cardiology', \n    description: 'Heart health and cardiovascular innovations. Discuss the latest in cardiac care, devices, and treatment methodologies.',\n    icon: 'heart', \n    color: '#EF4444', \n    posts_count: 1243, \n    members_count: 8521,\n    rules: ['Be respectful', 'No promotional content', 'Cite sources'],\n    moderators: [{ id: 1, name: 'Dr. Sarah Chen' }],\n  },\n  { \n    id: 2, \n    name: 'Oncology', \n    slug: 'oncology', \n    description: 'Cancer research and treatment advances. Share insights on immunotherapy, targeted treatments, and clinical trials.',\n    icon: 'activity', \n    color: '#8B5CF6', \n    posts_count: 987, \n    members_count: 6234,\n    rules: ['Evidence-based discussion only', 'Patient privacy first', 'No misinformation'],\n    moderators: [{ id: 2, name: 'Dr. Michael Roberts' }],\n  },\n  { \n    id: 3, \n    name: 'Neurology', \n    slug: 'neurology', \n    description: 'Brain and nervous system innovations. Explore neurodegenerative diseases, brain-computer interfaces, and neurological research.',\n    icon: 'cpu', \n    color: '#3B82F6', \n    posts_count: 756, \n    members_count: 5102,\n    rules: ['Scientific rigor required', 'Respectful debate', 'No personal attacks'],\n    moderators: [{ id: 3, name: 'Dr. Emily Thompson' }],\n  },\n  { \n    id: 4, \n    name: 'Digital Health', \n    slug: 'digital-health', \n    description: 'Health tech and digital therapeutics. Discuss telemedicine, wearables, health apps, and the future of connected healthcare.',\n    icon: 'smartphone', \n    color: '#10B981', \n    posts_count: 1567, \n    members_count: 9876,\n    rules: ['Share insights openly', 'Disclose conflicts of interest', 'Focus on patient outcomes'],\n    moderators: [{ id: 4, name: 'James Wilson, PhD' }],\n  },\n  { \n    id: 5, \n    name: 'Biotech', \n    slug: 'biotech', \n    description: 'Biotechnology breakthroughs. Gene therapy, CRISPR, cell therapies, and the cutting edge of biological science.',\n    icon: 'flask-conical', \n    color: '#F59E0B', \n    posts_count: 892, \n    members_count: 7234,\n    rules: ['Technical accuracy matters', 'Respect IP boundaries', 'Encourage collaboration'],\n    moderators: [{ id: 5, name: 'Dr. Lisa Park' }],\n  },\n  { \n    id: 6, \n    name: 'Medical Devices', \n    slug: 'medical-devices', \n    description: 'Innovative medical equipment. Discuss regulatory pathways, device development, and breakthrough technologies.',\n    icon: 'stethoscope', \n    color: '#06B6D4', \n    posts_count: 654, \n    members_count: 4521,\n    rules: ['Focus on innovation', 'Respect regulatory processes', 'Share case studies'],\n    moderators: [{ id: 6, name: 'Mark Johnson, MBA' }],\n  },\n  { \n    id: 7, \n    name: 'Pharmaceuticals', \n    slug: 'pharma', \n    description: 'Drug development and pharmaceutical innovations. Clinical trials, drug approvals, and market dynamics.',\n    icon: 'pill', \n    color: '#EC4899', \n    posts_count: 1123, \n    members_count: 8765,\n    rules: ['Disclosure required', 'Evidence-based claims', 'Patient safety first'],\n    moderators: [{ id: 7, name: 'Dr. Rachel Green' }],\n  },\n  { \n    id: 8, \n    name: 'Healthcare AI', \n    slug: 'healthcare-ai', \n    description: 'Artificial intelligence in medicine. Machine learning diagnostics, predictive analytics, and AI-assisted care.',\n    icon: 'brain', \n    color: '#6366F1', \n    posts_count: 876, \n    members_count: 5432,\n    rules: ['Explain algorithms clearly', 'Address bias concerns', 'Focus on clinical utility'],\n    moderators: [{ id: 8, name: 'Alex Kim, PhD' }],\n  },\n];\n\nconst userMemberships = new Map<number, Set<number>>();\n\nrouter.get('/', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const userId = (req as any).userId;\n    const userRooms = userMemberships.get(userId) || new Set();\n    \n    const rooms = ROOMS.map(room => ({\n      ...room,\n      is_member: userRooms.has(room.id),\n    }));\n    \n    res.json({ rooms });\n  } catch (error) {\n    console.error('Rooms error:', error);\n    res.status(500).json({ error: 'Failed to fetch rooms' });\n  }\n});\n\nrouter.get('/:slug', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { slug } = req.params;\n    const userId = (req as any).userId;\n    const userRooms = userMemberships.get(userId) || new Set();\n    \n    const room = ROOMS.find(r => r.slug === slug);\n    if (!room) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    \n    res.json({ ...room, is_member: userRooms.has(room.id) });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch room' });\n  }\n});\n\nrouter.post('/:slug/join', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { slug } = req.params;\n    const userId = (req as any).userId;\n    \n    const room = ROOMS.find(r => r.slug === slug);\n    if (!room) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    \n    if (!userMemberships.has(userId)) {\n      userMemberships.set(userId, new Set());\n    }\n    userMemberships.get(userId)!.add(room.id);\n    \n    res.json({ success: true, is_member: true, members_count: room.members_count + 1 });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to join room' });\n  }\n});\n\nrouter.delete('/:slug/join', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { slug } = req.params;\n    const userId = (req as any).userId;\n    \n    const room = ROOMS.find(r => r.slug === slug);\n    if (!room) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    \n    const userRooms = userMemberships.get(userId);\n    if (userRooms) {\n      userRooms.delete(room.id);\n    }\n    \n    res.json({ success: true, is_member: false, members_count: room.members_count });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to leave room' });\n  }\n});\n\nrouter.get('/:slug/posts', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { slug } = req.params;\n    const { cursor, limit = 20 } = req.query;\n    \n    const room = ROOMS.find(r => r.slug === slug);\n    if (!room) {\n      return res.status(404).json({ error: 'Room not found' });\n    }\n    \n    const authors = [\n      { id: 1, first_name: 'Sarah', last_name: 'Chen', full_name: 'Dr. Sarah Chen', specialty: 'Cardiologist', avatar_url: null, is_verified: true },\n      { id: 2, first_name: 'Michael', last_name: 'Roberts', full_name: 'Dr. Michael Roberts', specialty: 'Oncologist', avatar_url: null, is_verified: true },\n    ];\n    \n    const posts = Array.from({ length: Number(limit) }, (_, i) => ({\n      id: i + 1,\n      content: `Discussion about ${room.name} - Topic ${i + 1}. Great insights on the latest developments in this field. #${room.slug}`,\n      author: authors[i % authors.length],\n      room: { ...room, is_member: true },\n      images: [],\n      video_url: null,\n      is_anonymous: false,\n      mentions: [],\n      hashtags: [`#${room.slug}`],\n      upvotes: Math.floor(Math.random() * 50) + 5,\n      downvotes: Math.floor(Math.random() * 5),\n      comments_count: Math.floor(Math.random() * 20),\n      user_vote: null,\n      is_bookmarked: false,\n      feed_score: Math.random() * 100,\n      created_at: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString(),\n      updated_at: new Date().toISOString(),\n    }));\n    \n    res.json({\n      posts,\n      has_more: true,\n      next_cursor: 'next_page_token',\n      feed_style: 'chronological',\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch room posts' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":7797,"size_tokens":null},"client/screens/AIChatScreen.tsx":{"content":"/**\n * AI Chat Screen\n * AI-powered healthcare investment assistant\n */\n\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  TextInput,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n  Image,\n  Animated,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useMutation } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { aiApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { formatRelativeTime } from '@/lib/utils';\n\ninterface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n  isTyping?: boolean;\n}\n\ninterface SuggestedPrompt {\n  icon: string;\n  text: string;\n  query: string;\n}\n\nconst SUGGESTED_PROMPTS: SuggestedPrompt[] = [\n  {\n    icon: 'üìä',\n    text: 'Market Analysis',\n    query: 'What are the current trends in healthcare investment?',\n  },\n  {\n    icon: 'üíä',\n    text: 'Drug Pipeline',\n    query: 'Explain how to evaluate a biotech company\\'s drug pipeline',\n  },\n  {\n    icon: 'üè•',\n    text: 'MedTech',\n    query: 'What makes a medical device startup investment-worthy?',\n  },\n  {\n    icon: 'üìà',\n    text: 'Due Diligence',\n    query: 'What are the key factors for healthcare startup due diligence?',\n  },\n  {\n    icon: 'üß¨',\n    text: 'Genomics',\n    query: 'What\\'s the investment outlook for genomics companies?',\n  },\n  {\n    icon: 'üí°',\n    text: 'Digital Health',\n    query: 'How do I evaluate digital health investments?',\n  },\n];\n\nexport default function AIChatScreen() {\n  const navigation = useNavigation<any>();\n  const { user } = useAuth();\n  const flatListRef = useRef<FlatList>(null);\n  const inputRef = useRef<TextInput>(null);\n  const appColors = useAppColors();\n\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputText, setInputText] = useState('');\n  const [isTypingAnimation] = useState(new Animated.Value(0));\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      // Add user message\n      const userMessage: Message = {\n        id: Date.now().toString(),\n        role: 'user',\n        content,\n        timestamp: new Date(),\n      };\n      setMessages((prev) => [...prev, userMessage]);\n\n      // Add typing indicator\n      const typingMessage: Message = {\n        id: 'typing',\n        role: 'assistant',\n        content: '',\n        timestamp: new Date(),\n        isTyping: true,\n      };\n      setMessages((prev) => [...prev, typingMessage]);\n\n      // Call AI API\n      const response = await aiApi.chat(content, messages.map(m => ({\n        role: m.role,\n        content: m.content,\n      })));\n\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to get response');\n      }\n\n      return response.data?.response || 'I apologize, but I couldn\\'t generate a response.';\n    },\n    onSuccess: (responseText) => {\n      // Remove typing indicator and add response\n      setMessages((prev) => {\n        const filtered = prev.filter((m) => m.id !== 'typing');\n        return [\n          ...filtered,\n          {\n            id: Date.now().toString(),\n            role: 'assistant',\n            content: responseText,\n            timestamp: new Date(),\n          },\n        ];\n      });\n    },\n    onError: (error) => {\n      // Remove typing indicator and show error\n      setMessages((prev) => {\n        const filtered = prev.filter((m) => m.id !== 'typing');\n        return [\n          ...filtered,\n          {\n            id: Date.now().toString(),\n            role: 'assistant',\n            content: 'I apologize, but I encountered an error. Please try again.',\n            timestamp: new Date(),\n          },\n        ];\n      });\n    },\n  });\n\n  // Typing animation\n  useEffect(() => {\n    if (sendMessageMutation.isPending) {\n      Animated.loop(\n        Animated.sequence([\n          Animated.timing(isTypingAnimation, {\n            toValue: 1,\n            duration: 500,\n            useNativeDriver: true,\n          }),\n          Animated.timing(isTypingAnimation, {\n            toValue: 0,\n            duration: 500,\n            useNativeDriver: true,\n          }),\n        ])\n      ).start();\n    } else {\n      isTypingAnimation.setValue(0);\n    }\n  }, [sendMessageMutation.isPending]);\n\n  // Scroll to bottom when new messages\n  useEffect(() => {\n    if (messages.length > 0) {\n      setTimeout(() => {\n        flatListRef.current?.scrollToEnd({ animated: true });\n      }, 100);\n    }\n  }, [messages.length]);\n\n  const handleSend = useCallback(() => {\n    const trimmed = inputText.trim();\n    if (!trimmed || sendMessageMutation.isPending) return;\n    setInputText('');\n    sendMessageMutation.mutate(trimmed);\n  }, [inputText, sendMessageMutation]);\n\n  const handlePromptPress = useCallback((query: string) => {\n    setInputText(query);\n    inputRef.current?.focus();\n  }, []);\n\n  const handleClearChat = useCallback(() => {\n    setMessages([]);\n  }, []);\n\n  const renderMessage = ({ item }: { item: Message }) => {\n    const isUser = item.role === 'user';\n\n    if (item.isTyping) {\n      return (\n        <View style={[styles.messageContainer, styles.assistantMessage]}>\n          <View style={styles.assistantAvatar}>\n            <MaterialCommunityIcons name=\"robot\" size={20} color={Colors.primary} />\n          </View>\n          <View style={[styles.typingIndicator, { backgroundColor: appColors.surface }]}>\n            <Animated.View\n              style={[\n                styles.typingDot,\n                {\n                  opacity: isTypingAnimation.interpolate({\n                    inputRange: [0, 1],\n                    outputRange: [0.3, 1],\n                  }),\n                },\n              ]}\n            />\n            <Animated.View\n              style={[\n                styles.typingDot,\n                {\n                  opacity: isTypingAnimation.interpolate({\n                    inputRange: [0, 0.5, 1],\n                    outputRange: [0.3, 1, 0.3],\n                  }),\n                },\n              ]}\n            />\n            <Animated.View\n              style={[\n                styles.typingDot,\n                {\n                  opacity: isTypingAnimation.interpolate({\n                    inputRange: [0, 1],\n                    outputRange: [1, 0.3],\n                  }),\n                },\n              ]}\n            />\n          </View>\n        </View>\n      );\n    }\n\n    return (\n      <View style={[styles.messageContainer, isUser ? styles.userMessage : styles.assistantMessage]}>\n        {!isUser && (\n          <View style={styles.assistantAvatar}>\n            <MaterialCommunityIcons name=\"robot\" size={20} color={Colors.primary} />\n          </View>\n        )}\n        <View style={[styles.messageBubble, isUser ? styles.userBubble : [styles.assistantBubble, { backgroundColor: appColors.surface }]]}>\n          <ThemedText style={[styles.messageText, { color: appColors.textPrimary }, isUser && styles.userMessageText]}>\n            {item.content}\n          </ThemedText>\n          <ThemedText style={[styles.messageTime, { color: appColors.textSecondary }, isUser && styles.userMessageTime]}>\n            {formatRelativeTime(item.timestamp.toISOString())}\n          </ThemedText>\n        </View>\n        {isUser && (\n          user?.avatar_url ? (\n            <Image source={{ uri: user.avatar_url }} style={styles.userAvatar} />\n          ) : (\n            <View style={[styles.userAvatar, styles.userAvatarPlaceholder]}>\n              <ThemedText style={styles.userAvatarText}>\n                {user?.first_name?.[0]}{user?.last_name?.[0]}\n              </ThemedText>\n            </View>\n          )\n        )}\n      </View>\n    );\n  };\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      {/* AI Avatar */}\n      <LinearGradient\n        colors={[Colors.primary, Colors.secondary]}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={styles.aiAvatarLarge}\n      >\n        <MaterialCommunityIcons name=\"robot\" size={48} color=\"white\" />\n      </LinearGradient>\n\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>MedInvest AI Assistant</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        I'm here to help you with healthcare investment insights, market analysis, and due diligence questions.\n      </ThemedText>\n\n      {/* Suggested Prompts */}\n      <View style={styles.promptsContainer}>\n        <ThemedText style={[styles.promptsTitle, { color: appColors.textSecondary }]}>Try asking about:</ThemedText>\n        <View style={styles.promptsGrid}>\n          {SUGGESTED_PROMPTS.map((prompt, index) => (\n            <TouchableOpacity\n              key={index}\n              style={[styles.promptCard, { backgroundColor: appColors.surface }]}\n              onPress={() => handlePromptPress(prompt.query)}\n            >\n              <ThemedText style={styles.promptIcon}>{prompt.icon}</ThemedText>\n              <ThemedText style={[styles.promptText, { color: appColors.textPrimary }]}>{prompt.text}</ThemedText>\n            </TouchableOpacity>\n          ))}\n        </View>\n      </View>\n\n      {/* Disclaimer */}\n      <View style={styles.disclaimerContainer}>\n        <Ionicons name=\"information-circle-outline\" size={16} color={appColors.textSecondary} />\n        <ThemedText style={[styles.disclaimerText, { color: appColors.textSecondary }]}>\n          AI responses are for informational purposes only. Always consult with qualified professionals for investment decisions.\n        </ThemedText>\n      </View>\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n        keyboardVerticalOffset={0}\n      >\n        {/* Header */}\n        <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n          <View style={styles.headerCenter}>\n            <View style={styles.headerAvatar}>\n              <MaterialCommunityIcons name=\"robot\" size={20} color={Colors.primary} />\n            </View>\n            <View>\n              <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>AI Assistant</ThemedText>\n              <ThemedText style={[styles.headerSubtitle, { color: appColors.textSecondary }]}>Powered by MedInvest AI</ThemedText>\n            </View>\n          </View>\n          {messages.length > 0 && (\n            <TouchableOpacity style={styles.clearButton} onPress={handleClearChat}>\n              <Ionicons name=\"trash-outline\" size={20} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          )}\n        </View>\n\n        {/* Messages */}\n        <FlatList\n          ref={flatListRef}\n          data={messages}\n          renderItem={renderMessage}\n          keyExtractor={(item) => item.id}\n          ListEmptyComponent={renderEmpty}\n          contentContainerStyle={[\n            styles.messagesList,\n            messages.length === 0 && styles.messagesListEmpty,\n          ]}\n          showsVerticalScrollIndicator={false}\n        />\n\n        {/* Input */}\n        <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <View style={styles.inputWrapper}>\n            <TextInput\n              ref={inputRef}\n              style={[styles.input, { color: appColors.textPrimary }]}\n              placeholder=\"Ask about healthcare investments...\"\n              placeholderTextColor={appColors.textSecondary}\n              value={inputText}\n              onChangeText={setInputText}\n              multiline\n              maxLength={2000}\n              editable={!sendMessageMutation.isPending}\n            />\n          </View>\n          <TouchableOpacity\n            style={[styles.sendButton, (!inputText.trim() || sendMessageMutation.isPending) && styles.sendButtonDisabled]}\n            onPress={handleSend}\n            disabled={!inputText.trim() || sendMessageMutation.isPending}\n          >\n            <LinearGradient\n              colors={inputText.trim() && !sendMessageMutation.isPending ? [Colors.primary, Colors.secondary] : [appColors.border, appColors.border]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.sendButtonGradient}\n            >\n              <Ionicons name=\"send\" size={20} color=\"white\" />\n            </LinearGradient>\n          </TouchableOpacity>\n        </View>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerCenter: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginLeft: Spacing.sm,\n  },\n  headerAvatar: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  headerSubtitle: {\n    ...Typography.small,\n  },\n  clearButton: {\n    padding: Spacing.sm,\n  },\n  messagesList: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.lg,\n  },\n  messagesListEmpty: {\n    flex: 1,\n  },\n  messageContainer: {\n    flexDirection: 'row',\n    marginBottom: Spacing.lg,\n    alignItems: 'flex-end',\n  },\n  userMessage: {\n    justifyContent: 'flex-end',\n  },\n  assistantMessage: {\n    justifyContent: 'flex-start',\n  },\n  assistantAvatar: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.sm,\n  },\n  userAvatar: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    marginLeft: Spacing.sm,\n  },\n  userAvatarPlaceholder: {\n    backgroundColor: Colors.secondary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  userAvatarText: {\n    ...Typography.small,\n    color: Colors.secondary,\n    fontWeight: '600',\n  },\n  messageBubble: {\n    maxWidth: '75%',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.lg,\n  },\n  userBubble: {\n    backgroundColor: Colors.primary,\n    borderBottomRightRadius: 4,\n  },\n  assistantBubble: {\n    borderBottomLeftRadius: 4,\n    ...Shadows.card,\n  },\n  messageText: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  userMessageText: {\n    color: 'white',\n  },\n  messageTime: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n  userMessageTime: {\n    color: 'rgba(255,255,255,0.7)',\n  },\n  typingIndicator: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.lg,\n    ...Shadows.card,\n    gap: 6,\n  },\n  typingDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: Colors.primary,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n  },\n  aiAvatarLarge: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.sm,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 22,\n    marginBottom: Spacing.xl,\n  },\n  promptsContainer: {\n    width: '100%',\n  },\n  promptsTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.md,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  promptsGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: Spacing.sm,\n  },\n  promptCard: {\n    width: '48%',\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n    gap: Spacing.sm,\n  },\n  promptIcon: {\n    fontSize: 20,\n  },\n  promptText: {\n    ...Typography.caption,\n    fontWeight: '500',\n    flex: 1,\n  },\n  disclaimerContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    backgroundColor: Colors.light.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    marginTop: Spacing.xl,\n    gap: Spacing.sm,\n  },\n  disclaimerText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 18,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    padding: Spacing.md,\n    borderTopWidth: 1,\n    gap: Spacing.sm,\n  },\n  inputWrapper: {\n    flex: 1,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    maxHeight: 120,\n  },\n  input: {\n    ...Typography.body,\n    maxHeight: 100,\n  },\n  sendButton: {\n    borderRadius: BorderRadius.full,\n    overflow: 'hidden',\n  },\n  sendButtonDisabled: {\n    opacity: 0.5,\n  },\n  sendButtonGradient: {\n    width: 44,\n    height: 44,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n","path":null,"size_bytes":18013,"size_tokens":null},"client/components/NotificationsDropdown.tsx":{"content":"/**\n * Notifications Dropdown Component\n * Grouped notifications with rich content display\n */\n\nimport React, { useCallback, useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  ScrollView,\n  Modal,\n  Pressable,\n  ActivityIndicator,\n  Dimensions,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { notificationsApi, Notification } from '@/lib/api';\nimport { formatRelativeTime } from '@/lib/utils';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\n\ninterface NotificationsDropdownProps {\n  visible: boolean;\n  onClose: () => void;\n  anchorPosition?: { top: number; right: number };\n}\n\ntype NotificationGroup = {\n  title: string;\n  items: Notification[];\n};\n\nfunction groupNotifications(notifications: Notification[]): NotificationGroup[] {\n  const now = new Date();\n  const thisWeek: Notification[] = [];\n  const earlier: Notification[] = [];\n\n  notifications.forEach(notification => {\n    const notifDate = new Date(notification.created_at);\n    const diffDays = Math.floor((now.getTime() - notifDate.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (diffDays < 7) {\n      thisWeek.push(notification);\n    } else {\n      earlier.push(notification);\n    }\n  });\n\n  const groups: NotificationGroup[] = [];\n  if (thisWeek.length > 0) {\n    groups.push({ title: 'THIS WEEK', items: thisWeek });\n  }\n  if (earlier.length > 0) {\n    groups.push({ title: 'EARLIER', items: earlier });\n  }\n\n  return groups;\n}\n\nexport default function NotificationsDropdown({\n  visible,\n  onClose,\n  anchorPosition = { top: 60, right: 16 },\n}: NotificationsDropdownProps) {\n  const appColors = useAppColors();\n  const navigation = useNavigation<any>();\n  const queryClient = useQueryClient();\n\n  const { data, isLoading } = useQuery({\n    queryKey: ['notifications', 'dropdown'],\n    queryFn: async () => {\n      const response = await notificationsApi.getNotifications(1);\n      return {\n        notifications: response.data?.notifications || [],\n        unread_count: response.data?.unread_count || 0,\n      };\n    },\n    enabled: visible,\n  });\n\n  const markReadMutation = useMutation({\n    mutationFn: async (id: number) => {\n      await notificationsApi.markAsRead(id);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['notifications'] });\n    },\n  });\n\n  const handleNotificationPress = useCallback((notification: Notification) => {\n    if (!notification.is_read) {\n      markReadMutation.mutate(notification.id);\n    }\n\n    const data = notification.data as any;\n    \n    switch (notification.type) {\n      case 'publication_match':\n        if (data?.publication_id) {\n          navigation.navigate('PostDetail', { postId: data.publication_id });\n        }\n        break;\n      case 'peer_update':\n        if (data?.user_id) {\n          navigation.navigate('UserProfile', { userId: data.user_id });\n        }\n        break;\n      case 'highlight':\n      case 'mention':\n        if (data?.post_id) {\n          navigation.navigate('PostDetail', { postId: data.post_id });\n        }\n        break;\n      case 'follow':\n        if (data?.follower_id) {\n          navigation.navigate('UserProfile', { userId: data.follower_id });\n        }\n        break;\n      default:\n        navigation.navigate('Notifications');\n    }\n\n    onClose();\n  }, [navigation, markReadMutation, onClose]);\n\n  const handleViewAll = useCallback(() => {\n    navigation.navigate('Notifications');\n    onClose();\n  }, [navigation, onClose]);\n\n  const handleSettings = useCallback(() => {\n    navigation.navigate('Settings', { section: 'notifications' });\n    onClose();\n  }, [navigation, onClose]);\n\n  const groups = data?.notifications ? groupNotifications(data.notifications) : [];\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n    >\n      <Pressable style={styles.overlay} onPress={onClose}>\n        <Pressable \n          style={[styles.dropdown, { backgroundColor: appColors.surface, top: anchorPosition.top, right: anchorPosition.right }]}\n          onPress={(e) => e.stopPropagation()}\n        >\n          {/* Header */}\n          <View style={[styles.header, { borderBottomColor: appColors.border }]}>\n            <View style={styles.headerLeft}>\n              <Ionicons name=\"notifications\" size={20} color={appColors.textPrimary} />\n              <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Notifications</ThemedText>\n            </View>\n            <TouchableOpacity style={styles.settingsButton} onPress={handleSettings}>\n              <Ionicons name=\"settings-outline\" size={20} color={Colors.primary} />\n            </TouchableOpacity>\n          </View>\n\n          {/* Content */}\n          <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n            {isLoading ? (\n              <View style={styles.loadingContainer}>\n                <ActivityIndicator size=\"small\" color={Colors.primary} />\n              </View>\n            ) : groups.length === 0 ? (\n              <View style={styles.emptyContainer}>\n                <Ionicons name=\"notifications-off-outline\" size={32} color={appColors.textSecondary} />\n                <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No notifications yet</ThemedText>\n              </View>\n            ) : (\n              groups.map((group, groupIndex) => (\n                <View key={groupIndex} style={styles.group}>\n                  <ThemedText style={[styles.groupTitle, { color: appColors.textSecondary }]}>{group.title}</ThemedText>\n                  {group.items.map((notification) => (\n                    <NotificationItem\n                      key={notification.id}\n                      notification={notification}\n                      onPress={() => handleNotificationPress(notification)}\n                    />\n                  ))}\n                </View>\n              ))\n            )}\n          </ScrollView>\n\n          {/* Footer */}\n          <TouchableOpacity style={[styles.footer, { borderTopColor: appColors.border }]} onPress={handleViewAll}>\n            <ThemedText style={[styles.footerText, { color: appColors.textSecondary }]}>View all notifications</ThemedText>\n          </TouchableOpacity>\n        </Pressable>\n      </Pressable>\n    </Modal>\n  );\n}\n\ninterface NotificationItemProps {\n  notification: Notification;\n  onPress: () => void;\n}\n\nfunction NotificationItem({ notification, onPress }: NotificationItemProps) {\n  const appColors = useAppColors();\n\n  const getNotificationIcon = () => {\n    switch (notification.type) {\n      case 'publication_match':\n        return { icon: 'document-text', color: Colors.primary, bg: Colors.primary + '20' };\n      case 'peer_update':\n        return { icon: 'people', color: Colors.secondary, bg: Colors.secondary + '20' };\n      case 'highlight':\n        return { icon: 'star', color: appColors.warning, bg: appColors.warning + '20' };\n      case 'mention':\n        return { icon: 'at', color: Colors.primary, bg: Colors.primary + '20' };\n      case 'follow':\n        return { icon: 'person-add', color: Colors.secondary, bg: Colors.secondary + '20' };\n      case 'like':\n        return { icon: 'heart', color: appColors.error, bg: appColors.error + '20' };\n      case 'comment':\n        return { icon: 'chatbubble', color: Colors.primary, bg: Colors.primary + '20' };\n      default:\n        return { icon: 'notifications', color: appColors.textSecondary, bg: Colors.light.backgroundSecondary };\n    }\n  };\n\n  const iconConfig = getNotificationIcon();\n  const data = notification.data as any;\n\n  return (\n    <TouchableOpacity\n      style={[styles.notificationItem, { backgroundColor: appColors.surface }, !notification.is_read && styles.unreadItem]}\n      onPress={onPress}\n    >\n      {/* Icon */}\n      <View style={[styles.notificationIcon, { backgroundColor: iconConfig.bg }]}>\n        <Ionicons name={iconConfig.icon as any} size={18} color={iconConfig.color} />\n      </View>\n\n      {/* Content */}\n      <View style={styles.notificationContent}>\n        <ThemedText style={[styles.notificationTitle, { color: appColors.textPrimary }]} numberOfLines={2}>\n          {notification.title}\n        </ThemedText>\n        {notification.body && (\n          <ThemedText style={[styles.notificationBody, { color: appColors.textSecondary }]} numberOfLines={2}>\n            {notification.body}\n          </ThemedText>\n        )}\n        <ThemedText style={[styles.notificationTime, { color: appColors.textSecondary }]}>\n          {formatRelativeTime(notification.created_at)}\n        </ThemedText>\n      </View>\n\n      {/* More button */}\n      <TouchableOpacity style={styles.moreButton}>\n        <Ionicons name=\"ellipsis-horizontal\" size={16} color={appColors.textSecondary} />\n      </TouchableOpacity>\n    </TouchableOpacity>\n  );\n}\n\ninterface NotificationBellProps {\n  onPress: () => void;\n  unreadCount?: number;\n}\n\nexport function NotificationBell({ onPress, unreadCount = 0 }: NotificationBellProps) {\n  const appColors = useAppColors();\n  return (\n    <TouchableOpacity style={styles.bellContainer} onPress={onPress}>\n      <Ionicons name=\"notifications-outline\" size={24} color={appColors.textPrimary} />\n      {unreadCount > 0 && (\n        <View style={[styles.badge, { backgroundColor: appColors.error }]}>\n          <ThemedText style={styles.badgeText}>\n            {unreadCount > 99 ? '99+' : unreadCount}\n          </ThemedText>\n        </View>\n      )}\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.3)',\n  },\n  dropdown: {\n    position: 'absolute',\n    width: Math.min(SCREEN_WIDTH - 32, 380),\n    maxHeight: 480,\n    borderRadius: BorderRadius.lg,\n    ...Shadows.card,\n    shadowOpacity: 0.2,\n    elevation: 8,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  headerLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  settingsButton: {\n    padding: Spacing.xs,\n  },\n  content: {\n    maxHeight: 360,\n  },\n  loadingContainer: {\n    padding: Spacing.xl,\n    alignItems: 'center',\n  },\n  emptyContainer: {\n    padding: Spacing.xl,\n    alignItems: 'center',\n  },\n  emptyText: {\n    ...Typography.body,\n    marginTop: Spacing.sm,\n  },\n  group: {\n    paddingTop: Spacing.sm,\n  },\n  groupTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  notificationItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n  },\n  unreadItem: {\n    backgroundColor: Colors.primary + '08',\n  },\n  notificationIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  notificationContent: {\n    flex: 1,\n  },\n  notificationTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    lineHeight: 20,\n  },\n  notificationBody: {\n    ...Typography.small,\n    marginTop: 4,\n    lineHeight: 18,\n  },\n  notificationTime: {\n    ...Typography.small,\n    marginTop: 4,\n  },\n  moreButton: {\n    padding: Spacing.xs,\n  },\n  footer: {\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderTopWidth: 1,\n  },\n  footerText: {\n    ...Typography.caption,\n  },\n\n  bellContainer: {\n    position: 'relative',\n    padding: Spacing.xs,\n  },\n  badge: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    minWidth: 18,\n    height: 18,\n    borderRadius: 9,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: 4,\n  },\n  badgeText: {\n    ...Typography.small,\n    fontSize: 10,\n    color: 'white',\n    fontWeight: '700',\n  },\n});\n","path":null,"size_bytes":12386,"size_tokens":null},"client/screens/SettingsScreen.tsx":{"content":"/**\n * Settings Screen\n * Account settings, preferences, and premium subscription\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Switch,\n  Alert,\n  Linking,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { subscriptionApi } from '@/lib/api';\n\ninterface SettingItemProps {\n  icon: string;\n  iconFamily?: 'ionicons' | 'material';\n  label: string;\n  value?: string;\n  onPress?: () => void;\n  isSwitch?: boolean;\n  switchValue?: boolean;\n  onSwitchChange?: (value: boolean) => void;\n  showArrow?: boolean;\n  danger?: boolean;\n}\n\nfunction SettingItem({\n  icon,\n  iconFamily = 'ionicons',\n  label,\n  value,\n  onPress,\n  isSwitch,\n  switchValue,\n  onSwitchChange,\n  showArrow = true,\n  danger,\n}: SettingItemProps) {\n  const IconComponent = iconFamily === 'material' ? MaterialCommunityIcons : Ionicons;\n  const appColors = useAppColors();\n\n  return (\n    <TouchableOpacity\n      style={[styles.settingItem, { borderBottomColor: appColors.border }]}\n      onPress={onPress}\n      disabled={isSwitch}\n    >\n      <View style={[styles.settingIcon, danger && { backgroundColor: appColors.error + '15' }]}>\n        <IconComponent\n          name={icon as any}\n          size={20}\n          color={danger ? appColors.error : Colors.primary}\n        />\n      </View>\n      <View style={styles.settingContent}>\n        <ThemedText style={[styles.settingLabel, { color: appColors.textPrimary }, danger && { color: appColors.error }]}>\n          {label}\n        </ThemedText>\n        {value && <ThemedText style={[styles.settingValue, { color: appColors.textSecondary }]}>{value}</ThemedText>}\n      </View>\n      {isSwitch ? (\n        <Switch\n          value={switchValue}\n          onValueChange={onSwitchChange}\n          trackColor={{ false: appColors.border, true: Colors.primary + '50' }}\n          thumbColor={switchValue ? Colors.primary : Colors.light.backgroundTertiary}\n        />\n      ) : showArrow ? (\n        <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n      ) : null}\n    </TouchableOpacity>\n  );\n}\n\nexport default function SettingsScreen() {\n  const navigation = useNavigation<any>();\n  const { user, signOut } = useAuth();\n  const appColors = useAppColors();\n  const { mode, setMode, isDark } = useThemeContext();\n\n  // Notification preferences\n  const [pushEnabled, setPushEnabled] = useState(true);\n  const [emailEnabled, setEmailEnabled] = useState(true);\n\n  // Subscription status\n  const { data: subscriptionStatus } = useQuery({\n    queryKey: ['subscription'],\n    queryFn: async () => {\n      const response = await subscriptionApi.getStatus();\n      return response.data;\n    },\n  });\n\n  const handleLogout = () => {\n    if (Platform.OS === 'web') {\n      const confirmed = window.confirm('Are you sure you want to sign out?');\n      if (confirmed) {\n        signOut();\n      }\n    } else {\n      Alert.alert(\n        'Sign Out',\n        'Are you sure you want to sign out?',\n        [\n          { text: 'Cancel', style: 'cancel' },\n          { text: 'Sign Out', style: 'destructive', onPress: () => signOut() },\n        ]\n      );\n    }\n  };\n\n  const handleDeleteAccount = () => {\n    if (Platform.OS === 'web') {\n      const confirmed = window.confirm('This action cannot be undone. All your data will be permanently deleted. Are you sure?');\n      if (confirmed) {\n        window.alert('Please contact support to delete your account.');\n      }\n    } else {\n      Alert.alert(\n        'Delete Account',\n        'This action cannot be undone. All your data will be permanently deleted.',\n        [\n          { text: 'Cancel', style: 'cancel' },\n          {\n            text: 'Delete',\n            style: 'destructive',\n            onPress: () => {\n              Alert.alert('Contact Support', 'Please contact support to delete your account.');\n            },\n          },\n        ]\n      );\n    }\n  };\n\n  const handleManageSubscription = async () => {\n    if (subscriptionStatus?.is_premium) {\n      const response = await subscriptionApi.getPortalUrl();\n      if (response.data?.portal_url) {\n        Linking.openURL(response.data.portal_url);\n      }\n    } else {\n      navigation.navigate('Premium');\n    }\n  };\n\n  const handleChangePassword = () => {\n    navigation.navigate('ChangePassword');\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Settings</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Account Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Account</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"person-outline\"\n              label=\"Edit Profile\"\n              onPress={() => navigation.navigate('EditProfile')}\n            />\n            <SettingItem\n              icon=\"mail-outline\"\n              label=\"Email\"\n              value={user?.email}\n              showArrow={false}\n            />\n            <SettingItem\n              icon=\"lock-closed-outline\"\n              label=\"Change Password\"\n              onPress={handleChangePassword}\n            />\n            <SettingItem\n              icon=\"shield-checkmark-outline\"\n              label=\"Two-Factor Authentication\"\n              onPress={() => {}}\n            />\n          </View>\n        </View>\n\n        {/* Subscription Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Subscription</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"crown\"\n              iconFamily=\"material\"\n              label={subscriptionStatus?.is_premium ? 'Premium Member' : 'Upgrade to Premium'}\n              value={subscriptionStatus?.is_premium ? 'Active' : 'Free'}\n              onPress={handleManageSubscription}\n            />\n            {subscriptionStatus?.is_premium && (\n              <SettingItem\n                icon=\"card-outline\"\n                label=\"Manage Subscription\"\n                onPress={handleManageSubscription}\n              />\n            )}\n          </View>\n        </View>\n\n        {/* Notifications Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Notifications</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"notifications-outline\"\n              label=\"Push Notifications\"\n              isSwitch\n              switchValue={pushEnabled}\n              onSwitchChange={setPushEnabled}\n            />\n            <SettingItem\n              icon=\"mail-outline\"\n              label=\"Email Notifications\"\n              isSwitch\n              switchValue={emailEnabled}\n              onSwitchChange={setEmailEnabled}\n            />\n            <SettingItem\n              icon=\"options-outline\"\n              label=\"Notification Preferences\"\n              onPress={() => {}}\n            />\n          </View>\n        </View>\n\n        {/* Privacy Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Privacy</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"eye-off-outline\"\n              label=\"Private Profile\"\n              isSwitch\n              switchValue={false}\n              onSwitchChange={() => {}}\n            />\n            <SettingItem\n              icon=\"people-outline\"\n              label=\"Blocked Users\"\n              onPress={() => {}}\n            />\n            <SettingItem\n              icon=\"download-outline\"\n              label=\"Download My Data\"\n              onPress={() => {}}\n            />\n          </View>\n        </View>\n\n        {/* Appearance Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Appearance</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"moon-outline\"\n              label=\"Dark Mode\"\n              isSwitch\n              switchValue={isDark}\n              onSwitchChange={(value: boolean) => setMode(value ? 'dark' : 'light')}\n            />\n            <SettingItem\n              icon=\"color-palette-outline\"\n              label=\"Appearance\"\n              value={mode === 'system' ? 'System' : mode === 'dark' ? 'Dark' : 'Light'}\n              onPress={() => navigation.navigate('AppearanceSettings')}\n            />\n          </View>\n        </View>\n\n        {/* Support Section */}\n        <View style={styles.section}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>Support</ThemedText>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"help-circle-outline\"\n              label=\"Help Center\"\n              onPress={() => Linking.openURL('https://medinvest.com/help')}\n            />\n            <SettingItem\n              icon=\"chatbubble-outline\"\n              label=\"Contact Support\"\n              onPress={() => Linking.openURL('mailto:support@medinvest.com')}\n            />\n            <SettingItem\n              icon=\"document-text-outline\"\n              label=\"Terms of Service\"\n              onPress={() => Linking.openURL('https://medinvest.com/terms')}\n            />\n            <SettingItem\n              icon=\"shield-outline\"\n              label=\"Privacy Policy\"\n              onPress={() => Linking.openURL('https://medinvest.com/privacy')}\n            />\n          </View>\n        </View>\n\n        {/* Account Actions */}\n        <View style={styles.section}>\n          <View style={[styles.sectionContent, { backgroundColor: appColors.surface, borderColor: appColors.border }]}>\n            <SettingItem\n              icon=\"log-out-outline\"\n              label=\"Sign Out\"\n              onPress={handleLogout}\n              showArrow={false}\n            />\n            <SettingItem\n              icon=\"trash-outline\"\n              label=\"Delete Account\"\n              onPress={handleDeleteAccount}\n              showArrow={false}\n              danger\n            />\n          </View>\n        </View>\n\n        {/* App Info */}\n        <View style={styles.appInfo}>\n          <ThemedText style={[styles.appVersion, { color: appColors.textSecondary }]}>MedInvest v1.0.0</ThemedText>\n          <ThemedText style={[styles.appCopyright, { color: appColors.textSecondary }]}>¬© 2024 MedInvest Inc.</ThemedText>\n        </View>\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  content: {\n    flex: 1,\n  },\n  section: {\n    marginTop: Spacing.lg,\n  },\n  sectionTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n    paddingHorizontal: Spacing.lg,\n    marginBottom: Spacing.sm,\n  },\n  sectionContent: {\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n  },\n  settingItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  settingIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: BorderRadius.sm,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  settingContent: {\n    flex: 1,\n  },\n  settingLabel: {\n    ...Typography.body,\n  },\n  settingValue: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  appInfo: {\n    alignItems: 'center',\n    paddingVertical: Spacing['3xl'],\n  },\n  appVersion: {\n    ...Typography.caption,\n  },\n  appCopyright: {\n    ...Typography.small,\n    marginTop: Spacing.xs,\n  },\n});\n","path":null,"size_bytes":13738,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/lib/app-rating.ts":{"content":"/**\n * App Rating Prompt\n * Smart prompts to ask users to rate the app\n */\n\nimport { Platform, Alert, Linking } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as StoreReview from 'expo-store-review';\n\n// Configuration\nconst CONFIG = {\n  // Minimum days since install before showing prompt\n  MIN_DAYS_SINCE_INSTALL: 3,\n  \n  // Minimum app launches before showing prompt\n  MIN_LAUNCHES: 5,\n  \n  // Minimum positive actions (posts, comments, likes) before prompting\n  MIN_POSITIVE_ACTIONS: 10,\n  \n  // Days between prompts if user dismisses\n  DAYS_BETWEEN_PROMPTS: 30,\n  \n  // Maximum times to prompt (ever)\n  MAX_PROMPTS: 3,\n  \n  // Store URLs\n  APP_STORE_URL: 'https://apps.apple.com/app/idXXXXXXXXXX?action=write-review',\n  PLAY_STORE_URL: 'https://play.google.com/store/apps/details?id=com.medinvest.app',\n};\n\n// Storage keys\nconst STORAGE_KEYS = {\n  INSTALL_DATE: 'rating_install_date',\n  LAUNCH_COUNT: 'rating_launch_count',\n  ACTION_COUNT: 'rating_action_count',\n  LAST_PROMPT_DATE: 'rating_last_prompt_date',\n  PROMPT_COUNT: 'rating_prompt_count',\n  HAS_RATED: 'rating_has_rated',\n  NEVER_ASK: 'rating_never_ask',\n};\n\n// Rating prompt result\nexport type RatingResult = 'rated' | 'later' | 'never' | 'error';\n\n/**\n * App Rating Service\n */\nclass AppRatingService {\n  private initialized = false;\n  private installDate: Date | null = null;\n  private launchCount = 0;\n  private actionCount = 0;\n  private lastPromptDate: Date | null = null;\n  private promptCount = 0;\n  private hasRated = false;\n  private neverAsk = false;\n\n  /**\n   * Initialize the service (call on app start)\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n\n    try {\n      // Load stored values\n      const [\n        installDateStr,\n        launchCountStr,\n        actionCountStr,\n        lastPromptDateStr,\n        promptCountStr,\n        hasRatedStr,\n        neverAskStr,\n      ] = await Promise.all([\n        AsyncStorage.getItem(STORAGE_KEYS.INSTALL_DATE),\n        AsyncStorage.getItem(STORAGE_KEYS.LAUNCH_COUNT),\n        AsyncStorage.getItem(STORAGE_KEYS.ACTION_COUNT),\n        AsyncStorage.getItem(STORAGE_KEYS.LAST_PROMPT_DATE),\n        AsyncStorage.getItem(STORAGE_KEYS.PROMPT_COUNT),\n        AsyncStorage.getItem(STORAGE_KEYS.HAS_RATED),\n        AsyncStorage.getItem(STORAGE_KEYS.NEVER_ASK),\n      ]);\n\n      // Set install date if first launch\n      if (!installDateStr) {\n        this.installDate = new Date();\n        await AsyncStorage.setItem(STORAGE_KEYS.INSTALL_DATE, this.installDate.toISOString());\n      } else {\n        this.installDate = new Date(installDateStr);\n      }\n\n      this.launchCount = parseInt(launchCountStr || '0', 10);\n      this.actionCount = parseInt(actionCountStr || '0', 10);\n      this.lastPromptDate = lastPromptDateStr ? new Date(lastPromptDateStr) : null;\n      this.promptCount = parseInt(promptCountStr || '0', 10);\n      this.hasRated = hasRatedStr === 'true';\n      this.neverAsk = neverAskStr === 'true';\n\n      // Increment launch count\n      this.launchCount++;\n      await AsyncStorage.setItem(STORAGE_KEYS.LAUNCH_COUNT, this.launchCount.toString());\n\n      this.initialized = true;\n    } catch (error) {\n      console.error('[AppRating] Error initializing:', error);\n    }\n  }\n\n  /**\n   * Track a positive action (call after user does something good)\n   */\n  async trackPositiveAction(): Promise<void> {\n    this.actionCount++;\n    await AsyncStorage.setItem(STORAGE_KEYS.ACTION_COUNT, this.actionCount.toString());\n  }\n\n  /**\n   * Check if we should show the rating prompt\n   */\n  shouldShowPrompt(): boolean {\n    if (!this.initialized) return false;\n    if (this.hasRated) return false;\n    if (this.neverAsk) return false;\n    if (this.promptCount >= CONFIG.MAX_PROMPTS) return false;\n\n    // Check minimum launches\n    if (this.launchCount < CONFIG.MIN_LAUNCHES) return false;\n\n    // Check minimum actions\n    if (this.actionCount < CONFIG.MIN_POSITIVE_ACTIONS) return false;\n\n    // Check minimum days since install\n    if (this.installDate) {\n      const daysSinceInstall = this.getDaysSince(this.installDate);\n      if (daysSinceInstall < CONFIG.MIN_DAYS_SINCE_INSTALL) return false;\n    }\n\n    // Check days since last prompt\n    if (this.lastPromptDate) {\n      const daysSincePrompt = this.getDaysSince(this.lastPromptDate);\n      if (daysSincePrompt < CONFIG.DAYS_BETWEEN_PROMPTS) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Show the native rating prompt\n   */\n  async showNativePrompt(): Promise<boolean> {\n    try {\n      const isAvailable = await StoreReview.isAvailableAsync();\n      \n      if (isAvailable) {\n        await StoreReview.requestReview();\n        await this.recordPromptShown();\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('[AppRating] Error showing native prompt:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Show custom rating dialog\n   */\n  async showCustomPrompt(): Promise<RatingResult> {\n    return new Promise((resolve) => {\n      Alert.alert(\n        'Enjoying MedInvest?',\n        'If you\\'re finding MedInvest helpful, would you mind taking a moment to rate us? It really helps!',\n        [\n          {\n            text: 'Not Now',\n            style: 'cancel',\n            onPress: () => {\n              this.recordPromptShown();\n              resolve('later');\n            },\n          },\n          {\n            text: 'Never Ask',\n            style: 'destructive',\n            onPress: () => {\n              this.setNeverAsk();\n              resolve('never');\n            },\n          },\n          {\n            text: 'Rate Now',\n            onPress: async () => {\n              const success = await this.openStoreForRating();\n              if (success) {\n                this.setHasRated();\n                resolve('rated');\n              } else {\n                resolve('error');\n              }\n            },\n          },\n        ],\n        { cancelable: true }\n      );\n    });\n  }\n\n  /**\n   * Show a satisfaction check before rating\n   */\n  async showSatisfactionCheck(): Promise<RatingResult> {\n    return new Promise((resolve) => {\n      Alert.alert(\n        'How\\'s your experience?',\n        'Are you enjoying MedInvest?',\n        [\n          {\n            text: 'Not Really',\n            style: 'cancel',\n            onPress: () => {\n              this.showFeedbackPrompt();\n              resolve('later');\n            },\n          },\n          {\n            text: 'Yes!',\n            onPress: () => {\n              this.showRatingPrompt().then(resolve);\n            },\n          },\n        ],\n        { cancelable: true }\n      );\n    });\n  }\n\n  /**\n   * Show rating prompt after positive response\n   */\n  private async showRatingPrompt(): Promise<RatingResult> {\n    // Try native prompt first\n    const nativeShown = await this.showNativePrompt();\n    \n    if (!nativeShown) {\n      // Fall back to custom prompt\n      return this.showCustomPrompt();\n    }\n\n    // Assume user might have rated\n    this.recordPromptShown();\n    return 'later';\n  }\n\n  /**\n   * Show feedback prompt for unhappy users\n   */\n  private showFeedbackPrompt(): void {\n    Alert.alert(\n      'We\\'d love to hear from you',\n      'Would you like to tell us how we can improve?',\n      [\n        {\n          text: 'No Thanks',\n          style: 'cancel',\n          onPress: () => {\n            this.recordPromptShown();\n          },\n        },\n        {\n          text: 'Send Feedback',\n          onPress: () => {\n            // Navigate to feedback screen or open email\n            const email = 'feedback@medinvest.com';\n            const subject = 'MedInvest App Feedback';\n            Linking.openURL(`mailto:${email}?subject=${encodeURIComponent(subject)}`);\n          },\n        },\n      ]\n    );\n  }\n\n  /**\n   * Open app store for rating\n   */\n  async openStoreForRating(): Promise<boolean> {\n    try {\n      const url = Platform.OS === 'ios' ? CONFIG.APP_STORE_URL : CONFIG.PLAY_STORE_URL;\n      const canOpen = await Linking.canOpenURL(url);\n      \n      if (canOpen) {\n        await Linking.openURL(url);\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('[AppRating] Error opening store:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Record that a prompt was shown\n   */\n  private async recordPromptShown(): Promise<void> {\n    this.promptCount++;\n    this.lastPromptDate = new Date();\n    \n    await Promise.all([\n      AsyncStorage.setItem(STORAGE_KEYS.PROMPT_COUNT, this.promptCount.toString()),\n      AsyncStorage.setItem(STORAGE_KEYS.LAST_PROMPT_DATE, this.lastPromptDate.toISOString()),\n    ]);\n  }\n\n  /**\n   * Set that user has rated\n   */\n  private async setHasRated(): Promise<void> {\n    this.hasRated = true;\n    await AsyncStorage.setItem(STORAGE_KEYS.HAS_RATED, 'true');\n  }\n\n  /**\n   * Set that user never wants to be asked\n   */\n  private async setNeverAsk(): Promise<void> {\n    this.neverAsk = true;\n    await AsyncStorage.setItem(STORAGE_KEYS.NEVER_ASK, 'true');\n  }\n\n  /**\n   * Calculate days since a date\n   */\n  private getDaysSince(date: Date): number {\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    return Math.floor(diffMs / (1000 * 60 * 60 * 24));\n  }\n\n  /**\n   * Reset all rating data (for testing)\n   */\n  async reset(): Promise<void> {\n    await Promise.all([\n      AsyncStorage.removeItem(STORAGE_KEYS.INSTALL_DATE),\n      AsyncStorage.removeItem(STORAGE_KEYS.LAUNCH_COUNT),\n      AsyncStorage.removeItem(STORAGE_KEYS.ACTION_COUNT),\n      AsyncStorage.removeItem(STORAGE_KEYS.LAST_PROMPT_DATE),\n      AsyncStorage.removeItem(STORAGE_KEYS.PROMPT_COUNT),\n      AsyncStorage.removeItem(STORAGE_KEYS.HAS_RATED),\n      AsyncStorage.removeItem(STORAGE_KEYS.NEVER_ASK),\n    ]);\n\n    this.initialized = false;\n    this.launchCount = 0;\n    this.actionCount = 0;\n    this.promptCount = 0;\n    this.hasRated = false;\n    this.neverAsk = false;\n    this.lastPromptDate = null;\n    this.installDate = null;\n  }\n\n  /**\n   * Get current stats (for debugging)\n   */\n  getStats() {\n    return {\n      installDate: this.installDate,\n      launchCount: this.launchCount,\n      actionCount: this.actionCount,\n      promptCount: this.promptCount,\n      lastPromptDate: this.lastPromptDate,\n      hasRated: this.hasRated,\n      neverAsk: this.neverAsk,\n      shouldShow: this.shouldShowPrompt(),\n    };\n  }\n}\n\nexport const appRatingService = new AppRatingService();\n\n/**\n * Hook for app rating\n */\nexport function useAppRating() {\n  const checkAndPrompt = async () => {\n    await appRatingService.initialize();\n    \n    if (appRatingService.shouldShowPrompt()) {\n      await appRatingService.showSatisfactionCheck();\n    }\n  };\n\n  const trackAction = () => {\n    appRatingService.trackPositiveAction();\n  };\n\n  const forcePrompt = () => {\n    return appRatingService.showSatisfactionCheck();\n  };\n\n  return {\n    checkAndPrompt,\n    trackAction,\n    forcePrompt,\n    shouldShow: () => appRatingService.shouldShowPrompt(),\n    getStats: () => appRatingService.getStats(),\n  };\n}\n\n/**\n * Convenience function to track positive actions\n * Call this after: creating post, liking, commenting, completing investment, etc.\n */\nexport const trackPositiveAction = () => {\n  appRatingService.trackPositiveAction();\n};\n","path":null,"size_bytes":11331,"size_tokens":null},"server/replit_integrations/batch/index.ts":{"content":"export {\n  batchProcess,\n  batchProcessWithSSE,\n  isRateLimitError,\n  type BatchOptions,\n} from \"./utils\";\n\n","path":null,"size_bytes":108,"size_tokens":null},"client/services/notifications.ts":{"content":"import { useEffect, useRef, useCallback } from 'react';\nimport { Platform, Alert } from 'react-native';\nimport * as Notifications from 'expo-notifications';\nimport * as Device from 'expo-device';\nimport Constants from 'expo-constants';\nimport { useNavigation } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { apiClient } from '@/api/client';\nimport type { RootStackParamList } from '@/navigation/types';\n\nconst PUSH_TOKEN_KEY = '@medinvest/push_token';\n\n// Configure notification handling\nNotifications.setNotificationHandler({\n  handleNotification: async () => ({\n    shouldShowAlert: true,\n    shouldPlaySound: true,\n    shouldSetBadge: true,\n  }),\n});\n\n/**\n * Notification data types\n */\nexport interface NotificationData {\n  type: 'investment_update' | 'portfolio_milestone' | 'new_opportunity' | 'article' | 'system';\n  investmentId?: string;\n  articleId?: string;\n  url?: string;\n}\n\n/**\n * Register for push notifications\n */\nexport async function registerForPushNotifications(): Promise<string | null> {\n  let token: string | null = null;\n\n  // Must be a physical device\n  if (!Device.isDevice) {\n    console.log('Push notifications require a physical device');\n    return null;\n  }\n\n  // Check existing permission\n  const { status: existingStatus } = await Notifications.getPermissionsAsync();\n  let finalStatus = existingStatus;\n\n  // Request permission if not granted\n  if (existingStatus !== 'granted') {\n    const { status } = await Notifications.requestPermissionsAsync();\n    finalStatus = status;\n  }\n\n  if (finalStatus !== 'granted') {\n    console.log('Push notification permission not granted');\n    return null;\n  }\n\n  // Get Expo push token\n  try {\n    const projectId = Constants.expoConfig?.extra?.eas?.projectId;\n    \n    const tokenData = await Notifications.getExpoPushTokenAsync({\n      projectId,\n    });\n    token = tokenData.data;\n\n    // Store token locally\n    await AsyncStorage.setItem(PUSH_TOKEN_KEY, token);\n\n    // Send token to backend\n    await apiClient.post('/users/me/push-token', { token });\n\n    console.log('Push token registered:', token);\n  } catch (error) {\n    console.error('Failed to get push token:', error);\n  }\n\n  // Configure Android channel\n  if (Platform.OS === 'android') {\n    await Notifications.setNotificationChannelAsync('default', {\n      name: 'Default',\n      importance: Notifications.AndroidImportance.MAX,\n      vibrationPattern: [0, 250, 250, 250],\n      lightColor: '#0066CC',\n    });\n\n    await Notifications.setNotificationChannelAsync('investments', {\n      name: 'Investment Updates',\n      importance: Notifications.AndroidImportance.HIGH,\n      description: 'Updates about your investments',\n    });\n\n    await Notifications.setNotificationChannelAsync('opportunities', {\n      name: 'New Opportunities',\n      importance: Notifications.AndroidImportance.DEFAULT,\n      description: 'New investment opportunities',\n    });\n  }\n\n  return token;\n}\n\n/**\n * Unregister push notifications\n */\nexport async function unregisterPushNotifications(): Promise<void> {\n  try {\n    const token = await AsyncStorage.getItem(PUSH_TOKEN_KEY);\n    \n    if (token) {\n      // Remove token from backend\n      await apiClient.delete('/users/me/push-token', { data: { token } });\n      \n      // Remove local token\n      await AsyncStorage.removeItem(PUSH_TOKEN_KEY);\n    }\n  } catch (error) {\n    console.error('Failed to unregister push token:', error);\n  }\n}\n\n/**\n * Get badge count\n */\nexport async function getBadgeCount(): Promise<number> {\n  return await Notifications.getBadgeCountAsync();\n}\n\n/**\n * Set badge count\n */\nexport async function setBadgeCount(count: number): Promise<void> {\n  await Notifications.setBadgeCountAsync(count);\n}\n\n/**\n * Clear all notifications\n */\nexport async function clearAllNotifications(): Promise<void> {\n  await Notifications.dismissAllNotificationsAsync();\n  await setBadgeCount(0);\n}\n\n/**\n * Schedule a local notification\n */\nexport async function scheduleLocalNotification({\n  title,\n  body,\n  data,\n  trigger,\n}: {\n  title: string;\n  body: string;\n  data?: NotificationData;\n  trigger?: Notifications.NotificationTriggerInput;\n}): Promise<string> {\n  return await Notifications.scheduleNotificationAsync({\n    content: {\n      title,\n      body,\n      data,\n      sound: true,\n    },\n    trigger: trigger || null,\n  });\n}\n\n/**\n * Hook for handling push notifications\n */\nexport function usePushNotifications() {\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const notificationListener = useRef<Notifications.Subscription>();\n  const responseListener = useRef<Notifications.Subscription>();\n\n  const handleNotificationResponse = useCallback(\n    (response: Notifications.NotificationResponse) => {\n      const data = response.notification.request.content.data as NotificationData;\n\n      if (!data?.type) return;\n\n      // Navigate based on notification type\n      switch (data.type) {\n        case 'investment_update':\n        case 'new_opportunity':\n          if (data.investmentId) {\n            navigation.navigate('InvestmentDetail', {\n              investmentId: data.investmentId,\n            });\n          }\n          break;\n\n        case 'portfolio_milestone':\n          navigation.navigate('Main', { screen: 'Portfolio' } as any);\n          break;\n\n        case 'article':\n          if (data.articleId) {\n            // Navigate to article detail when implemented\n            navigation.navigate('Main', { screen: 'Research' } as any);\n          }\n          break;\n\n        case 'system':\n        default:\n          // Show alert for system notifications\n          break;\n      }\n    },\n    [navigation]\n  );\n\n  useEffect(() => {\n    // Register for push notifications\n    registerForPushNotifications();\n\n    // Listen for incoming notifications while app is foregrounded\n    notificationListener.current = Notifications.addNotificationReceivedListener(\n      (notification) => {\n        console.log('Notification received:', notification);\n      }\n    );\n\n    // Listen for user interaction with notifications\n    responseListener.current = Notifications.addNotificationResponseReceivedListener(\n      handleNotificationResponse\n    );\n\n    // Check if app was opened from a notification\n    Notifications.getLastNotificationResponseAsync().then((response) => {\n      if (response) {\n        handleNotificationResponse(response);\n      }\n    });\n\n    return () => {\n      if (notificationListener.current) {\n        Notifications.removeNotificationSubscription(notificationListener.current);\n      }\n      if (responseListener.current) {\n        Notifications.removeNotificationSubscription(responseListener.current);\n      }\n    };\n  }, [handleNotificationResponse]);\n\n  return {\n    registerForPushNotifications,\n    unregisterPushNotifications,\n    clearAllNotifications,\n    scheduleLocalNotification,\n  };\n}\n\n/**\n * Notification preferences hook\n */\nexport function useNotificationPreferences() {\n  const getPreferences = useCallback(async () => {\n    try {\n      const response = await apiClient.get('/users/me/notification-preferences');\n      return response.data;\n    } catch (error) {\n      console.error('Failed to get notification preferences:', error);\n      return null;\n    }\n  }, []);\n\n  const updatePreferences = useCallback(\n    async (preferences: {\n      investmentUpdates?: boolean;\n      newOpportunities?: boolean;\n      portfolioMilestones?: boolean;\n      articles?: boolean;\n      marketing?: boolean;\n    }) => {\n      try {\n        const response = await apiClient.patch(\n          '/users/me/notification-preferences',\n          preferences\n        );\n        return response.data;\n      } catch (error) {\n        console.error('Failed to update notification preferences:', error);\n        throw error;\n      }\n    },\n    []\n  );\n\n  return {\n    getPreferences,\n    updatePreferences,\n  };\n}\n","path":null,"size_bytes":8019,"size_tokens":null},"server/routes/deals.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { authMiddleware, optionalAuthMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\nconst DEALS = [\n  {\n    id: 1,\n    title: 'CardioTech Innovations Series B',\n    company_name: 'CardioTech Innovations',\n    description: 'Revolutionary AI-powered cardiac monitoring platform that enables real-time detection of arrhythmias and heart conditions. FDA-cleared device with proven clinical outcomes.',\n    category: 'Medical Devices',\n    stage: 'Series B',\n    target_raise: 15000000,\n    raised: 8500000,\n    minimum_investment: 5000,\n    maximum_investment: 500000,\n    investors_count: 234,\n    valuation: 75000000,\n    equity_offered: 20,\n    deadline: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),\n    highlights: [\n      'FDA 510(k) cleared',\n      '50+ hospital partnerships',\n      '$2.1M ARR with 40% MoM growth',\n      'Experienced founding team from Medtronic',\n    ],\n    risks: [\n      'Regulatory uncertainty in new markets',\n      'Competition from established players',\n      'Hardware manufacturing challenges',\n    ],\n    team: [\n      { name: 'Dr. Sarah Chen', role: 'CEO', background: 'Former Medtronic VP' },\n      { name: 'Michael Roberts', role: 'CTO', background: 'MIT PhD, 15 patents' },\n    ],\n    documents: [\n      { name: 'Pitch Deck', url: '/docs/pitch.pdf' },\n      { name: 'Financial Model', url: '/docs/financials.xlsx' },\n    ],\n    status: 'active',\n    featured: true,\n    image_url: null,\n    created_at: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString(),\n  },\n  {\n    id: 2,\n    title: 'GenomeRx Seed Round',\n    company_name: 'GenomeRx',\n    description: 'Pioneering personalized medicine through advanced genomic analysis. Our platform enables physicians to prescribe the right medication at the right dose based on genetic profiles.',\n    category: 'Biotech',\n    stage: 'Seed',\n    target_raise: 5000000,\n    raised: 3200000,\n    minimum_investment: 2500,\n    maximum_investment: 250000,\n    investors_count: 156,\n    valuation: 20000000,\n    equity_offered: 25,\n    deadline: new Date(Date.now() + 45 * 24 * 60 * 60 * 1000).toISOString(),\n    highlights: [\n      'Patented genomic analysis technology',\n      'Partnership with 3 major health systems',\n      'CLIA-certified laboratory',\n      'Published research in Nature Medicine',\n    ],\n    risks: [\n      'Long sales cycle with health systems',\n      'Insurance reimbursement challenges',\n      'Technology obsolescence risk',\n    ],\n    team: [\n      { name: 'Dr. Emily Thompson', role: 'CEO', background: 'Harvard Medical School faculty' },\n      { name: 'James Wilson', role: 'CSO', background: 'Stanford PhD, genomics pioneer' },\n    ],\n    documents: [\n      { name: 'Pitch Deck', url: '/docs/pitch.pdf' },\n      { name: 'Technical Overview', url: '/docs/tech.pdf' },\n    ],\n    status: 'active',\n    featured: true,\n    image_url: null,\n    created_at: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),\n  },\n  {\n    id: 3,\n    title: 'MindWell Digital Therapeutics Pre-Series A',\n    company_name: 'MindWell Health',\n    description: 'FDA-authorized digital therapeutic for anxiety and depression. Prescription-based app with proven clinical efficacy and reimbursement pathways.',\n    category: 'Digital Health',\n    stage: 'Pre-Series A',\n    target_raise: 8000000,\n    raised: 2100000,\n    minimum_investment: 3000,\n    maximum_investment: 300000,\n    investors_count: 89,\n    valuation: 35000000,\n    equity_offered: 23,\n    deadline: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000).toISOString(),\n    highlights: [\n      'FDA De Novo authorized',\n      'CPT codes secured for reimbursement',\n      '15,000+ prescriptions written',\n      'Clinical outcomes exceed SSRIs',\n    ],\n    risks: [\n      'Patient engagement challenges',\n      'Physician adoption barriers',\n      'Competition from wellness apps',\n    ],\n    team: [\n      { name: 'Dr. Lisa Park', role: 'CEO', background: 'Psychiatrist, Stanford Health' },\n      { name: 'Alex Kim', role: 'CTO', background: 'Ex-Google Health engineer' },\n    ],\n    documents: [\n      { name: 'Pitch Deck', url: '/docs/pitch.pdf' },\n      { name: 'Clinical Study Results', url: '/docs/clinical.pdf' },\n    ],\n    status: 'active',\n    featured: false,\n    image_url: null,\n    created_at: new Date(Date.now() - 21 * 24 * 60 * 60 * 1000).toISOString(),\n  },\n  {\n    id: 4,\n    title: 'NeuraScan AI Series A',\n    company_name: 'NeuraScan AI',\n    description: 'AI-powered medical imaging analysis for early detection of neurological conditions. Our algorithms detect Alzheimer\\'s and Parkinson\\'s years before symptoms appear.',\n    category: 'Healthcare AI',\n    stage: 'Series A',\n    target_raise: 12000000,\n    raised: 9800000,\n    minimum_investment: 10000,\n    maximum_investment: 1000000,\n    investors_count: 178,\n    valuation: 60000000,\n    equity_offered: 20,\n    deadline: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000).toISOString(),\n    highlights: [\n      '95% accuracy in early detection',\n      'Integration with major PACS systems',\n      'Published in JAMA Neurology',\n      'Contracts with 25 imaging centers',\n    ],\n    risks: [\n      'Regulatory approval timeline',\n      'Competition from radiology giants',\n      'Data privacy concerns',\n    ],\n    team: [\n      { name: 'Dr. Mark Johnson', role: 'CEO', background: 'Neurologist, Mayo Clinic' },\n      { name: 'Rachel Green', role: 'CTO', background: 'DeepMind alumna' },\n    ],\n    documents: [\n      { name: 'Pitch Deck', url: '/docs/pitch.pdf' },\n      { name: 'AI Performance Metrics', url: '/docs/ai-metrics.pdf' },\n    ],\n    status: 'active',\n    featured: true,\n    image_url: null,\n    created_at: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),\n  },\n];\n\nconst watchlist = new Map<number, Set<number>>();\n\nrouter.get('/', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { category, stage, sort = 'featured', limit = 20 } = req.query;\n    const userId = (req as any).userId;\n    const userWatchlist = watchlist.get(userId) || new Set();\n    \n    let deals = [...DEALS];\n    \n    if (category) {\n      deals = deals.filter(d => d.category.toLowerCase() === String(category).toLowerCase());\n    }\n    \n    if (stage) {\n      deals = deals.filter(d => d.stage.toLowerCase() === String(stage).toLowerCase());\n    }\n    \n    if (sort === 'featured') {\n      deals.sort((a, b) => (b.featured ? 1 : 0) - (a.featured ? 1 : 0));\n    } else if (sort === 'newest') {\n      deals.sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n    } else if (sort === 'ending_soon') {\n      deals.sort((a, b) => new Date(a.deadline).getTime() - new Date(b.deadline).getTime());\n    }\n    \n    const dealsWithWatchlist = deals.map(deal => ({\n      ...deal,\n      is_watched: userWatchlist.has(deal.id),\n    }));\n    \n    res.json({ \n      deals: dealsWithWatchlist.slice(0, Number(limit)),\n      total: deals.length,\n      categories: ['Medical Devices', 'Biotech', 'Digital Health', 'Healthcare AI', 'Pharmaceuticals'],\n      stages: ['Seed', 'Pre-Series A', 'Series A', 'Series B', 'Series C+'],\n    });\n  } catch (error) {\n    console.error('Deals error:', error);\n    res.status(500).json({ error: 'Failed to fetch deals' });\n  }\n});\n\nrouter.get('/featured', async (req: Request, res: Response) => {\n  try {\n    const featured = DEALS.filter(d => d.featured);\n    res.json({ deals: featured });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch featured deals' });\n  }\n});\n\nrouter.get('/:id', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const userId = (req as any).userId;\n    const userWatchlist = watchlist.get(userId) || new Set();\n    \n    const deal = DEALS.find(d => d.id === parseInt(id));\n    if (!deal) {\n      return res.status(404).json({ error: 'Deal not found' });\n    }\n    \n    res.json({ ...deal, is_watched: userWatchlist.has(deal.id) });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to fetch deal' });\n  }\n});\n\nrouter.post('/:id/watch', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const userId = (req as any).userId;\n    \n    if (!watchlist.has(userId)) {\n      watchlist.set(userId, new Set());\n    }\n    watchlist.get(userId)!.add(parseInt(id));\n    \n    res.json({ success: true, is_watched: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to watch deal' });\n  }\n});\n\nrouter.delete('/:id/watch', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const userId = (req as any).userId;\n    \n    const userWatchlist = watchlist.get(userId);\n    if (userWatchlist) {\n      userWatchlist.delete(parseInt(id));\n    }\n    \n    res.json({ success: true, is_watched: false });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to unwatch deal' });\n  }\n});\n\nrouter.post('/:id/interest', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const { amount, message } = req.body;\n    \n    res.json({ \n      success: true, \n      message: 'Your interest has been recorded. Our team will contact you within 24 hours.',\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to express interest' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":9448,"size_tokens":null},"client/components/Button.tsx":{"content":"import React from 'react';\nimport {\n  Pressable,\n  Text,\n  StyleSheet,\n  ActivityIndicator,\n  View,\n  type PressableProps,\n  type StyleProp,\n  type ViewStyle,\n  type TextStyle,\n} from 'react-native';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport type ButtonVariant = 'primary' | 'secondary' | 'outline' | 'ghost' | 'danger' | 'gradient';\nexport type ButtonSize = 'sm' | 'md' | 'lg';\n\nexport interface ButtonProps extends Omit<PressableProps, 'style'> {\n  /** Button text */\n  children: string;\n  /** Visual variant */\n  variant?: ButtonVariant;\n  /** Size preset */\n  size?: ButtonSize;\n  /** Show loading spinner */\n  loading?: boolean;\n  /** Disable button */\n  disabled?: boolean;\n  /** Icon name (Feather) to show before text */\n  leftIcon?: keyof typeof Feather.glyphMap;\n  /** Icon name (Feather) to show after text */\n  rightIcon?: keyof typeof Feather.glyphMap;\n  /** Full width button */\n  fullWidth?: boolean;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n  /** Custom text style */\n  textStyle?: StyleProp<TextStyle>;\n}\n\nconst SIZES = {\n  sm: {\n    paddingVertical: spacing.sm,\n    paddingHorizontal: spacing.md,\n    iconSize: 16,\n    gap: spacing.xs,\n  },\n  md: {\n    paddingVertical: spacing.md,\n    paddingHorizontal: spacing.lg,\n    iconSize: 18,\n    gap: spacing.sm,\n  },\n  lg: {\n    paddingVertical: spacing.lg,\n    paddingHorizontal: spacing.xl,\n    iconSize: 20,\n    gap: spacing.sm,\n  },\n};\n\nexport function Button({\n  children,\n  variant = 'primary',\n  size = 'md',\n  loading = false,\n  disabled = false,\n  leftIcon,\n  rightIcon,\n  fullWidth = false,\n  style,\n  textStyle,\n  onPressIn,\n  onPressOut,\n  ...props\n}: ButtonProps) {\n  const scale = useSharedValue(1);\n  const sizeConfig = SIZES[size];\n  const isDisabled = disabled || loading;\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = (e: any) => {\n    scale.value = withSpring(0.97, { damping: 15, stiffness: 400 });\n    onPressIn?.(e);\n  };\n\n  const handlePressOut = (e: any) => {\n    scale.value = withSpring(1, { damping: 15, stiffness: 400 });\n    onPressOut?.(e);\n  };\n\n  const getVariantStyles = () => {\n    switch (variant) {\n      case 'primary':\n        return {\n          container: [\n            styles.container,\n            styles.primaryContainer,\n            isDisabled && styles.disabledContainer,\n          ],\n          text: [styles.text, styles.primaryText],\n          iconColor: colors.text.inverse,\n        };\n      case 'secondary':\n        return {\n          container: [\n            styles.container,\n            styles.secondaryContainer,\n            isDisabled && styles.disabledSecondaryContainer,\n          ],\n          text: [styles.text, styles.secondaryText],\n          iconColor: colors.primary.main,\n        };\n      case 'outline':\n        return {\n          container: [\n            styles.container,\n            styles.outlineContainer,\n            isDisabled && styles.disabledOutlineContainer,\n          ],\n          text: [styles.text, styles.outlineText],\n          iconColor: colors.primary.main,\n        };\n      case 'ghost':\n        return {\n          container: [styles.container, styles.ghostContainer],\n          text: [styles.text, styles.ghostText],\n          iconColor: colors.primary.main,\n        };\n      case 'danger':\n        return {\n          container: [\n            styles.container,\n            styles.dangerContainer,\n            isDisabled && styles.disabledContainer,\n          ],\n          text: [styles.text, styles.dangerText],\n          iconColor: colors.text.inverse,\n        };\n      case 'gradient':\n        return {\n          container: [styles.container],\n          text: [styles.text, styles.gradientText],\n          iconColor: colors.text.inverse,\n        };\n      default:\n        return {\n          container: [styles.container],\n          text: [styles.text],\n          iconColor: colors.text.primary,\n        };\n    }\n  };\n\n  const variantStyles = getVariantStyles();\n  const textSizeStyle = size === 'sm' ? typography.button.small : size === 'lg' ? typography.button.large : typography.button.medium;\n\n  const renderContent = () => (\n    <View style={[styles.content, { gap: sizeConfig.gap }]}>\n      {loading ? (\n        <ActivityIndicator\n          size=\"small\"\n          color={variantStyles.iconColor}\n        />\n      ) : (\n        <>\n          {leftIcon && (\n            <Feather\n              name={leftIcon}\n              size={sizeConfig.iconSize}\n              color={isDisabled ? colors.text.tertiary : variantStyles.iconColor}\n            />\n          )}\n          <Text\n            style={[\n              variantStyles.text,\n              textSizeStyle,\n              isDisabled && styles.disabledText,\n              textStyle,\n            ]}\n          >\n            {children}\n          </Text>\n          {rightIcon && (\n            <Feather\n              name={rightIcon}\n              size={sizeConfig.iconSize}\n              color={isDisabled ? colors.text.tertiary : variantStyles.iconColor}\n            />\n          )}\n        </>\n      )}\n    </View>\n  );\n\n  const containerStyle = [\n    variantStyles.container,\n    {\n      paddingVertical: sizeConfig.paddingVertical,\n      paddingHorizontal: sizeConfig.paddingHorizontal,\n    },\n    fullWidth && styles.fullWidth,\n    style,\n  ];\n\n  if (variant === 'gradient' && !isDisabled) {\n    return (\n      <AnimatedPressable\n        style={[animatedStyle, fullWidth && styles.fullWidth]}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        disabled={isDisabled}\n        {...props}\n      >\n        <LinearGradient\n          colors={colors.gradient.colors as unknown as string[]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 0 }}\n          style={[\n            styles.container,\n            styles.gradientContainer,\n            {\n              paddingVertical: sizeConfig.paddingVertical,\n              paddingHorizontal: sizeConfig.paddingHorizontal,\n            },\n            style,\n          ]}\n        >\n          {renderContent()}\n        </LinearGradient>\n      </AnimatedPressable>\n    );\n  }\n\n  return (\n    <AnimatedPressable\n      style={[animatedStyle, containerStyle]}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      disabled={isDisabled}\n      {...props}\n    >\n      {renderContent()}\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    borderRadius: layout.radiusMedium,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  content: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  fullWidth: {\n    width: '100%',\n  },\n  text: {\n    textAlign: 'center',\n  },\n\n  // Primary\n  primaryContainer: {\n    backgroundColor: colors.primary.main,\n  },\n  primaryText: {\n    color: colors.text.inverse,\n  },\n\n  // Secondary\n  secondaryContainer: {\n    backgroundColor: colors.transparent.primary10,\n  },\n  secondaryText: {\n    color: colors.primary.main,\n  },\n  disabledSecondaryContainer: {\n    backgroundColor: colors.background.secondary,\n  },\n\n  // Outline\n  outlineContainer: {\n    backgroundColor: 'transparent',\n    borderWidth: 1.5,\n    borderColor: colors.primary.main,\n  },\n  outlineText: {\n    color: colors.primary.main,\n  },\n  disabledOutlineContainer: {\n    borderColor: colors.border.light,\n  },\n\n  // Ghost\n  ghostContainer: {\n    backgroundColor: 'transparent',\n  },\n  ghostText: {\n    color: colors.primary.main,\n  },\n\n  // Danger\n  dangerContainer: {\n    backgroundColor: colors.semantic.error,\n  },\n  dangerText: {\n    color: colors.text.inverse,\n  },\n\n  // Gradient\n  gradientContainer: {\n    overflow: 'hidden',\n  },\n  gradientText: {\n    color: colors.text.inverse,\n  },\n\n  // Disabled\n  disabledContainer: {\n    backgroundColor: colors.border.light,\n  },\n  disabledText: {\n    color: colors.text.tertiary,\n  },\n});\n\nexport default Button;\n","path":null,"size_bytes":8232,"size_tokens":null},"client/lib/biometric-auth.ts":{"content":"/**\n * Biometric Authentication Service\n * Face ID / Touch ID / Fingerprint support\n */\n\nimport * as LocalAuthentication from 'expo-local-authentication';\nimport * as SecureStore from 'expo-secure-store';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform, Alert } from 'react-native';\n\n// Storage keys\nconst BIOMETRIC_ENABLED_KEY = 'biometric_enabled';\nconst BIOMETRIC_CREDENTIALS_KEY = 'biometric_credentials';\n\nconst secureGet = async (key: string): Promise<string | null> => {\n  if (Platform.OS === 'web') {\n    return AsyncStorage.getItem(key);\n  }\n  return SecureStore.getItemAsync(key);\n};\n\nconst secureSet = async (key: string, value: string, options?: any): Promise<void> => {\n  if (Platform.OS === 'web') {\n    await AsyncStorage.setItem(key, value);\n    return;\n  }\n  await SecureStore.setItemAsync(key, value, options);\n};\n\nconst secureDelete = async (key: string): Promise<void> => {\n  if (Platform.OS === 'web') {\n    await AsyncStorage.removeItem(key);\n    return;\n  }\n  await SecureStore.deleteItemAsync(key);\n};\n\nexport type BiometricType = 'fingerprint' | 'facial' | 'iris' | 'none';\n\nexport interface BiometricStatus {\n  isAvailable: boolean;\n  isEnrolled: boolean;\n  biometricType: BiometricType;\n  supportedTypes: BiometricType[];\n}\n\nexport interface StoredCredentials {\n  email: string;\n  password: string;\n}\n\nclass BiometricAuthService {\n  /**\n   * Check if biometric authentication is available on device\n   */\n  async checkBiometricAvailability(): Promise<BiometricStatus> {\n    try {\n      // Check if hardware is available\n      const isAvailable = await LocalAuthentication.hasHardwareAsync();\n      \n      // Check if biometrics are enrolled\n      const isEnrolled = await LocalAuthentication.isEnrolledAsync();\n      \n      // Get supported authentication types\n      const supportedTypes = await LocalAuthentication.supportedAuthenticationTypesAsync();\n      \n      // Determine primary biometric type\n      let biometricType: BiometricType = 'none';\n      const typeNames: BiometricType[] = [];\n      \n      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.FACIAL_RECOGNITION)) {\n        biometricType = 'facial';\n        typeNames.push('facial');\n      }\n      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.FINGERPRINT)) {\n        if (biometricType === 'none') biometricType = 'fingerprint';\n        typeNames.push('fingerprint');\n      }\n      if (supportedTypes.includes(LocalAuthentication.AuthenticationType.IRIS)) {\n        if (biometricType === 'none') biometricType = 'iris';\n        typeNames.push('iris');\n      }\n\n      return {\n        isAvailable,\n        isEnrolled,\n        biometricType,\n        supportedTypes: typeNames,\n      };\n    } catch (error) {\n      console.error('[Biometric] Error checking availability:', error);\n      return {\n        isAvailable: false,\n        isEnrolled: false,\n        biometricType: 'none',\n        supportedTypes: [],\n      };\n    }\n  }\n\n  /**\n   * Get human-readable name for biometric type\n   */\n  getBiometricName(type: BiometricType): string {\n    switch (type) {\n      case 'facial':\n        return Platform.OS === 'ios' ? 'Face ID' : 'Face Recognition';\n      case 'fingerprint':\n        return Platform.OS === 'ios' ? 'Touch ID' : 'Fingerprint';\n      case 'iris':\n        return 'Iris Recognition';\n      default:\n        return 'Biometric';\n    }\n  }\n\n  /**\n   * Authenticate user with biometrics\n   */\n  async authenticate(reason?: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const status = await this.checkBiometricAvailability();\n      \n      if (!status.isAvailable) {\n        return { success: false, error: 'Biometric authentication not available' };\n      }\n      \n      if (!status.isEnrolled) {\n        return { success: false, error: 'No biometrics enrolled on this device' };\n      }\n\n      const biometricName = this.getBiometricName(status.biometricType);\n      \n      const result = await LocalAuthentication.authenticateAsync({\n        promptMessage: reason || `Authenticate with ${biometricName}`,\n        cancelLabel: 'Cancel',\n        fallbackLabel: 'Use Password',\n        disableDeviceFallback: false,\n      });\n\n      if (result.success) {\n        return { success: true };\n      } else {\n        let errorMessage = 'Authentication failed';\n        \n        switch (result.error) {\n          case 'user_cancel':\n            errorMessage = 'Authentication cancelled';\n            break;\n          case 'user_fallback':\n            errorMessage = 'User chose password fallback';\n            break;\n          case 'system_cancel':\n            errorMessage = 'Authentication was cancelled by the system';\n            break;\n          case 'not_enrolled':\n            errorMessage = 'No biometrics enrolled';\n            break;\n          case 'lockout':\n            errorMessage = 'Too many failed attempts. Try again later.';\n            break;\n          default:\n            errorMessage = result.error || 'Authentication failed';\n        }\n        \n        return { success: false, error: errorMessage };\n      }\n    } catch (error) {\n      console.error('[Biometric] Authentication error:', error);\n      return { success: false, error: 'An error occurred during authentication' };\n    }\n  }\n\n  /**\n   * Check if biometric login is enabled for the app\n   */\n  async isBiometricLoginEnabled(): Promise<boolean> {\n    try {\n      const enabled = await secureGet(BIOMETRIC_ENABLED_KEY);\n      return enabled === 'true';\n    } catch (error) {\n      console.error('[Biometric] Error checking enabled status:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Enable biometric login and store credentials\n   */\n  async enableBiometricLogin(email: string, password: string): Promise<boolean> {\n    try {\n      // First authenticate to confirm identity\n      const authResult = await this.authenticate('Confirm your identity to enable biometric login');\n      \n      if (!authResult.success) {\n        return false;\n      }\n\n      // Store credentials securely\n      const credentials: StoredCredentials = { email, password };\n      await secureSet(\n        BIOMETRIC_CREDENTIALS_KEY,\n        JSON.stringify(credentials),\n        Platform.OS !== 'web' ? {\n          keychainAccessible: SecureStore.WHEN_PASSCODE_SET_THIS_DEVICE_ONLY,\n        } : undefined\n      );\n\n      await secureSet(BIOMETRIC_ENABLED_KEY, 'true');\n\n      return true;\n    } catch (error) {\n      console.error('[Biometric] Error enabling biometric login:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Disable biometric login and clear stored credentials\n   */\n  async disableBiometricLogin(): Promise<boolean> {\n    try {\n      await secureDelete(BIOMETRIC_CREDENTIALS_KEY);\n      await secureDelete(BIOMETRIC_ENABLED_KEY);\n      return true;\n    } catch (error) {\n      console.error('[Biometric] Error disabling biometric login:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get stored credentials after biometric authentication\n   */\n  async getCredentialsWithBiometric(): Promise<StoredCredentials | null> {\n    try {\n      // Check if biometric login is enabled\n      const isEnabled = await this.isBiometricLoginEnabled();\n      if (!isEnabled) {\n        return null;\n      }\n\n      // Authenticate with biometrics\n      const authResult = await this.authenticate('Sign in with biometrics');\n      if (!authResult.success) {\n        return null;\n      }\n\n      // Retrieve stored credentials\n      const credentialsJson = await secureGet(BIOMETRIC_CREDENTIALS_KEY);\n      if (!credentialsJson) {\n        return null;\n      }\n\n      return JSON.parse(credentialsJson) as StoredCredentials;\n    } catch (error) {\n      console.error('[Biometric] Error getting credentials:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Update stored password (e.g., after password change)\n   */\n  async updateStoredPassword(newPassword: string): Promise<boolean> {\n    try {\n      const credentialsJson = await secureGet(BIOMETRIC_CREDENTIALS_KEY);\n      if (!credentialsJson) {\n        return false;\n      }\n\n      const credentials: StoredCredentials = JSON.parse(credentialsJson);\n      credentials.password = newPassword;\n\n      await secureSet(\n        BIOMETRIC_CREDENTIALS_KEY,\n        JSON.stringify(credentials),\n        Platform.OS !== 'web' ? {\n          keychainAccessible: SecureStore.WHEN_PASSCODE_SET_THIS_DEVICE_ONLY,\n        } : undefined\n      );\n\n      return true;\n    } catch (error) {\n      console.error('[Biometric] Error updating password:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Prompt user to enable biometric login\n   */\n  async promptEnableBiometric(\n    email: string,\n    password: string,\n    onSuccess?: () => void\n  ): Promise<void> {\n    const status = await this.checkBiometricAvailability();\n    \n    if (!status.isAvailable || !status.isEnrolled) {\n      return;\n    }\n\n    const biometricName = this.getBiometricName(status.biometricType);\n\n    Alert.alert(\n      `Enable ${biometricName}?`,\n      `Would you like to use ${biometricName} to sign in faster next time?`,\n      [\n        {\n          text: 'Not Now',\n          style: 'cancel',\n        },\n        {\n          text: 'Enable',\n          onPress: async () => {\n            const success = await this.enableBiometricLogin(email, password);\n            if (success) {\n              Alert.alert('Success', `${biometricName} login enabled!`);\n              onSuccess?.();\n            }\n          },\n        },\n      ]\n    );\n  }\n}\n\nexport const biometricAuth = new BiometricAuthService();\n","path":null,"size_bytes":9584,"size_tokens":null},"server/routes/users.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { db, users, pushTokens, notificationPreferences, paymentMethods } from '../db';\nimport { eq, and, ne, or, ilike, sql } from 'drizzle-orm';\nimport { authMiddleware } from '../middleware/auth';\nimport multer from 'multer';\nimport path from 'path';\nimport fs from 'fs/promises';\n\nconst router = Router();\n\n// All user routes require authentication\nrouter.use(authMiddleware);\n\n// Configure multer for avatar uploads\nconst storage = multer.diskStorage({\n  destination: './uploads/avatars',\n  filename: (req, file, cb) => {\n    const uniqueSuffix = `${Date.now()}-${Math.round(Math.random() * 1e9)}`;\n    cb(null, `${req.user!.id}-${uniqueSuffix}${path.extname(file.originalname)}`);\n  },\n});\n\nconst upload = multer({\n  storage,\n  limits: { fileSize: 5 * 1024 * 1024 }, // 5MB\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/webp'];\n    if (allowedTypes.includes(file.mimetype)) {\n      cb(null, true);\n    } else {\n      cb(new Error('Invalid file type. Only JPEG, PNG, and WebP are allowed.'));\n    }\n  },\n});\n\n/**\n * GET /api/users/me\n * Get current user profile\n */\nrouter.get('/me', async (req: Request, res: Response) => {\n  try {\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        phone: users.phone,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n        updatedAt: users.updatedAt,\n      })\n      .from(users)\n      .where(eq(users.id, req.user!.id))\n      .limit(1);\n\n    if (!user) {\n      res.status(404).json({ message: 'User not found' });\n      return;\n    }\n\n    res.json({\n      ...user,\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || undefined,\n    });\n  } catch (error) {\n    console.error('Get user error:', error);\n    res.status(500).json({ message: 'Failed to fetch user' });\n  }\n});\n\n/**\n * PATCH /api/users/me\n * Update current user profile\n */\nrouter.patch('/me', async (req: Request, res: Response) => {\n  try {\n    const { firstName, lastName, phone } = req.body;\n\n    const [updatedUser] = await db\n      .update(users)\n      .set({\n        firstName,\n        lastName,\n        phone,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, req.user!.id))\n      .returning({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        phone: users.phone,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n        updatedAt: users.updatedAt,\n      });\n\n    res.json({\n      ...updatedUser,\n      fullName: [updatedUser.firstName, updatedUser.lastName]\n        .filter(Boolean)\n        .join(' ') || undefined,\n    });\n  } catch (error) {\n    console.error('Update user error:', error);\n    res.status(500).json({ message: 'Failed to update user' });\n  }\n});\n\n/**\n * POST /api/users/me/avatar\n * Upload user avatar\n */\nrouter.post('/me/avatar', upload.single('avatar'), async (req: Request, res: Response) => {\n  try {\n    if (!req.file) {\n      res.status(400).json({ message: 'No file uploaded' });\n      return;\n    }\n\n    // Get current avatar to delete old file\n    const [currentUser] = await db\n      .select({ avatarUrl: users.avatarUrl })\n      .from(users)\n      .where(eq(users.id, req.user!.id))\n      .limit(1);\n\n    // Delete old avatar file if exists\n    if (currentUser?.avatarUrl && currentUser.avatarUrl.startsWith('/uploads/')) {\n      try {\n        await fs.unlink(`.${currentUser.avatarUrl}`);\n      } catch {\n        // Ignore if file doesn't exist\n      }\n    }\n\n    // Update user with new avatar URL\n    const avatarUrl = `/uploads/avatars/${req.file.filename}`;\n\n    const [updatedUser] = await db\n      .update(users)\n      .set({\n        avatarUrl,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, req.user!.id))\n      .returning({ avatarUrl: users.avatarUrl });\n\n    res.json({ avatarUrl: updatedUser.avatarUrl });\n  } catch (error) {\n    console.error('Upload avatar error:', error);\n    res.status(500).json({ message: 'Failed to upload avatar' });\n  }\n});\n\n/**\n * POST /api/users/me/push-token\n * Register push notification token\n */\nrouter.post('/me/push-token', async (req: Request, res: Response) => {\n  try {\n    const { token, platform } = req.body;\n\n    if (!token) {\n      res.status(400).json({ message: 'Token is required' });\n      return;\n    }\n\n    // Check if token already exists\n    const [existingToken] = await db\n      .select()\n      .from(pushTokens)\n      .where(eq(pushTokens.token, token))\n      .limit(1);\n\n    if (existingToken) {\n      // Update user ID if different\n      if (existingToken.userId !== req.user!.id) {\n        await db\n          .update(pushTokens)\n          .set({ userId: req.user!.id })\n          .where(eq(pushTokens.id, existingToken.id));\n      }\n    } else {\n      // Create new token\n      await db.insert(pushTokens).values({\n        userId: req.user!.id,\n        token,\n        platform,\n      });\n    }\n\n    res.json({ message: 'Push token registered' });\n  } catch (error) {\n    console.error('Register push token error:', error);\n    res.status(500).json({ message: 'Failed to register push token' });\n  }\n});\n\n/**\n * DELETE /api/users/me/push-token\n * Unregister push notification token\n */\nrouter.delete('/me/push-token', async (req: Request, res: Response) => {\n  try {\n    const { token } = req.body;\n\n    if (!token) {\n      res.status(400).json({ message: 'Token is required' });\n      return;\n    }\n\n    await db\n      .delete(pushTokens)\n      .where(\n        and(\n          eq(pushTokens.userId, req.user!.id),\n          eq(pushTokens.token, token)\n        )\n      );\n\n    res.json({ message: 'Push token unregistered' });\n  } catch (error) {\n    console.error('Unregister push token error:', error);\n    res.status(500).json({ message: 'Failed to unregister push token' });\n  }\n});\n\n/**\n * GET /api/users/me/notification-preferences\n * Get notification preferences\n */\nrouter.get('/me/notification-preferences', async (req: Request, res: Response) => {\n  try {\n    let [prefs] = await db\n      .select({\n        investmentUpdates: notificationPreferences.investmentUpdates,\n        newOpportunities: notificationPreferences.newOpportunities,\n        portfolioMilestones: notificationPreferences.portfolioMilestones,\n        articles: notificationPreferences.articles,\n        marketing: notificationPreferences.marketing,\n      })\n      .from(notificationPreferences)\n      .where(eq(notificationPreferences.userId, req.user!.id))\n      .limit(1);\n\n    // Create default preferences if not exists\n    if (!prefs) {\n      [prefs] = await db\n        .insert(notificationPreferences)\n        .values({ userId: req.user!.id })\n        .returning({\n          investmentUpdates: notificationPreferences.investmentUpdates,\n          newOpportunities: notificationPreferences.newOpportunities,\n          portfolioMilestones: notificationPreferences.portfolioMilestones,\n          articles: notificationPreferences.articles,\n          marketing: notificationPreferences.marketing,\n        });\n    }\n\n    res.json(prefs);\n  } catch (error) {\n    console.error('Get notification preferences error:', error);\n    res.status(500).json({ message: 'Failed to fetch notification preferences' });\n  }\n});\n\n/**\n * PATCH /api/users/me/notification-preferences\n * Update notification preferences\n */\nrouter.patch('/me/notification-preferences', async (req: Request, res: Response) => {\n  try {\n    const {\n      investmentUpdates,\n      newOpportunities,\n      portfolioMilestones,\n      articles,\n      marketing,\n    } = req.body;\n\n    // Build update object with only provided fields\n    const updateData: Record<string, any> = { updatedAt: new Date() };\n    \n    if (investmentUpdates !== undefined) updateData.investmentUpdates = investmentUpdates;\n    if (newOpportunities !== undefined) updateData.newOpportunities = newOpportunities;\n    if (portfolioMilestones !== undefined) updateData.portfolioMilestones = portfolioMilestones;\n    if (articles !== undefined) updateData.articles = articles;\n    if (marketing !== undefined) updateData.marketing = marketing;\n\n    // Check if preferences exist\n    const [existing] = await db\n      .select({ id: notificationPreferences.id })\n      .from(notificationPreferences)\n      .where(eq(notificationPreferences.userId, req.user!.id))\n      .limit(1);\n\n    let prefs;\n\n    if (existing) {\n      [prefs] = await db\n        .update(notificationPreferences)\n        .set(updateData)\n        .where(eq(notificationPreferences.userId, req.user!.id))\n        .returning({\n          investmentUpdates: notificationPreferences.investmentUpdates,\n          newOpportunities: notificationPreferences.newOpportunities,\n          portfolioMilestones: notificationPreferences.portfolioMilestones,\n          articles: notificationPreferences.articles,\n          marketing: notificationPreferences.marketing,\n        });\n    } else {\n      [prefs] = await db\n        .insert(notificationPreferences)\n        .values({\n          userId: req.user!.id,\n          ...updateData,\n        })\n        .returning({\n          investmentUpdates: notificationPreferences.investmentUpdates,\n          newOpportunities: notificationPreferences.newOpportunities,\n          portfolioMilestones: notificationPreferences.portfolioMilestones,\n          articles: notificationPreferences.articles,\n          marketing: notificationPreferences.marketing,\n        });\n    }\n\n    res.json(prefs);\n  } catch (error) {\n    console.error('Update notification preferences error:', error);\n    res.status(500).json({ message: 'Failed to update notification preferences' });\n  }\n});\n\n/**\n * GET /api/users/me/payment-methods\n * Get user's payment methods\n */\nrouter.get('/me/payment-methods', async (req: Request, res: Response) => {\n  try {\n    const methods = await db\n      .select({\n        id: paymentMethods.id,\n        type: paymentMethods.type,\n        name: paymentMethods.name,\n        last4: paymentMethods.last4,\n        expiryMonth: paymentMethods.expiryMonth,\n        expiryYear: paymentMethods.expiryYear,\n        bankName: paymentMethods.bankName,\n        isDefault: paymentMethods.isDefault,\n      })\n      .from(paymentMethods)\n      .where(eq(paymentMethods.userId, req.user!.id));\n\n    res.json(methods);\n  } catch (error) {\n    console.error('Get payment methods error:', error);\n    res.status(500).json({ message: 'Failed to fetch payment methods' });\n  }\n});\n\n/**\n * GET /api/users/search\n * Search users by name or email\n */\nrouter.get('/search', async (req: Request, res: Response) => {\n  try {\n    const { q } = req.query;\n    const searchTerm = String(q || '').trim();\n\n    if (!searchTerm) {\n      res.json({ users: [] });\n      return;\n    }\n\n    const searchPattern = `%${searchTerm}%`;\n\n    const results = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        isVerified: users.isVerified,\n      })\n      .from(users)\n      .where(\n        and(\n          ne(users.id, req.user!.id),\n          or(\n            ilike(users.firstName, searchPattern),\n            ilike(users.lastName, searchPattern),\n            ilike(users.email, searchPattern),\n            sql`CONCAT(${users.firstName}, ' ', ${users.lastName}) ILIKE ${searchPattern}`\n          )\n        )\n      )\n      .limit(20);\n\n    const formattedUsers = results.map((user) => ({\n      id: user.id,\n      email: user.email,\n      firstName: user.firstName || '',\n      lastName: user.lastName || '',\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || user.email,\n      avatarUrl: user.avatarUrl,\n      isVerified: user.isVerified,\n    }));\n\n    res.json({ users: formattedUsers });\n  } catch (error) {\n    console.error('Search users error:', error);\n    res.status(500).json({ message: 'Failed to search users' });\n  }\n});\n\n/**\n * GET /api/users/explore\n * Get suggested users to connect with (excludes current user)\n */\nrouter.get('/explore', async (req: Request, res: Response) => {\n  try {\n    const results = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        isVerified: users.isVerified,\n      })\n      .from(users)\n      .where(ne(users.id, req.user!.id))\n      .limit(20);\n\n    const formattedUsers = results.map((user) => ({\n      id: user.id,\n      email: user.email,\n      firstName: user.firstName || '',\n      lastName: user.lastName || '',\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || user.email,\n      avatarUrl: user.avatarUrl,\n      isVerified: user.isVerified,\n    }));\n\n    res.json({ users: formattedUsers });\n  } catch (error) {\n    console.error('Explore users error:', error);\n    res.status(500).json({ message: 'Failed to fetch suggested users' });\n  }\n});\n\n/**\n * GET /api/users/:id/following\n * Get users that a user is following (for messaging suggestions)\n */\nrouter.get('/:id/following', async (req: Request, res: Response) => {\n  try {\n    // For now, return explore results as \"following\" since we don't have a follow system yet\n    const results = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        isVerified: users.isVerified,\n      })\n      .from(users)\n      .where(ne(users.id, req.user!.id))\n      .limit(20);\n\n    const formattedUsers = results.map((user) => ({\n      id: user.id,\n      email: user.email,\n      firstName: user.firstName || '',\n      lastName: user.lastName || '',\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || user.email,\n      avatarUrl: user.avatarUrl,\n      isVerified: user.isVerified,\n    }));\n\n    res.json({ users: formattedUsers });\n  } catch (error) {\n    console.error('Get following error:', error);\n    res.status(500).json({ message: 'Failed to fetch following users' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":14503,"size_tokens":null},"client/components/Badge.tsx":{"content":"import React from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  type StyleProp,\n  type ViewStyle,\n  type TextStyle,\n} from 'react-native';\nimport { Feather } from '@expo/vector-icons';\n\nimport { colors, typography, spacing, layout } from '@/theme';\n\nexport type BadgeVariant =\n  | 'default'\n  | 'primary'\n  | 'secondary'\n  | 'success'\n  | 'warning'\n  | 'error'\n  | 'info'\n  | 'outline';\n\nexport type BadgeSize = 'sm' | 'md' | 'lg';\n\nexport interface BadgeProps {\n  /** Badge text */\n  children: string;\n  /** Visual variant */\n  variant?: BadgeVariant;\n  /** Size preset */\n  size?: BadgeSize;\n  /** Icon name (Feather) before text */\n  icon?: keyof typeof Feather.glyphMap;\n  /** Dot indicator instead of text */\n  dot?: boolean;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n  /** Custom text style */\n  textStyle?: StyleProp<TextStyle>;\n}\n\nconst SIZE_CONFIG = {\n  sm: {\n    paddingVertical: spacing.xs / 2,\n    paddingHorizontal: spacing.sm,\n    fontSize: 10,\n    iconSize: 10,\n    dotSize: 6,\n  },\n  md: {\n    paddingVertical: spacing.xs,\n    paddingHorizontal: spacing.sm,\n    fontSize: 11,\n    iconSize: 12,\n    dotSize: 8,\n  },\n  lg: {\n    paddingVertical: spacing.sm,\n    paddingHorizontal: spacing.md,\n    fontSize: 12,\n    iconSize: 14,\n    dotSize: 10,\n  },\n};\n\nconst VARIANT_STYLES: Record<\n  BadgeVariant,\n  { backgroundColor: string; textColor: string; borderColor?: string }\n> = {\n  default: {\n    backgroundColor: colors.background.secondary,\n    textColor: colors.text.secondary,\n  },\n  primary: {\n    backgroundColor: colors.transparent.primary10,\n    textColor: colors.primary.main,\n  },\n  secondary: {\n    backgroundColor: colors.transparent.secondary10,\n    textColor: colors.secondary.main,\n  },\n  success: {\n    backgroundColor: 'rgba(0, 168, 107, 0.1)',\n    textColor: colors.semantic.success,\n  },\n  warning: {\n    backgroundColor: 'rgba(245, 158, 11, 0.1)',\n    textColor: colors.semantic.warning,\n  },\n  error: {\n    backgroundColor: 'rgba(220, 38, 38, 0.1)',\n    textColor: colors.semantic.error,\n  },\n  info: {\n    backgroundColor: 'rgba(59, 130, 246, 0.1)',\n    textColor: '#3B82F6',\n  },\n  outline: {\n    backgroundColor: 'transparent',\n    textColor: colors.text.secondary,\n    borderColor: colors.border.medium,\n  },\n};\n\nexport function Badge({\n  children,\n  variant = 'default',\n  size = 'md',\n  icon,\n  dot = false,\n  style,\n  textStyle,\n}: BadgeProps) {\n  const sizeConfig = SIZE_CONFIG[size];\n  const variantStyle = VARIANT_STYLES[variant];\n\n  if (dot) {\n    return (\n      <View\n        style={[\n          styles.dot,\n          {\n            width: sizeConfig.dotSize,\n            height: sizeConfig.dotSize,\n            borderRadius: sizeConfig.dotSize / 2,\n            backgroundColor: variantStyle.textColor,\n          },\n          style,\n        ]}\n      />\n    );\n  }\n\n  return (\n    <View\n      style={[\n        styles.container,\n        {\n          backgroundColor: variantStyle.backgroundColor,\n          paddingVertical: sizeConfig.paddingVertical,\n          paddingHorizontal: sizeConfig.paddingHorizontal,\n          borderWidth: variantStyle.borderColor ? 1 : 0,\n          borderColor: variantStyle.borderColor,\n        },\n        style,\n      ]}\n    >\n      {icon && (\n        <Feather\n          name={icon}\n          size={sizeConfig.iconSize}\n          color={variantStyle.textColor}\n          style={styles.icon}\n        />\n      )}\n      <Text\n        style={[\n          styles.text,\n          {\n            fontSize: sizeConfig.fontSize,\n            color: variantStyle.textColor,\n          },\n          textStyle,\n        ]}\n      >\n        {children}\n      </Text>\n    </View>\n  );\n}\n\n// Notification Badge (numeric)\nexport interface NotificationBadgeProps {\n  /** Count to display */\n  count: number;\n  /** Maximum count before showing + */\n  max?: number;\n  /** Size preset */\n  size?: 'sm' | 'md';\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function NotificationBadge({\n  count,\n  max = 99,\n  size = 'md',\n  style,\n}: NotificationBadgeProps) {\n  if (count <= 0) return null;\n\n  const displayCount = count > max ? `${max}+` : count.toString();\n  const isSmall = size === 'sm';\n  const minWidth = displayCount.length > 2 ? (isSmall ? 20 : 24) : isSmall ? 16 : 20;\n\n  return (\n    <View\n      style={[\n        styles.notificationBadge,\n        {\n          minWidth,\n          height: isSmall ? 16 : 20,\n          paddingHorizontal: isSmall ? 4 : 6,\n        },\n        style,\n      ]}\n    >\n      <Text\n        style={[\n          styles.notificationText,\n          { fontSize: isSmall ? 10 : 11 },\n        ]}\n      >\n        {displayCount}\n      </Text>\n    </View>\n  );\n}\n\n// Status Badge with dot\nexport interface StatusBadgeProps {\n  /** Status text */\n  label: string;\n  /** Status type */\n  status: 'success' | 'warning' | 'error' | 'info' | 'default';\n  /** Size preset */\n  size?: BadgeSize;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nconst STATUS_COLORS = {\n  success: colors.semantic.success,\n  warning: colors.semantic.warning,\n  error: colors.semantic.error,\n  info: '#3B82F6',\n  default: colors.text.tertiary,\n};\n\nexport function StatusBadge({\n  label,\n  status = 'default',\n  size = 'md',\n  style,\n}: StatusBadgeProps) {\n  const sizeConfig = SIZE_CONFIG[size];\n  const dotColor = STATUS_COLORS[status];\n\n  return (\n    <View\n      style={[\n        styles.statusContainer,\n        {\n          paddingVertical: sizeConfig.paddingVertical,\n          paddingHorizontal: sizeConfig.paddingHorizontal,\n        },\n        style,\n      ]}\n    >\n      <View\n        style={[\n          styles.statusDot,\n          {\n            width: sizeConfig.dotSize,\n            height: sizeConfig.dotSize,\n            borderRadius: sizeConfig.dotSize / 2,\n            backgroundColor: dotColor,\n          },\n        ]}\n      />\n      <Text\n        style={[\n          styles.statusText,\n          { fontSize: sizeConfig.fontSize },\n        ]}\n      >\n        {label}\n      </Text>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: layout.radiusFull,\n    alignSelf: 'flex-start',\n  },\n  text: {\n    fontWeight: '600',\n    textTransform: 'capitalize',\n  },\n  icon: {\n    marginRight: spacing.xs,\n  },\n  dot: {\n    // Dot badge\n  },\n\n  // Notification Badge\n  notificationBadge: {\n    backgroundColor: colors.semantic.error,\n    borderRadius: 10,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  notificationText: {\n    color: colors.text.inverse,\n    fontWeight: '700',\n  },\n\n  // Status Badge\n  statusContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: colors.background.secondary,\n    borderRadius: layout.radiusFull,\n    alignSelf: 'flex-start',\n  },\n  statusDot: {\n    marginRight: spacing.xs,\n  },\n  statusText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    fontWeight: '500',\n  },\n});\n\nexport default Badge;\n","path":null,"size_bytes":6995,"size_tokens":null},"client/screens/CreatePostScreen.tsx":{"content":"/**\n * CreatePost Screen\n * Create new posts with media, mentions, and hashtags\n */\n\nimport React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  ScrollView,\n  Image,\n  Alert,\n  ActivityIndicator,\n  KeyboardAvoidingView,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport * as ImagePicker from 'expo-image-picker';\nimport { Video, ResizeMode } from 'expo-av';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { postsApi, roomsApi, searchApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Room } from '@/types';\n\ntype CreatePostRouteParams = {\n  CreatePost: {\n    roomSlug?: string;\n  };\n};\n\ninterface MediaItem {\n  uri: string;\n  type: 'image' | 'video';\n  duration?: number;\n}\n\nconst MAX_MEDIA = 10;\nconst MAX_VIDEOS = 1; // Limit videos per post\nconst MAX_CONTENT_LENGTH = 5000;\n\nexport default function CreatePostScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<CreatePostRouteParams, 'CreatePost'>>();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  const inputRef = useRef<TextInput>(null);\n  const appColors = useAppColors();\n\n  const [content, setContent] = useState('');\n  const [selectedRoom, setSelectedRoom] = useState<Room | null>(null);\n  const [media, setMedia] = useState<MediaItem[]>([]);\n  const [isAnonymous, setIsAnonymous] = useState(false);\n  const [showRoomPicker, setShowRoomPicker] = useState(false);\n  const [mentionQuery, setMentionQuery] = useState<string | null>(null);\n  const [hashtagQuery, setHashtagQuery] = useState<string | null>(null);\n\n  // Legacy support\n  const images = media.filter(m => m.type === 'image').map(m => m.uri);\n  const videos = media.filter(m => m.type === 'video');\n  const setImages = (uris: string[]) => {\n    setMedia([...videos, ...uris.map(uri => ({ uri, type: 'image' as const }))]);\n  };\n\n  // Fetch rooms\n  const { data: roomsData } = useQuery({\n    queryKey: ['rooms'],\n    queryFn: async () => {\n      const response = await roomsApi.getRooms();\n      return response.data?.rooms || [];\n    },\n  });\n\n  // Autocomplete for mentions\n  const { data: mentionSuggestions } = useQuery({\n    queryKey: ['autocomplete', 'users', mentionQuery],\n    queryFn: async () => {\n      if (!mentionQuery) return [];\n      const response = await searchApi.autocomplete(mentionQuery, 'users');\n      return response.data?.suggestions || [];\n    },\n    enabled: !!mentionQuery && mentionQuery.length > 0,\n  });\n\n  // Autocomplete for hashtags\n  const { data: hashtagSuggestions } = useQuery({\n    queryKey: ['autocomplete', 'hashtags', hashtagQuery],\n    queryFn: async () => {\n      if (!hashtagQuery) return [];\n      const response = await searchApi.autocomplete(hashtagQuery, 'hashtags');\n      return response.data?.suggestions || [];\n    },\n    enabled: !!hashtagQuery && hashtagQuery.length > 0,\n  });\n\n  // Set initial room if provided\n  React.useEffect(() => {\n    if (route.params?.roomSlug && roomsData) {\n      const room = roomsData.find(r => r.slug === route.params.roomSlug);\n      if (room) setSelectedRoom(room);\n    }\n  }, [route.params?.roomSlug, roomsData]);\n\n  // Create post mutation\n  const createPostMutation = useMutation({\n    mutationFn: async () => {\n      if (!selectedRoom) throw new Error('Please select a room');\n      if (!content.trim()) throw new Error('Please add some content');\n\n      const imageUris = media.filter(m => m.type === 'image').map(m => m.uri);\n      const videoUri = media.find(m => m.type === 'video')?.uri;\n\n      const response = await postsApi.createPost({\n        content: content.trim(),\n        room_id: selectedRoom.id,\n        is_anonymous: isAnonymous,\n        images: imageUris.length > 0 ? imageUris : undefined,\n        video: videoUri,\n      });\n\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to create post');\n      }\n\n      return response.data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['feed'] });\n      navigation.goBack();\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  // Handle image picking\n  const handlePickImages = async () => {\n    if (media.length >= MAX_MEDIA) {\n      Alert.alert('Limit Reached', `You can only add up to ${MAX_MEDIA} media items`);\n      return;\n    }\n\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\n      allowsMultipleSelection: true,\n      quality: 0.8,\n      selectionLimit: MAX_MEDIA - media.length,\n    });\n\n    if (!result.canceled) {\n      const newMedia: MediaItem[] = result.assets.map(asset => ({\n        uri: asset.uri,\n        type: 'image',\n      }));\n      setMedia([...media, ...newMedia].slice(0, MAX_MEDIA));\n    }\n  };\n\n  // Handle video picking\n  const handlePickVideo = async () => {\n    if (videos.length >= MAX_VIDEOS) {\n      Alert.alert('Limit Reached', `You can only add ${MAX_VIDEOS} video per post`);\n      return;\n    }\n    if (media.length >= MAX_MEDIA) {\n      Alert.alert('Limit Reached', `You can only add up to ${MAX_MEDIA} media items`);\n      return;\n    }\n\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Videos,\n      allowsEditing: true,\n      quality: 0.8,\n      videoMaxDuration: 60, // 60 seconds max\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      const asset = result.assets[0];\n      const newVideo: MediaItem = {\n        uri: asset.uri,\n        type: 'video',\n        duration: asset.duration ?? undefined,\n      };\n      setMedia([...media, newVideo]);\n    }\n  };\n\n  // Handle camera capture\n  const handleCamera = async () => {\n    const { status } = await ImagePicker.requestCameraPermissionsAsync();\n    if (status !== 'granted') {\n      Alert.alert('Permission needed', 'Camera access is required to take photos');\n      return;\n    }\n\n    const result = await ImagePicker.launchCameraAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      quality: 0.8,\n      videoMaxDuration: 60,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      const asset = result.assets[0];\n      const newMedia: MediaItem = {\n        uri: asset.uri,\n        type: asset.type === 'video' ? 'video' : 'image',\n        duration: asset.duration ?? undefined,\n      };\n      \n      if (newMedia.type === 'video' && videos.length >= MAX_VIDEOS) {\n        Alert.alert('Limit Reached', `You can only add ${MAX_VIDEOS} video per post`);\n        return;\n      }\n      \n      setMedia([...media, newMedia].slice(0, MAX_MEDIA));\n    }\n  };\n\n  const handleRemoveMedia = (index: number) => {\n    setMedia(media.filter((_, i) => i !== index));\n  };\n\n  const handleRemoveImage = (index: number) => {\n    setImages(images.filter((_, i) => i !== index));\n  };\n\n  // Handle text change with autocomplete detection\n  const handleContentChange = (text: string) => {\n    setContent(text);\n\n    // Detect @mentions\n    const mentionMatch = text.match(/@(\\w*)$/);\n    if (mentionMatch) {\n      setMentionQuery(mentionMatch[1]);\n      setHashtagQuery(null);\n    } \n    // Detect #hashtags\n    else {\n      const hashtagMatch = text.match(/#(\\w*)$/);\n      if (hashtagMatch) {\n        setHashtagQuery(hashtagMatch[1]);\n        setMentionQuery(null);\n      } else {\n        setMentionQuery(null);\n        setHashtagQuery(null);\n      }\n    }\n  };\n\n  // Insert suggestion\n  const handleInsertSuggestion = (suggestion: string, type: 'mention' | 'hashtag') => {\n    const prefix = type === 'mention' ? '@' : '#';\n    const pattern = type === 'mention' ? /@\\w*$/ : /#\\w*$/;\n    \n    setContent(content.replace(pattern, `${prefix}${suggestion} `));\n    setMentionQuery(null);\n    setHashtagQuery(null);\n    inputRef.current?.focus();\n  };\n\n  const canPost = content.trim().length > 0 && selectedRoom !== null;\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        {/* Header */}\n        <View style={[styles.header, { borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.cancelButton} onPress={() => navigation.goBack()}>\n            <ThemedText style={[styles.cancelText, { color: appColors.textSecondary }]}>Cancel</ThemedText>\n          </TouchableOpacity>\n          <TouchableOpacity\n            style={[styles.postButton, !canPost && styles.postButtonDisabled]}\n            onPress={() => createPostMutation.mutate()}\n            disabled={!canPost || createPostMutation.isPending}\n          >\n            {createPostMutation.isPending ? (\n              <ActivityIndicator size=\"small\" color=\"white\" />\n            ) : (\n              <ThemedText style={styles.postButtonText}>Post</ThemedText>\n            )}\n          </TouchableOpacity>\n        </View>\n\n        <ScrollView style={styles.content} keyboardShouldPersistTaps=\"handled\">\n          {/* Room Selector */}\n          <TouchableOpacity\n            style={styles.roomSelector}\n            onPress={() => setShowRoomPicker(!showRoomPicker)}\n          >\n            {selectedRoom ? (\n              <>\n                <ThemedText style={styles.roomIcon}>{selectedRoom.icon}</ThemedText>\n                <ThemedText style={[styles.roomName, { color: selectedRoom.color }]}>\n                  {selectedRoom.name}\n                </ThemedText>\n              </>\n            ) : (\n              <ThemedText style={[styles.roomPlaceholder, { color: appColors.textSecondary }]}>Select a room</ThemedText>\n            )}\n            <Ionicons name=\"chevron-down\" size={20} color={appColors.textSecondary} />\n          </TouchableOpacity>\n\n          {/* Room Picker Dropdown */}\n          {showRoomPicker && (\n            <View style={[styles.roomPicker, { backgroundColor: appColors.surface }]}>\n              {roomsData?.map((room) => (\n                <TouchableOpacity\n                  key={room.id}\n                  style={[\n                    styles.roomOption,\n                    { borderBottomColor: appColors.border },\n                    selectedRoom?.id === room.id && styles.roomOptionSelected,\n                  ]}\n                  onPress={() => {\n                    setSelectedRoom(room);\n                    setShowRoomPicker(false);\n                  }}\n                >\n                  <ThemedText style={styles.roomIcon}>{room.icon}</ThemedText>\n                  <ThemedText style={[styles.roomOptionName, { color: appColors.textPrimary }]}>{room.name}</ThemedText>\n                </TouchableOpacity>\n              ))}\n            </View>\n          )}\n\n          {/* Author Info */}\n          <View style={styles.authorRow}>\n            {isAnonymous ? (\n              <View style={[styles.avatar, styles.anonymousAvatar]}>\n                <Ionicons name=\"person\" size={20} color={appColors.textSecondary} />\n              </View>\n            ) : user?.avatar_url ? (\n              <Image source={{ uri: user.avatar_url }} style={styles.avatar} />\n            ) : (\n              <View style={[styles.avatar, styles.avatarPlaceholder]}>\n                <ThemedText style={styles.avatarText}>\n                  {user?.first_name?.[0]}{user?.last_name?.[0]}\n                </ThemedText>\n              </View>\n            )}\n            <ThemedText style={[styles.authorName, { color: appColors.textPrimary }]}>\n              {isAnonymous ? 'Anonymous' : user?.full_name}\n            </ThemedText>\n          </View>\n\n          {/* Content Input */}\n          <TextInput\n            ref={inputRef}\n            style={[styles.input, { color: appColors.textPrimary }]}\n            placeholder=\"What's on your mind?\"\n            placeholderTextColor={appColors.textSecondary}\n            multiline\n            value={content}\n            onChangeText={handleContentChange}\n            maxLength={MAX_CONTENT_LENGTH}\n            autoFocus\n          />\n\n          {/* Character Count */}\n          <View style={styles.charCount}>\n            <ThemedText style={[\n              styles.charCountText,\n              { color: appColors.textSecondary },\n              content.length > MAX_CONTENT_LENGTH * 0.9 && { color: appColors.warning },\n            ]}>\n              {content.length}/{MAX_CONTENT_LENGTH}\n            </ThemedText>\n          </View>\n\n          {/* Autocomplete Suggestions */}\n          {(mentionQuery !== null && mentionSuggestions && mentionSuggestions.length > 0) && (\n            <View style={styles.suggestions}>\n              {mentionSuggestions.map((suggestion, index) => (\n                <TouchableOpacity\n                  key={index}\n                  style={[styles.suggestionItem, { borderBottomColor: appColors.border }]}\n                  onPress={() => handleInsertSuggestion(suggestion, 'mention')}\n                >\n                  <Ionicons name=\"at\" size={16} color={Colors.primary} />\n                  <ThemedText style={[styles.suggestionText, { color: appColors.textPrimary }]}>{suggestion}</ThemedText>\n                </TouchableOpacity>\n              ))}\n            </View>\n          )}\n\n          {(hashtagQuery !== null && hashtagSuggestions && hashtagSuggestions.length > 0) && (\n            <View style={styles.suggestions}>\n              {hashtagSuggestions.map((suggestion, index) => (\n                <TouchableOpacity\n                  key={index}\n                  style={[styles.suggestionItem, { borderBottomColor: appColors.border }]}\n                  onPress={() => handleInsertSuggestion(suggestion, 'hashtag')}\n                >\n                  <ThemedText style={styles.hashtagIcon}>#</ThemedText>\n                  <ThemedText style={[styles.suggestionText, { color: appColors.textPrimary }]}>{suggestion}</ThemedText>\n                </TouchableOpacity>\n              ))}\n            </View>\n          )}\n\n          {/* Media Preview (Images & Videos) */}\n          {media.length > 0 && (\n            <ScrollView horizontal style={styles.imagesContainer} showsHorizontalScrollIndicator={false}>\n              {media.map((item, index) => (\n                <View key={index} style={styles.imageWrapper}>\n                  {item.type === 'video' ? (\n                    <View style={styles.videoPreviewContainer}>\n                      <Video\n                        source={{ uri: item.uri }}\n                        style={styles.previewImage}\n                        resizeMode={ResizeMode.COVER}\n                        shouldPlay={false}\n                        isMuted\n                      />\n                      <View style={styles.videoOverlay}>\n                        <Ionicons name=\"play-circle\" size={32} color=\"white\" />\n                        {item.duration && (\n                          <ThemedText style={styles.videoDuration}>\n                            {Math.floor(item.duration / 1000)}s\n                          </ThemedText>\n                        )}\n                      </View>\n                    </View>\n                  ) : (\n                    <Image source={{ uri: item.uri }} style={styles.previewImage} />\n                  )}\n                  <TouchableOpacity\n                    style={styles.removeImageButton}\n                    onPress={() => handleRemoveMedia(index)}\n                  >\n                    <Ionicons name=\"close-circle\" size={24} color=\"white\" />\n                  </TouchableOpacity>\n                </View>\n              ))}\n            </ScrollView>\n          )}\n        </ScrollView>\n\n        {/* Bottom Toolbar */}\n        <View style={[styles.toolbar, { borderTopColor: appColors.border }]}>\n          <View style={styles.toolbarLeft}>\n            <TouchableOpacity style={styles.toolbarButton} onPress={handlePickImages}>\n              <Ionicons name=\"image-outline\" size={24} color={Colors.primary} />\n              {images.length > 0 && (\n                <View style={styles.imageBadge}>\n                  <ThemedText style={styles.imageBadgeText}>{images.length}</ThemedText>\n                </View>\n              )}\n            </TouchableOpacity>\n            <TouchableOpacity \n              style={[styles.toolbarButton, videos.length >= MAX_VIDEOS && styles.toolbarButtonDisabled]} \n              onPress={handlePickVideo}\n              disabled={videos.length >= MAX_VIDEOS}\n            >\n              <Ionicons \n                name=\"videocam-outline\" \n                size={24} \n                color={videos.length >= MAX_VIDEOS ? appColors.textSecondary : Colors.primary} \n              />\n              {videos.length > 0 && (\n                <View style={[styles.imageBadge, styles.videoBadge]}>\n                  <ThemedText style={styles.imageBadgeText}>{videos.length}</ThemedText>\n                </View>\n              )}\n            </TouchableOpacity>\n            <TouchableOpacity style={styles.toolbarButton} onPress={handleCamera}>\n              <Ionicons name=\"camera-outline\" size={24} color={Colors.primary} />\n            </TouchableOpacity>\n          </View>\n\n          <TouchableOpacity\n            style={[styles.anonymousToggle, isAnonymous && styles.anonymousToggleActive]}\n            onPress={() => setIsAnonymous(!isAnonymous)}\n          >\n            <Ionicons\n              name={isAnonymous ? 'eye-off' : 'eye-off-outline'}\n              size={18}\n              color={isAnonymous ? Colors.primary : appColors.textSecondary}\n            />\n            <ThemedText style={[\n              styles.anonymousText,\n              { color: appColors.textSecondary },\n              isAnonymous && styles.anonymousTextActive,\n            ]}>\n              Anonymous\n            </ThemedText>\n          </TouchableOpacity>\n        </View>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  cancelButton: {\n    padding: Spacing.sm,\n  },\n  cancelText: {\n    ...Typography.body,\n  },\n  postButton: {\n    backgroundColor: Colors.primary,\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  postButtonDisabled: {\n    opacity: 0.5,\n  },\n  postButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  content: {\n    flex: 1,\n    padding: Spacing.lg,\n  },\n  roomSelector: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.md,\n    gap: Spacing.sm,\n  },\n  roomIcon: {\n    fontSize: 16,\n  },\n  roomName: {\n    ...Typography.body,\n    fontWeight: '500',\n    flex: 1,\n  },\n  roomPlaceholder: {\n    ...Typography.body,\n    flex: 1,\n  },\n  roomPicker: {\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.md,\n    ...Shadows.card,\n  },\n  roomOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  roomOptionSelected: {\n    backgroundColor: Colors.primary + '10',\n  },\n  roomOptionName: {\n    ...Typography.body,\n  },\n  authorRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n    gap: Spacing.md,\n  },\n  avatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  anonymousAvatar: {\n    backgroundColor: Colors.light.backgroundTertiary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  authorName: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  input: {\n    ...Typography.body,\n    minHeight: 120,\n    textAlignVertical: 'top',\n  },\n  charCount: {\n    alignItems: 'flex-end',\n    marginTop: Spacing.sm,\n  },\n  charCountText: {\n    ...Typography.small,\n  },\n  suggestions: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.sm,\n    marginTop: Spacing.sm,\n  },\n  suggestionItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  hashtagIcon: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  suggestionText: {\n    ...Typography.body,\n  },\n  imagesContainer: {\n    marginTop: Spacing.md,\n  },\n  imageWrapper: {\n    marginRight: Spacing.sm,\n    position: 'relative',\n  },\n  previewImage: {\n    width: 100,\n    height: 100,\n    borderRadius: BorderRadius.sm,\n  },\n  videoPreviewContainer: {\n    width: 100,\n    height: 100,\n    borderRadius: BorderRadius.sm,\n    overflow: 'hidden',\n  },\n  videoOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(0,0,0,0.3)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  videoDuration: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n    marginTop: Spacing.xs,\n  },\n  removeImageButton: {\n    position: 'absolute',\n    top: -8,\n    right: -8,\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    borderRadius: 12,\n  },\n  toolbar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderTopWidth: 1,\n  },\n  toolbarLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.md,\n  },\n  toolbarButton: {\n    padding: Spacing.sm,\n    position: 'relative',\n  },\n  toolbarButtonDisabled: {\n    opacity: 0.5,\n  },\n  imageBadge: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    backgroundColor: Colors.primary,\n    borderRadius: 10,\n    minWidth: 18,\n    height: 18,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  videoBadge: {\n    backgroundColor: Colors.secondary,\n  },\n  imageBadgeText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n    fontSize: 10,\n  },\n  anonymousToggle: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n    gap: Spacing.xs,\n  },\n  anonymousToggleActive: {\n    backgroundColor: Colors.primary + '15',\n  },\n  anonymousText: {\n    ...Typography.small,\n  },\n  anonymousTextActive: {\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n});\n","path":null,"size_bytes":23180,"size_tokens":null},"client/navigation/RootNavigator.tsx":{"content":"/**\n * Navigation Configuration\n * Main app navigation with auth flow\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { NavigationContainer, DefaultTheme, DarkTheme } from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport { Ionicons } from '@expo/vector-icons';\nimport { View, ActivityIndicator, Platform } from 'react-native';\n\nimport { Colors, Spacing } from '@/constants/theme';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { linkingConfig } from '@/lib/deep-linking';\n\n// Auth Screens\nimport LoginScreen from '@/screens/LoginScreenNew';\nimport RegisterScreen from '@/screens/RegisterScreen';\nimport ForgotPasswordScreen from '@/screens/ForgotPasswordScreen';\nimport VerifyEmailScreen from '@/screens/VerifyEmailScreen';\nimport OnboardingScreen, { hasCompletedOnboarding } from '@/screens/OnboardingScreen';\n\n// Main Screens\nimport HomeScreen from '@/screens/HomeScreen';\nimport RoomsScreen from '@/screens/RoomsScreen';\nimport MessagesScreen from '@/screens/MessagesScreen';\nimport ProfileScreen from '@/screens/ProfileScreen';\nimport DealsScreen from '@/screens/DealsScreen';\n\n// Stack Screens\nimport CreatePostScreen from '@/screens/CreatePostScreen';\nimport PostDetailScreen from '@/screens/PostDetailScreen';\nimport ConversationScreen from '@/screens/ConversationScreen';\nimport NewConversationScreen from '@/screens/NewConversationScreen';\nimport NotificationsScreen from '@/screens/NotificationsScreen';\nimport SearchScreen from '@/screens/SearchScreen';\nimport EditProfileScreen from '@/screens/EditProfileScreen';\nimport UserProfileScreen from '@/screens/UserProfileScreen';\nimport RoomDetailScreen from '@/screens/RoomDetailScreen';\nimport HashtagScreen from '@/screens/HashtagScreen';\nimport FollowersScreen from '@/screens/FollowersScreen';\nimport BookmarksScreen from '@/screens/BookmarksScreen';\nimport LeaderboardScreen from '@/screens/LeaderboardScreen';\nimport AchievementsScreen from '@/screens/AchievementsScreen';\nimport SettingsScreen from '@/screens/SettingsScreen';\nimport PremiumScreen from '@/screens/PremiumScreen';\nimport AMADetailScreen from '@/screens/AMADetailScreen';\nimport CourseDetailScreen from '@/screens/CourseDetailScreen';\nimport EventDetailScreen from '@/screens/EventDetailScreen';\nimport DealDetailScreen from '@/screens/DealDetailScreen';\nimport AIChatScreen from '@/screens/AIChatScreen';\nimport LessonPlayerScreen from '@/screens/LessonPlayerScreen';\nimport ChangePasswordScreen from '@/screens/ChangePasswordScreen';\nimport BlockedUsersScreen from '@/screens/BlockedUsersScreen';\nimport DeleteAccountScreen from '@/screens/DeleteAccountScreen';\nimport BiometricSettingsScreen from '@/screens/BiometricSettingsScreen';\nimport PrivacyPolicyScreen from '@/screens/PrivacyPolicyScreen';\nimport TermsOfServiceScreen from '@/screens/TermsOfServiceScreen';\nimport AppearanceSettingsScreen from '@/screens/AppearanceSettingsScreen';\nimport EditPostScreen from '@/screens/EditPostScreen';\nimport DraftsScreen from '@/screens/DraftsScreen';\nimport NotificationSettingsScreen from '@/screens/NotificationSettingsScreen';\nimport ContentPreferencesScreen from '@/screens/ContentPreferencesScreen';\nimport ReportScreen from '@/screens/ReportScreen';\nimport SavedSearchesScreen from '@/screens/SavedSearchesScreen';\nimport DataExportScreen from '@/screens/DataExportScreen';\nimport VoiceCallScreen from '@/screens/VoiceCallScreen';\n\n// Types\nimport { RootStackParamList, MainTabParamList, AuthStackParamList } from '@/types';\n\nconst Stack = createNativeStackNavigator<RootStackParamList>();\nconst Tab = createBottomTabNavigator<MainTabParamList>();\nconst AuthStack = createNativeStackNavigator<AuthStackParamList>();\n\n// Auth Navigator\nfunction AuthNavigator() {\n  return (\n    <AuthStack.Navigator\n      screenOptions={{\n        headerShown: false,\n        animation: 'slide_from_right',\n      }}\n    >\n      <AuthStack.Screen name=\"Login\" component={LoginScreen} />\n      <AuthStack.Screen name=\"Register\" component={RegisterScreen} />\n      <AuthStack.Screen name=\"ForgotPassword\" component={ForgotPasswordScreen} />\n      <AuthStack.Screen name=\"VerifyEmail\" component={VerifyEmailScreen} />\n    </AuthStack.Navigator>\n  );\n}\n\n// Tab Navigator\nfunction MainTabNavigator() {\n  const appColors = useAppColors();\n  return (\n    <Tab.Navigator\n      screenOptions={({ route }) => ({\n        headerShown: false,\n        tabBarActiveTintColor: Colors.primary,\n        tabBarInactiveTintColor: appColors.textSecondary,\n        tabBarStyle: {\n          backgroundColor: appColors.surface,\n          borderTopColor: appColors.border,\n          paddingBottom: Platform.OS === 'ios' ? Spacing.lg : Spacing.sm,\n          paddingTop: Spacing.sm,\n          height: Platform.OS === 'ios' ? 84 : 64,\n        },\n        tabBarLabelStyle: {\n          fontSize: 11,\n          fontWeight: '500',\n        },\n        tabBarIcon: ({ focused, color }) => {\n          let iconName: keyof typeof Ionicons.glyphMap = 'home';\n\n          switch (route.name) {\n            case 'Home':\n              iconName = focused ? 'home' : 'home-outline';\n              break;\n            case 'Rooms':\n              iconName = focused ? 'people' : 'people-outline';\n              break;\n            case 'Discover':\n              iconName = focused ? 'compass' : 'compass-outline';\n              break;\n            case 'Messages':\n              iconName = focused ? 'chatbubbles' : 'chatbubbles-outline';\n              break;\n            case 'Profile':\n              iconName = focused ? 'person' : 'person-outline';\n              break;\n          }\n\n          return <Ionicons name={iconName} size={24} color={color} />;\n        },\n      })}\n    >\n      <Tab.Screen \n        name=\"Home\" \n        component={HomeScreen}\n        options={{ tabBarLabel: 'Feed' }}\n      />\n      <Tab.Screen \n        name=\"Rooms\" \n        component={RoomsScreen}\n        options={{ tabBarLabel: 'Rooms' }}\n      />\n      <Tab.Screen \n        name=\"Discover\" \n        component={DealsScreen}\n        options={{ tabBarLabel: 'Deals' }}\n      />\n      <Tab.Screen \n        name=\"Messages\" \n        component={MessagesScreen}\n        options={{ tabBarLabel: 'Messages' }}\n      />\n      <Tab.Screen \n        name=\"Profile\" \n        component={ProfileScreen}\n        options={{ tabBarLabel: 'Profile' }}\n      />\n    </Tab.Navigator>\n  );\n}\n\n// Root Navigator\nexport default function RootNavigator() {\n  const { isAuthenticated, isLoading } = useAuth();\n  const appColors = useAppColors();\n  const [hasOnboarded, setHasOnboarded] = useState<boolean | null>(null);\n\n  const navigationTheme = appColors.isDark ? {\n    ...DarkTheme,\n    colors: {\n      ...DarkTheme.colors,\n      primary: Colors.primary,\n      background: appColors.background,\n      card: appColors.surface,\n      text: appColors.textPrimary,\n      border: appColors.border,\n    },\n  } : {\n    ...DefaultTheme,\n    colors: {\n      ...DefaultTheme.colors,\n      primary: Colors.primary,\n      background: appColors.background,\n      card: appColors.surface,\n      text: appColors.textPrimary,\n      border: appColors.border,\n    },\n  };\n\n  // Check onboarding status on mount\n  useEffect(() => {\n    checkOnboarding();\n  }, []);\n\n  const checkOnboarding = async () => {\n    const completed = await hasCompletedOnboarding();\n    setHasOnboarded(completed);\n  };\n\n  if (isLoading || hasOnboarded === null) {\n    return (\n      <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center', backgroundColor: appColors.surface }}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </View>\n    );\n  }\n\n  return (\n    <NavigationContainer linking={linkingConfig} theme={navigationTheme}>\n      <Stack.Navigator\n        screenOptions={{\n          headerShown: false,\n          animation: 'slide_from_right',\n        }}\n      >\n        {/* Onboarding for first-time users */}\n        {!hasOnboarded && !isAuthenticated && (\n          <Stack.Screen name=\"Onboarding\" component={OnboardingScreen} />\n        )}\n        \n        {!isAuthenticated ? (\n          <Stack.Screen name=\"Auth\" component={AuthNavigator} />\n        ) : (\n          <>\n            <Stack.Screen name=\"Main\" component={MainTabNavigator} />\n            \n            {/* Modal Screens */}\n            <Stack.Screen\n              name=\"CreatePost\"\n              component={CreatePostScreen}\n              options={{\n                presentation: 'modal',\n                animation: 'slide_from_bottom',\n              }}\n            />\n            \n            {/* Push Screens */}\n            <Stack.Screen name=\"PostDetail\" component={PostDetailScreen} />\n            <Stack.Screen name=\"UserProfile\" component={UserProfileScreen} />\n            <Stack.Screen name=\"EditProfile\" component={EditProfileScreen} />\n            <Stack.Screen name=\"RoomDetail\" component={RoomDetailScreen} />\n            <Stack.Screen \n              name=\"Conversation\" \n              component={ConversationScreen}\n              options={{ headerShown: false }}\n            />\n            <Stack.Screen name=\"NewConversation\" component={NewConversationScreen} />\n            <Stack.Screen \n              name=\"VoiceCall\" \n              component={VoiceCallScreen}\n              options={{\n                presentation: 'fullScreenModal',\n                animation: 'slide_from_bottom',\n                headerShown: false,\n              }}\n            />\n            <Stack.Screen name=\"Notifications\" component={NotificationsScreen} />\n            <Stack.Screen name=\"Search\" component={SearchScreen} />\n            <Stack.Screen name=\"Hashtag\" component={HashtagScreen} />\n            <Stack.Screen name=\"Followers\" component={FollowersScreen} />\n            <Stack.Screen name=\"Bookmarks\" component={BookmarksScreen} />\n            <Stack.Screen name=\"Leaderboard\" component={LeaderboardScreen} />\n            <Stack.Screen name=\"Achievements\" component={AchievementsScreen} />\n            <Stack.Screen name=\"Settings\" component={SettingsScreen} />\n            <Stack.Screen \n              name=\"Premium\" \n              component={PremiumScreen}\n              options={{\n                presentation: 'modal',\n                animation: 'slide_from_bottom',\n              }}\n            />\n            \n            {/* Account Management */}\n            <Stack.Screen name=\"ChangePassword\" component={ChangePasswordScreen} />\n            <Stack.Screen name=\"BlockedUsers\" component={BlockedUsersScreen} />\n            <Stack.Screen name=\"DeleteAccount\" component={DeleteAccountScreen} />\n            <Stack.Screen name=\"BiometricSettings\" component={BiometricSettingsScreen} />\n            <Stack.Screen name=\"PrivacyPolicy\" component={PrivacyPolicyScreen} />\n            <Stack.Screen name=\"TermsOfService\" component={TermsOfServiceScreen} />\n            \n            {/* Content Detail Screens */}\n            <Stack.Screen name=\"AMADetail\" component={AMADetailScreen} />\n            <Stack.Screen name=\"CourseDetail\" component={CourseDetailScreen} />\n            <Stack.Screen name=\"EventDetail\" component={EventDetailScreen} />\n            <Stack.Screen name=\"DealDetail\" component={DealDetailScreen} />\n            <Stack.Screen \n              name=\"LessonPlayer\" \n              component={LessonPlayerScreen}\n              options={{\n                animation: 'slide_from_right',\n              }}\n            />\n            \n            {/* AI Chat */}\n            <Stack.Screen \n              name=\"AIChat\" \n              component={AIChatScreen}\n              options={{\n                presentation: 'modal',\n                animation: 'slide_from_bottom',\n              }}\n            />\n            \n            {/* Additional Settings Screens */}\n            <Stack.Screen name=\"AppearanceSettings\" component={AppearanceSettingsScreen} />\n            <Stack.Screen name=\"NotificationSettings\" component={NotificationSettingsScreen} />\n            <Stack.Screen name=\"ContentPreferences\" component={ContentPreferencesScreen} />\n            <Stack.Screen name=\"DataExport\" component={DataExportScreen} />\n            <Stack.Screen name=\"SavedSearches\" component={SavedSearchesScreen} />\n            \n            {/* Post Management */}\n            <Stack.Screen name=\"EditPost\" component={EditPostScreen} />\n            <Stack.Screen name=\"Drafts\" component={DraftsScreen} />\n            <Stack.Screen \n              name=\"Report\" \n              component={ReportScreen}\n              options={{\n                presentation: 'modal',\n                animation: 'slide_from_bottom',\n              }}\n            />\n          </>\n        )}\n      </Stack.Navigator>\n    </NavigationContainer>\n  );\n}\n","path":null,"size_bytes":12842,"size_tokens":null},"client/lib/offline-persistence.ts":{"content":"/**\n * Offline Persistence\n * React Query persistence with AsyncStorage\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { QueryClient } from '@tanstack/react-query';\nimport {\n  persistQueryClient,\n  PersistQueryClientProvider,\n  PersistedClient,\n  Persister,\n} from '@tanstack/react-query-persist-client';\nimport NetInfo, { NetInfoState } from '@react-native-community/netinfo';\n\n// Storage key for persisted cache\nconst CACHE_KEY = 'MEDINVEST_QUERY_CACHE';\nconst CACHE_VERSION = 1;\n\n/**\n * Create AsyncStorage persister for React Query\n */\nexport function createAsyncStoragePersister(): Persister {\n  return {\n    persistClient: async (client: PersistedClient) => {\n      try {\n        const data = JSON.stringify({\n          version: CACHE_VERSION,\n          timestamp: Date.now(),\n          client,\n        });\n        await AsyncStorage.setItem(CACHE_KEY, data);\n      } catch (error) {\n        console.error('[Persistence] Failed to persist cache:', error);\n      }\n    },\n    \n    restoreClient: async () => {\n      try {\n        const data = await AsyncStorage.getItem(CACHE_KEY);\n        if (!data) return undefined;\n\n        const parsed = JSON.parse(data);\n        \n        // Check version compatibility\n        if (parsed.version !== CACHE_VERSION) {\n          await AsyncStorage.removeItem(CACHE_KEY);\n          return undefined;\n        }\n\n        // Check if cache is too old (7 days)\n        const maxAge = 7 * 24 * 60 * 60 * 1000;\n        if (Date.now() - parsed.timestamp > maxAge) {\n          await AsyncStorage.removeItem(CACHE_KEY);\n          return undefined;\n        }\n\n        return parsed.client;\n      } catch (error) {\n        console.error('[Persistence] Failed to restore cache:', error);\n        return undefined;\n      }\n    },\n    \n    removeClient: async () => {\n      try {\n        await AsyncStorage.removeItem(CACHE_KEY);\n      } catch (error) {\n        console.error('[Persistence] Failed to remove cache:', error);\n      }\n    },\n  };\n}\n\n/**\n * Configure query client with offline support\n */\nexport function createOfflineQueryClient(): QueryClient {\n  return new QueryClient({\n    defaultOptions: {\n      queries: {\n        // Keep data fresh for 5 minutes\n        staleTime: 5 * 60 * 1000,\n        \n        // Cache data for 24 hours\n        gcTime: 24 * 60 * 60 * 1000,\n        \n        // Retry configuration\n        retry: (failureCount, error: any) => {\n          // Don't retry on 4xx errors\n          if (error?.status >= 400 && error?.status < 500) {\n            return false;\n          }\n          return failureCount < 3;\n        },\n        \n        // Network mode\n        networkMode: 'offlineFirst',\n        \n        // Refetch on reconnect\n        refetchOnReconnect: true,\n      },\n      mutations: {\n        // Retry mutations on network errors\n        retry: (failureCount, error: any) => {\n          if (error?.status >= 400 && error?.status < 500) {\n            return false;\n          }\n          return failureCount < 2;\n        },\n        \n        networkMode: 'offlineFirst',\n      },\n    },\n  });\n}\n\n/**\n * Setup persistence for query client\n */\nexport async function setupQueryPersistence(queryClient: QueryClient): Promise<void> {\n  const persister = createAsyncStoragePersister();\n\n  await persistQueryClient({\n    queryClient,\n    persister,\n    maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n    buster: CACHE_VERSION.toString(),\n    dehydrateOptions: {\n      shouldDehydrateQuery: (query) => {\n        // Only persist successful queries\n        if (query.state.status !== 'success') return false;\n        \n        // Don't persist sensitive data\n        const key = query.queryKey[0] as string;\n        const sensitiveKeys = ['auth', 'session', 'token'];\n        if (sensitiveKeys.includes(key)) return false;\n        \n        return true;\n      },\n    },\n  });\n}\n\n/**\n * Network connectivity manager\n */\nclass NetworkManager {\n  private isConnected: boolean = true;\n  private listeners: Set<(isConnected: boolean) => void> = new Set();\n  private unsubscribe: (() => void) | null = null;\n\n  /**\n   * Start monitoring network connectivity\n   */\n  startMonitoring(): void {\n    this.unsubscribe = NetInfo.addEventListener(this.handleConnectivityChange);\n    \n    // Check initial state\n    NetInfo.fetch().then(this.handleConnectivityChange);\n  }\n\n  /**\n   * Stop monitoring\n   */\n  stopMonitoring(): void {\n    this.unsubscribe?.();\n    this.unsubscribe = null;\n  }\n\n  /**\n   * Handle connectivity changes\n   */\n  private handleConnectivityChange = (state: NetInfoState): void => {\n    const wasConnected = this.isConnected;\n    this.isConnected = state.isConnected ?? false;\n\n    if (wasConnected !== this.isConnected) {\n      console.log('[Network]', this.isConnected ? 'Connected' : 'Disconnected');\n      this.notifyListeners();\n    }\n  };\n\n  /**\n   * Notify all listeners\n   */\n  private notifyListeners(): void {\n    this.listeners.forEach((listener) => {\n      listener(this.isConnected);\n    });\n  }\n\n  /**\n   * Subscribe to connectivity changes\n   */\n  subscribe(listener: (isConnected: boolean) => void): () => void {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  /**\n   * Check if currently connected\n   */\n  getIsConnected(): boolean {\n    return this.isConnected;\n  }\n\n  /**\n   * Wait for connection\n   */\n  async waitForConnection(timeoutMs: number = 30000): Promise<boolean> {\n    if (this.isConnected) return true;\n\n    return new Promise((resolve) => {\n      const timeout = setTimeout(() => {\n        unsubscribe();\n        resolve(false);\n      }, timeoutMs);\n\n      const unsubscribe = this.subscribe((connected) => {\n        if (connected) {\n          clearTimeout(timeout);\n          unsubscribe();\n          resolve(true);\n        }\n      });\n    });\n  }\n}\n\nexport const networkManager = new NetworkManager();\n\n/**\n * Offline mutation queue for background sync\n */\ninterface QueuedMutation {\n  id: string;\n  mutationKey: string;\n  variables: unknown;\n  timestamp: number;\n  retries: number;\n}\n\nclass OfflineMutationQueue {\n  private queue: QueuedMutation[] = [];\n  private storageKey = 'MEDINVEST_MUTATION_QUEUE';\n  private isProcessing = false;\n\n  /**\n   * Load queue from storage\n   */\n  async load(): Promise<void> {\n    try {\n      const data = await AsyncStorage.getItem(this.storageKey);\n      if (data) {\n        this.queue = JSON.parse(data);\n      }\n    } catch (error) {\n      console.error('[MutationQueue] Failed to load:', error);\n    }\n  }\n\n  /**\n   * Save queue to storage\n   */\n  private async save(): Promise<void> {\n    try {\n      await AsyncStorage.setItem(this.storageKey, JSON.stringify(this.queue));\n    } catch (error) {\n      console.error('[MutationQueue] Failed to save:', error);\n    }\n  }\n\n  /**\n   * Add mutation to queue\n   */\n  async add(mutationKey: string, variables: unknown): Promise<string> {\n    const mutation: QueuedMutation = {\n      id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      mutationKey,\n      variables,\n      timestamp: Date.now(),\n      retries: 0,\n    };\n\n    this.queue.push(mutation);\n    await this.save();\n\n    return mutation.id;\n  }\n\n  /**\n   * Remove mutation from queue\n   */\n  async remove(id: string): Promise<void> {\n    this.queue = this.queue.filter((m) => m.id !== id);\n    await this.save();\n  }\n\n  /**\n   * Process queued mutations\n   */\n  async process(\n    executor: (mutationKey: string, variables: unknown) => Promise<void>\n  ): Promise<void> {\n    if (this.isProcessing || this.queue.length === 0) return;\n    if (!networkManager.getIsConnected()) return;\n\n    this.isProcessing = true;\n\n    const pending = [...this.queue];\n\n    for (const mutation of pending) {\n      try {\n        await executor(mutation.mutationKey, mutation.variables);\n        await this.remove(mutation.id);\n      } catch (error) {\n        mutation.retries += 1;\n        \n        // Remove after 3 retries\n        if (mutation.retries >= 3) {\n          await this.remove(mutation.id);\n          console.error('[MutationQueue] Mutation failed after 3 retries:', mutation);\n        }\n      }\n    }\n\n    await this.save();\n    this.isProcessing = false;\n  }\n\n  /**\n   * Get queue length\n   */\n  getLength(): number {\n    return this.queue.length;\n  }\n\n  /**\n   * Clear queue\n   */\n  async clear(): Promise<void> {\n    this.queue = [];\n    await this.save();\n  }\n}\n\nexport const offlineMutationQueue = new OfflineMutationQueue();\n\n// Export provider components\nexport { PersistQueryClientProvider };\n","path":null,"size_bytes":8532,"size_tokens":null},"client/screens/settings/NotificationsSettingsScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  Switch,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport Animated, { FadeInDown } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport { useNotificationPreferences } from '@/services/notifications';\n\ninterface NotificationSetting {\n  key: string;\n  title: string;\n  description: string;\n  icon: keyof typeof Feather.glyphMap;\n}\n\nconst NOTIFICATION_SETTINGS: NotificationSetting[] = [\n  {\n    key: 'investmentUpdates',\n    title: 'Investment Updates',\n    description: 'Get notified about updates to your investments',\n    icon: 'trending-up',\n  },\n  {\n    key: 'newOpportunities',\n    title: 'New Opportunities',\n    description: 'Be the first to know about new investment opportunities',\n    icon: 'compass',\n  },\n  {\n    key: 'portfolioMilestones',\n    title: 'Portfolio Milestones',\n    description: 'Celebrate when your portfolio hits new milestones',\n    icon: 'award',\n  },\n  {\n    key: 'articles',\n    title: 'Research & Articles',\n    description: 'Stay informed with the latest healthcare insights',\n    icon: 'book-open',\n  },\n  {\n    key: 'marketing',\n    title: 'Marketing & Promotions',\n    description: 'Receive special offers and promotional content',\n    icon: 'gift',\n  },\n];\n\nexport default function NotificationsSettingsScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n  const { getPreferences, updatePreferences } = useNotificationPreferences();\n\n  const [preferences, setPreferences] = useState<Record<string, boolean>>({\n    investmentUpdates: true,\n    newOpportunities: true,\n    portfolioMilestones: true,\n    articles: false,\n    marketing: false,\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n\n  // Load preferences on mount\n  useEffect(() => {\n    const loadPreferences = async () => {\n      try {\n        const data = await getPreferences();\n        if (data) {\n          setPreferences(data);\n        }\n      } catch (error) {\n        console.error('Failed to load preferences:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadPreferences();\n  }, [getPreferences]);\n\n  const handleToggle = useCallback(\n    async (key: string, value: boolean) => {\n      // Optimistic update\n      setPreferences((prev) => ({ ...prev, [key]: value }));\n\n      try {\n        setIsSaving(true);\n        await updatePreferences({ [key]: value });\n      } catch (error) {\n        // Revert on error\n        setPreferences((prev) => ({ ...prev, [key]: !value }));\n        Alert.alert('Error', 'Failed to update notification settings.');\n      } finally {\n        setIsSaving(false);\n      }\n    },\n    [updatePreferences]\n  );\n\n  const handleEnableAll = useCallback(async () => {\n    const allEnabled = Object.fromEntries(\n      NOTIFICATION_SETTINGS.map((s) => [s.key, true])\n    );\n    setPreferences(allEnabled);\n\n    try {\n      setIsSaving(true);\n      await updatePreferences(allEnabled);\n    } catch (error) {\n      Alert.alert('Error', 'Failed to update notification settings.');\n    } finally {\n      setIsSaving(false);\n    }\n  }, [updatePreferences]);\n\n  const handleDisableAll = useCallback(async () => {\n    Alert.alert(\n      'Disable All Notifications',\n      'Are you sure you want to disable all notifications? You may miss important updates about your investments.',\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Disable All',\n          style: 'destructive',\n          onPress: async () => {\n            const allDisabled = Object.fromEntries(\n              NOTIFICATION_SETTINGS.map((s) => [s.key, false])\n            );\n            setPreferences(allDisabled);\n\n            try {\n              setIsSaving(true);\n              await updatePreferences(allDisabled);\n            } catch (error) {\n              Alert.alert('Error', 'Failed to update notification settings.');\n            } finally {\n              setIsSaving(false);\n            }\n          },\n        },\n      ]\n    );\n  }, [updatePreferences]);\n\n  if (isLoading) {\n    return (\n      <View style={[styles.container, styles.loadingContainer]}>\n        <ActivityIndicator size=\"large\" color={colors.primary.main} />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Notifications</Text>\n        <View style={styles.placeholder}>\n          {isSaving && (\n            <ActivityIndicator size=\"small\" color={colors.primary.main} />\n          )}\n        </View>\n      </View>\n\n      <ScrollView\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingBottom: insets.bottom + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Quick Actions */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(100)}\n          style={styles.quickActions}\n        >\n          <Pressable style={styles.quickAction} onPress={handleEnableAll}>\n            <Feather name=\"bell\" size={16} color={colors.primary.main} />\n            <Text style={styles.quickActionText}>Enable All</Text>\n          </Pressable>\n          <Pressable style={styles.quickAction} onPress={handleDisableAll}>\n            <Feather name=\"bell-off\" size={16} color={colors.text.secondary} />\n            <Text style={[styles.quickActionText, styles.quickActionTextMuted]}>\n              Disable All\n            </Text>\n          </Pressable>\n        </Animated.View>\n\n        {/* Notification Settings */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(200)}\n          style={styles.settingsContainer}\n        >\n          {NOTIFICATION_SETTINGS.map((setting, index) => (\n            <View\n              key={setting.key}\n              style={[\n                styles.settingItem,\n                index < NOTIFICATION_SETTINGS.length - 1 && styles.settingItemBorder,\n              ]}\n            >\n              <View style={styles.settingIcon}>\n                <Feather\n                  name={setting.icon}\n                  size={20}\n                  color={preferences[setting.key] ? colors.primary.main : colors.text.tertiary}\n                />\n              </View>\n              <View style={styles.settingContent}>\n                <Text style={styles.settingTitle}>{setting.title}</Text>\n                <Text style={styles.settingDescription}>{setting.description}</Text>\n              </View>\n              <Switch\n                value={preferences[setting.key]}\n                onValueChange={(value) => handleToggle(setting.key, value)}\n                trackColor={{\n                  false: colors.border.medium,\n                  true: colors.primary.light,\n                }}\n                thumbColor={\n                  preferences[setting.key] ? colors.primary.main : colors.surface.primary\n                }\n              />\n            </View>\n          ))}\n        </Animated.View>\n\n        {/* Info Card */}\n        <Animated.View\n          entering={FadeInDown.duration(400).delay(300)}\n          style={styles.infoCard}\n        >\n          <Feather name=\"info\" size={20} color={colors.primary.main} />\n          <Text style={styles.infoText}>\n            You can also manage notifications from your device's Settings app under\n            MedInvest notifications.\n          </Text>\n        </Animated.View>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  loadingContainer: {\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n    alignItems: 'flex-end',\n  },\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    padding: spacing.lg,\n  },\n\n  // Quick Actions\n  quickActions: {\n    flexDirection: 'row',\n    gap: spacing.md,\n    marginBottom: spacing.xl,\n  },\n  quickAction: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.sm,\n    paddingVertical: spacing.md,\n    borderRadius: layout.radiusMedium,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    backgroundColor: colors.surface.primary,\n  },\n  quickActionText: {\n    ...typography.captionMedium,\n    color: colors.primary.main,\n  },\n  quickActionTextMuted: {\n    color: colors.text.secondary,\n  },\n\n  // Settings\n  settingsContainer: {\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusLarge,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    overflow: 'hidden',\n  },\n  settingItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: spacing.lg,\n  },\n  settingItemBorder: {\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  settingIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  settingContent: {\n    flex: 1,\n    marginRight: spacing.md,\n  },\n  settingTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  settingDescription: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    lineHeight: 18,\n  },\n\n  // Info Card\n  infoCard: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    gap: spacing.md,\n    backgroundColor: colors.transparent.primary10,\n    padding: spacing.lg,\n    borderRadius: layout.radiusMedium,\n    marginTop: spacing.xl,\n  },\n  infoText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    flex: 1,\n    lineHeight: 20,\n  },\n});\n","path":null,"size_bytes":10606,"size_tokens":null},"scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction stripProtocol(domain) {\n  let urlString = domain.trim();\n\n  if (!/^https?:\\/\\//i.test(urlString)) {\n    urlString = `https://${urlString}`;\n  }\n\n  return new URL(urlString).host;\n}\n\nfunction getDeploymentDomain() {\n  // Check Replit deployment environment variables first\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_INTERNAL_APP_DOMAIN);\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_DEV_DOMAIN);\n  }\n\n  if (process.env.EXPO_PUBLIC_DOMAIN) {\n    return stripProtocol(process.env.EXPO_PUBLIC_DOMAIN);\n  }\n\n  console.error(\n    \"ERROR: No deployment domain found. Set REPLIT_INTERNAL_APP_DOMAIN, REPLIT_DEV_DOMAIN, or EXPO_PUBLIC_DOMAIN\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\", {\n      signal: AbortSignal.timeout(5000),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro(expoPublicDomain) {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    console.log(\"Metro already running\");\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  console.log(`Setting EXPO_PUBLIC_DOMAIN=${expoPublicDomain}`);\n  const env = {\n    ...process.env,\n    EXPO_PUBLIC_DOMAIN: expoPublicDomain,\n  };\n  metroProcess = spawn(\"npm\", [\"run\", \"expo:start:static:build\"], {\n    stdio: [\"ignore\", \"pipe\", \"pipe\"],\n    detached: false,\n    env,\n  });\n\n  if (metroProcess.stdout) {\n    metroProcess.stdout.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.log(`[Metro] ${output}`);\n    });\n  }\n  if (metroProcess.stderr) {\n    metroProcess.stderr.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.error(`[Metro Error] ${output}`);\n    });\n  }\n\n  for (let i = 0; i < 60; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 120_000);\n\n  try {\n    console.log(`Downloading: ${url}`);\n    const response = await fetch(url, { signal: controller.signal });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n\n    if (error.name === \"AbortError\") {\n      throw new Error(`Download timeout after 2m: ${url}`);\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  const url = new URL(\"http://localhost:8081/client/index.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  console.log(`Fetching ${platform} bundle...`);\n  await downloadFile(url.toString(), output);\n  console.log(`${platform} bundle ready`);\n}\n\nasync function downloadManifest(platform) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 300_000);\n\n  try {\n    console.log(`Fetching ${platform} manifest...`);\n    const response = await fetch(\"http://localhost:8081/manifest\", {\n      headers: { \"expo-platform\": platform },\n      signal: controller.signal,\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const manifest = await response.json();\n    console.log(`${platform} manifest ready`);\n    return manifest;\n  } catch (error) {\n    if (error.name === \"AbortError\") {\n      throw new Error(\n        `Manifest download timeout after 5m for platform: ${platform}`,\n      );\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n  console.log(\"This may take several minutes for production builds...\");\n\n  try {\n    const results = await Promise.allSettled([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n\n    const failures = results\n      .map((result, index) => ({ result, index }))\n      .filter(({ result }) => result.status === \"rejected\");\n\n    if (failures.length > 0) {\n      const errorMessages = failures.map(({ result, index }) => {\n        const names = [\n          \"iOS bundle\",\n          \"Android bundle\",\n          \"iOS manifest\",\n          \"Android manifest\",\n        ];\n        return `  - ${names[index]}: ${result.reason?.message || result.reason}`;\n      });\n\n      exitWithError(`Download failed:\\n${errorMessages.join(\"\\n\")}`);\n    }\n\n    const iosManifest =\n      results[2].status === \"fulfilled\" ? results[2].value : null;\n    const androidManifest =\n      results[3].status === \"fulfilled\" ? results[3].value : null;\n\n    console.log(\"All downloads completed successfully\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Unexpected download error: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath);\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath);\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath);\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const domain = getDeploymentDomain();\n  const baseUrl = `https://${domain}`;\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro(domain);\n\n  const downloadTimeout = 300000;\n  const downloadPromise = downloadBundlesAndManifests(timestamp);\n  const timeoutPromise = new Promise((_, reject) => {\n    setTimeout(() => {\n      reject(\n        new Error(\n          `Overall download timeout after ${downloadTimeout / 1000} seconds. ` +\n            \"Metro may be struggling to generate bundles. Check Metro logs above.\",\n        ),\n      );\n    }, downloadTimeout);\n  });\n\n  const manifests = await Promise.race([downloadPromise, timeoutPromise]);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","path":null,"size_bytes":14884,"size_tokens":null},"client/screens/main/ProfileScreen.tsx":{"content":"import React, { useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  Alert,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport Animated, { FadeInDown } from 'react-native-reanimated';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\nimport type { RootStackParamList } from '@/navigation/types';\n\n// Types\ninterface MenuItem {\n  id: string;\n  title: string;\n  icon: keyof typeof Feather.glyphMap;\n  screen?: keyof RootStackParamList;\n  action?: 'logout';\n  badge?: string;\n}\n\n// Menu items\nconst MENU_ITEMS: MenuItem[] = [\n  { id: '1', title: 'Documents', icon: 'file-text', screen: 'Documents' },\n  { id: '2', title: 'Payment Methods', icon: 'credit-card', screen: 'PaymentMethods' },\n  { id: '3', title: 'Notifications', icon: 'bell', badge: '3' },\n  { id: '4', title: 'Support', icon: 'help-circle', screen: 'Support' },\n  { id: '5', title: 'Legal', icon: 'shield', screen: 'Legal' },\n  { id: '6', title: 'Log Out', icon: 'log-out', action: 'logout' },\n];\n\n/**\n * Profile Screen\n * Account settings and documents\n */\nexport default function ProfileScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const { user, signOut } = useAuth();\n\n  const handleMenuPress = useCallback(\n    (item: MenuItem) => {\n      if (item.action === 'logout') {\n        Alert.alert(\n          'Log Out',\n          'Are you sure you want to log out?',\n          [\n            { text: 'Cancel', style: 'cancel' },\n            {\n              text: 'Log Out',\n              style: 'destructive',\n              onPress: signOut,\n            },\n          ],\n          { cancelable: true }\n        );\n      } else if (item.screen) {\n        navigation.navigate(item.screen as any);\n      }\n    },\n    [navigation, signOut]\n  );\n\n  const handleSettingsPress = useCallback(() => {\n    navigation.navigate('Settings');\n  }, [navigation]);\n\n  // Get initials for avatar\n  const getInitials = () => {\n    if (user?.firstName && user?.lastName) {\n      return `${user.firstName[0]}${user.lastName[0]}`.toUpperCase();\n    }\n    if (user?.fullName) {\n      const parts = user.fullName.split(' ');\n      return parts.length > 1\n        ? `${parts[0][0]}${parts[parts.length - 1][0]}`.toUpperCase()\n        : parts[0][0].toUpperCase();\n    }\n    if (user?.email) {\n      return user.email[0].toUpperCase();\n    }\n    return 'U';\n  };\n\n  const displayName =\n    user?.fullName ||\n    (user?.firstName && user?.lastName\n      ? `${user.firstName} ${user.lastName}`\n      : user?.email || 'User');\n\n  return (\n    <View style={styles.container}>\n      {/* Header */}\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Text style={styles.screenTitle}>Profile</Text>\n        <Pressable style={styles.headerButton} onPress={handleSettingsPress}>\n          <Feather name=\"settings\" size={24} color={colors.text.primary} />\n        </Pressable>\n      </View>\n\n      {/* Content */}\n      <ScrollView\n        style={styles.scrollView}\n        contentContainerStyle={[\n          styles.scrollContent,\n          { paddingBottom: layout.tabBarHeight + spacing.xl },\n        ]}\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Profile Card */}\n        <Animated.View\n          entering={FadeInDown.duration(600).delay(100)}\n          style={styles.profileCard}\n        >\n          {/* Avatar */}\n          <View style={styles.avatarContainer}>\n            {user?.avatarUrl ? (\n              <View style={styles.avatar}>\n                {/* TODO: Add Image component with user.avatarUrl */}\n                <Text style={styles.avatarText}>{getInitials()}</Text>\n              </View>\n            ) : (\n              <View style={styles.avatar}>\n                <Text style={styles.avatarText}>{getInitials()}</Text>\n              </View>\n            )}\n            <Pressable style={styles.editAvatarButton}>\n              <Feather name=\"camera\" size={14} color={colors.text.inverse} />\n            </Pressable>\n          </View>\n\n          {/* User Info */}\n          <Text style={styles.userName}>{displayName}</Text>\n          <Text style={styles.userEmail}>{user?.email}</Text>\n\n          {/* Verification Badge */}\n          {user?.isVerified && (\n            <View style={styles.verifiedBadge}>\n              <Feather\n                name=\"check-circle\"\n                size={14}\n                color={colors.semantic.success}\n              />\n              <Text style={styles.verifiedText}>Verified Investor</Text>\n            </View>\n          )}\n\n          {/* Quick Stats */}\n          <View style={styles.statsContainer}>\n            <View style={styles.stat}>\n              <Text style={styles.statValue}>5</Text>\n              <Text style={styles.statLabel}>Investments</Text>\n            </View>\n            <View style={styles.statDivider} />\n            <View style={styles.stat}>\n              <Text style={styles.statValue}>$125K</Text>\n              <Text style={styles.statLabel}>Total Value</Text>\n            </View>\n            <View style={styles.statDivider} />\n            <View style={styles.stat}>\n              <Text style={styles.statValue}>2</Text>\n              <Text style={styles.statLabel}>Years</Text>\n            </View>\n          </View>\n        </Animated.View>\n\n        {/* Menu Items */}\n        <Animated.View\n          entering={FadeInDown.duration(600).delay(200)}\n          style={styles.menuContainer}\n        >\n          {MENU_ITEMS.map((item, index) => {\n            const isLogout = item.action === 'logout';\n            const isLast = index === MENU_ITEMS.length - 1;\n\n            return (\n              <Pressable\n                key={item.id}\n                style={[\n                  styles.menuItem,\n                  !isLast && styles.menuItemBorder,\n                  isLogout && styles.menuItemLogout,\n                ]}\n                onPress={() => handleMenuPress(item)}\n              >\n                <View style={styles.menuItemLeft}>\n                  <View\n                    style={[\n                      styles.menuItemIcon,\n                      isLogout && styles.menuItemIconLogout,\n                    ]}\n                  >\n                    <Feather\n                      name={item.icon}\n                      size={20}\n                      color={isLogout ? colors.semantic.error : colors.primary.main}\n                    />\n                  </View>\n                  <Text\n                    style={[\n                      styles.menuItemTitle,\n                      isLogout && styles.menuItemTitleLogout,\n                    ]}\n                  >\n                    {item.title}\n                  </Text>\n                </View>\n                <View style={styles.menuItemRight}>\n                  {item.badge && (\n                    <View style={styles.badge}>\n                      <Text style={styles.badgeText}>{item.badge}</Text>\n                    </View>\n                  )}\n                  {!isLogout && (\n                    <Feather\n                      name=\"chevron-right\"\n                      size={20}\n                      color={colors.text.tertiary}\n                    />\n                  )}\n                </View>\n              </Pressable>\n            );\n          })}\n        </Animated.View>\n\n        {/* App Version */}\n        <Animated.View\n          entering={FadeInDown.duration(600).delay(300)}\n          style={styles.versionContainer}\n        >\n          <Text style={styles.versionText}>MedInvest v1.0.0</Text>\n        </Animated.View>\n      </ScrollView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Header\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    backgroundColor: colors.background.primary,\n  },\n  screenTitle: {\n    ...typography.title,\n    color: colors.text.primary,\n  },\n  headerButton: {\n    padding: spacing.xs,\n  },\n\n  // Scroll View\n  scrollView: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingTop: spacing.md,\n  },\n\n  // Profile Card\n  profileCard: {\n    backgroundColor: colors.surface.primary,\n    marginHorizontal: spacing.lg,\n    padding: spacing.xl,\n    borderRadius: layout.radiusLarge,\n    alignItems: 'center',\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    ...shadows.card,\n  },\n  avatarContainer: {\n    position: 'relative',\n    marginBottom: spacing.lg,\n  },\n  avatar: {\n    width: layout.avatarLarge,\n    height: layout.avatarLarge,\n    borderRadius: layout.avatarLarge / 2,\n    backgroundColor: colors.primary.main,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  avatarText: {\n    ...typography.title,\n    color: colors.text.inverse,\n  },\n  editAvatarButton: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    backgroundColor: colors.primary.main,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: colors.surface.primary,\n  },\n  userName: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  userEmail: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    marginBottom: spacing.md,\n  },\n  verifiedBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n    backgroundColor: colors.transparent.secondary10,\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.xs,\n    borderRadius: layout.radiusFull,\n    marginBottom: spacing.lg,\n  },\n  verifiedText: {\n    ...typography.small,\n    color: colors.semantic.success,\n  },\n\n  // Stats\n  statsContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n    paddingTop: spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  stat: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  statDivider: {\n    width: 1,\n    height: 32,\n    backgroundColor: colors.border.light,\n  },\n  statValue: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  statLabel: {\n    ...typography.small,\n    color: colors.text.secondary,\n  },\n\n  // Menu\n  menuContainer: {\n    backgroundColor: colors.surface.primary,\n    marginHorizontal: spacing.lg,\n    marginTop: spacing.xl,\n    borderRadius: layout.radiusLarge,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    overflow: 'hidden',\n  },\n  menuItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.lg,\n  },\n  menuItemBorder: {\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  menuItemLogout: {\n    backgroundColor: colors.transparent.black10,\n  },\n  menuItemLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.md,\n  },\n  menuItemIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  menuItemIconLogout: {\n    backgroundColor: 'rgba(220, 38, 38, 0.1)',\n  },\n  menuItemTitle: {\n    ...typography.body,\n    color: colors.text.primary,\n  },\n  menuItemTitleLogout: {\n    color: colors.semantic.error,\n  },\n  menuItemRight: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n  },\n  badge: {\n    backgroundColor: colors.semantic.error,\n    paddingHorizontal: spacing.sm,\n    paddingVertical: 2,\n    borderRadius: 10,\n    minWidth: 20,\n    alignItems: 'center',\n  },\n  badgeText: {\n    ...typography.small,\n    color: colors.text.inverse,\n    fontWeight: '600',\n  },\n\n  // Version\n  versionContainer: {\n    alignItems: 'center',\n    paddingVertical: spacing.xl,\n  },\n  versionText: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n});\n","path":null,"size_bytes":12282,"size_tokens":null},"client/components/index.ts":{"content":"/**\n * Components Index\n * Export all components for easy imports\n */\n\n// Core Components\nexport { ThemedText } from './ThemedText';\nexport { ThemedView } from './ThemedView';\nexport { default as Button } from './Button';\nexport { default as Card } from './Card';\nexport { default as Spacer } from './Spacer';\nexport { ErrorBoundary } from './ErrorBoundary';\nexport { ErrorFallback } from './ErrorFallback';\n\n// Post Components\nexport { default as PostCard } from './PostCard';\nexport { default as RichTextContent } from './RichTextContent';\n\n// Feed Components\nexport { default as RoomFilter } from './RoomFilter';\nexport { default as TrendingSidebar } from './TrendingSidebar';\n\n// Modal Components\nexport { default as ReportModal } from './ReportModal';\nexport { default as ImageViewer } from './ImageViewer';\n\n// Media Components\nexport { default as VideoPlayer, InlineVideoPlayer } from './VideoPlayer';\n\n// Network & Error Components\nexport { \n  NetworkProvider, \n  useNetwork, \n  OfflinePlaceholder, \n  ErrorState, \n  RateLimitError \n} from './NetworkStatus';\n\n// Discovery Components\nexport { default as PeopleYouMayKnow, PeopleYouMayKnowCompact } from './PeopleYouMayKnow';\nexport { default as DiscoverMoreNews, DiscoverNewsCompact, FeaturedNewsCard } from './DiscoverMoreNews';\n\n// Notifications\nexport { default as NotificationsDropdown, NotificationBell } from './NotificationsDropdown';\n\n// Advanced Components\nexport { default as CustomRefreshControl } from './CustomRefreshControl';\nexport { default as ImageCropper } from './ImageCropper';\nexport { default as InAppBrowser } from './InAppBrowser';\nexport { default as MentionInput } from './MentionInput';\nexport * from './MessageStatus';\nexport * from './MuteUser';\nexport * from './PinnedPosts';\nexport * from './Poll';\nexport * from './Reactions';\nexport { default as SearchFilters } from './SearchFilters';\nexport * from './SkeletonLoaders';\nexport { default as ThreadedComments } from './ThreadedComments';\nexport * from './OnboardingTooltips';\n","path":null,"size_bytes":2016,"size_tokens":null},"client/navigation/index.ts":{"content":"export { default as RootNavigator } from './RootNavigator';\nexport { default as MainTabNavigator } from './MainTabNavigator';\nexport * from './types';\n","path":null,"size_bytes":151,"size_tokens":null},"eslint.config.js":{"content":"// https://docs.expo.dev/guides/using-eslint/\nconst { defineConfig } = require(\"eslint/config\");\nconst expoConfig = require(\"eslint-config-expo/flat\");\nconst eslintPluginPrettierRecommended = require(\"eslint-plugin-prettier/recommended\");\n\nmodule.exports = defineConfig([\n  expoConfig,\n  eslintPluginPrettierRecommended,\n  {\n    ignores: [\"dist/*\"],\n  },\n]);\n","path":null,"size_bytes":359,"size_tokens":null},"shared/models/chat.ts":{"content":"import { pgTable, serial, integer, text, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { sql } from \"drizzle-orm\";\n\nexport const conversations = pgTable(\"conversations\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  conversationId: integer(\"conversation_id\").notNull().references(() => conversations.id, { onDelete: \"cascade\" }),\n  role: text(\"role\").notNull(),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`CURRENT_TIMESTAMP`).notNull(),\n});\n\nexport const insertConversationSchema = createInsertSchema(conversations).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\n\n","path":null,"size_bytes":1229,"size_tokens":null},"client/screens/auth/OnboardingScreen.tsx":{"content":"import React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Dimensions,\n  Pressable,\n  FlatList,\n  type ViewToken,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport Animated, {\n  FadeIn,\n  FadeInDown,\n  FadeInUp,\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  interpolate,\n  Extrapolation,\n} from 'react-native-reanimated';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport { Button } from '@/components';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\nconst ONBOARDING_COMPLETE_KEY = '@medinvest/onboarding_complete';\n\ninterface OnboardingSlide {\n  id: string;\n  icon: keyof typeof Feather.glyphMap;\n  iconColor: string;\n  title: string;\n  description: string;\n  gradient: string[];\n}\n\nconst SLIDES: OnboardingSlide[] = [\n  {\n    id: '1',\n    icon: 'trending-up',\n    iconColor: colors.primary.main,\n    title: 'Invest in Medical Innovation',\n    description:\n      'Discover vetted investment opportunities in biotech, medical devices, and digital health companies shaping the future of healthcare.',\n    gradient: [colors.primary.main, colors.primary.dark],\n  },\n  {\n    id: '2',\n    icon: 'shield',\n    iconColor: colors.secondary.main,\n    title: 'Secure & Transparent',\n    description:\n      'Every investment is thoroughly vetted by our team of medical and financial experts. Track your portfolio in real-time with full transparency.',\n    gradient: [colors.secondary.main, colors.secondary.dark],\n  },\n  {\n    id: '3',\n    icon: 'book-open',\n    iconColor: '#8B5CF6',\n    title: 'Stay Informed',\n    description:\n      'Access exclusive research, market insights, and expert analysis to make informed investment decisions in the medical sector.',\n    gradient: ['#8B5CF6', '#6D28D9'],\n  },\n  {\n    id: '4',\n    icon: 'users',\n    iconColor: '#F59E0B',\n    title: 'Join Our Community',\n    description:\n      'Connect with like-minded investors passionate about advancing healthcare. Start your journey with as little as $1,000.',\n    gradient: ['#F59E0B', '#D97706'],\n  },\n];\n\ninterface OnboardingScreenProps {\n  navigation: any;\n}\n\nexport default function OnboardingScreen({ navigation }: OnboardingScreenProps) {\n  const insets = useSafeAreaInsets();\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const flatListRef = useRef<FlatList>(null);\n  const scrollX = useSharedValue(0);\n\n  const isLastSlide = currentIndex === SLIDES.length - 1;\n\n  const handleViewableItemsChanged = useCallback(\n    ({ viewableItems }: { viewableItems: ViewToken[] }) => {\n      if (viewableItems.length > 0) {\n        setCurrentIndex(viewableItems[0].index || 0);\n      }\n    },\n    []\n  );\n\n  const viewabilityConfig = {\n    itemVisiblePercentThreshold: 50,\n  };\n\n  const goToNext = useCallback(() => {\n    if (currentIndex < SLIDES.length - 1) {\n      flatListRef.current?.scrollToIndex({\n        index: currentIndex + 1,\n        animated: true,\n      });\n    }\n  }, [currentIndex]);\n\n  const completeOnboarding = useCallback(async () => {\n    try {\n      await AsyncStorage.setItem(ONBOARDING_COMPLETE_KEY, 'true');\n      navigation.replace('Auth');\n    } catch (error) {\n      console.error('Failed to save onboarding state:', error);\n      navigation.replace('Auth');\n    }\n  }, [navigation]);\n\n  const skipOnboarding = useCallback(async () => {\n    await completeOnboarding();\n  }, [completeOnboarding]);\n\n  const renderSlide = useCallback(\n    ({ item, index }: { item: OnboardingSlide; index: number }) => {\n      return (\n        <View style={styles.slide}>\n          {/* Icon Container */}\n          <Animated.View\n            entering={FadeInDown.delay(200).duration(600)}\n            style={styles.iconWrapper}\n          >\n            <LinearGradient\n              colors={item.gradient}\n              style={styles.iconGradient}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n            >\n              <View style={styles.iconInner}>\n                <Feather name={item.icon} size={64} color={item.iconColor} />\n              </View>\n            </LinearGradient>\n          </Animated.View>\n\n          {/* Text Content */}\n          <Animated.View\n            entering={FadeInUp.delay(400).duration(600)}\n            style={styles.textContent}\n          >\n            <Text style={styles.title}>{item.title}</Text>\n            <Text style={styles.description}>{item.description}</Text>\n          </Animated.View>\n        </View>\n      );\n    },\n    []\n  );\n\n  const renderDots = () => (\n    <View style={styles.dotsContainer}>\n      {SLIDES.map((_, index) => {\n        const isActive = index === currentIndex;\n        return (\n          <Animated.View\n            key={index}\n            style={[\n              styles.dot,\n              isActive && styles.dotActive,\n            ]}\n          />\n        );\n      })}\n    </View>\n  );\n\n  return (\n    <View style={[styles.container, { paddingTop: insets.top }]}>\n      {/* Skip Button */}\n      {!isLastSlide && (\n        <Animated.View\n          entering={FadeIn.delay(600)}\n          style={styles.skipContainer}\n        >\n          <Pressable onPress={skipOnboarding} style={styles.skipButton}>\n            <Text style={styles.skipText}>Skip</Text>\n          </Pressable>\n        </Animated.View>\n      )}\n\n      {/* Slides */}\n      <FlatList\n        ref={flatListRef}\n        data={SLIDES}\n        keyExtractor={(item) => item.id}\n        renderItem={renderSlide}\n        horizontal\n        pagingEnabled\n        showsHorizontalScrollIndicator={false}\n        bounces={false}\n        onViewableItemsChanged={handleViewableItemsChanged}\n        viewabilityConfig={viewabilityConfig}\n        onScroll={(event) => {\n          scrollX.value = event.nativeEvent.contentOffset.x;\n        }}\n        scrollEventThrottle={16}\n        getItemLayout={(_, index) => ({\n          length: SCREEN_WIDTH,\n          offset: SCREEN_WIDTH * index,\n          index,\n        })}\n      />\n\n      {/* Bottom Section */}\n      <View style={[styles.bottomSection, { paddingBottom: insets.bottom + spacing.lg }]}>\n        {/* Dots */}\n        {renderDots()}\n\n        {/* Action Buttons */}\n        <View style={styles.actionsContainer}>\n          {isLastSlide ? (\n            <Button\n              variant=\"gradient\"\n              size=\"lg\"\n              onPress={completeOnboarding}\n              fullWidth\n              rightIcon=\"arrow-right\"\n            >\n              Get Started\n            </Button>\n          ) : (\n            <View style={styles.navigationButtons}>\n              <View style={styles.nextButtonWrapper}>\n                <Button\n                  variant=\"primary\"\n                  size=\"lg\"\n                  onPress={goToNext}\n                  fullWidth\n                  rightIcon=\"arrow-right\"\n                >\n                  Continue\n                </Button>\n              </View>\n            </View>\n          )}\n        </View>\n\n        {/* Terms Notice */}\n        <Text style={styles.termsText}>\n          By continuing, you agree to our{' '}\n          <Text style={styles.termsLink}>Terms of Service</Text> and{' '}\n          <Text style={styles.termsLink}>Privacy Policy</Text>\n        </Text>\n      </View>\n    </View>\n  );\n}\n\n// Helper to check if onboarding is complete\nexport async function isOnboardingComplete(): Promise<boolean> {\n  try {\n    const value = await AsyncStorage.getItem(ONBOARDING_COMPLETE_KEY);\n    return value === 'true';\n  } catch {\n    return false;\n  }\n}\n\n// Helper to reset onboarding (for testing)\nexport async function resetOnboarding(): Promise<void> {\n  try {\n    await AsyncStorage.removeItem(ONBOARDING_COMPLETE_KEY);\n  } catch (error) {\n    console.error('Failed to reset onboarding:', error);\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Skip\n  skipContainer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    zIndex: 10,\n    paddingTop: spacing.md,\n    paddingRight: spacing.lg,\n  },\n  skipButton: {\n    paddingVertical: spacing.sm,\n    paddingHorizontal: spacing.md,\n  },\n  skipText: {\n    ...typography.body,\n    color: colors.text.secondary,\n  },\n\n  // Slide\n  slide: {\n    width: SCREEN_WIDTH,\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: spacing.xl,\n  },\n\n  // Icon\n  iconWrapper: {\n    marginBottom: spacing['3xl'],\n  },\n  iconGradient: {\n    width: 160,\n    height: 160,\n    borderRadius: 80,\n    padding: 4,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  iconInner: {\n    width: '100%',\n    height: '100%',\n    borderRadius: 78,\n    backgroundColor: colors.background.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n\n  // Text\n  textContent: {\n    alignItems: 'center',\n    paddingHorizontal: spacing.md,\n  },\n  title: {\n    ...typography.largeTitle,\n    color: colors.text.primary,\n    textAlign: 'center',\n    marginBottom: spacing.md,\n  },\n  description: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n    lineHeight: 26,\n    maxWidth: 320,\n  },\n\n  // Bottom Section\n  bottomSection: {\n    paddingHorizontal: spacing.xl,\n    paddingTop: spacing.xl,\n  },\n\n  // Dots\n  dotsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: spacing.xl,\n    gap: spacing.sm,\n  },\n  dot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: colors.border.medium,\n  },\n  dotActive: {\n    width: 24,\n    backgroundColor: colors.primary.main,\n  },\n\n  // Actions\n  actionsContainer: {\n    marginBottom: spacing.lg,\n  },\n  navigationButtons: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  nextButtonWrapper: {\n    flex: 1,\n  },\n\n  // Terms\n  termsText: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    textAlign: 'center',\n    lineHeight: 18,\n  },\n  termsLink: {\n    color: colors.primary.main,\n    textDecorationLine: 'underline',\n  },\n});\n","path":null,"size_bytes":10225,"size_tokens":null},"client/hooks/useScreenOptions.ts":{"content":"import { Platform } from \"react-native\";\nimport { NativeStackNavigationOptions } from \"@react-navigation/native-stack\";\nimport { isLiquidGlassAvailable } from \"expo-glass-effect\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\n\ninterface UseScreenOptionsParams {\n  transparent?: boolean;\n}\n\nexport function useScreenOptions({\n  transparent = true,\n}: UseScreenOptionsParams = {}): NativeStackNavigationOptions {\n  const { theme, isDark } = useTheme();\n\n  return {\n    headerTitleAlign: \"center\",\n    headerTransparent: transparent,\n    headerBlurEffect: isDark ? \"dark\" : \"light\",\n    headerTintColor: theme.text,\n    headerStyle: {\n      backgroundColor: Platform.select({\n        ios: undefined,\n        android: theme.backgroundRoot,\n        web: theme.backgroundRoot,\n      }),\n    },\n    gestureEnabled: true,\n    gestureDirection: \"horizontal\",\n    fullScreenGestureEnabled: isLiquidGlassAvailable() ? false : true,\n    contentStyle: {\n      backgroundColor: theme.backgroundRoot,\n    },\n  };\n}\n","path":null,"size_bytes":1000,"size_tokens":null},"server/db.ts":{"content":"import { Pool } from \"pg\";\nimport { drizzle } from \"drizzle-orm/node-postgres\";\nimport * as schema from \"./db/schema\";\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nexport const db = drizzle(pool, { schema });\n\nexport * from \"./db/schema\";\n","path":null,"size_bytes":270,"size_tokens":null},"client/screens/SearchScreen.tsx":{"content":"/**\n * Search Screen\n * Search posts, users, rooms, and hashtags\n */\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  FlatList,\n  Image,\n  ActivityIndicator,\n  Keyboard,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { searchApi, feedApi } from '@/lib/api';\nimport { SearchType, Post, User, Room, TrendingTopic } from '@/types';\nimport { formatNumber, debounce } from '@/lib/utils';\nimport PostCard from '@/components/PostCard';\n\ntype TabType = 'top' | 'posts' | 'users' | 'rooms' | 'tags';\n\nexport default function SearchScreen() {\n  const navigation = useNavigation<any>();\n  const inputRef = useRef<TextInput>(null);\n  const appColors = useAppColors();\n  \n  const [query, setQuery] = useState('');\n  const [activeTab, setActiveTab] = useState<TabType>('top');\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Debounced search\n  const debouncedSetSearch = useCallback(\n    debounce((value: string) => {\n      setSearchQuery(value);\n    }, 300),\n    []\n  );\n\n  const handleQueryChange = (text: string) => {\n    setQuery(text);\n    debouncedSetSearch(text);\n  };\n\n  // Trending topics for empty state\n  const { data: trendingData } = useQuery({\n    queryKey: ['trending'],\n    queryFn: async () => {\n      const response = await feedApi.getTrending();\n      return response.data?.topics || [];\n    },\n    enabled: !searchQuery,\n  });\n\n  // Search results\n  const { data: searchResults, isLoading } = useQuery({\n    queryKey: ['search', searchQuery, activeTab],\n    queryFn: async () => {\n      const type = activeTab === 'top' ? 'all' : activeTab as SearchType;\n      const response = await searchApi.search(searchQuery, type);\n      return response.data;\n    },\n    enabled: searchQuery.length > 0,\n  });\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleRoomPress = useCallback((roomSlug: string) => {\n    navigation.navigate('RoomDetail', { roomSlug });\n  }, [navigation]);\n\n  const handleHashtagPress = useCallback((tag: string) => {\n    navigation.navigate('Hashtag', { tag });\n  }, [navigation]);\n\n  const handleClear = () => {\n    setQuery('');\n    setSearchQuery('');\n    inputRef.current?.focus();\n  };\n\n  const renderTabs = () => (\n    <View style={[styles.tabsContainer, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n      {(['top', 'posts', 'users', 'rooms', 'tags'] as TabType[]).map((tab) => (\n        <TouchableOpacity\n          key={tab}\n          style={[styles.tab, activeTab === tab && styles.tabActive]}\n          onPress={() => setActiveTab(tab)}\n        >\n          <ThemedText style={[styles.tabText, { color: appColors.textSecondary }, activeTab === tab && styles.tabTextActive]}>\n            {tab.charAt(0).toUpperCase() + tab.slice(1)}\n          </ThemedText>\n        </TouchableOpacity>\n      ))}\n    </View>\n  );\n\n  const renderUserItem = ({ item }: { item: User }) => (\n    <TouchableOpacity style={[styles.userItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]} onPress={() => handleUserPress(item.id)}>\n      {item.avatar_url ? (\n        <Image source={{ uri: item.avatar_url }} style={styles.userAvatar} />\n      ) : (\n        <View style={[styles.userAvatar, styles.userAvatarPlaceholder]}>\n          <ThemedText style={styles.userAvatarText}>\n            {item.first_name[0]}{item.last_name[0]}\n          </ThemedText>\n        </View>\n      )}\n      <View style={styles.userInfo}>\n        <View style={styles.userNameRow}>\n          <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>{item.full_name}</ThemedText>\n          {item.is_verified && (\n            <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n          )}\n        </View>\n        {item.specialty && (\n          <ThemedText style={[styles.userSpecialty, { color: appColors.textSecondary }]}>{item.specialty}</ThemedText>\n        )}\n        <ThemedText style={[styles.userFollowers, { color: appColors.textSecondary }]}>\n          {formatNumber(item.followers_count)} followers\n        </ThemedText>\n      </View>\n      <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n    </TouchableOpacity>\n  );\n\n  const renderRoomItem = ({ item }: { item: Room }) => (\n    <TouchableOpacity style={[styles.roomItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]} onPress={() => handleRoomPress(item.slug)}>\n      <View style={[styles.roomIcon, { backgroundColor: item.color + '20' }]}>\n        <ThemedText style={styles.roomEmoji}>{item.icon}</ThemedText>\n      </View>\n      <View style={styles.roomInfo}>\n        <ThemedText style={[styles.roomName, { color: appColors.textPrimary }]}>{item.name}</ThemedText>\n        <ThemedText style={[styles.roomDescription, { color: appColors.textSecondary }]} numberOfLines={1}>\n          {item.description}\n        </ThemedText>\n        <ThemedText style={[styles.roomMembers, { color: appColors.textSecondary }]}>\n          {formatNumber(item.members_count)} members ¬∑ {formatNumber(item.posts_count)} posts\n        </ThemedText>\n      </View>\n      {!item.is_member && (\n        <TouchableOpacity style={styles.joinButton}>\n          <ThemedText style={styles.joinButtonText}>Join</ThemedText>\n        </TouchableOpacity>\n      )}\n    </TouchableOpacity>\n  );\n\n  const renderHashtagItem = ({ item }: { item: TrendingTopic }) => (\n    <TouchableOpacity style={[styles.hashtagItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]} onPress={() => handleHashtagPress(item.hashtag)}>\n      <View style={styles.hashtagIcon}>\n        <ThemedText style={styles.hashtagSymbol}>#</ThemedText>\n      </View>\n      <View style={styles.hashtagInfo}>\n        <ThemedText style={[styles.hashtagName, { color: appColors.textPrimary }]}>{item.hashtag}</ThemedText>\n        <ThemedText style={[styles.hashtagCount, { color: appColors.textSecondary }]}>\n          {formatNumber(item.count)} posts\n        </ThemedText>\n      </View>\n      <Ionicons \n        name={item.trend === 'up' ? 'trending-up' : item.trend === 'down' ? 'trending-down' : 'remove'} \n        size={20} \n        color={item.trend === 'up' ? Colors.secondary : item.trend === 'down' ? appColors.error : appColors.textSecondary} \n      />\n    </TouchableOpacity>\n  );\n\n  const renderContent = () => {\n    if (!searchQuery) {\n      // Show trending topics\n      return (\n        <View style={styles.trendingContainer}>\n          <ThemedText style={[styles.trendingTitle, { color: appColors.textPrimary }]}>Trending Topics</ThemedText>\n          {trendingData?.map((topic, index) => (\n            <TouchableOpacity\n              key={topic.hashtag}\n              style={[styles.trendingItem, { borderBottomColor: appColors.border }]}\n              onPress={() => handleHashtagPress(topic.hashtag)}\n            >\n              <ThemedText style={[styles.trendingRank, { color: appColors.textSecondary }]}>{index + 1}</ThemedText>\n              <View style={styles.trendingInfo}>\n                <ThemedText style={[styles.trendingTag, { color: appColors.textPrimary }]}>#{topic.hashtag}</ThemedText>\n                <ThemedText style={[styles.trendingCount, { color: appColors.textSecondary }]}>\n                  {formatNumber(topic.count)} posts\n                </ThemedText>\n              </View>\n              <Ionicons \n                name={topic.trend === 'up' ? 'trending-up' : 'trending-down'} \n                size={18} \n                color={topic.trend === 'up' ? Colors.secondary : appColors.error} \n              />\n            </TouchableOpacity>\n          ))}\n        </View>\n      );\n    }\n\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={Colors.primary} />\n        </View>\n      );\n    }\n\n    // Render based on active tab\n    switch (activeTab) {\n      case 'users':\n        return (\n          <FlatList\n            data={searchResults?.users || []}\n            renderItem={renderUserItem}\n            keyExtractor={(item) => item.id.toString()}\n            ListEmptyComponent={\n              <View style={styles.emptyContainer}>\n                <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No users found</ThemedText>\n              </View>\n            }\n          />\n        );\n      case 'rooms':\n        return (\n          <FlatList\n            data={searchResults?.rooms || []}\n            renderItem={renderRoomItem}\n            keyExtractor={(item) => item.id.toString()}\n            ListEmptyComponent={\n              <View style={styles.emptyContainer}>\n                <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No rooms found</ThemedText>\n              </View>\n            }\n          />\n        );\n      case 'tags':\n        return (\n          <FlatList\n            data={searchResults?.hashtags || []}\n            renderItem={renderHashtagItem}\n            keyExtractor={(item) => item.hashtag}\n            ListEmptyComponent={\n              <View style={styles.emptyContainer}>\n                <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No hashtags found</ThemedText>\n              </View>\n            }\n          />\n        );\n      case 'posts':\n      case 'top':\n      default:\n        return (\n          <FlatList\n            data={searchResults?.posts || []}\n            renderItem={({ item }) => (\n              <PostCard\n                post={item}\n                onPress={() => handlePostPress(item.id)}\n                onUserPress={() => handleUserPress(item.author.id)}\n                onVote={() => {}}\n                onBookmark={() => {}}\n                onHashtagPress={handleHashtagPress}\n              />\n            )}\n            keyExtractor={(item) => item.id.toString()}\n            ListEmptyComponent={\n              <View style={styles.emptyContainer}>\n                <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>No posts found</ThemedText>\n              </View>\n            }\n          />\n        );\n    }\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Search Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <View style={styles.searchInputContainer}>\n          <Ionicons name=\"search\" size={20} color={appColors.textSecondary} />\n          <TextInput\n            ref={inputRef}\n            style={[styles.searchInput, { color: appColors.textPrimary }]}\n            placeholder=\"Search MedInvest...\"\n            placeholderTextColor={appColors.textSecondary}\n            value={query}\n            onChangeText={handleQueryChange}\n            autoFocus\n            returnKeyType=\"search\"\n            onSubmitEditing={Keyboard.dismiss}\n          />\n          {query.length > 0 && (\n            <TouchableOpacity onPress={handleClear}>\n              <Ionicons name=\"close-circle\" size={20} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          )}\n        </View>\n      </View>\n\n      {/* Tabs (only show when searching) */}\n      {searchQuery.length > 0 && renderTabs()}\n\n      {/* Content */}\n      {renderContent()}\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n    marginRight: Spacing.xs,\n  },\n  searchInputContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    height: 40,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    ...Typography.body,\n    height: '100%',\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    alignItems: 'center',\n  },\n  tabActive: {\n    borderBottomWidth: 2,\n    borderBottomColor: Colors.primary,\n  },\n  tabText: {\n    ...Typography.caption,\n  },\n  tabTextActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyText: {\n    ...Typography.body,\n  },\n  trendingContainer: {\n    padding: Spacing.lg,\n  },\n  trendingTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.lg,\n  },\n  trendingItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  trendingRank: {\n    ...Typography.body,\n    fontWeight: '700',\n    width: 24,\n  },\n  trendingInfo: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  trendingTag: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  trendingCount: {\n    ...Typography.small,\n  },\n  userItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  userAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  userAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  userAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  userInfo: {\n    flex: 1,\n  },\n  userNameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userSpecialty: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  userFollowers: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  roomItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  roomIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  roomEmoji: {\n    fontSize: 24,\n  },\n  roomInfo: {\n    flex: 1,\n  },\n  roomName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  roomDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  roomMembers: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  joinButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    backgroundColor: Colors.primary,\n  },\n  joinButtonText: {\n    ...Typography.caption,\n    color: 'white',\n    fontWeight: '600',\n  },\n  hashtagItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  hashtagIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  hashtagSymbol: {\n    ...Typography.heading,\n    color: Colors.primary,\n  },\n  hashtagInfo: {\n    flex: 1,\n  },\n  hashtagName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  hashtagCount: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n});\n","path":null,"size_bytes":16156,"size_tokens":null},"packages/shared/src/constants/index.ts":{"content":"/**\n * @medinvest/shared - Constants\n * \n * All shared constants used across web and mobile apps.\n */\n\n// =============================================================================\n// API\n// =============================================================================\n\nexport const API_VERSION = 'v1';\n\n// =============================================================================\n// PAGINATION\n// =============================================================================\n\nexport const DEFAULT_PAGE_SIZE = 20;\nexport const MAX_PAGE_SIZE = 100;\n\n// =============================================================================\n// CONTENT LIMITS\n// =============================================================================\n\nexport const LIMITS = {\n  // Posts\n  POST_CONTENT_MAX: 5000,\n  POST_IMAGES_MAX: 10,\n  POST_VIDEO_MAX_MB: 100,\n  \n  // Comments\n  COMMENT_CONTENT_MAX: 2000,\n  \n  // Messages\n  MESSAGE_CONTENT_MAX: 5000,\n  MESSAGE_ATTACHMENTS_MAX: 5,\n  \n  // Profile\n  BIO_MAX: 500,\n  USERNAME_MIN: 3,\n  USERNAME_MAX: 30,\n  NAME_MIN: 2,\n  NAME_MAX: 100,\n  \n  // Polls\n  POLL_QUESTION_MAX: 150,\n  POLL_OPTION_MAX: 50,\n  POLL_OPTIONS_MIN: 2,\n  POLL_OPTIONS_MAX: 6,\n  \n  // Search\n  SEARCH_QUERY_MAX: 200,\n  \n  // Pins\n  PINNED_POSTS_MAX: 3,\n  \n  // Keywords\n  MUTED_KEYWORDS_MAX: 100,\n} as const;\n\n// =============================================================================\n// TIMEOUTS & INTERVALS\n// =============================================================================\n\nexport const TIMEOUTS = {\n  // API\n  API_REQUEST: 30000, // 30 seconds\n  FILE_UPLOAD: 120000, // 2 minutes\n  \n  // UI\n  TOAST_DURATION: 3000,\n  LOADING_DELAY: 200, // Show loading after this delay\n  DEBOUNCE_SEARCH: 300,\n  DEBOUNCE_TYPING: 500,\n  \n  // WebSocket\n  WS_RECONNECT_BASE: 1000,\n  WS_RECONNECT_MAX: 30000,\n  WS_HEARTBEAT: 30000,\n  \n  // Typing indicator\n  TYPING_TIMEOUT: 3000,\n} as const;\n\n// =============================================================================\n// NOTIFICATION TYPES\n// =============================================================================\n\nexport const NOTIFICATION_TYPES = {\n  LIKE: 'like',\n  COMMENT: 'comment',\n  REPLY: 'reply',\n  MENTION: 'mention',\n  FOLLOW: 'follow',\n  MESSAGE: 'message',\n  DEAL_UPDATE: 'deal_update',\n  SYSTEM: 'system',\n  ACHIEVEMENT: 'achievement',\n} as const;\n\n// =============================================================================\n// WEBSOCKET EVENTS\n// =============================================================================\n\nexport const WS_EVENTS = {\n  // Outgoing (client -> server)\n  TYPING_START: 'typing_start',\n  TYPING_STOP: 'typing_stop',\n  MESSAGE_READ: 'message_read',\n  PRESENCE_ONLINE: 'presence_online',\n  PRESENCE_OFFLINE: 'presence_offline',\n  \n  // Incoming (server -> client)\n  MESSAGE: 'message',\n  TYPING: 'typing',\n  READ_RECEIPT: 'read_receipt',\n  NOTIFICATION: 'notification',\n  USER_ONLINE: 'user_online',\n  USER_OFFLINE: 'user_offline',\n  POST_UPDATED: 'post_updated',\n  POST_DELETED: 'post_deleted',\n} as const;\n\n// =============================================================================\n// ERROR CODES\n// =============================================================================\n\nexport const ERROR_CODES = {\n  // Auth\n  UNAUTHORIZED: 'UNAUTHORIZED',\n  FORBIDDEN: 'FORBIDDEN',\n  TOKEN_EXPIRED: 'TOKEN_EXPIRED',\n  INVALID_CREDENTIALS: 'INVALID_CREDENTIALS',\n  EMAIL_NOT_VERIFIED: 'EMAIL_NOT_VERIFIED',\n  \n  // Validation\n  VALIDATION_ERROR: 'VALIDATION_ERROR',\n  INVALID_INPUT: 'INVALID_INPUT',\n  \n  // Resources\n  NOT_FOUND: 'NOT_FOUND',\n  ALREADY_EXISTS: 'ALREADY_EXISTS',\n  \n  // Rate limiting\n  RATE_LIMIT: 'RATE_LIMIT',\n  \n  // Server\n  SERVER_ERROR: 'SERVER_ERROR',\n  SERVICE_UNAVAILABLE: 'SERVICE_UNAVAILABLE',\n  \n  // Network\n  NETWORK_ERROR: 'NETWORK_ERROR',\n  TIMEOUT: 'TIMEOUT',\n} as const;\n\n// =============================================================================\n// STORAGE KEYS\n// =============================================================================\n\nexport const STORAGE_KEYS = {\n  // Auth\n  AUTH_TOKEN: 'auth_token',\n  REFRESH_TOKEN: 'refresh_token',\n  USER: 'user',\n  \n  // Settings\n  THEME: 'theme',\n  NOTIFICATION_SETTINGS: 'notification_settings',\n  CONTENT_PREFERENCES: 'content_preferences',\n  \n  // Cache\n  FEED_CACHE: 'feed_cache',\n  USER_CACHE: 'user_cache',\n  \n  // Features\n  ONBOARDING_COMPLETED: 'onboarding_completed',\n  COMPLETED_TOURS: 'completed_onboarding_tours',\n  RATING_DATA: 'rating_data',\n  DRAFT_POSTS: 'draft_posts',\n  RECENT_SEARCHES: 'recent_searches',\n  SAVED_SEARCHES: 'saved_searches',\n  PINNED_POSTS: 'pinned_posts',\n  OFFLINE_QUEUE: 'offline_action_queue',\n  \n  // Widgets (iOS)\n  WIDGET_PORTFOLIO: 'widget_data_portfolio',\n  WIDGET_NOTIFICATIONS: 'widget_data_notifications',\n  WIDGET_QUICK_STATS: 'widget_data_quick_stats',\n} as const;\n\n// =============================================================================\n// DEEP LINK ROUTES\n// =============================================================================\n\nexport const DEEP_LINKS = {\n  HOME: 'medinvest://home',\n  PROFILE: 'medinvest://profile',\n  POST: 'medinvest://post', // + /:id\n  USER: 'medinvest://user', // + /:id\n  ROOM: 'medinvest://room', // + /:id\n  DEAL: 'medinvest://deal', // + /:id\n  MESSAGES: 'medinvest://messages',\n  CONVERSATION: 'medinvest://conversation', // + /:id\n  NOTIFICATIONS: 'medinvest://notifications',\n  SEARCH: 'medinvest://search',\n  TRENDING: 'medinvest://trending',\n  PORTFOLIO: 'medinvest://portfolio',\n  SETTINGS: 'medinvest://settings',\n  NEW_POST: 'medinvest://post/new',\n} as const;\n\n// =============================================================================\n// COLORS (for consistency across platforms)\n// =============================================================================\n\nexport const BRAND_COLORS = {\n  primary: '#0066FF',\n  primaryDark: '#0052CC',\n  primaryLight: '#3385FF',\n  \n  secondary: '#6B7280',\n  \n  success: '#10B981',\n  warning: '#F59E0B',\n  error: '#EF4444',\n  info: '#3B82F6',\n  \n  // Reactions\n  like: '#3B82F6',\n  love: '#EF4444',\n  laugh: '#F59E0B',\n  wow: '#8B5CF6',\n  sad: '#6B7280',\n  fire: '#F97316',\n  thinking: '#10B981',\n  clap: '#EC4899',\n} as const;\n\n// =============================================================================\n// FEATURE FLAGS\n// =============================================================================\n\nexport const FEATURES = {\n  POLLS: true,\n  REACTIONS: true,\n  PINNED_POSTS: true,\n  ANONYMOUS_POSTS: true,\n  DIRECT_MESSAGES: true,\n  DEALS: true,\n  PREMIUM: true,\n  AI_CHAT: true,\n  OFFLINE_MODE: true,\n  BIOMETRIC_AUTH: true,\n  WIDGETS: true, // iOS only\n  APP_SHORTCUTS: true,\n} as const;\n\n// =============================================================================\n// REGEX PATTERNS\n// =============================================================================\n\nexport const PATTERNS = {\n  EMAIL: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\n  USERNAME: /^[a-zA-Z0-9_]{3,30}$/,\n  MENTION: /@(\\w+)/g,\n  HASHTAG: /#(\\w+)/g,\n  URL: /(https?:\\/\\/[^\\s]+)/g,\n  PASSWORD_UPPERCASE: /[A-Z]/,\n  PASSWORD_LOWERCASE: /[a-z]/,\n  PASSWORD_NUMBER: /[0-9]/,\n} as const;\n\n// =============================================================================\n// VERSION INFO\n// =============================================================================\n\nexport const SHARED_VERSION = '1.0.0';\n","path":null,"size_bytes":7348,"size_tokens":null},"client/theme/index.ts":{"content":"/**\n * MedInvest Theme\n * Central export for all design tokens\n * \n * \"Bloomberg meets Apple Health\" - Professional, trustworthy,\n * medical blue meets financial confidence\n */\n\nexport { colors } from './colors';\nexport type { ColorPalette } from './colors';\n\nexport { typography, fontWeights } from './typography';\nexport type { Typography } from './typography';\n\nexport { \n  spacing, \n  layout, \n  borders, \n  shadows, \n  zIndex \n} from './spacing';\nexport type { Spacing, Layout, Shadows } from './spacing';\n\n// Combined theme object for convenience\nimport { colors } from './colors';\nimport { typography, fontWeights } from './typography';\nimport { spacing, layout, borders, shadows, zIndex } from './spacing';\n\nexport const theme = {\n  colors,\n  typography,\n  fontWeights,\n  spacing,\n  layout,\n  borders,\n  shadows,\n  zIndex,\n} as const;\n\nexport type Theme = typeof theme;\n\n// Default export\nexport default theme;\n","path":null,"size_bytes":919,"size_tokens":null},"client/screens/main/ArticleDetailScreen.tsx":{"content":"import React, { useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  Pressable,\n  Share,\n  Linking,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, { FadeIn, FadeInDown } from 'react-native-reanimated';\nimport { Image } from 'expo-image';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport { Badge, Button, Skeleton, SkeletonText } from '@/components';\nimport { useArticleDetail, useToggleBookmark } from '@/api';\nimport { useToast } from '@/components/Toast';\n\ninterface ArticleDetailScreenProps {\n  route: {\n    params: {\n      articleId: string;\n    };\n  };\n  navigation: any;\n}\n\nexport default function ArticleDetailScreen({\n  route,\n  navigation,\n}: ArticleDetailScreenProps) {\n  const { articleId } = route.params;\n  const insets = useSafeAreaInsets();\n  const toast = useToast();\n\n  const { data: article, isLoading, error } = useArticleDetail(articleId);\n  const toggleBookmark = useToggleBookmark();\n\n  const handleBack = useCallback(() => {\n    navigation.goBack();\n  }, [navigation]);\n\n  const handleBookmark = useCallback(async () => {\n    if (!article) return;\n\n    try {\n      await toggleBookmark.mutateAsync(articleId);\n      toast.success(\n        article.isBookmarked ? 'Removed from saved' : 'Article saved'\n      );\n    } catch {\n      toast.error('Failed to update bookmark');\n    }\n  }, [article, articleId, toggleBookmark, toast]);\n\n  const handleShare = useCallback(async () => {\n    if (!article) return;\n\n    try {\n      await Share.share({\n        title: article.title,\n        message: `${article.title}\\n\\nRead more: ${article.sourceUrl || 'https://medinvest.app'}`,\n      });\n    } catch {\n      // User cancelled or error\n    }\n  }, [article]);\n\n  const handleOpenSource = useCallback(() => {\n    if (article?.sourceUrl) {\n      Linking.openURL(article.sourceUrl);\n    }\n  }, [article]);\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <View style={[styles.container, { paddingTop: insets.top }]}>\n        <View style={styles.header}>\n          <Pressable onPress={handleBack} style={styles.backButton}>\n            <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n          </Pressable>\n        </View>\n        <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n          <Skeleton width=\"100%\" height={220} borderRadius={0} />\n          <View style={styles.articleContent}>\n            <Skeleton width={80} height={24} style={styles.categoryBadge} />\n            <Skeleton width=\"90%\" height={28} style={styles.titleSkeleton} />\n            <Skeleton width=\"60%\" height={28} />\n            <View style={styles.metaRow}>\n              <Skeleton width={100} height={16} />\n              <Skeleton width={80} height={16} />\n            </View>\n            <View style={styles.bodySkeleton}>\n              <SkeletonText lines={4} />\n              <View style={{ height: spacing.lg }} />\n              <SkeletonText lines={5} />\n              <View style={{ height: spacing.lg }} />\n              <SkeletonText lines={3} />\n            </View>\n          </View>\n        </ScrollView>\n      </View>\n    );\n  }\n\n  if (error || !article) {\n    return (\n      <View style={[styles.container, styles.errorContainer, { paddingTop: insets.top }]}>\n        <Feather name=\"alert-circle\" size={48} color={colors.text.tertiary} />\n        <Text style={styles.errorTitle}>Unable to load article</Text>\n        <Text style={styles.errorMessage}>\n          Something went wrong. Please try again.\n        </Text>\n        <Button variant=\"outline\" onPress={handleBack} leftIcon=\"arrow-left\">\n          Go Back\n        </Button>\n      </View>\n    );\n  }\n\n  return (\n    <View style={[styles.container, { paddingTop: insets.top }]}>\n      {/* Header */}\n      <View style={styles.header}>\n        <Pressable onPress={handleBack} style={styles.backButton} hitSlop={8}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        \n        <View style={styles.headerActions}>\n          <Pressable\n            onPress={handleBookmark}\n            style={styles.actionButton}\n            hitSlop={8}\n          >\n            <Feather\n              name={article.isBookmarked ? 'bookmark' : 'bookmark'}\n              size={22}\n              color={article.isBookmarked ? colors.primary.main : colors.text.primary}\n              style={article.isBookmarked ? { fill: colors.primary.main } : undefined}\n            />\n          </Pressable>\n          \n          <Pressable onPress={handleShare} style={styles.actionButton} hitSlop={8}>\n            <Feather name=\"share\" size={22} color={colors.text.primary} />\n          </Pressable>\n        </View>\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        showsVerticalScrollIndicator={false}\n        contentContainerStyle={{ paddingBottom: insets.bottom + spacing.xl }}\n      >\n        {/* Hero Image */}\n        {article.imageUrl && (\n          <Animated.View entering={FadeIn.duration(400)}>\n            <Image\n              source={{ uri: article.imageUrl }}\n              style={styles.heroImage}\n              contentFit=\"cover\"\n              transition={300}\n            />\n          </Animated.View>\n        )}\n\n        <Animated.View\n          style={styles.articleContent}\n          entering={FadeInDown.delay(200).duration(400)}\n        >\n          {/* Category & Featured Badge */}\n          <View style={styles.badgeRow}>\n            <Badge variant=\"primary\">{article.category}</Badge>\n            {article.isFeatured && (\n              <Badge variant=\"warning\" icon=\"star\">\n                Featured\n              </Badge>\n            )}\n          </View>\n\n          {/* Title */}\n          <Text style={styles.title}>{article.title}</Text>\n\n          {/* Meta Info */}\n          <View style={styles.metaRow}>\n            <View style={styles.metaItem}>\n              <Feather name=\"calendar\" size={14} color={colors.text.tertiary} />\n              <Text style={styles.metaText}>\n                {formatDate(article.publishedAt)}\n              </Text>\n            </View>\n            \n            <View style={styles.metaItem}>\n              <Feather name=\"clock\" size={14} color={colors.text.tertiary} />\n              <Text style={styles.metaText}>{article.readTime} min read</Text>\n            </View>\n            \n            <View style={styles.metaItem}>\n              <Feather name=\"eye\" size={14} color={colors.text.tertiary} />\n              <Text style={styles.metaText}>\n                {article.viewCount.toLocaleString()} views\n              </Text>\n            </View>\n          </View>\n\n          {/* Author & Source */}\n          <View style={styles.sourceRow}>\n            <View style={styles.sourceInfo}>\n              <View style={styles.sourceIcon}>\n                <Feather name=\"edit-3\" size={16} color={colors.primary.main} />\n              </View>\n              <View>\n                {article.author && (\n                  <Text style={styles.authorName}>{article.author}</Text>\n                )}\n                <Text style={styles.sourceName}>{article.source}</Text>\n              </View>\n            </View>\n            \n            {article.sourceUrl && (\n              <Pressable onPress={handleOpenSource} style={styles.sourceLink}>\n                <Text style={styles.sourceLinkText}>View Source</Text>\n                <Feather\n                  name=\"external-link\"\n                  size={14}\n                  color={colors.primary.main}\n                />\n              </Pressable>\n            )}\n          </View>\n\n          {/* Divider */}\n          <View style={styles.divider} />\n\n          {/* Summary */}\n          <Text style={styles.summary}>{article.summary}</Text>\n\n          {/* Content */}\n          {article.content && (\n            <Text style={styles.body}>{article.content}</Text>\n          )}\n\n          {/* Tags */}\n          {article.tags && article.tags.length > 0 && (\n            <View style={styles.tagsSection}>\n              <Text style={styles.tagsLabel}>Topics</Text>\n              <View style={styles.tagsContainer}>\n                {article.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"outline\" size=\"sm\">\n                    {tag}\n                  </Badge>\n                ))}\n              </View>\n            </View>\n          )}\n        </Animated.View>\n      </ScrollView>\n\n      {/* Bottom CTA */}\n      <View style={[styles.bottomBar, { paddingBottom: insets.bottom + spacing.md }]}>\n        <Button\n          variant=\"primary\"\n          onPress={handleBookmark}\n          leftIcon={article.isBookmarked ? 'check' : 'bookmark'}\n          fullWidth\n        >\n          {article.isBookmarked ? 'Saved to Library' : 'Save Article'}\n        </Button>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  \n  // Header\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.sm,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerActions: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n  },\n  actionButton: {\n    padding: spacing.xs,\n  },\n\n  // Content\n  content: {\n    flex: 1,\n  },\n  heroImage: {\n    width: '100%',\n    height: 220,\n    backgroundColor: colors.background.secondary,\n  },\n  articleContent: {\n    padding: spacing.lg,\n  },\n\n  // Badges\n  badgeRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n    marginBottom: spacing.md,\n  },\n\n  // Title\n  title: {\n    ...typography.largeTitle,\n    color: colors.text.primary,\n    marginBottom: spacing.md,\n    lineHeight: 36,\n  },\n\n  // Meta\n  metaRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flexWrap: 'wrap',\n    gap: spacing.md,\n    marginBottom: spacing.lg,\n  },\n  metaItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n  },\n  metaText: {\n    ...typography.caption,\n    color: colors.text.tertiary,\n  },\n\n  // Source\n  sourceRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: colors.background.secondary,\n    padding: spacing.md,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.lg,\n  },\n  sourceInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n  },\n  sourceIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: colors.transparent.primary10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  authorName: {\n    ...typography.captionMedium,\n    color: colors.text.primary,\n  },\n  sourceName: {\n    ...typography.caption,\n    color: colors.text.secondary,\n  },\n  sourceLink: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.xs,\n  },\n  sourceLinkText: {\n    ...typography.caption,\n    color: colors.primary.main,\n  },\n\n  // Divider\n  divider: {\n    height: 1,\n    backgroundColor: colors.border.light,\n    marginBottom: spacing.lg,\n  },\n\n  // Body\n  summary: {\n    ...typography.body,\n    color: colors.text.primary,\n    fontWeight: '500',\n    lineHeight: 26,\n    marginBottom: spacing.lg,\n  },\n  body: {\n    ...typography.body,\n    color: colors.text.secondary,\n    lineHeight: 26,\n  },\n\n  // Tags\n  tagsSection: {\n    marginTop: spacing.xl,\n    paddingTop: spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n  },\n  tagsLabel: {\n    ...typography.captionMedium,\n    color: colors.text.secondary,\n    marginBottom: spacing.sm,\n  },\n  tagsContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: spacing.sm,\n  },\n\n  // Bottom Bar\n  bottomBar: {\n    paddingHorizontal: spacing.lg,\n    paddingTop: spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: colors.border.light,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Skeleton\n  categoryBadge: {\n    marginBottom: spacing.md,\n  },\n  titleSkeleton: {\n    marginBottom: spacing.sm,\n  },\n  bodySkeleton: {\n    marginTop: spacing.lg,\n  },\n\n  // Error\n  errorContainer: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: spacing.xl,\n  },\n  errorTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginTop: spacing.lg,\n    marginBottom: spacing.sm,\n  },\n  errorMessage: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n    marginBottom: spacing.xl,\n  },\n});\n","path":null,"size_bytes":12877,"size_tokens":null},"client/App.tsx":{"content":"/**\n * MedInvest Mobile App\n * Healthcare Investment Community Platform\n */\n\nimport React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { KeyboardProvider } from \"react-native-keyboard-controller\";\nimport { SafeAreaProvider } from \"react-native-safe-area-context\";\nimport { StatusBar } from \"expo-status-bar\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\n\nimport { queryClient } from \"@/lib/query-client\";\nimport RootNavigator from \"@/navigation/RootNavigator\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { NetworkProvider } from \"@/components/NetworkStatus\";\nimport { ThemeProvider, useThemeContext } from \"@/contexts/ThemeContext\";\n\nfunction AppContent() {\n  const { isDark } = useThemeContext();\n  \n  return (\n    <>\n      <RootNavigator />\n      <StatusBar style={isDark ? \"light\" : \"dark\"} />\n    </>\n  );\n}\n\nexport default function App() {\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <ThemeProvider>\n          <AuthProvider>\n            <NetworkProvider>\n              <SafeAreaProvider>\n                <GestureHandlerRootView style={styles.root}>\n                  <KeyboardProvider>\n                    <AppContent />\n                  </KeyboardProvider>\n                </GestureHandlerRootView>\n              </SafeAreaProvider>\n            </NetworkProvider>\n          </AuthProvider>\n        </ThemeProvider>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n\nconst styles = StyleSheet.create({\n  root: {\n    flex: 1,\n  },\n});\n","path":null,"size_bytes":1676,"size_tokens":null},"client/screens/OnboardingScreen.tsx":{"content":"/**\n * Onboarding Screen\n * First-time user welcome flow\n */\n\nimport React, { useState, useRef, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Dimensions,\n  TouchableOpacity,\n  FlatList,\n  Animated,\n  Image,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\nconst ONBOARDING_COMPLETE_KEY = 'onboarding_complete';\n\ninterface OnboardingSlide {\n  id: string;\n  title: string;\n  description: string;\n  icon: string;\n  iconType: 'ionicons' | 'material';\n  gradient: string[];\n}\n\nconst SLIDES: OnboardingSlide[] = [\n  {\n    id: '1',\n    title: 'Welcome to MedInvest',\n    description: 'The premier community for healthcare investors. Connect with experts, discover opportunities, and grow your portfolio.',\n    icon: 'medical',\n    iconType: 'ionicons',\n    gradient: [Colors.primary, '#1565C0'],\n  },\n  {\n    id: '2',\n    title: 'Expert Community',\n    description: 'Join 14 specialty rooms covering Biotech, MedTech, Pharma, Digital Health, and more. Learn from industry professionals.',\n    icon: 'people',\n    iconType: 'ionicons',\n    gradient: ['#7C4DFF', '#651FFF'],\n  },\n  {\n    id: '3',\n    title: 'Investment Deals',\n    description: 'Access exclusive healthcare investment opportunities. From early-stage startups to growth-stage companies.',\n    icon: 'trending-up',\n    iconType: 'ionicons',\n    gradient: [Colors.secondary, '#00897B'],\n  },\n  {\n    id: '4',\n    title: 'AI-Powered Insights',\n    description: 'Get instant answers about healthcare investments with our AI assistant. Due diligence made simple.',\n    icon: 'robot',\n    iconType: 'material',\n    gradient: ['#FF6F00', '#FF8F00'],\n  },\n  {\n    id: '5',\n    title: 'Earn & Learn',\n    description: 'Earn points for engaging, unlock achievements, and climb the leaderboard while expanding your investment knowledge.',\n    icon: 'trophy',\n    iconType: 'ionicons',\n    gradient: ['#FFD600', '#FFAB00'],\n  },\n];\n\nexport default function OnboardingScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const flatListRef = useRef<FlatList>(null);\n  const scrollX = useRef(new Animated.Value(0)).current;\n  \n  const [currentIndex, setCurrentIndex] = useState(0);\n\n  const handleNext = useCallback(() => {\n    if (currentIndex < SLIDES.length - 1) {\n      flatListRef.current?.scrollToIndex({\n        index: currentIndex + 1,\n        animated: true,\n      });\n    } else {\n      handleComplete();\n    }\n  }, [currentIndex]);\n\n  const handleSkip = useCallback(() => {\n    handleComplete();\n  }, []);\n\n  const handleComplete = useCallback(async () => {\n    try {\n      await AsyncStorage.setItem(ONBOARDING_COMPLETE_KEY, 'true');\n    } catch (error) {\n      console.error('Error saving onboarding status:', error);\n    }\n    \n    navigation.reset({\n      index: 0,\n      routes: [{ name: 'Auth' }],\n    });\n  }, [navigation]);\n\n  const handleViewableItemsChanged = useRef(\n    ({ viewableItems }: { viewableItems: Array<{ index: number | null }> }) => {\n      if (viewableItems.length > 0 && viewableItems[0].index !== null) {\n        setCurrentIndex(viewableItems[0].index);\n      }\n    }\n  ).current;\n\n  const renderSlide = ({ item, index }: { item: OnboardingSlide; index: number }) => {\n    const inputRange = [\n      (index - 1) * SCREEN_WIDTH,\n      index * SCREEN_WIDTH,\n      (index + 1) * SCREEN_WIDTH,\n    ];\n\n    const scale = scrollX.interpolate({\n      inputRange,\n      outputRange: [0.8, 1, 0.8],\n      extrapolate: 'clamp',\n    });\n\n    const opacity = scrollX.interpolate({\n      inputRange,\n      outputRange: [0.4, 1, 0.4],\n      extrapolate: 'clamp',\n    });\n\n    return (\n      <View style={styles.slide}>\n        <Animated.View style={[styles.iconContainer, { transform: [{ scale }], opacity }]}>\n          <LinearGradient\n            colors={item.gradient}\n            style={styles.iconGradient}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n          >\n            {item.iconType === 'material' ? (\n              <MaterialCommunityIcons name={item.icon as any} size={80} color=\"white\" />\n            ) : (\n              <Ionicons name={item.icon as any} size={80} color=\"white\" />\n            )}\n          </LinearGradient>\n        </Animated.View>\n\n        <Animated.View style={{ opacity }}>\n          <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>{item.title}</ThemedText>\n          <ThemedText style={[styles.description, { color: appColors.textSecondary }]}>{item.description}</ThemedText>\n        </Animated.View>\n      </View>\n    );\n  };\n\n  const renderDots = () => (\n    <View style={styles.dotsContainer}>\n      {SLIDES.map((_, index) => {\n        const inputRange = [\n          (index - 1) * SCREEN_WIDTH,\n          index * SCREEN_WIDTH,\n          (index + 1) * SCREEN_WIDTH,\n        ];\n\n        const dotWidth = scrollX.interpolate({\n          inputRange,\n          outputRange: [8, 24, 8],\n          extrapolate: 'clamp',\n        });\n\n        const dotOpacity = scrollX.interpolate({\n          inputRange,\n          outputRange: [0.3, 1, 0.3],\n          extrapolate: 'clamp',\n        });\n\n        return (\n          <Animated.View\n            key={index}\n            style={[\n              styles.dot,\n              {\n                width: dotWidth,\n                opacity: dotOpacity,\n              },\n            ]}\n          />\n        );\n      })}\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]}>\n      {/* Skip Button */}\n      <TouchableOpacity style={styles.skipButton} onPress={handleSkip}>\n        <ThemedText style={[styles.skipText, { color: appColors.textSecondary }]}>Skip</ThemedText>\n      </TouchableOpacity>\n\n      {/* Slides */}\n      <Animated.FlatList\n        ref={flatListRef}\n        data={SLIDES}\n        renderItem={renderSlide}\n        keyExtractor={(item) => item.id}\n        horizontal\n        pagingEnabled\n        showsHorizontalScrollIndicator={false}\n        onScroll={Animated.event(\n          [{ nativeEvent: { contentOffset: { x: scrollX } } }],\n          { useNativeDriver: true }\n        )}\n        scrollEventThrottle={16}\n        onViewableItemsChanged={handleViewableItemsChanged}\n        viewabilityConfig={{\n          itemVisiblePercentThreshold: 50,\n        }}\n      />\n\n      {/* Bottom Section */}\n      <View style={styles.bottomSection}>\n        {renderDots()}\n\n        <TouchableOpacity style={styles.nextButton} onPress={handleNext}>\n          <LinearGradient\n            colors={[Colors.primary, Colors.secondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={styles.nextButtonGradient}\n          >\n            <ThemedText style={styles.nextButtonText}>\n              {currentIndex === SLIDES.length - 1 ? 'Get Started' : 'Next'}\n            </ThemedText>\n            <Ionicons\n              name={currentIndex === SLIDES.length - 1 ? 'checkmark' : 'arrow-forward'}\n              size={20}\n              color=\"white\"\n            />\n          </LinearGradient>\n        </TouchableOpacity>\n\n        {/* Sign In Link */}\n        <TouchableOpacity style={styles.signInLink} onPress={handleComplete}>\n          <ThemedText style={[styles.signInText, { color: appColors.textSecondary }]}>\n            Already have an account? <ThemedText style={styles.signInTextBold}>Sign In</ThemedText>\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n    </SafeAreaView>\n  );\n}\n\n/**\n * Check if onboarding has been completed\n */\nexport async function hasCompletedOnboarding(): Promise<boolean> {\n  try {\n    const completed = await AsyncStorage.getItem(ONBOARDING_COMPLETE_KEY);\n    return completed === 'true';\n  } catch (error) {\n    return false;\n  }\n}\n\n/**\n * Reset onboarding status (for testing)\n */\nexport async function resetOnboarding(): Promise<void> {\n  try {\n    await AsyncStorage.removeItem(ONBOARDING_COMPLETE_KEY);\n  } catch (error) {\n    console.error('Error resetting onboarding:', error);\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  skipButton: {\n    position: 'absolute',\n    top: 60,\n    right: Spacing.lg,\n    zIndex: 10,\n    padding: Spacing.sm,\n  },\n  skipText: {\n    ...Typography.body,\n  },\n  slide: {\n    width: SCREEN_WIDTH,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: Spacing.xl,\n    paddingTop: SCREEN_HEIGHT * 0.1,\n  },\n  iconContainer: {\n    marginBottom: Spacing['3xl'],\n  },\n  iconGradient: {\n    width: 160,\n    height: 160,\n    borderRadius: 80,\n    alignItems: 'center',\n    justifyContent: 'center',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 10 },\n    shadowOpacity: 0.3,\n    shadowRadius: 20,\n    elevation: 10,\n  },\n  title: {\n    ...Typography.largeTitle,\n    textAlign: 'center',\n    marginBottom: Spacing.lg,\n  },\n  description: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 26,\n    paddingHorizontal: Spacing.md,\n  },\n  bottomSection: {\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.xl,\n  },\n  dotsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  dot: {\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: Colors.primary,\n    marginHorizontal: 4,\n  },\n  nextButton: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    marginBottom: Spacing.lg,\n  },\n  nextButtonGradient: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  nextButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  signInLink: {\n    alignItems: 'center',\n    paddingVertical: Spacing.sm,\n  },\n  signInText: {\n    ...Typography.body,\n  },\n  signInTextBold: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":10395,"size_tokens":null},"client/components/ThemedView.tsx":{"content":"import { View, type ViewProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\n\nexport type ThemedViewProps = ViewProps & {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport function ThemedView({\n  style,\n  lightColor,\n  darkColor,\n  ...otherProps\n}: ThemedViewProps) {\n  const { theme, isDark } = useTheme();\n\n  const backgroundColor =\n    isDark && darkColor\n      ? darkColor\n      : !isDark && lightColor\n        ? lightColor\n        : theme.backgroundRoot;\n\n  return <View style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","path":null,"size_bytes":563,"size_tokens":null},"packages/shared/src/utils/index.ts":{"content":"/**\n * @medinvest/shared - Utilities\n * \n * Common utility functions used by both web and mobile apps.\n */\n\n// =============================================================================\n// DATE & TIME FORMATTING\n// =============================================================================\n\n/**\n * Format a date as relative time (e.g., \"2h ago\", \"3d\")\n */\nexport function formatRelativeTime(date: string | Date): string {\n  const now = new Date();\n  const then = new Date(date);\n  const seconds = Math.floor((now.getTime() - then.getTime()) / 1000);\n\n  if (seconds < 0) return 'just now';\n  if (seconds < 60) return 'just now';\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h`;\n  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d`;\n  if (seconds < 2592000) return `${Math.floor(seconds / 604800)}w`;\n\n  return then.toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n  });\n}\n\n/**\n * Format a date as full date string\n */\nexport function formatDate(date: string | Date): string {\n  return new Date(date).toLocaleDateString(undefined, {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n  });\n}\n\n/**\n * Format a date as short date\n */\nexport function formatShortDate(date: string | Date): string {\n  return new Date(date).toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n  });\n}\n\n/**\n * Format time (e.g., \"3:45 PM\")\n */\nexport function formatTime(date: string | Date): string {\n  return new Date(date).toLocaleTimeString(undefined, {\n    hour: 'numeric',\n    minute: '2-digit',\n  });\n}\n\n/**\n * Format date and time\n */\nexport function formatDateTime(date: string | Date): string {\n  return new Date(date).toLocaleString(undefined, {\n    month: 'short',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: '2-digit',\n  });\n}\n\n/**\n * Get time remaining until a date (for polls, deadlines)\n */\nexport function getTimeRemaining(endDate: string | Date): string {\n  const now = new Date();\n  const end = new Date(endDate);\n  const diff = end.getTime() - now.getTime();\n\n  if (diff <= 0) return 'Ended';\n\n  const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n  const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n  if (days > 0) return `${days}d ${hours}h left`;\n  if (hours > 0) return `${hours}h ${minutes}m left`;\n  return `${minutes}m left`;\n}\n\n// =============================================================================\n// NUMBER FORMATTING\n// =============================================================================\n\n/**\n * Format number in compact form (e.g., 1.2K, 3.4M)\n */\nexport function formatCompactNumber(num: number): string {\n  if (num >= 1000000) {\n    return `${(num / 1000000).toFixed(1).replace(/\\.0$/, '')}M`;\n  }\n  if (num >= 1000) {\n    return `${(num / 1000).toFixed(1).replace(/\\.0$/, '')}K`;\n  }\n  return num.toString();\n}\n\n/**\n * Format currency\n */\nexport function formatCurrency(\n  amount: number,\n  currency = 'USD',\n  compact = false\n): string {\n  if (compact) {\n    if (amount >= 1000000) {\n      return `$${(amount / 1000000).toFixed(1)}M`;\n    }\n    if (amount >= 1000) {\n      return `$${(amount / 1000).toFixed(0)}K`;\n    }\n  }\n\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency,\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  }).format(amount);\n}\n\n/**\n * Format percentage\n */\nexport function formatPercentage(value: number, decimals = 1): string {\n  return `${value >= 0 ? '+' : ''}${value.toFixed(decimals)}%`;\n}\n\n/**\n * Format file size\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;\n}\n\n// =============================================================================\n// STRING UTILITIES\n// =============================================================================\n\n/**\n * Extract @mentions from text\n */\nexport function extractMentions(content: string): string[] {\n  const regex = /@(\\w+)/g;\n  const matches = content.match(regex);\n  return matches ? [...new Set(matches.map((m) => m.slice(1)))] : [];\n}\n\n/**\n * Extract #hashtags from text\n */\nexport function extractHashtags(content: string): string[] {\n  const regex = /#(\\w+)/g;\n  const matches = content.match(regex);\n  return matches ? [...new Set(matches.map((m) => m.slice(1).toLowerCase()))] : [];\n}\n\n/**\n * Extract URLs from text\n */\nexport function extractUrls(content: string): string[] {\n  const regex = /(https?:\\/\\/[^\\s]+)/g;\n  const matches = content.match(regex);\n  return matches ? [...new Set(matches)] : [];\n}\n\n/**\n * Truncate text with ellipsis\n */\nexport function truncate(text: string, maxLength: number): string {\n  if (text.length <= maxLength) return text;\n  return text.slice(0, maxLength - 3).trim() + '...';\n}\n\n/**\n * Capitalize first letter\n */\nexport function capitalize(text: string): string {\n  return text.charAt(0).toUpperCase() + text.slice(1);\n}\n\n/**\n * Convert to title case\n */\nexport function toTitleCase(text: string): string {\n  return text\n    .toLowerCase()\n    .split(' ')\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n}\n\n/**\n * Generate initials from name\n */\nexport function getInitials(name: string): string {\n  return name\n    .split(' ')\n    .map((word) => word.charAt(0))\n    .join('')\n    .toUpperCase()\n    .slice(0, 2);\n}\n\n/**\n * Slugify text\n */\nexport function slugify(text: string): string {\n  return text\n    .toLowerCase()\n    .replace(/[^\\w\\s-]/g, '')\n    .replace(/[\\s_-]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n}\n\n// =============================================================================\n// VALIDATION HELPERS\n// =============================================================================\n\n/**\n * Check if email is valid\n */\nexport function isValidEmail(email: string): boolean {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n\n/**\n * Check if password is strong\n */\nexport function isStrongPassword(password: string): boolean {\n  return (\n    password.length >= 8 &&\n    /[A-Z]/.test(password) &&\n    /[a-z]/.test(password) &&\n    /[0-9]/.test(password)\n  );\n}\n\n/**\n * Check if username is valid\n */\nexport function isValidUsername(username: string): boolean {\n  return /^[a-zA-Z0-9_]{3,30}$/.test(username);\n}\n\n/**\n * Check if URL is valid\n */\nexport function isValidUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n// =============================================================================\n// CONTENT FILTERING\n// =============================================================================\n\n/**\n * Check if content contains muted keywords\n */\nexport function containsMutedKeywords(\n  content: string,\n  keywords: string[]\n): boolean {\n  if (keywords.length === 0) return false;\n  const lowerContent = content.toLowerCase();\n  return keywords.some((keyword) =>\n    lowerContent.includes(keyword.toLowerCase())\n  );\n}\n\n/**\n * Filter posts by muted keywords\n */\nexport function filterByMutedKeywords<T extends { content: string }>(\n  items: T[],\n  keywords: string[]\n): T[] {\n  if (keywords.length === 0) return items;\n  return items.filter((item) => !containsMutedKeywords(item.content, keywords));\n}\n\n// =============================================================================\n// ARRAY UTILITIES\n// =============================================================================\n\n/**\n * Remove duplicates from array by key\n */\nexport function uniqueBy<T>(array: T[], key: keyof T): T[] {\n  const seen = new Set();\n  return array.filter((item) => {\n    const value = item[key];\n    if (seen.has(value)) return false;\n    seen.add(value);\n    return true;\n  });\n}\n\n/**\n * Group array by key\n */\nexport function groupBy<T>(array: T[], key: keyof T): Record<string, T[]> {\n  return array.reduce((acc, item) => {\n    const groupKey = String(item[key]);\n    if (!acc[groupKey]) acc[groupKey] = [];\n    acc[groupKey].push(item);\n    return acc;\n  }, {} as Record<string, T[]>);\n}\n\n/**\n * Sort array by key\n */\nexport function sortBy<T>(\n  array: T[],\n  key: keyof T,\n  order: 'asc' | 'desc' = 'asc'\n): T[] {\n  return [...array].sort((a, b) => {\n    const aVal = a[key];\n    const bVal = b[key];\n    if (aVal < bVal) return order === 'asc' ? -1 : 1;\n    if (aVal > bVal) return order === 'asc' ? 1 : -1;\n    return 0;\n  });\n}\n\n// =============================================================================\n// ID GENERATION\n// =============================================================================\n\n/**\n * Generate a unique ID\n */\nexport function generateId(): string {\n  return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n/**\n * Generate a UUID v4\n */\nexport function generateUUID(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n// =============================================================================\n// DEBOUNCE & THROTTLE\n// =============================================================================\n\n/**\n * Debounce function\n */\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: ReturnType<typeof setTimeout> | null = null;\n\n  return (...args: Parameters<T>) => {\n    if (timeout) clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Throttle function\n */\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => (inThrottle = false), limit);\n    }\n  };\n}\n\n// =============================================================================\n// ASYNC HELPERS\n// =============================================================================\n\n/**\n * Sleep for a given duration\n */\nexport function sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Retry a function with exponential backoff\n */\nexport async function retry<T>(\n  fn: () => Promise<T>,\n  maxRetries = 3,\n  baseDelay = 1000\n): Promise<T> {\n  let lastError: Error;\n\n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error as Error;\n      if (i < maxRetries - 1) {\n        await sleep(baseDelay * Math.pow(2, i));\n      }\n    }\n  }\n\n  throw lastError!;\n}\n","path":null,"size_bytes":10893,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"node:http\";\nimport { registerChatRoutes } from \"./replit_integrations/chat\";\n\nimport authRoutes from './routes/auth';\nimport investmentsRoutes from './routes/investments';\nimport portfolioRoutes from './routes/portfolio';\nimport articlesRoutes from './routes/articles';\nimport usersRoutes from './routes/users';\nimport aiRoutes from './routes/ai';\nimport postsRoutes from './routes/posts';\nimport roomsRoutes from './routes/rooms';\nimport dealsRoutes from './routes/deals';\nimport notificationsRoutes from './routes/notifications';\nimport messagesRoutes from './routes/messages';\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  registerChatRoutes(app);\n\n  app.get('/api/health', (req, res) => {\n    res.json({ status: 'ok', timestamp: new Date().toISOString() });\n  });\n\n  app.use('/api/auth', authRoutes);\n  app.use('/api/investments', investmentsRoutes);\n  app.use('/api/portfolio', portfolioRoutes);\n  app.use('/api/articles', articlesRoutes);\n  app.use('/api/users', usersRoutes);\n  app.use('/api/ai', aiRoutes);\n  app.use('/api/posts', postsRoutes);\n  app.use('/api/rooms', roomsRoutes);\n  app.use('/api/deals', dealsRoutes);\n  app.use('/api/notifications', notificationsRoutes);\n  app.use('/api/messages', messagesRoutes);\n  \n  // Feed aliases - redirect to postsRoutes feed endpoints\n  app.get('/api/feed', (req, res, next) => {\n    req.url = '/feed';\n    postsRoutes(req, res, next);\n  });\n  app.get('/api/feed/trending', (req, res, next) => {\n    req.url = '/feed/trending';\n    postsRoutes(req, res, next);\n  });\n\n  app.get('/api/oauth-debug', (req, res) => {\n    const forwardedProto = req.header('x-forwarded-proto') || req.protocol || 'https';\n    const forwardedHost = req.header('x-forwarded-host') || req.get('host');\n    const currentOrigin = `${forwardedProto}://${forwardedHost}`;\n    const callbackUri = `${currentOrigin}/api/auth/callback`;\n    const devDomain = process.env.REPLIT_DEV_DOMAIN;\n    const pubDomains = process.env.REPLIT_DOMAINS;\n    const uris: string[] = [callbackUri];\n    if (devDomain) uris.push(`https://${devDomain}/api/auth/callback`);\n    if (pubDomains) {\n      for (const d of pubDomains.split(',')) {\n        const u = `https://${d.trim()}/api/auth/callback`;\n        if (!uris.includes(u)) uris.push(u);\n      }\n    }\n    for (const d of ['themedicineandmoneyshow.com', 'medinvest-mobile--rsmolarz.replit.app']) {\n      const u = `https://${d}/api/auth/callback`;\n      if (!uris.includes(u)) uris.push(u);\n    }\n    const origins = [...new Set(uris.map(u => u.replace('/api/auth/callback', '')))];\n    res.send(`<!DOCTYPE html><html><head><title>OAuth Debug</title>\n    <style>body{font-family:system-ui;max-width:800px;margin:40px auto;padding:20px;background:#1a1a2e;color:#e0e0e0}\n    h1{color:#00a86b}h2{color:#0066cc;margin-top:20px}code{background:#2d2d44;padding:4px 8px;border-radius:4px;display:block;margin:5px 0;word-break:break-all;font-size:14px}\n    .s{background:#2d2d44;padding:15px;border-radius:8px;margin:10px 0}\n    .ok{color:#00a86b}.miss{color:#cc4444}</style></head>\n    <body><h1>OAuth Redirect URI Setup Guide</h1>\n    <div class=\"s\"><h2>Step 1: Copy These Redirect URIs</h2>\n    <p>Add ALL of these to each OAuth provider:</p>\n    ${uris.map(u => `<code>${u}</code>`).join('')}</div>\n    <div class=\"s\"><h2>Step 2: Google Cloud Console</h2>\n    <p><a href=\"https://console.cloud.google.com/apis/credentials\" style=\"color:#00a86b\">Open Google Cloud Console</a></p>\n    <p><b>Authorized JavaScript Origins:</b></p>\n    ${origins.map(u => `<code>${u}</code>`).join('')}\n    <p><b>Authorized Redirect URIs:</b></p>\n    ${uris.map(u => `<code>${u}</code>`).join('')}\n    <p><b>IMPORTANT:</b> OAuth consent screen must be \"External\" type. If in \"Testing\" mode, add your Google email as a test user.</p></div>\n    <div class=\"s\"><h2>Step 3: GitHub Developer Settings</h2>\n    <p><a href=\"https://github.com/settings/developers\" style=\"color:#00a86b\">Open GitHub Developer Settings</a></p>\n    <p><b>Authorization callback URL:</b> (only supports ONE)</p>\n    <code>${callbackUri}</code></div>\n    <div class=\"s\"><h2>Step 4: Facebook Developers</h2>\n    <p><a href=\"https://developers.facebook.com\" style=\"color:#00a86b\">Open Facebook Developers</a> ‚Üí Your App ‚Üí Use Cases ‚Üí Facebook Login ‚Üí Customize ‚Üí Settings</p>\n    <p><b>Valid OAuth Redirect URIs:</b></p>\n    ${uris.map(u => `<code>${u}</code>`).join('')}</div>\n    <div class=\"s\"><h2>Provider Credentials Status</h2>\n    <p>Google: <span class=\"${process.env.GOOGLE_WEB_CLIENT_ID || process.env.EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID ? 'ok' : 'miss'}\">${process.env.GOOGLE_WEB_CLIENT_ID || process.env.EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID ? 'Configured' : 'Missing'}</span></p>\n    <p>GitHub: <span class=\"${process.env.GITHUB_CLIENT_ID || process.env.EXPO_PUBLIC_GITHUB_CLIENT_ID ? 'ok' : 'miss'}\">${process.env.GITHUB_CLIENT_ID || process.env.EXPO_PUBLIC_GITHUB_CLIENT_ID ? 'Configured' : 'Missing'}</span></p>\n    <p>Facebook: <span class=\"${process.env.FACEBOOK_APP_ID || process.env.EXPO_PUBLIC_FACEBOOK_APP_ID ? 'ok' : 'miss'}\">${process.env.FACEBOOK_APP_ID || process.env.EXPO_PUBLIC_FACEBOOK_APP_ID ? 'Configured' : 'Missing'}</span></p></div>\n    </body></html>`);\n  });\n\n  app.use('/api/*', (req, res) => {\n    res.status(404).json({ message: 'Endpoint not found' });\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":5482,"size_tokens":null},"server/replit_integrations/chat/storage.ts":{"content":"import { db } from \"../../db\";\nimport { conversations, messages } from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\n\nexport interface IChatStorage {\n  getConversation(id: number): Promise<typeof conversations.$inferSelect | undefined>;\n  getAllConversations(): Promise<(typeof conversations.$inferSelect)[]>;\n  createConversation(title: string): Promise<typeof conversations.$inferSelect>;\n  deleteConversation(id: number): Promise<void>;\n  getMessagesByConversation(conversationId: number): Promise<(typeof messages.$inferSelect)[]>;\n  createMessage(conversationId: number, role: string, content: string): Promise<typeof messages.$inferSelect>;\n}\n\nexport const chatStorage: IChatStorage = {\n  async getConversation(id: number) {\n    const [conversation] = await db.select().from(conversations).where(eq(conversations.id, id));\n    return conversation;\n  },\n\n  async getAllConversations() {\n    return db.select().from(conversations).orderBy(desc(conversations.createdAt));\n  },\n\n  async createConversation(title: string) {\n    const [conversation] = await db.insert(conversations).values({ title }).returning();\n    return conversation;\n  },\n\n  async deleteConversation(id: number) {\n    await db.delete(messages).where(eq(messages.conversationId, id));\n    await db.delete(conversations).where(eq(conversations.id, id));\n  },\n\n  async getMessagesByConversation(conversationId: number) {\n    return db.select().from(messages).where(eq(messages.conversationId, conversationId)).orderBy(messages.createdAt);\n  },\n\n  async createMessage(conversationId: number, role: string, content: string) {\n    const [message] = await db.insert(messages).values({ conversationId, role, content }).returning();\n    return message;\n  },\n};\n\n","path":null,"size_bytes":1737,"size_tokens":null},"client/hooks/useSearch.ts":{"content":"import { useState, useEffect, useCallback, useRef } from 'react';\nimport { Keyboard } from 'react-native';\n\n/**\n * Debounce hook - delays value updates\n */\nexport function useDebounce<T>(value: T, delay: number = 500): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}\n\n/**\n * Debounced callback hook\n */\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\n  callback: T,\n  delay: number = 500\n): T {\n  const timeoutRef = useRef<NodeJS.Timeout>();\n\n  const debouncedCallback = useCallback(\n    (...args: Parameters<T>) => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      timeoutRef.current = setTimeout(() => {\n        callback(...args);\n      }, delay);\n    },\n    [callback, delay]\n  ) as T;\n\n  useEffect(() => {\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, []);\n\n  return debouncedCallback;\n}\n\n/**\n * Search state hook with debouncing\n */\nexport function useSearch(initialValue: string = '', delay: number = 400) {\n  const [query, setQuery] = useState(initialValue);\n  const [isSearching, setIsSearching] = useState(false);\n  const debouncedQuery = useDebounce(query, delay);\n\n  useEffect(() => {\n    setIsSearching(query !== debouncedQuery);\n  }, [query, debouncedQuery]);\n\n  const clearSearch = useCallback(() => {\n    setQuery('');\n    Keyboard.dismiss();\n  }, []);\n\n  return {\n    query,\n    setQuery,\n    debouncedQuery,\n    isSearching,\n    clearSearch,\n    hasQuery: query.length > 0,\n  };\n}\n\n/**\n * Infinite scroll hook for FlatList\n */\nexport function useInfiniteScroll({\n  hasNextPage,\n  isFetchingNextPage,\n  fetchNextPage,\n}: {\n  hasNextPage?: boolean;\n  isFetchingNextPage: boolean;\n  fetchNextPage: () => void;\n}) {\n  const handleEndReached = useCallback(() => {\n    if (hasNextPage && !isFetchingNextPage) {\n      fetchNextPage();\n    }\n  }, [hasNextPage, isFetchingNextPage, fetchNextPage]);\n\n  return {\n    onEndReached: handleEndReached,\n    onEndReachedThreshold: 0.5,\n  };\n}\n\n/**\n * Pull to refresh hook\n */\nexport function useRefresh(refetch: () => Promise<any>) {\n  const [refreshing, setRefreshing] = useState(false);\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    try {\n      await refetch();\n    } finally {\n      setRefreshing(false);\n    }\n  }, [refetch]);\n\n  return {\n    refreshing,\n    onRefresh,\n  };\n}\n\n/**\n * Combined list hook for infinite scroll with refresh\n */\nexport function useInfiniteList<T>({\n  data,\n  isLoading,\n  isRefetching,\n  hasNextPage,\n  isFetchingNextPage,\n  fetchNextPage,\n  refetch,\n}: {\n  data?: { pages: { data: T[] }[] };\n  isLoading: boolean;\n  isRefetching: boolean;\n  hasNextPage?: boolean;\n  isFetchingNextPage: boolean;\n  fetchNextPage: () => void;\n  refetch: () => Promise<any>;\n}) {\n  // Flatten paginated data\n  const flatData = data?.pages.flatMap((page) => page.data) ?? [];\n\n  // Pull to refresh\n  const { refreshing, onRefresh } = useRefresh(refetch);\n\n  // Infinite scroll\n  const { onEndReached, onEndReachedThreshold } = useInfiniteScroll({\n    hasNextPage,\n    isFetchingNextPage,\n    fetchNextPage,\n  });\n\n  return {\n    data: flatData,\n    isLoading,\n    isRefetching,\n    refreshing,\n    onRefresh,\n    onEndReached,\n    onEndReachedThreshold,\n    isFetchingNextPage,\n    hasNextPage,\n    isEmpty: !isLoading && flatData.length === 0,\n  };\n}\n\n/**\n * Previous value hook\n */\nexport function usePrevious<T>(value: T): T | undefined {\n  const ref = useRef<T>();\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n}\n\n/**\n * Mounted state hook\n */\nexport function useMounted(): boolean {\n  const mounted = useRef(false);\n\n  useEffect(() => {\n    mounted.current = true;\n    return () => {\n      mounted.current = false;\n    };\n  }, []);\n\n  return mounted.current;\n}\n","path":null,"size_bytes":4061,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"docs/watch-api-reference.md":{"content":"# MedInvest Apple Watch API Reference\n\n## Overview\n\nThis document provides the API reference for integrating the MedInvest Apple Watch app with the backend server. The watch app can access portfolio data, receive deal alerts, and view investment summaries.\n\n## Base URL\n\n**Development:**\n```\nhttps://sudx66ludnd9.picard.replit.dev:5000/api\n```\n\n**Production:**\n```\nhttps://your-app-name.replit.app/api\n```\n\n## Authentication\n\nAll authenticated endpoints require a JWT token in the Authorization header:\n\n```\nAuthorization: Bearer <token>\n```\n\n### Login\n\n**Endpoint:** `POST /auth/login`\n\n**Request Body:**\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"password123\"\n}\n```\n\n**Response:**\n```json\n{\n  \"token\": \"jwt_token_here\",\n  \"user\": {\n    \"id\": \"uuid\",\n    \"email\": \"user@example.com\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"avatarUrl\": \"https://...\",\n    \"isVerified\": true,\n    \"fullName\": \"John Doe\"\n  }\n}\n```\n\n### Social Login (Google/Apple/GitHub/Facebook)\n\n**Endpoint:** `POST /auth/social`\n\n**Request Body:**\n```json\n{\n  \"provider\": \"google|apple|github|facebook\",\n  \"token\": \"oauth_id_token\",\n  \"email\": \"user@example.com\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\"\n}\n```\n\n**Response:** Same as login\n\n### Token Notes\n\n- The API uses a single JWT token (no refresh token)\n- Tokens expire after 30 days\n- When token expires, the API returns `401 Unauthorized`\n- The watch app should prompt user to re-authenticate via iPhone companion app\n- Store token securely in Keychain\n\n---\n\n## Portfolio Endpoints\n\nAll portfolio endpoints require authentication.\n\n### Get Portfolio Summary\n\nPerfect for watch complications and glances.\n\n**Endpoint:** `GET /portfolio/summary`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Response:**\n```json\n{\n  \"totalValue\": 27500.00,\n  \"totalInvested\": 25000.00,\n  \"totalGainLoss\": 2500.00,\n  \"gainLossPercent\": 10.0,\n  \"activeInvestments\": 5,\n  \"completedInvestments\": 2,\n  \"pendingInvestments\": 1\n}\n```\n\n### Get Investments List\n\n**Endpoint:** `GET /portfolio/investments`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Query Parameters:**\n- `page` (optional): Page number (default: 1)\n- `limit` (optional): Items per page (default: 20, max: 50)\n- `status` (optional): Filter by status (`active`, `completed`, `pending`)\n\n**Response:**\n```json\n{\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"investmentId\": \"uuid\",\n      \"name\": \"BioTech Therapeutics\",\n      \"category\": \"Biotech\",\n      \"imageUrl\": \"https://...\",\n      \"amountInvested\": 5000.00,\n      \"currentValue\": 6250.00,\n      \"gainLossPercent\": 25.0,\n      \"status\": \"active\",\n      \"investedAt\": \"2025-06-15T10:00:00.000Z\"\n    }\n  ],\n  \"page\": 1,\n  \"limit\": 20,\n  \"totalItems\": 8,\n  \"totalPages\": 1,\n  \"hasMore\": false\n}\n```\n\n### Get Transactions\n\n**Endpoint:** `GET /portfolio/transactions`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Query Parameters:**\n- `page` (optional): Page number\n- `limit` (optional): Items per page\n- `type` (optional): Filter by type (`investment`, `dividend`, `withdrawal`)\n\n**Response:**\n```json\n{\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"type\": \"investment\",\n      \"amount\": 5000.00,\n      \"status\": \"completed\",\n      \"investmentName\": \"MedDevice Pro\",\n      \"createdAt\": \"2026-01-10T14:30:00.000Z\",\n      \"completedAt\": \"2026-01-10T14:35:00.000Z\"\n    }\n  ],\n  \"page\": 1,\n  \"limit\": 20,\n  \"totalItems\": 5,\n  \"totalPages\": 1,\n  \"hasMore\": false\n}\n```\n\n---\n\n## Investment Deals\n\n### Get Deals List\n\n**Endpoint:** `GET /investments`\n\n**Headers:** `Authorization: Bearer <token>` (optional - affects bookmark status)\n\n**Query Parameters:**\n- `page` (optional): Page number (default: 1)\n- `limit` (optional): Items per page (default: 10, max: 50)\n- `category` (optional): Filter by category\n- `riskLevel` (optional): Filter by risk level\n- `status` (optional): Filter by status (default: `active`)\n- `sortBy` (optional): `newest`, `endingSoon`, `mostFunded`, `highestROI`\n\n**Response:**\n```json\n{\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"name\": \"AI Diagnostics Platform\",\n      \"description\": \"Revolutionary AI-powered medical diagnostics\",\n      \"category\": \"Digital Health\",\n      \"imageUrl\": \"https://...\",\n      \"fundingGoal\": 500000.00,\n      \"fundingCurrent\": 325000.00,\n      \"minimumInvestment\": 1000.00,\n      \"expectedROI\": \"15-25%\",\n      \"riskLevel\": \"medium\",\n      \"status\": \"active\",\n      \"daysRemaining\": 21,\n      \"startDate\": \"2025-12-01T00:00:00.000Z\",\n      \"endDate\": \"2026-02-03T23:59:59.000Z\",\n      \"investors\": 45,\n      \"createdAt\": \"2025-12-01T00:00:00.000Z\",\n      \"updatedAt\": \"2026-01-10T00:00:00.000Z\"\n    }\n  ],\n  \"page\": 1,\n  \"limit\": 10,\n  \"totalItems\": 15,\n  \"totalPages\": 2,\n  \"hasMore\": true\n}\n```\n\n### Get Deal Details\n\n**Endpoint:** `GET /investments/:id`\n\n**Headers:** `Authorization: Bearer <token>` (optional)\n\n**Response:** Same structure as list item, plus additional fields available in the investment record.\n\n---\n\n## User Profile\n\n### Get Current User\n\n**Endpoint:** `GET /users/me`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Response:**\n```json\n{\n  \"id\": \"uuid\",\n  \"email\": \"user@example.com\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"fullName\": \"John Doe\",\n  \"avatarUrl\": \"https://...\",\n  \"isVerified\": true,\n  \"isPremium\": false,\n  \"specialty\": \"Investor\",\n  \"bio\": \"Healthcare investor focused on biotech\",\n  \"createdAt\": \"2025-01-01T00:00:00.000Z\"\n}\n```\n\n### Register Push Token\n\nFor receiving notifications on the watch.\n\n**Endpoint:** `POST /users/me/push-token`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Request Body:**\n```json\n{\n  \"token\": \"apple_push_token_here\",\n  \"platform\": \"watchos\"\n}\n```\n\nNote: `platform` is optional but recommended for filtering notifications.\n\n**Response:**\n```json\n{\n  \"message\": \"Push token registered\"\n}\n```\n\n### Remove Push Token\n\n**Endpoint:** `DELETE /users/me/push-token`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Request Body:**\n```json\n{\n  \"token\": \"apple_push_token_here\"\n}\n```\n\n**Response:**\n```json\n{\n  \"message\": \"Push token unregistered\"\n}\n```\n\n---\n\n## Messages\n\n### Get Unread Count\n\nPerfect for watch badge updates.\n\n**Endpoint:** `GET /messages/unread-count`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Response:**\n```json\n{\n  \"count\": 3\n}\n```\n\n### Get Conversations\n\n**Endpoint:** `GET /messages`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Response:**\n```json\n{\n  \"conversations\": [\n    {\n      \"id\": \"uuid\",\n      \"other_user\": {\n        \"id\": \"uuid\",\n        \"email\": \"sarah@example.com\",\n        \"first_name\": \"Sarah\",\n        \"last_name\": \"Mitchell\",\n        \"full_name\": \"Sarah Mitchell\",\n        \"avatar_url\": \"https://...\",\n        \"is_verified\": true\n      },\n      \"last_message\": \"Thanks for your investment inquiry!\",\n      \"last_message_at\": \"2026-01-13T10:30:00.000Z\",\n      \"unread_count\": 2,\n      \"is_muted\": false\n    }\n  ]\n}\n```\n\n**Note:** All fields in messages responses use `snake_case` naming convention.\n\n---\n\n## AI Assistant\n\n### Quick Chat\n\nFor watch voice interactions.\n\n**Endpoint:** `POST /ai/chat`\n\n**Headers:** `Authorization: Bearer <token>`\n\n**Request Body:**\n```json\n{\n  \"message\": \"What's my portfolio performance?\",\n  \"context\": \"watch\"\n}\n```\n\n**Response:**\n```json\n{\n  \"response\": \"Your portfolio is up 10% this month with a total value of $27,500. Your top performer is BioTech Therapeutics at +25%.\"\n}\n```\n\n---\n\n## Error Responses\n\nAll endpoints return consistent error formats:\n\n```json\n{\n  \"message\": \"Error description\"\n}\n```\n\n### Common HTTP Status Codes\n\n| Code | Meaning |\n|------|---------|\n| 200 | Success |\n| 201 | Created |\n| 400 | Bad Request - Invalid parameters |\n| 401 | Unauthorized - Invalid or expired token |\n| 403 | Forbidden - Access denied |\n| 404 | Not Found |\n| 500 | Server Error |\n\n---\n\n## Watch-Specific Recommendations\n\n### Complications\n\nUse these endpoints for complications:\n- **Portfolio Value:** `GET /portfolio/summary` ‚Üí `totalValue`\n- **Daily Change:** `GET /portfolio/summary` ‚Üí `totalGainLoss`, `gainLossPercent`\n- **Unread Messages:** `GET /messages/unread-count` ‚Üí `count`\n\n### Data Refresh Strategy\n\n- **Background refresh:** Every 15-30 minutes\n- **On wrist raise:** Check if data is older than 5 minutes\n- **Push notifications:** Use APNs for real-time deal alerts\n\n### Caching\n\nCache responses locally on the watch for offline access:\n- Portfolio summary: 5 minutes\n- Deal list: 15 minutes\n- User profile: 1 hour\n\n### WatchConnectivity\n\nFor seamless authentication, use WatchConnectivity to:\n1. Transfer JWT tokens from iPhone to Watch\n2. Sync user preferences\n3. Handle re-authentication when token expires\n\n---\n\n## Sample Swift Code\n\n### Models\n\n```swift\nimport Foundation\n\n// MARK: - Portfolio\n\nstruct PortfolioSummary: Decodable {\n    let totalValue: Double\n    let totalInvested: Double\n    let totalGainLoss: Double\n    let gainLossPercent: Double\n    let activeInvestments: Int\n    let completedInvestments: Int\n    let pendingInvestments: Int\n}\n\nstruct PortfolioInvestment: Decodable {\n    let id: String\n    let investmentId: String\n    let name: String\n    let category: String\n    let imageUrl: String?\n    let amountInvested: Double\n    let currentValue: Double\n    let gainLossPercent: Double\n    let status: String\n    let investedAt: String\n}\n\nstruct PortfolioInvestmentsResponse: Decodable {\n    let data: [PortfolioInvestment]\n    let page: Int\n    let limit: Int\n    let totalItems: Int\n    let totalPages: Int\n    let hasMore: Bool\n}\n\n// MARK: - Investments\n\nstruct Investment: Decodable {\n    let id: String\n    let name: String\n    let description: String\n    let category: String\n    let imageUrl: String?\n    let fundingGoal: Double\n    let fundingCurrent: Double\n    let minimumInvestment: Double\n    let expectedROI: String\n    let riskLevel: String\n    let status: String\n    let daysRemaining: Int\n    let investors: Int\n}\n\nstruct InvestmentsResponse: Decodable {\n    let data: [Investment]\n    let page: Int\n    let limit: Int\n    let totalItems: Int\n    let totalPages: Int\n    let hasMore: Bool\n}\n\n// MARK: - Messages\n\nstruct UnreadCountResponse: Decodable {\n    let count: Int\n}\n\nstruct ConversationUser: Decodable {\n    let id: String\n    let email: String\n    let firstName: String\n    let lastName: String\n    let fullName: String\n    let avatarUrl: String?\n    let isVerified: Bool\n    \n    enum CodingKeys: String, CodingKey {\n        case id, email\n        case firstName = \"first_name\"\n        case lastName = \"last_name\"\n        case fullName = \"full_name\"\n        case avatarUrl = \"avatar_url\"\n        case isVerified = \"is_verified\"\n    }\n}\n\nstruct Conversation: Decodable {\n    let id: String\n    let otherUser: ConversationUser\n    let lastMessage: String?\n    let lastMessageAt: String?\n    let unreadCount: Int\n    let isMuted: Bool\n    \n    enum CodingKeys: String, CodingKey {\n        case id\n        case otherUser = \"other_user\"\n        case lastMessage = \"last_message\"\n        case lastMessageAt = \"last_message_at\"\n        case unreadCount = \"unread_count\"\n        case isMuted = \"is_muted\"\n    }\n}\n\nstruct ConversationsResponse: Decodable {\n    let conversations: [Conversation]\n}\n\n// MARK: - Errors\n\nenum APIError: Error {\n    case invalidResponse\n    case unauthorized\n    case serverError(Int)\n    case decodingError(Error)\n}\n```\n\n### API Client\n\n```swift\nimport Foundation\n\nclass MedInvestAPI {\n    static let shared = MedInvestAPI()\n    \n    private let baseURL = \"https://your-app.replit.app/api\"\n    private var token: String?\n    \n    func setToken(_ token: String) {\n        self.token = token\n        KeychainHelper.save(token, forKey: \"medinvest_token\")\n    }\n    \n    func loadToken() {\n        self.token = KeychainHelper.load(forKey: \"medinvest_token\")\n    }\n    \n    func clearToken() {\n        self.token = nil\n        KeychainHelper.delete(forKey: \"medinvest_token\")\n    }\n    \n    private func makeRequest<T: Decodable>(\n        endpoint: String,\n        method: String = \"GET\",\n        body: Data? = nil\n    ) async throws -> T {\n        guard let url = URL(string: \"\\(baseURL)\\(endpoint)\") else {\n            throw APIError.invalidResponse\n        }\n        \n        var request = URLRequest(url: url)\n        request.httpMethod = method\n        request.setValue(\"application/json\", forHTTPHeaderField: \"Content-Type\")\n        \n        if let token = token {\n            request.setValue(\"Bearer \\(token)\", forHTTPHeaderField: \"Authorization\")\n        }\n        \n        if let body = body {\n            request.httpBody = body\n        }\n        \n        let (data, response) = try await URLSession.shared.data(for: request)\n        \n        guard let httpResponse = response as? HTTPURLResponse else {\n            throw APIError.invalidResponse\n        }\n        \n        if httpResponse.statusCode == 401 {\n            throw APIError.unauthorized\n        }\n        \n        if httpResponse.statusCode >= 400 {\n            throw APIError.serverError(httpResponse.statusCode)\n        }\n        \n        do {\n            return try JSONDecoder().decode(T.self, from: data)\n        } catch {\n            throw APIError.decodingError(error)\n        }\n    }\n    \n    // MARK: - Portfolio\n    \n    func getPortfolioSummary() async throws -> PortfolioSummary {\n        try await makeRequest(endpoint: \"/portfolio/summary\")\n    }\n    \n    func getPortfolioInvestments(page: Int = 1, limit: Int = 10) async throws -> PortfolioInvestmentsResponse {\n        try await makeRequest(endpoint: \"/portfolio/investments?page=\\(page)&limit=\\(limit)\")\n    }\n    \n    // MARK: - Investments\n    \n    func getInvestments(page: Int = 1, limit: Int = 10) async throws -> InvestmentsResponse {\n        try await makeRequest(endpoint: \"/investments?page=\\(page)&limit=\\(limit)\")\n    }\n    \n    // MARK: - Messages\n    \n    func getUnreadCount() async throws -> UnreadCountResponse {\n        try await makeRequest(endpoint: \"/messages/unread-count\")\n    }\n    \n    func getConversations() async throws -> ConversationsResponse {\n        try await makeRequest(endpoint: \"/messages\")\n    }\n    \n    // MARK: - Push Tokens\n    \n    func registerPushToken(_ token: String, platform: String = \"watchos\") async throws {\n        let body = try JSONEncoder().encode([\"token\": token, \"platform\": platform])\n        let _: MessageResponse = try await makeRequest(\n            endpoint: \"/users/me/push-token\",\n            method: \"POST\",\n            body: body\n        )\n    }\n}\n\nstruct MessageResponse: Decodable {\n    let message: String\n}\n```\n\n### Complication Data Provider\n\n```swift\nimport ClockKit\n\nclass ComplicationDataSource: NSObject, CLKComplicationDataSource {\n    func getCurrentTimelineEntry(\n        for complication: CLKComplication,\n        withHandler handler: @escaping (CLKComplicationTimelineEntry?) -> Void\n    ) {\n        Task {\n            do {\n                let summary = try await MedInvestAPI.shared.getPortfolioSummary()\n                let template = createTemplate(for: complication, with: summary)\n                let entry = CLKComplicationTimelineEntry(date: Date(), complicationTemplate: template)\n                handler(entry)\n            } catch {\n                handler(nil)\n            }\n        }\n    }\n    \n    private func createTemplate(\n        for complication: CLKComplication,\n        with summary: PortfolioSummary\n    ) -> CLKComplicationTemplate {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .currency\n        formatter.maximumFractionDigits = 0\n        \n        let valueText = formatter.string(from: NSNumber(value: summary.totalValue)) ?? \"$0\"\n        let changeText = String(format: \"%+.1f%%\", summary.gainLossPercent)\n        let changeColor = summary.gainLossPercent >= 0 ? UIColor.green : UIColor.red\n        \n        switch complication.family {\n        case .circularSmall:\n            let template = CLKComplicationTemplateCircularSmallSimpleText()\n            template.textProvider = CLKSimpleTextProvider(text: changeText)\n            return template\n            \n        case .modularSmall:\n            let template = CLKComplicationTemplateModularSmallStackText()\n            template.line1TextProvider = CLKSimpleTextProvider(text: valueText)\n            template.line2TextProvider = CLKSimpleTextProvider(text: changeText)\n            return template\n            \n        case .graphicCircular:\n            let template = CLKComplicationTemplateGraphicCircularStackText()\n            template.line1TextProvider = CLKSimpleTextProvider(text: valueText)\n            template.line2TextProvider = CLKSimpleTextProvider(text: changeText)\n            return template\n            \n        default:\n            let template = CLKComplicationTemplateCircularSmallSimpleText()\n            template.textProvider = CLKSimpleTextProvider(text: changeText)\n            return template\n        }\n    }\n}\n```\n\n### WatchConnectivity for Token Sync\n\n```swift\nimport WatchConnectivity\n\nclass WatchSessionManager: NSObject, WCSessionDelegate {\n    static let shared = WatchSessionManager()\n    \n    private var session: WCSession?\n    \n    func startSession() {\n        if WCSession.isSupported() {\n            session = WCSession.default\n            session?.delegate = self\n            session?.activate()\n        }\n    }\n    \n    // Receive token from iPhone\n    func session(\n        _ session: WCSession,\n        didReceiveMessage message: [String : Any]\n    ) {\n        if let token = message[\"token\"] as? String {\n            DispatchQueue.main.async {\n                MedInvestAPI.shared.setToken(token)\n                NotificationCenter.default.post(name: .tokenReceived, object: nil)\n            }\n        }\n    }\n    \n    // Receive token via application context (persistent)\n    func session(\n        _ session: WCSession,\n        didReceiveApplicationContext applicationContext: [String : Any]\n    ) {\n        if let token = applicationContext[\"token\"] as? String {\n            DispatchQueue.main.async {\n                MedInvestAPI.shared.setToken(token)\n            }\n        }\n    }\n    \n    // Request token from iPhone when needed\n    func requestToken() {\n        session?.sendMessage([\"request\": \"token\"], replyHandler: { reply in\n            if let token = reply[\"token\"] as? String {\n                DispatchQueue.main.async {\n                    MedInvestAPI.shared.setToken(token)\n                }\n            }\n        }, errorHandler: { error in\n            print(\"Failed to request token: \\(error)\")\n        })\n    }\n    \n    // WCSessionDelegate required methods\n    func session(\n        _ session: WCSession,\n        activationDidCompleteWith activationState: WCSessionActivationState,\n        error: Error?\n    ) {\n        if activationState == .activated {\n            // Check for token in application context\n            if let token = session.receivedApplicationContext[\"token\"] as? String {\n                MedInvestAPI.shared.setToken(token)\n            }\n        }\n    }\n}\n\nextension Notification.Name {\n    static let tokenReceived = Notification.Name(\"tokenReceived\")\n}\n```\n\n---\n\n## Contact\n\nFor API issues or feature requests, contact the MedInvest development team.\n","path":null,"size_bytes":19119,"size_tokens":null},"client/providers/QueryProvider.tsx":{"content":"import React from 'react';\nimport {\n  QueryClient,\n  QueryClientProvider,\n  onlineManager,\n  focusManager,\n  type QueryClientConfig,\n} from '@tanstack/react-query';\nimport { createAsyncStoragePersister } from '@tanstack/query-async-storage-persister';\nimport { PersistQueryClientProvider } from '@tanstack/react-query-persist-client';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport NetInfo from '@react-native-community/netinfo';\nimport { AppState, type AppStateStatus, Platform } from 'react-native';\n\n// ============================================\n// Query Client Configuration\n// ============================================\n\nconst queryClientConfig: QueryClientConfig = {\n  defaultOptions: {\n    queries: {\n      // Stale time - how long data is considered fresh\n      staleTime: 1000 * 60 * 5, // 5 minutes\n\n      // Cache time - how long inactive data stays in cache\n      gcTime: 1000 * 60 * 60 * 24, // 24 hours (was cacheTime)\n\n      // Retry configuration\n      retry: (failureCount, error: any) => {\n        // Don't retry on 4xx errors (client errors)\n        if (error?.status >= 400 && error?.status < 500) {\n          return false;\n        }\n        // Retry up to 3 times for other errors\n        return failureCount < 3;\n      },\n      retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000),\n\n      // Refetch configuration\n      refetchOnWindowFocus: true,\n      refetchOnReconnect: true,\n      refetchOnMount: true,\n\n      // Network mode - fetch only when online\n      networkMode: 'online',\n    },\n    mutations: {\n      // Retry mutations once on failure\n      retry: 1,\n      retryDelay: 1000,\n      networkMode: 'online',\n    },\n  },\n};\n\n// Create query client instance\nexport const queryClient = new QueryClient(queryClientConfig);\n\n// ============================================\n// Online Manager Setup\n// ============================================\n\n// Configure online status detection\nonlineManager.setEventListener((setOnline) => {\n  return NetInfo.addEventListener((state) => {\n    setOnline(!!state.isConnected && state.isInternetReachable !== false);\n  });\n});\n\n// ============================================\n// Focus Manager Setup\n// ============================================\n\n// Configure app focus detection\nfunction onAppStateChange(status: AppStateStatus) {\n  if (Platform.OS !== 'web') {\n    focusManager.setFocused(status === 'active');\n  }\n}\n\n// ============================================\n// Async Storage Persister\n// ============================================\n\nconst CACHE_KEY = '@medinvest/react-query-cache';\n\nconst asyncStoragePersister = createAsyncStoragePersister({\n  storage: AsyncStorage,\n  key: CACHE_KEY,\n  throttleTime: 1000, // Throttle writes to once per second\n  serialize: JSON.stringify,\n  deserialize: JSON.parse,\n});\n\n// ============================================\n// Query Keys Factory\n// ============================================\n\nexport const queryKeys = {\n  // Investments\n  investments: {\n    all: ['investments'] as const,\n    lists: () => [...queryKeys.investments.all, 'list'] as const,\n    list: (filters: Record<string, any>) =>\n      [...queryKeys.investments.lists(), filters] as const,\n    details: () => [...queryKeys.investments.all, 'detail'] as const,\n    detail: (id: string) => [...queryKeys.investments.details(), id] as const,\n    search: (query: string, filters?: Record<string, any>) =>\n      [...queryKeys.investments.all, 'search', query, filters] as const,\n  },\n\n  // Portfolio\n  portfolio: {\n    all: ['portfolio'] as const,\n    summary: () => [...queryKeys.portfolio.all, 'summary'] as const,\n    investments: () => [...queryKeys.portfolio.all, 'investments'] as const,\n    transactions: (filters?: Record<string, any>) =>\n      [...queryKeys.portfolio.all, 'transactions', filters] as const,\n  },\n\n  // Articles\n  articles: {\n    all: ['articles'] as const,\n    lists: () => [...queryKeys.articles.all, 'list'] as const,\n    list: (filters: Record<string, any>) =>\n      [...queryKeys.articles.lists(), filters] as const,\n    details: () => [...queryKeys.articles.all, 'detail'] as const,\n    detail: (id: string) => [...queryKeys.articles.details(), id] as const,\n    bookmarked: () => [...queryKeys.articles.all, 'bookmarked'] as const,\n  },\n\n  // User\n  user: {\n    all: ['user'] as const,\n    profile: () => [...queryKeys.user.all, 'profile'] as const,\n    preferences: () => [...queryKeys.user.all, 'preferences'] as const,\n    paymentMethods: () => [...queryKeys.user.all, 'payment-methods'] as const,\n  },\n};\n\n// ============================================\n// Provider Component\n// ============================================\n\ninterface QueryProviderProps {\n  children: React.ReactNode;\n  /** Enable persistence to AsyncStorage */\n  enablePersistence?: boolean;\n}\n\nexport function QueryProvider({\n  children,\n  enablePersistence = true,\n}: QueryProviderProps) {\n  // Setup app state listener for focus management\n  React.useEffect(() => {\n    const subscription = AppState.addEventListener('change', onAppStateChange);\n    return () => subscription.remove();\n  }, []);\n\n  if (enablePersistence) {\n    return (\n      <PersistQueryClientProvider\n        client={queryClient}\n        persistOptions={{\n          persister: asyncStoragePersister,\n          maxAge: 1000 * 60 * 60 * 24, // 24 hours\n          dehydrateOptions: {\n            shouldDehydrateQuery: (query) => {\n              // Only persist successful queries\n              return query.state.status === 'success';\n            },\n          },\n        }}\n        onSuccess={() => {\n          // Resume any paused mutations after hydration\n          queryClient.resumePausedMutations();\n        }}\n      >\n        {children}\n      </PersistQueryClientProvider>\n    );\n  }\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      {children}\n    </QueryClientProvider>\n  );\n}\n\n// ============================================\n// Utility Functions\n// ============================================\n\n/**\n * Prefetch data for a route/screen\n */\nexport async function prefetchInvestment(id: string) {\n  await queryClient.prefetchQuery({\n    queryKey: queryKeys.investments.detail(id),\n    staleTime: 1000 * 60 * 5, // 5 minutes\n  });\n}\n\n/**\n * Invalidate all investment-related queries\n */\nexport function invalidateInvestments() {\n  queryClient.invalidateQueries({ queryKey: queryKeys.investments.all });\n}\n\n/**\n * Invalidate portfolio queries\n */\nexport function invalidatePortfolio() {\n  queryClient.invalidateQueries({ queryKey: queryKeys.portfolio.all });\n}\n\n/**\n * Clear all cached data\n */\nexport async function clearQueryCache() {\n  queryClient.clear();\n  await AsyncStorage.removeItem(CACHE_KEY);\n}\n\n/**\n * Get current online status\n */\nexport function isOnline(): boolean {\n  return onlineManager.isOnline();\n}\n\nexport default QueryProvider;\n","path":null,"size_bytes":6870,"size_tokens":null},"packages/shared/src/index.ts":{"content":"/**\n * @medinvest/shared\n * \n * Shared code for MedInvest web and mobile applications.\n * \n * Usage in Web:\n * ```typescript\n * import { User, Post, loginSchema, formatRelativeTime } from '@medinvest/shared';\n * ```\n * \n * Usage in Mobile:\n * ```typescript\n * import { User, Post, loginSchema, formatRelativeTime } from '@medinvest/shared';\n * ```\n * \n * Or import specific modules:\n * ```typescript\n * import { User, Post } from '@medinvest/shared/types';\n * import { loginSchema } from '@medinvest/shared/validators';\n * import { formatRelativeTime } from '@medinvest/shared/utils';\n * import { ApiClient } from '@medinvest/shared/api';\n * import { LIMITS, ERROR_CODES } from '@medinvest/shared/constants';\n * ```\n */\n\n// Types\nexport * from './types';\n\n// Validators\nexport * from './validators';\n\n// Utilities\nexport * from './utils';\n\n// API Client\nexport * from './api';\n\n// Constants\nexport * from './constants';\n","path":null,"size_bytes":920,"size_tokens":null},"client/contexts/ThemeContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useColorScheme, Appearance } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nexport type ThemeMode = 'light' | 'dark' | 'system';\n\nexport const ThemeColors = {\n  light: {\n    background: '#F5F7FA',\n    backgroundSecondary: '#EBEEF2',\n    backgroundTertiary: '#E1E5EB',\n    surface: '#FFFFFF',\n    surfaceElevated: '#FFFFFF',\n    textPrimary: '#1A1D21',\n    textSecondary: '#5F6368',\n    textTertiary: '#9AA0A6',\n    textInverse: '#FFFFFF',\n    primary: '#1E88E5',\n    primaryDark: '#1565C0',\n    primaryLight: '#64B5F6',\n    secondary: '#00897B',\n    secondaryDark: '#00695C',\n    success: '#34A853',\n    warning: '#FBBC04',\n    error: '#EA4335',\n    info: '#4285F4',\n    border: '#E0E4E8',\n    borderLight: '#F0F2F4',\n    divider: '#E8EAED',\n    overlay: 'rgba(0, 0, 0, 0.5)',\n    card: '#FFFFFF',\n    input: '#F5F7FA',\n    inputFocused: '#FFFFFF',\n    tabBar: '#FFFFFF',\n    statusBar: 'dark-content',\n  },\n  dark: {\n    background: '#121212',\n    backgroundSecondary: '#1E1E1E',\n    backgroundTertiary: '#2D2D2D',\n    surface: '#1E1E1E',\n    surfaceElevated: '#2D2D2D',\n    textPrimary: '#E8EAED',\n    textSecondary: '#9AA0A6',\n    textTertiary: '#5F6368',\n    textInverse: '#1A1D21',\n    primary: '#64B5F6',\n    primaryDark: '#1E88E5',\n    primaryLight: '#90CAF9',\n    secondary: '#4DB6AC',\n    secondaryDark: '#00897B',\n    success: '#81C784',\n    warning: '#FFD54F',\n    error: '#E57373',\n    info: '#64B5F6',\n    border: '#3D3D3D',\n    borderLight: '#2D2D2D',\n    divider: '#3D3D3D',\n    overlay: 'rgba(0, 0, 0, 0.7)',\n    card: '#1E1E1E',\n    input: '#2D2D2D',\n    inputFocused: '#3D3D3D',\n    tabBar: '#1E1E1E',\n    statusBar: 'light-content',\n  },\n};\n\ninterface ThemeContextType {\n  mode: ThemeMode;\n  isDark: boolean;\n  colors: typeof ThemeColors.light;\n  setMode: (mode: ThemeMode) => void;\n  toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nconst THEME_STORAGE_KEY = 'app_theme_mode';\n\ninterface ThemeProviderProps {\n  children: ReactNode;\n}\n\nexport function ThemeProvider({ children }: ThemeProviderProps) {\n  const systemColorScheme = useColorScheme();\n  const [mode, setModeState] = useState<ThemeMode>('system');\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    loadThemePreference();\n  }, []);\n\n  useEffect(() => {\n    const subscription = Appearance.addChangeListener(() => {\n      if (mode === 'system') {\n        setModeState('system');\n      }\n    });\n    return () => subscription.remove();\n  }, [mode]);\n\n  const loadThemePreference = async () => {\n    try {\n      const savedMode = await AsyncStorage.getItem(THEME_STORAGE_KEY);\n      if (savedMode && ['light', 'dark', 'system'].includes(savedMode)) {\n        setModeState(savedMode as ThemeMode);\n      }\n    } catch (error) {\n      console.error('Error loading theme preference:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const setMode = async (newMode: ThemeMode) => {\n    setModeState(newMode);\n    try {\n      await AsyncStorage.setItem(THEME_STORAGE_KEY, newMode);\n    } catch (error) {\n      console.error('Error saving theme preference:', error);\n    }\n  };\n\n  const toggleTheme = () => {\n    const newMode = isDark ? 'light' : 'dark';\n    setMode(newMode);\n  };\n\n  const isDark = mode === 'dark' || (mode === 'system' && systemColorScheme === 'dark');\n  const colors = isDark ? ThemeColors.dark : ThemeColors.light;\n\n  const value: ThemeContextType = {\n    mode,\n    isDark,\n    colors,\n    setMode,\n    toggleTheme,\n  };\n\n  if (isLoading) {\n    return null;\n  }\n\n  return (\n    <ThemeContext.Provider value={value}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useThemeContext() {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useThemeContext must be used within a ThemeProvider');\n  }\n  return context;\n}\n\nexport function useColors() {\n  const { colors } = useThemeContext();\n  return colors;\n}\n\nexport function useIsDarkMode() {\n  const { isDark } = useThemeContext();\n  return isDark;\n}\n","path":null,"size_bytes":4203,"size_tokens":null},"server/routes/notifications.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { authMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\ntype NotificationType = \n  | 'like' | 'comment' | 'follow' | 'mention' | 'reply' | 'message'\n  | 'ama_live' | 'deal_update' | 'achievement' | 'friend_request' \n  | 'friend_accepted' | 'investment_update' | 'course_update' | 'event_reminder' | 'system';\n\ninterface Notification {\n  id: number;\n  type: NotificationType;\n  title: string;\n  body: string;\n  is_read: boolean;\n  data: Record<string, any>;\n  created_at: string;\n}\n\nconst generateNotifications = (count: number): Notification[] => {\n  const types: Array<{ type: NotificationType; title: string; body: string; data: Record<string, any> }> = [\n    { type: 'like', title: 'New Like', body: 'Dr. Sarah Chen liked your post about CRISPR therapy', data: { post_id: 1, user_id: 1 } },\n    { type: 'comment', title: 'New Comment', body: 'Michael Roberts commented on your post', data: { post_id: 1, user_id: 2 } },\n    { type: 'follow', title: 'New Follower', body: 'Dr. Emily Thompson started following you', data: { user_id: 3 } },\n    { type: 'mention', title: 'Mention', body: 'James Wilson mentioned you in a post', data: { post_id: 2, user_id: 4 } },\n    { type: 'deal_update', title: 'Deal Update', body: 'CardioTech Innovations has reached 80% of funding goal', data: { deal_id: 1 } },\n    { type: 'investment_update', title: 'Investment Update', body: 'Your investment in GenomeRx has increased by 12%', data: { deal_id: 2 } },\n    { type: 'ama_live', title: 'AMA Starting', body: 'Dr. Lisa Park\\'s AMA on Digital Therapeutics is starting now', data: { ama_id: 1 } },\n    { type: 'achievement', title: 'Achievement Unlocked', body: 'You earned the \"Early Investor\" badge!', data: { achievement_id: 1 } },\n    { type: 'friend_request', title: 'Friend Request', body: 'Dr. Mark Johnson wants to connect', data: { user_id: 5 } },\n    { type: 'course_update', title: 'New Lesson Available', body: 'A new lesson is available in \"Healthcare Investment Fundamentals\"', data: { course_id: 1 } },\n    { type: 'event_reminder', title: 'Event Reminder', body: 'MedTech Innovation Summit starts in 1 hour', data: { event_id: 1 } },\n    { type: 'system', title: 'Account Update', body: 'Your account verification is complete', data: {} },\n  ];\n\n  return Array.from({ length: count }, (_, i) => {\n    const notifType = types[i % types.length];\n    return {\n      id: i + 1,\n      type: notifType.type,\n      title: notifType.title,\n      body: notifType.body,\n      is_read: i > 3,\n      data: notifType.data,\n      created_at: new Date(Date.now() - i * 3600000).toISOString(),\n    };\n  });\n};\n\nconst notifications = generateNotifications(20);\n\nrouter.get('/', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { page = 1, limit = 20 } = req.query;\n    const start = (Number(page) - 1) * Number(limit);\n    const end = start + Number(limit);\n    const paged = notifications.slice(start, end);\n    const unreadCount = notifications.filter(n => !n.is_read).length;\n    \n    res.json({ \n      notifications: paged,\n      unread_count: unreadCount,\n      total: notifications.length,\n      has_more: end < notifications.length,\n    });\n  } catch (error) {\n    console.error('Notifications error:', error);\n    res.status(500).json({ error: 'Failed to fetch notifications' });\n  }\n});\n\nrouter.get('/unread-count', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const count = notifications.filter(n => !n.is_read).length;\n    res.json({ count });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to get unread count' });\n  }\n});\n\nrouter.post('/:id/read', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const notification = notifications.find(n => n.id === parseInt(id));\n    if (notification) {\n      notification.is_read = true;\n    }\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to mark as read' });\n  }\n});\n\nrouter.post('/read-all', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    notifications.forEach(n => n.is_read = true);\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to mark all as read' });\n  }\n});\n\nrouter.get('/preferences', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({\n      push_enabled: true,\n      email_enabled: true,\n      likes: true,\n      comments: true,\n      follows: true,\n      mentions: true,\n      messages: true,\n      deals: true,\n      amas: true,\n    });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to get preferences' });\n  }\n});\n\nrouter.put('/preferences', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const preferences = req.body;\n    res.json({ success: true, ...preferences });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to update preferences' });\n  }\n});\n\nrouter.post('/push-token', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { token, platform, deviceId } = req.body;\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to register push token' });\n  }\n});\n\nrouter.delete('/push-token/:token', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Failed to unregister push token' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":5530,"size_tokens":null},"client/components/RichTextContent.tsx":{"content":"/**\n * RichTextContent Component\n * Renders text with clickable mentions and hashtags\n */\n\nimport React, { memo, useMemo } from 'react';\nimport { Text, StyleSheet, TextStyle, StyleProp } from 'react-native';\nimport { Colors, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { Mention } from '@/types';\n\ninterface RichTextContentProps {\n  content: string;\n  mentions?: Mention[];\n  hashtags?: string[];\n  onHashtagPress?: (tag: string) => void;\n  onMentionPress?: (userId: number) => void;\n  numberOfLines?: number;\n  style?: StyleProp<TextStyle>;\n}\n\ninterface TextSegment {\n  type: 'text' | 'mention' | 'hashtag' | 'link';\n  content: string;\n  data?: {\n    userId?: number;\n    tag?: string;\n    url?: string;\n  };\n}\n\nfunction RichTextContent({\n  content,\n  mentions = [],\n  hashtags = [],\n  onHashtagPress,\n  onMentionPress,\n  numberOfLines,\n  style,\n}: RichTextContentProps) {\n  const appColors = useAppColors();\n\n  const segments = useMemo(() => {\n    const result: TextSegment[] = [];\n    \n    const pattern = /(@\\w+|#\\w+|https?:\\/\\/[^\\s]+)/g;\n    \n    let lastIndex = 0;\n    let match;\n\n    while ((match = pattern.exec(content)) !== null) {\n      if (match.index > lastIndex) {\n        result.push({\n          type: 'text',\n          content: content.slice(lastIndex, match.index),\n        });\n      }\n\n      const matchedText = match[0];\n\n      if (matchedText.startsWith('@')) {\n        const username = matchedText.slice(1);\n        const mentionData = mentions.find(m => m.username === username);\n        result.push({\n          type: 'mention',\n          content: matchedText,\n          data: { userId: mentionData?.user_id },\n        });\n      } else if (matchedText.startsWith('#')) {\n        const tag = matchedText.slice(1);\n        result.push({\n          type: 'hashtag',\n          content: matchedText,\n          data: { tag },\n        });\n      } else if (matchedText.startsWith('http')) {\n        result.push({\n          type: 'link',\n          content: matchedText,\n          data: { url: matchedText },\n        });\n      }\n\n      lastIndex = match.index + matchedText.length;\n    }\n\n    if (lastIndex < content.length) {\n      result.push({\n        type: 'text',\n        content: content.slice(lastIndex),\n      });\n    }\n\n    return result;\n  }, [content, mentions]);\n\n  const handleMentionPress = (userId?: number) => {\n    if (userId && onMentionPress) {\n      onMentionPress(userId);\n    }\n  };\n\n  const handleHashtagPress = (tag?: string) => {\n    if (tag && onHashtagPress) {\n      onHashtagPress(tag);\n    }\n  };\n\n  return (\n    <Text style={[styles.text, { color: appColors.textPrimary }, style]} numberOfLines={numberOfLines}>\n      {segments.map((segment, index) => {\n        switch (segment.type) {\n          case 'mention':\n            return (\n              <Text\n                key={index}\n                style={styles.mention}\n                onPress={() => handleMentionPress(segment.data?.userId)}\n              >\n                {segment.content}\n              </Text>\n            );\n          case 'hashtag':\n            return (\n              <Text\n                key={index}\n                style={styles.hashtag}\n                onPress={() => handleHashtagPress(segment.data?.tag)}\n              >\n                {segment.content}\n              </Text>\n            );\n          case 'link':\n            return (\n              <Text key={index} style={styles.link}>\n                {segment.content}\n              </Text>\n            );\n          default:\n            return <Text key={index}>{segment.content}</Text>;\n        }\n      })}\n    </Text>\n  );\n}\n\nconst styles = StyleSheet.create({\n  text: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  mention: {\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n  hashtag: {\n    color: Colors.primary,\n    fontWeight: '500',\n  },\n  link: {\n    color: Colors.primary,\n    textDecorationLine: 'underline',\n  },\n});\n\nexport default memo(RichTextContent);\n","path":null,"size_bytes":4009,"size_tokens":null},"client/screens/PremiumScreen.tsx":{"content":"/**\n * Premium Screen\n * Subscription upgrade and features display\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Dimensions,\n  ActivityIndicator,\n  Alert,\n  Linking,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { subscriptionApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\n\nconst { width } = Dimensions.get('window');\n\nconst PREMIUM_FEATURES = [\n  {\n    icon: 'analytics-outline',\n    title: 'Advanced Analytics',\n    description: 'Deep insights into market trends and investment performance',\n  },\n  {\n    icon: 'rocket-outline',\n    title: 'Early Access',\n    description: 'Be first to see new deals and investment opportunities',\n  },\n  {\n    icon: 'shield-checkmark-outline',\n    title: 'Verified Badge',\n    description: 'Stand out with a premium verification badge on your profile',\n  },\n  {\n    icon: 'chatbubbles-outline',\n    title: 'Priority Support',\n    description: '24/7 dedicated support from our expert team',\n  },\n  {\n    icon: 'document-text-outline',\n    title: 'Exclusive Content',\n    description: 'Access premium research reports and expert analysis',\n  },\n  {\n    icon: 'eye-off-outline',\n    title: 'Ad-Free Experience',\n    description: 'Enjoy MedInvest without any advertisements',\n  },\n];\n\nconst PRICING_PLANS = [\n  {\n    id: 'monthly',\n    name: 'Monthly',\n    price: '$29',\n    period: '/month',\n    savings: null,\n  },\n  {\n    id: 'yearly',\n    name: 'Yearly',\n    price: '$199',\n    period: '/year',\n    savings: 'Save 43%',\n    popular: true,\n  },\n];\n\nexport default function PremiumScreen() {\n  const navigation = useNavigation<any>();\n  const { user, refreshUser } = useAuth();\n  const [selectedPlan, setSelectedPlan] = useState('yearly');\n  const appColors = useAppColors();\n\n  const checkoutMutation = useMutation({\n    mutationFn: async () => {\n      const response = await subscriptionApi.createCheckoutSession();\n      if (!response.success || !response.data?.checkout_url) {\n        throw new Error('Failed to create checkout session');\n      }\n      return response.data.checkout_url;\n    },\n    onSuccess: (checkoutUrl) => {\n      Linking.openURL(checkoutUrl);\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message || 'Failed to start checkout');\n    },\n  });\n\n  const handleSubscribe = () => {\n    checkoutMutation.mutate();\n  };\n\n  const renderFeature = (feature: typeof PREMIUM_FEATURES[0], index: number) => (\n    <View key={index} style={styles.featureItem}>\n      <View style={styles.featureIcon}>\n        <Ionicons name={feature.icon as any} size={24} color={Colors.primary} />\n      </View>\n      <View style={styles.featureContent}>\n        <ThemedText style={[styles.featureTitle, { color: appColors.textPrimary }]}>{feature.title}</ThemedText>\n        <ThemedText style={[styles.featureDescription, { color: appColors.textSecondary }]}>{feature.description}</ThemedText>\n      </View>\n    </View>\n  );\n\n  const renderPricingPlan = (plan: typeof PRICING_PLANS[0]) => (\n    <TouchableOpacity\n      key={plan.id}\n      style={[\n        styles.pricingCard,\n        selectedPlan === plan.id && styles.pricingCardSelected,\n      ]}\n      onPress={() => setSelectedPlan(plan.id)}\n    >\n      {plan.popular && (\n        <View style={styles.popularBadge}>\n          <ThemedText style={styles.popularText}>Most Popular</ThemedText>\n        </View>\n      )}\n      <View style={styles.pricingContent}>\n        <ThemedText style={[styles.planName, { color: appColors.textSecondary }]}>{plan.name}</ThemedText>\n        <View style={styles.priceRow}>\n          <ThemedText style={[styles.price, { color: appColors.textPrimary }]}>{plan.price}</ThemedText>\n          <ThemedText style={[styles.period, { color: appColors.textSecondary }]}>{plan.period}</ThemedText>\n        </View>\n        {plan.savings && (\n          <ThemedText style={styles.savings}>{plan.savings}</ThemedText>\n        )}\n      </View>\n      <View style={[\n        styles.radioButton,\n        { borderColor: appColors.border },\n        selectedPlan === plan.id && styles.radioButtonSelected,\n      ]}>\n        {selectedPlan === plan.id && (\n          <View style={styles.radioButtonInner} />\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]} edges={['top']}>\n      {/* Header */}\n      <View style={styles.header}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"close\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Hero Section */}\n        <View style={styles.heroSection}>\n          <LinearGradient\n            colors={[Colors.primary, Colors.secondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.crownContainer}\n          >\n            <MaterialCommunityIcons name=\"crown\" size={48} color=\"white\" />\n          </LinearGradient>\n          <ThemedText style={[styles.heroTitle, { color: appColors.textPrimary }]}>Upgrade to Premium</ThemedText>\n          <ThemedText style={[styles.heroSubtitle, { color: appColors.textSecondary }]}>\n            Unlock the full potential of MedInvest and accelerate your healthcare investment journey\n          </ThemedText>\n        </View>\n\n        {/* Features Section */}\n        <View style={styles.featuresSection}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Premium Benefits</ThemedText>\n          {PREMIUM_FEATURES.map(renderFeature)}\n        </View>\n\n        {/* Pricing Section */}\n        <View style={styles.pricingSection}>\n          <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>Choose Your Plan</ThemedText>\n          <View style={styles.pricingCards}>\n            {PRICING_PLANS.map(renderPricingPlan)}\n          </View>\n        </View>\n\n        {/* Guarantee */}\n        <View style={styles.guaranteeSection}>\n          <Ionicons name=\"shield-checkmark\" size={24} color={Colors.secondary} />\n          <ThemedText style={[styles.guaranteeText, { color: appColors.textSecondary }]}>\n            7-day money-back guarantee. Cancel anytime.\n          </ThemedText>\n        </View>\n\n        {/* Testimonials */}\n        <View style={styles.testimonialSection}>\n          <View style={styles.testimonialCard}>\n            <ThemedText style={[styles.testimonialText, { color: appColors.textPrimary }]}>\n              \"Premium gave me access to deals I never would have found otherwise. Already seeing 3x returns on my first investment!\"\n            </ThemedText>\n            <ThemedText style={[styles.testimonialAuthor, { color: appColors.textSecondary }]}>\n              ‚Äî Dr. Sarah Chen, Cardiologist\n            </ThemedText>\n          </View>\n        </View>\n      </ScrollView>\n\n      {/* Subscribe Button */}\n      <View style={[styles.footer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n        <TouchableOpacity\n          style={styles.subscribeButton}\n          onPress={handleSubscribe}\n          disabled={checkoutMutation.isPending}\n        >\n          <LinearGradient\n            colors={[Colors.primary, Colors.secondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={styles.subscribeGradient}\n          >\n            {checkoutMutation.isPending ? (\n              <ActivityIndicator color=\"white\" />\n            ) : (\n              <>\n                <ThemedText style={styles.subscribeText}>\n                  Start Premium {selectedPlan === 'yearly' ? '- $199/year' : '- $29/month'}\n                </ThemedText>\n              </>\n            )}\n          </LinearGradient>\n        </TouchableOpacity>\n        <ThemedText style={[styles.footerNote, { color: appColors.textSecondary }]}>\n          Subscription auto-renews. Cancel anytime.\n        </ThemedText>\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  heroSection: {\n    alignItems: 'center',\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing['2xl'],\n  },\n  crownContainer: {\n    width: 96,\n    height: 96,\n    borderRadius: 24,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.xl,\n  },\n  heroTitle: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.sm,\n  },\n  heroSubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 22,\n  },\n  sectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.lg,\n    paddingHorizontal: Spacing.lg,\n  },\n  featuresSection: {\n    paddingVertical: Spacing.xl,\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  featureItem: {\n    flexDirection: 'row',\n    paddingHorizontal: Spacing.lg,\n    marginBottom: Spacing.lg,\n  },\n  featureIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 12,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  featureContent: {\n    flex: 1,\n  },\n  featureTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: 2,\n  },\n  featureDescription: {\n    ...Typography.caption,\n    lineHeight: 20,\n  },\n  pricingSection: {\n    paddingVertical: Spacing.xl,\n  },\n  pricingCards: {\n    paddingHorizontal: Spacing.lg,\n    gap: Spacing.md,\n  },\n  pricingCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    borderWidth: 2,\n    borderColor: 'transparent',\n  },\n  pricingCardSelected: {\n    borderColor: Colors.primary,\n    backgroundColor: Colors.primary + '08',\n  },\n  popularBadge: {\n    position: 'absolute',\n    top: -10,\n    right: Spacing.lg,\n    backgroundColor: Colors.secondary,\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.full,\n  },\n  popularText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '600',\n  },\n  pricingContent: {\n    flex: 1,\n  },\n  planName: {\n    ...Typography.caption,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  priceRow: {\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    marginTop: Spacing.xs,\n  },\n  price: {\n    ...Typography.title,\n  },\n  period: {\n    ...Typography.body,\n    marginLeft: Spacing.xs,\n  },\n  savings: {\n    ...Typography.small,\n    color: Colors.secondary,\n    fontWeight: '600',\n    marginTop: Spacing.xs,\n  },\n  radioButton: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 2,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  radioButtonSelected: {\n    borderColor: Colors.primary,\n  },\n  radioButtonInner: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    backgroundColor: Colors.primary,\n  },\n  guaranteeSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  guaranteeText: {\n    ...Typography.caption,\n  },\n  testimonialSection: {\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: Spacing.xl,\n  },\n  testimonialCard: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.lg,\n  },\n  testimonialText: {\n    ...Typography.body,\n    fontStyle: 'italic',\n    lineHeight: 24,\n  },\n  testimonialAuthor: {\n    ...Typography.caption,\n    marginTop: Spacing.md,\n  },\n  footer: {\n    padding: Spacing.lg,\n    paddingBottom: Spacing.xl,\n    borderTopWidth: 1,\n  },\n  subscribeButton: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.button,\n  },\n  subscribeGradient: {\n    paddingVertical: Spacing.lg,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  subscribeText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '700',\n  },\n  footerNote: {\n    ...Typography.small,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":12828,"size_tokens":null},"client/screens/main/BookmarkedArticlesScreen.tsx":{"content":"import React, { useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport { useNavigation } from '@react-navigation/native';\nimport Animated, { FadeIn, FadeInDown, Layout } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport { useBookmarkedArticles, useToggleBookmark } from '@/api/hooks';\nimport { useInfiniteList } from '@/hooks/useSearch';\nimport type { Article } from '@/types';\n\nexport default function BookmarkedArticlesScreen() {\n  const insets = useSafeAreaInsets();\n  const navigation = useNavigation();\n  \n  const articlesQuery = useBookmarkedArticles();\n  const toggleBookmark = useToggleBookmark();\n\n  const {\n    data: articles,\n    isLoading,\n    refreshing,\n    onRefresh,\n    onEndReached,\n    onEndReachedThreshold,\n    isFetchingNextPage,\n    isEmpty,\n  } = useInfiniteList({\n    data: articlesQuery.data,\n    isLoading: articlesQuery.isLoading,\n    isRefetching: articlesQuery.isRefetching,\n    hasNextPage: articlesQuery.hasNextPage,\n    isFetchingNextPage: articlesQuery.isFetchingNextPage,\n    fetchNextPage: articlesQuery.fetchNextPage,\n    refetch: articlesQuery.refetch,\n  });\n\n  const handleArticlePress = useCallback((article: Article) => {\n    // Navigate to article detail\n    console.log('Open article:', article.id);\n  }, []);\n\n  const handleRemoveBookmark = useCallback(\n    (articleId: string) => {\n      toggleBookmark.mutate(articleId);\n    },\n    [toggleBookmark]\n  );\n\n  const renderArticleItem = ({\n    item,\n    index,\n  }: {\n    item: Article;\n    index: number;\n  }) => (\n    <Animated.View\n      entering={FadeInDown.duration(400).delay(index * 80)}\n      layout={Layout.springify()}\n    >\n      <Pressable\n        style={styles.articleItem}\n        onPress={() => handleArticlePress(item)}\n      >\n        <View style={styles.articleThumbnail}>\n          <Feather name=\"file-text\" size={24} color={colors.primary.main} />\n        </View>\n\n        <View style={styles.articleContent}>\n          <View style={styles.articleMeta}>\n            <Text style={styles.articleCategory}>{item.category}</Text>\n            <Text style={styles.articleDot}>‚Ä¢</Text>\n            <Text style={styles.articleTime}>{item.publishedAt}</Text>\n          </View>\n          <Text style={styles.articleTitle} numberOfLines={2}>\n            {item.title}\n          </Text>\n          <View style={styles.articleFooter}>\n            <Text style={styles.articleSource}>{item.source}</Text>\n            <Pressable\n              onPress={() => handleRemoveBookmark(item.id)}\n              hitSlop={8}\n              style={styles.removeButton}\n            >\n              <Feather name=\"bookmark\" size={16} color={colors.primary.main} />\n            </Pressable>\n          </View>\n        </View>\n      </Pressable>\n    </Animated.View>\n  );\n\n  const renderEmptyState = () => {\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={colors.primary.main} />\n        </View>\n      );\n    }\n\n    return (\n      <Animated.View entering={FadeIn.duration(400)} style={styles.emptyState}>\n        <View style={styles.emptyIcon}>\n          <Feather name=\"bookmark\" size={64} color={colors.text.tertiary} />\n        </View>\n        <Text style={styles.emptyTitle}>No saved articles</Text>\n        <Text style={styles.emptyDescription}>\n          Articles you bookmark will appear here for easy access.\n        </Text>\n      </Animated.View>\n    );\n  };\n\n  const renderFooter = () => {\n    if (!isFetchingNextPage) return null;\n    return (\n      <View style={styles.footerLoader}>\n        <ActivityIndicator size=\"small\" color={colors.primary.main} />\n      </View>\n    );\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.header, { paddingTop: insets.top + spacing.md }]}>\n        <Pressable style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Saved Articles</Text>\n        <View style={styles.placeholder} />\n      </View>\n\n      <FlatList\n        data={articles}\n        keyExtractor={(item) => item.id}\n        renderItem={renderArticleItem}\n        ListEmptyComponent={isEmpty ? renderEmptyState : null}\n        ListFooterComponent={renderFooter}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: insets.bottom + spacing.xl },\n          isEmpty && styles.listContentEmpty,\n        ]}\n        showsVerticalScrollIndicator={false}\n        onEndReached={onEndReached}\n        onEndReachedThreshold={onEndReachedThreshold}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            tintColor={colors.primary.main}\n          />\n        }\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.lg,\n    paddingBottom: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  placeholder: {\n    width: 32,\n  },\n  listContent: {\n    padding: spacing.lg,\n  },\n  listContentEmpty: {\n    flexGrow: 1,\n  },\n  articleItem: {\n    flexDirection: 'row',\n    backgroundColor: colors.surface.primary,\n    padding: spacing.md,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n  },\n  articleThumbnail: {\n    width: 72,\n    height: 72,\n    borderRadius: layout.radiusMedium,\n    backgroundColor: colors.transparent.primary10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginRight: spacing.md,\n  },\n  articleContent: {\n    flex: 1,\n    justifyContent: 'space-between',\n  },\n  articleMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: spacing.xs,\n  },\n  articleCategory: {\n    ...typography.small,\n    color: colors.primary.main,\n  },\n  articleDot: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    marginHorizontal: spacing.xs,\n  },\n  articleTime: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  articleTitle: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  articleFooter: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  articleSource: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  removeButton: {\n    padding: spacing.xs,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  emptyState: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingHorizontal: spacing.xl,\n  },\n  emptyIcon: {\n    marginBottom: spacing.lg,\n  },\n  emptyTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n    marginBottom: spacing.sm,\n  },\n  emptyDescription: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n  },\n  footerLoader: {\n    paddingVertical: spacing.lg,\n    alignItems: 'center',\n  },\n});\n","path":null,"size_bytes":7593,"size_tokens":null},"client/lib/force-update.ts":{"content":"/**\n * Force Update Service\n * Require app update when critical updates are available\n */\n\nimport React, { useState, useEffect, useCallback, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Modal,\n  TouchableOpacity,\n  Linking,\n  Platform,\n  AppState,\n  AppStateStatus,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Application from 'expo-application';\nimport Constants from 'expo-constants';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { api } from '@/lib/api';\n\n// Version info from server\ninterface VersionInfo {\n  // Latest available version\n  latestVersion: string;\n  \n  // Minimum required version (force update if below)\n  minimumVersion: string;\n  \n  // Whether update is required\n  updateRequired: boolean;\n  \n  // Whether update is recommended (soft prompt)\n  updateRecommended: boolean;\n  \n  // Release notes\n  releaseNotes?: string[];\n  \n  // Store URLs\n  appStoreUrl?: string;\n  playStoreUrl?: string;\n}\n\n// Update type\nexport type UpdateType = 'required' | 'recommended' | 'none';\n\n// Store URLs\nconst STORE_URLS = {\n  ios: 'https://apps.apple.com/app/idXXXXXXXXXX',\n  android: 'https://play.google.com/store/apps/details?id=com.medinvest.app',\n};\n\n/**\n * Compare semantic versions\n * Returns: -1 if v1 < v2, 0 if equal, 1 if v1 > v2\n */\nfunction compareVersions(v1: string, v2: string): number {\n  const parts1 = v1.split('.').map(Number);\n  const parts2 = v2.split('.').map(Number);\n  \n  const maxLength = Math.max(parts1.length, parts2.length);\n  \n  for (let i = 0; i < maxLength; i++) {\n    const p1 = parts1[i] || 0;\n    const p2 = parts2[i] || 0;\n    \n    if (p1 < p2) return -1;\n    if (p1 > p2) return 1;\n  }\n  \n  return 0;\n}\n\n/**\n * Force Update Service\n */\nclass ForceUpdateService {\n  private versionInfo: VersionInfo | null = null;\n  private lastCheckTime: number = 0;\n  private checkInterval = 1000 * 60 * 60; // 1 hour\n\n  /**\n   * Get current app version\n   */\n  getCurrentVersion(): string {\n    // Expo Application gives us the native version\n    return Application.nativeApplicationVersion || \n           Constants.expoConfig?.version || \n           '1.0.0';\n  }\n\n  /**\n   * Get current build number\n   */\n  getBuildNumber(): string {\n    return Application.nativeBuildVersion || '1';\n  }\n\n  /**\n   * Check for updates from server\n   */\n  async checkForUpdates(): Promise<VersionInfo | null> {\n    // Rate limit checks\n    const now = Date.now();\n    if (now - this.lastCheckTime < this.checkInterval && this.versionInfo) {\n      return this.versionInfo;\n    }\n\n    try {\n      const currentVersion = this.getCurrentVersion();\n      const platform = Platform.OS;\n\n      const response = await api.get('/app/version', {\n        params: {\n          currentVersion,\n          platform,\n          buildNumber: this.getBuildNumber(),\n        },\n      });\n\n      if (response.data) {\n        this.versionInfo = response.data;\n        this.lastCheckTime = now;\n        return this.versionInfo;\n      }\n    } catch (error) {\n      console.error('[ForceUpdate] Error checking for updates:', error);\n      \n      // Return mock data for development\n      return this.getMockVersionInfo();\n    }\n\n    return null;\n  }\n\n  /**\n   * Mock version info for development\n   */\n  private getMockVersionInfo(): VersionInfo {\n    const currentVersion = this.getCurrentVersion();\n    \n    return {\n      latestVersion: currentVersion,\n      minimumVersion: '1.0.0',\n      updateRequired: false,\n      updateRecommended: false,\n      releaseNotes: [],\n      appStoreUrl: STORE_URLS.ios,\n      playStoreUrl: STORE_URLS.android,\n    };\n  }\n\n  /**\n   * Determine update type needed\n   */\n  async getUpdateType(): Promise<UpdateType> {\n    const versionInfo = await this.checkForUpdates();\n    if (!versionInfo) return 'none';\n\n    const currentVersion = this.getCurrentVersion();\n\n    // Check if below minimum required version\n    if (compareVersions(currentVersion, versionInfo.minimumVersion) < 0) {\n      return 'required';\n    }\n\n    // Check if below latest version\n    if (compareVersions(currentVersion, versionInfo.latestVersion) < 0) {\n      return 'recommended';\n    }\n\n    return 'none';\n  }\n\n  /**\n   * Open app store for update\n   */\n  async openStore(): Promise<boolean> {\n    const url = Platform.OS === 'ios' \n      ? (this.versionInfo?.appStoreUrl || STORE_URLS.ios)\n      : (this.versionInfo?.playStoreUrl || STORE_URLS.android);\n\n    try {\n      const canOpen = await Linking.canOpenURL(url);\n      if (canOpen) {\n        await Linking.openURL(url);\n        return true;\n      }\n    } catch (error) {\n      console.error('[ForceUpdate] Error opening store:', error);\n    }\n\n    return false;\n  }\n\n  /**\n   * Get version info\n   */\n  getVersionInfo(): VersionInfo | null {\n    return this.versionInfo;\n  }\n\n  /**\n   * Get release notes\n   */\n  getReleaseNotes(): string[] {\n    return this.versionInfo?.releaseNotes || [];\n  }\n}\n\nexport const forceUpdateService = new ForceUpdateService();\n\n// =============================================================================\n// FORCE UPDATE MODAL\n// =============================================================================\n\ninterface ForceUpdateModalProps {\n  visible: boolean;\n  updateType: UpdateType;\n  versionInfo: VersionInfo | null;\n  onUpdate: () => void;\n  onLater?: () => void;\n}\n\nexport const ForceUpdateModal = memo(function ForceUpdateModal({\n  visible,\n  updateType,\n  versionInfo,\n  onUpdate,\n  onLater,\n}: ForceUpdateModalProps) {\n  const { colors } = useThemeContext();\n\n  if (!visible || updateType === 'none') return null;\n\n  const isRequired = updateType === 'required';\n\n  return (\n    <Modal visible={visible} animationType=\"fade\" transparent>\n      <View style={styles.modalOverlay}>\n        <View style={[styles.modalContainer, { backgroundColor: colors.surface }]}>\n          {/* Icon */}\n          <View style={[styles.iconContainer, { backgroundColor: colors.primary + '20' }]}>\n            <Ionicons\n              name={isRequired ? 'warning-outline' : 'arrow-up-circle-outline'}\n              size={48}\n              color={colors.primary}\n            />\n          </View>\n\n          {/* Title */}\n          <ThemedText style={[styles.title, { color: colors.textPrimary }]}>\n            {isRequired ? 'Update Required' : 'Update Available'}\n          </ThemedText>\n\n          {/* Version info */}\n          <ThemedText style={[styles.versionText, { color: colors.textSecondary }]}>\n            Version {versionInfo?.latestVersion} is available\n          </ThemedText>\n\n          {/* Description */}\n          <ThemedText style={[styles.description, { color: colors.textSecondary }]}>\n            {isRequired\n              ? 'A critical update is required to continue using MedInvest. Please update to the latest version.'\n              : 'A new version of MedInvest is available with improvements and bug fixes.'}\n          </ThemedText>\n\n          {/* Release notes */}\n          {versionInfo?.releaseNotes && versionInfo.releaseNotes.length > 0 && (\n            <View style={[styles.releaseNotesContainer, { backgroundColor: colors.backgroundSecondary }]}>\n              <ThemedText style={[styles.releaseNotesTitle, { color: colors.textPrimary }]}>\n                What's New:\n              </ThemedText>\n              {versionInfo.releaseNotes.slice(0, 3).map((note, index) => (\n                <View key={index} style={styles.releaseNoteItem}>\n                  <ThemedText style={[styles.bulletPoint, { color: colors.primary }]}>‚Ä¢</ThemedText>\n                  <ThemedText style={[styles.releaseNoteText, { color: colors.textSecondary }]}>\n                    {note}\n                  </ThemedText>\n                </View>\n              ))}\n            </View>\n          )}\n\n          {/* Actions */}\n          <View style={styles.actions}>\n            {!isRequired && onLater && (\n              <TouchableOpacity\n                style={[styles.laterButton, { borderColor: colors.border }]}\n                onPress={() => {\n                  haptics.buttonPress();\n                  onLater();\n                }}\n              >\n                <ThemedText style={[styles.laterButtonText, { color: colors.textPrimary }]}>\n                  Later\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n\n            <TouchableOpacity\n              style={[\n                styles.updateButton,\n                { backgroundColor: colors.primary },\n                isRequired && styles.fullWidthButton,\n              ]}\n              onPress={() => {\n                haptics.buttonPress();\n                onUpdate();\n              }}\n            >\n              <Ionicons name=\"download-outline\" size={18} color=\"white\" />\n              <ThemedText style={styles.updateButtonText}>\n                Update Now\n              </ThemedText>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </View>\n    </Modal>\n  );\n});\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function useForceUpdate() {\n  const [showModal, setShowModal] = useState(false);\n  const [updateType, setUpdateType] = useState<UpdateType>('none');\n  const [versionInfo, setVersionInfo] = useState<VersionInfo | null>(null);\n\n  // Check on mount and app foreground\n  useEffect(() => {\n    checkForUpdates();\n\n    const subscription = AppState.addEventListener('change', handleAppStateChange);\n    return () => subscription.remove();\n  }, []);\n\n  const handleAppStateChange = (state: AppStateStatus) => {\n    if (state === 'active') {\n      checkForUpdates();\n    }\n  };\n\n  const checkForUpdates = async () => {\n    const type = await forceUpdateService.getUpdateType();\n    const info = forceUpdateService.getVersionInfo();\n\n    setUpdateType(type);\n    setVersionInfo(info);\n\n    if (type !== 'none') {\n      setShowModal(true);\n    }\n  };\n\n  const handleUpdate = async () => {\n    await forceUpdateService.openStore();\n  };\n\n  const handleLater = () => {\n    if (updateType !== 'required') {\n      setShowModal(false);\n    }\n  };\n\n  return {\n    showModal,\n    updateType,\n    versionInfo,\n    handleUpdate,\n    handleLater,\n    checkForUpdates,\n    ForceUpdateModalComponent: () => (\n      <ForceUpdateModal\n        visible={showModal}\n        updateType={updateType}\n        versionInfo={versionInfo}\n        onUpdate={handleUpdate}\n        onLater={updateType === 'required' ? undefined : handleLater}\n      />\n    ),\n  };\n}\n\n// =============================================================================\n// VERSION DISPLAY COMPONENT\n// =============================================================================\n\nexport const VersionDisplay = memo(function VersionDisplay() {\n  const { colors } = useThemeContext();\n  const version = forceUpdateService.getCurrentVersion();\n  const build = forceUpdateService.getBuildNumber();\n\n  return (\n    <ThemedText style={[styles.versionDisplay, { color: colors.textSecondary }]}>\n      Version {version} ({build})\n    </ThemedText>\n  );\n});\n\nconst styles = StyleSheet.create({\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.6)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: Spacing.lg,\n  },\n  modalContainer: {\n    width: '100%',\n    maxWidth: 340,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    alignItems: 'center',\n  },\n  iconContainer: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.lg,\n  },\n  title: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.xs,\n  },\n  versionText: {\n    ...Typography.caption,\n    marginBottom: Spacing.md,\n  },\n  description: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 22,\n  },\n  releaseNotesContainer: {\n    width: '100%',\n    marginTop: Spacing.lg,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  releaseNotesTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.sm,\n  },\n  releaseNoteItem: {\n    flexDirection: 'row',\n    marginTop: Spacing.xs,\n  },\n  bulletPoint: {\n    ...Typography.body,\n    marginRight: Spacing.sm,\n  },\n  releaseNoteText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 18,\n  },\n  actions: {\n    flexDirection: 'row',\n    marginTop: Spacing.xl,\n    gap: Spacing.md,\n    width: '100%',\n  },\n  laterButton: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    alignItems: 'center',\n  },\n  laterButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  updateButton: {\n    flex: 1,\n    flexDirection: 'row',\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: Spacing.sm,\n  },\n  fullWidthButton: {\n    flex: 1,\n  },\n  updateButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  versionDisplay: {\n    ...Typography.small,\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":13292,"size_tokens":null},"client/screens/PostDetailScreen.tsx":{"content":"/**\n * PostDetail Screen\n * View full post with comments thread\n */\n\nimport React, { useState, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  TextInput,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n  Image,\n  RefreshControl,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { postsApi } from '@/lib/api';\nimport { Post, Comment } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { formatRelativeTime } from '@/lib/utils';\nimport PostCard from '@/components/PostCard';\nimport RichTextContent from '@/components/RichTextContent';\n\ntype PostDetailRouteParams = {\n  PostDetail: {\n    postId: number;\n  };\n};\n\nexport default function PostDetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<PostDetailRouteParams, 'PostDetail'>>();\n  const { postId } = route.params;\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  const inputRef = useRef<TextInput>(null);\n  const appColors = useAppColors();\n\n  const [commentText, setCommentText] = useState('');\n  const [replyingTo, setReplyingTo] = useState<Comment | null>(null);\n\n  // Fetch post\n  const {\n    data: post,\n    isLoading: postLoading,\n    refetch: refetchPost,\n  } = useQuery({\n    queryKey: ['post', postId],\n    queryFn: async () => {\n      const response = await postsApi.getPost(postId);\n      return response.data;\n    },\n  });\n\n  // Fetch comments\n  const {\n    data: commentsData,\n    isLoading: commentsLoading,\n    isRefetching,\n    refetch: refetchComments,\n  } = useQuery({\n    queryKey: ['comments', postId],\n    queryFn: async () => {\n      const response = await postsApi.getComments(postId);\n      return response.data?.comments || [];\n    },\n  });\n\n  const comments = commentsData || [];\n\n  // Add comment mutation\n  const addCommentMutation = useMutation({\n    mutationFn: async () => {\n      const response = await postsApi.addComment(\n        postId,\n        commentText.trim(),\n        replyingTo?.id\n      );\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to add comment');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      setCommentText('');\n      setReplyingTo(null);\n      refetchComments();\n      refetchPost();\n    },\n  });\n\n  // Vote mutation\n  const voteMutation = useMutation({\n    mutationFn: async ({ direction }: { direction: 'up' | 'down' }) => {\n      return postsApi.vote(postId, direction);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['post', postId] });\n    },\n  });\n\n  // Bookmark mutation\n  const bookmarkMutation = useMutation({\n    mutationFn: async () => {\n      if (post?.is_bookmarked) {\n        return postsApi.removeBookmark(postId);\n      }\n      return postsApi.bookmark(postId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['post', postId] });\n    },\n  });\n\n  const handleRefresh = useCallback(() => {\n    refetchPost();\n    refetchComments();\n  }, [refetchPost, refetchComments]);\n\n  const handleReply = useCallback((comment: Comment) => {\n    setReplyingTo(comment);\n    inputRef.current?.focus();\n  }, []);\n\n  const handleCancelReply = useCallback(() => {\n    setReplyingTo(null);\n  }, []);\n\n  const handleSubmitComment = useCallback(() => {\n    if (!commentText.trim()) return;\n    addCommentMutation.mutate();\n  }, [commentText, addCommentMutation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const handleHashtagPress = useCallback((tag: string) => {\n    navigation.navigate('Hashtag', { tag });\n  }, [navigation]);\n\n  const renderComment = ({ item }: { item: Comment }) => (\n    <View style={[styles.commentItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }, item.parent_id != null && styles.replyItem]}>\n      <TouchableOpacity onPress={() => handleUserPress(Number(item.author.id))}>\n        {item.author.avatar_url ? (\n          <Image source={{ uri: item.author.avatar_url }} style={styles.commentAvatar} />\n        ) : (\n          <View style={[styles.commentAvatar, styles.commentAvatarPlaceholder]}>\n            <ThemedText style={styles.commentAvatarText}>\n              {(item.author.first_name || 'U')[0]}{(item.author.last_name || '')[0]}\n            </ThemedText>\n          </View>\n        )}\n      </TouchableOpacity>\n\n      <View style={styles.commentContent}>\n        <View style={styles.commentHeader}>\n          <TouchableOpacity onPress={() => handleUserPress(Number(item.author.id))}>\n            <ThemedText style={[styles.commentAuthor, { color: appColors.textPrimary }]}>{item.author.full_name}</ThemedText>\n          </TouchableOpacity>\n          <ThemedText style={[styles.commentTime, { color: appColors.textSecondary }]}>\n            {formatRelativeTime(item.created_at)}\n          </ThemedText>\n        </View>\n\n        <RichTextContent\n          content={item.content}\n          onMentionPress={handleUserPress}\n          onHashtagPress={handleHashtagPress}\n          style={[styles.commentText, { color: appColors.textPrimary }]}\n        />\n\n        <View style={styles.commentActions}>\n          <TouchableOpacity style={styles.commentAction}>\n            <Ionicons\n              name={item.user_vote === 'up' ? 'arrow-up' : 'arrow-up-outline'}\n              size={16}\n              color={item.user_vote === 'up' ? Colors.secondary : appColors.textSecondary}\n            />\n            <ThemedText style={[styles.commentActionText, { color: appColors.textSecondary }]}>\n              {item.upvotes - item.downvotes}\n            </ThemedText>\n            <Ionicons\n              name={item.user_vote === 'down' ? 'arrow-down' : 'arrow-down-outline'}\n              size={16}\n              color={item.user_vote === 'down' ? appColors.error : appColors.textSecondary}\n            />\n          </TouchableOpacity>\n\n          <TouchableOpacity\n            style={styles.commentAction}\n            onPress={() => handleReply(item)}\n          >\n            <Ionicons name=\"chatbubble-outline\" size={14} color={appColors.textSecondary} />\n            <ThemedText style={[styles.commentActionText, { color: appColors.textSecondary }]}>Reply</ThemedText>\n          </TouchableOpacity>\n        </View>\n\n        {/* Nested replies */}\n        {item.replies && item.replies.length > 0 ? (\n          <View style={[styles.repliesContainer, { borderLeftColor: appColors.border }]}>\n            {item.replies.map((reply) => (\n              <View key={reply.id} style={styles.replyItem}>\n                <TouchableOpacity onPress={() => handleUserPress(Number(reply.author.id))}>\n                  {reply.author.avatar_url ? (\n                    <Image source={{ uri: reply.author.avatar_url }} style={styles.replyAvatar} />\n                  ) : (\n                    <View style={[styles.replyAvatar, styles.commentAvatarPlaceholder]}>\n                      <ThemedText style={styles.replyAvatarText}>\n                        {(reply.author.first_name || 'U')[0]}{(reply.author.last_name || '')[0]}\n                      </ThemedText>\n                    </View>\n                  )}\n                </TouchableOpacity>\n                <View style={styles.replyContent}>\n                  <ThemedText style={[styles.replyAuthor, { color: appColors.textPrimary }]}>{reply.author.full_name}</ThemedText>\n                  <ThemedText style={[styles.replyText, { color: appColors.textPrimary }]}>{reply.content}</ThemedText>\n                </View>\n              </View>\n            ))}\n          </View>\n        ) : null}\n      </View>\n    </View>\n  );\n\n  const renderHeader = () => {\n    if (!post) return null;\n\n    return (\n      <View style={[styles.postContainer, { backgroundColor: appColors.surface }]}>\n        <PostCard\n          post={post}\n          onPress={() => {}}\n          onUserPress={() => handleUserPress(post.author.id)}\n          onVote={(direction) => direction && voteMutation.mutate({ direction })}\n          onBookmark={() => bookmarkMutation.mutate()}\n          onHashtagPress={handleHashtagPress}\n          onMentionPress={handleUserPress}\n          showFullContent\n        />\n        <View style={[styles.commentsHeader, { borderTopColor: appColors.border }]}>\n          <ThemedText style={[styles.commentsTitle, { color: appColors.textPrimary }]}>\n            Comments ({post.comments_count})\n          </ThemedText>\n        </View>\n      </View>\n    );\n  };\n\n  if (postLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n        keyboardVerticalOffset={Platform.OS === 'ios' ? 0 : 20}\n      >\n        {/* Header */}\n        <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n          <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Post</ThemedText>\n          <TouchableOpacity style={styles.moreButton}>\n            <Ionicons name=\"ellipsis-horizontal\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Comments List */}\n        <FlatList\n          data={comments}\n          renderItem={renderComment}\n          keyExtractor={(item) => item.id.toString()}\n          ListHeaderComponent={renderHeader}\n          refreshControl={\n            <RefreshControl\n              refreshing={isRefetching}\n              onRefresh={handleRefresh}\n              tintColor={Colors.primary}\n            />\n          }\n          contentContainerStyle={styles.listContent}\n          showsVerticalScrollIndicator={false}\n        />\n\n        {/* Comment Input */}\n        <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          {replyingTo && (\n            <View style={styles.replyingToBar}>\n              <ThemedText style={styles.replyingToText}>\n                Replying to {replyingTo.author.full_name}\n              </ThemedText>\n              <TouchableOpacity onPress={handleCancelReply}>\n                <Ionicons name=\"close\" size={18} color={appColors.textSecondary} />\n              </TouchableOpacity>\n            </View>\n          )}\n          <View style={styles.inputRow}>\n            {user?.avatar_url ? (\n              <Image source={{ uri: user.avatar_url }} style={styles.inputAvatar} />\n            ) : (\n              <View style={[styles.inputAvatar, styles.commentAvatarPlaceholder]}>\n                <ThemedText style={styles.commentAvatarText}>\n                  {user?.first_name?.[0]}{user?.last_name?.[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={styles.inputWrapper}>\n              <TextInput\n                ref={inputRef}\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder={replyingTo ? 'Write a reply...' : 'Add a comment...'}\n                placeholderTextColor={appColors.textSecondary}\n                value={commentText}\n                onChangeText={setCommentText}\n                multiline\n                maxLength={1000}\n              />\n            </View>\n            <TouchableOpacity\n              style={[styles.sendButton, !commentText.trim() && styles.sendButtonDisabled]}\n              onPress={handleSubmitComment}\n              disabled={!commentText.trim() || addCommentMutation.isPending}\n            >\n              {addCommentMutation.isPending ? (\n                <ActivityIndicator size=\"small\" color={Colors.primary} />\n              ) : (\n                <Ionicons\n                  name=\"send\"\n                  size={20}\n                  color={commentText.trim() ? Colors.primary : appColors.textSecondary}\n                />\n              )}\n            </TouchableOpacity>\n          </View>\n        </View>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  moreButton: {\n    padding: Spacing.sm,\n  },\n  listContent: {\n    paddingBottom: Spacing.lg,\n  },\n  postContainer: {\n  },\n  commentsHeader: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  commentsTitle: {\n    ...Typography.heading,\n  },\n  commentItem: {\n    flexDirection: 'row',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  replyItem: {\n    paddingLeft: Spacing.xl,\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  commentAvatar: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    marginRight: Spacing.md,\n  },\n  commentAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  commentAvatarText: {\n    fontSize: 12,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  commentContent: {\n    flex: 1,\n  },\n  commentHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.xs,\n  },\n  commentAuthor: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginRight: Spacing.sm,\n  },\n  commentTime: {\n    ...Typography.small,\n  },\n  commentText: {\n    ...Typography.body,\n    lineHeight: 20,\n  },\n  commentActions: {\n    flexDirection: 'row',\n    marginTop: Spacing.sm,\n    gap: Spacing.lg,\n  },\n  commentAction: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  commentActionText: {\n    ...Typography.small,\n  },\n  repliesContainer: {\n    marginTop: Spacing.md,\n    paddingLeft: Spacing.md,\n    borderLeftWidth: 2,\n  },\n  replyAvatar: {\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    marginRight: Spacing.sm,\n  },\n  replyAvatarText: {\n    fontSize: 9,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  replyContent: {\n    flex: 1,\n  },\n  replyAuthor: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  replyText: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  inputContainer: {\n    borderTopWidth: 1,\n  },\n  replyingToBar: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    backgroundColor: Colors.primary + '10',\n  },\n  replyingToText: {\n    ...Typography.small,\n    color: Colors.primary,\n  },\n  inputRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n  },\n  inputAvatar: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n  },\n  inputWrapper: {\n    flex: 1,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    maxHeight: 100,\n  },\n  input: {\n    ...Typography.body,\n    maxHeight: 80,\n  },\n  sendButton: {\n    padding: Spacing.sm,\n  },\n  sendButtonDisabled: {\n    opacity: 0.5,\n  },\n});\n","path":null,"size_bytes":16221,"size_tokens":null},"client/api/client.ts":{"content":"import axios, { type AxiosError, type InternalAxiosRequestConfig } from 'axios';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\nimport { AUTH_TOKEN_KEY } from '@/constants/auth';\n\nfunction getApiBaseUrl(): string {\n  const extraApiBaseUrl = Constants.expoConfig?.extra?.apiBaseUrl;\n  if (extraApiBaseUrl) {\n    let base = extraApiBaseUrl;\n    try {\n      const parsed = new URL(base);\n      if (parsed.hostname !== 'localhost' && parsed.hostname !== '127.0.0.1') {\n        parsed.port = '';\n        base = parsed.href.replace(/\\/$/, '');\n      }\n    } catch {}\n    return `${base}/api`;\n  }\n  \n  let domain = process.env.EXPO_PUBLIC_DOMAIN;\n  if (domain) {\n    domain = domain.replace(/:5000$/, '');\n    if (domain.includes('localhost')) {\n      return `http://${domain}/api`;\n    }\n    if (typeof window !== 'undefined' && window.location) {\n      return `${window.location.origin}/api`;\n    }\n    return `https://${domain}/api`;\n  }\n  \n  console.warn('[API] No API base URL configured, using localhost fallback');\n  return 'http://localhost:5000/api';\n}\n\nconst API_BASE_URL = getApiBaseUrl();\nconsole.log('[API Client] Base URL:', API_BASE_URL);\n\n/**\n * Axios instance with auth interceptors\n */\nexport const apiClient = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 30000,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n/**\n * Request interceptor - Add auth token\n */\napiClient.interceptors.request.use(\n  async (config: InternalAxiosRequestConfig) => {\n    try {\n      const token = await AsyncStorage.getItem(AUTH_TOKEN_KEY);\n      if (token && config.headers) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n    } catch (error) {\n      console.error('Error getting auth token:', error);\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n/**\n * Response interceptor - Handle errors\n */\napiClient.interceptors.response.use(\n  (response) => response,\n  async (error: AxiosError) => {\n    const originalRequest = error.config;\n\n    // Handle 401 - Unauthorized\n    if (error.response?.status === 401) {\n      // Clear stored token\n      await AsyncStorage.removeItem(AUTH_TOKEN_KEY);\n      \n      // You could emit an event here to trigger logout in AuthContext\n      // eventEmitter.emit('unauthorized');\n    }\n\n    if (!error.response) {\n      const url = error.config?.baseURL ? `${error.config.baseURL}${error.config.url || ''}` : 'unknown';\n      console.error('[API Client] Network error - no response received. URL:', url, 'Error:', error.message);\n      return Promise.reject({\n        message: 'Network error. Please check your connection.',\n        isNetworkError: true,\n        url,\n      });\n    }\n\n    // Handle API errors\n    const apiError = {\n      status: error.response.status,\n      message: (error.response.data as any)?.message || 'An error occurred',\n      errors: (error.response.data as any)?.errors,\n    };\n\n    return Promise.reject(apiError);\n  }\n);\n\n/**\n * API Error type\n */\nexport interface ApiError {\n  status?: number;\n  message: string;\n  errors?: Record<string, string[]>;\n  isNetworkError?: boolean;\n}\n\n/**\n * Type guard for API errors\n */\nexport function isApiError(error: unknown): error is ApiError {\n  return (\n    typeof error === 'object' &&\n    error !== null &&\n    'message' in error\n  );\n}\n","path":null,"size_bytes":3378,"size_tokens":null},"client/screens/portfolio/PortfolioScreen.tsx":{"content":"en',\n      alignItems: 'center',\n      marginBottom: 15,\n  },\n    summaryLabel: {\n      fontSize: 12,\n            color: '#999',\n            marginBottom: 4,\n        },\n          summaryValue: {\n            fontSize: 16,\n                  fontWeight: '600',\n                  color: '#000',\n              },\n                summaryDivider: {\n                      width: 1,\n                            height: 40,\n                            backgroundColor: '#eee',\n                        },\n    percentageRow: {\n          borderTopWidth: 1,\n                borderTopColor: '#eee',\n                paddingTop: 15,\n            },\n              percentageText: {\n                fontSize: 18,\n                      fontWeight: 'bold',\n                  },\n        gain: {\n              color: '#34C759',\n                },\n        loss: {\n              color: '#FF3B30',\n                },\n        chartCard: {\n              backgroundColor: '#fff',\n                    borderRadius: 12,\n                    padding: 20,\n                    marginBottom: 20,\n                    elevation: 3,\n                },\n                  chartTitle: {\n                    fontSize: 16,\n                          fontWeight: '600',\n                          marginBottom: 15,\n                      },\n                        chart: {\n                          borderRadius: 8,\n                            },\n                  actionButtons: {\n                        flexDirection: 'row',\n                              gap: 10,\n                              marginBottom: 30,\n                          },\n                            actionButton: {\n                              flex: 1,\n                                    paddingVertical: 12,\n                                    borderRadius: 8,\n                                    alignItems: 'center',\n                                    borderWidth: 1,\n                                    borderColor: '#007AFF',\n                                },\n                      primaryButton: {\n                            backgroundColor: '#007AFF',\n                              },\n                      actionButtonText: {\n                            fontSize: 14,\n                                  fontWeight: '600',\n                                  color: '#fff',\n                              },\n                      secondaryButtonText: {\n                            color: '#007AFF',\n                              },\n                      sectionTitle: {\n                            fontSize: 18,\n                                  fontWeight: '600',\n                                  marginBottom: 15,\n                                  color: '#000',\n                              },\n                      investmentsList: {\n                            marginBottom: 20,\n                              },\n                      investmentCard: {\n                            backgroundColor: '#fff',\n                                  borderRadius: 10,\n                                  padding: 15,\n                                  marginBottom: 12,\n                                  elevation: 2,\n                              },\n                                investmentHeader: {\n                                  flexDirection: 'row',\n                                        justifyContent: 'space-between',\n                                        alignItems: 'flex-start',\n                                        marginBottom: 10,\n                                    },\n                                      investmentName: {\n                                        fontSize: 16,\n                                              fontWeight: '600',\n                                              color: '#000',\n                                          },\n                                investmentTicker: {\n                                      fontSize: 12,\n                                            color: '#999',\n                                            marginTop: 2,\n                                        },\n                                          investmentValue: {\n                                            alignItems: 'flex-end',\n                                              },\n                                    investmentPrice: {\n                                          fontSize: 14,\n                                                fontWeight: '600',\n                                                color: '#000',\n                                            },\n                                    gainLoss: {\n                                          fontSize: 12,\n                                                fontWeight: '600',\n                                                marginTop: 4,\n                                            },\n                                              investmentDetails: {\n                                                flexDirection: 'row',\n                                                      justifyContent: 'space-between',\n                                                      borderTopWidth: 1,\n                                                      borderTopColor: '#eee',\n                                                      paddingTop: 10,\n                                                  },\n                                                    investmentQty: {\n                                                      fontSize: 12,\n                                                            color: '#666',\n                                                        },\n                                              investmentTotal: {\n                                                    fontSize: 12,\n                                                          fontWeight: '600',\n                                                          color: '#000',\n                                                      },\n                                              errorText: {\n                                                    fontSize: 16,\n                                                          color: '#FF3B30',\n                                                          marginBottom: 20,\n                                                      },\n                                                        retryButton: {\n                                                          backgroundColor: '#007AFF',\n                                                                paddingVertical: 10,\n                                                                paddingHorizontal: 20,\n                                                                borderRadius: 8,\n                                                            },\n                                                  retryButtonText: {\n                                                        color: '#fff',\n                                                              fontWeight: '600',\n                                                          },\n                                              });import React, { useState } from 'react';\n                                            import {\n                                                View,\n                                                Text,\n                                                ScrollView,\n                                                StyleSheet,\n                                                TextInput,\n                                                TouchableOpacity,\n                                                ActivityIndicator,\n                                                Alert,\n                                                KeyboardAvoidingView,\n                                                Platform,\n                                            } from 'react-native';\n                                            import { apiClient } from '../../services/api';\n\n                                            export const AddInvestmentScreen: React.FC<{ navigation: any; route: any }> = ({\n                                                navigation,\n                                                route,\n                                            }) => {\n                                                const isEditing = route.params?.investmentId ? true : false;\n                                                const [name, setName] = useState(route.params?.name || '');\n                                                const [ticker, setTicker] = useState(route.params?.ticker || '');\n                                                const [quantity, setQuantity] = useState(route.params?.quantity?.toString() || '');\n                                                const [purchasePrice, setPurchasePrice] = useState(route.params?.purchasePrice?.toString() || '');\n                                                const [currentPrice, setCurrentPrice] = useState(route.params?.currentPrice?.toString() || '');\n                                                const [loading, setLoading] = useState(false);\n                                                const [errors, setErrors] = useState<Record<string, string>>({});\n\n                                                const validateForm = () => {\n                                                      const newErrors: Record<string, string> = {};\n                                                      if (!name.trim()) newErrors.name = 'Investment name is required';\n                                                      if (!ticker.trim()) newErrors.ticker = 'Ticker symbol is required';\n                                                      if (!quantity || isNaN(parseFloat(quantity)) || parseFloat(quantity) <= 0)\n                                                              newErrors.quantity = 'Valid quantity required';\n                                                      if (!purchasePrice || isNaN(parseFloat(purchasePrice)) || parseFloat(purchasePrice) < 0)\n                                                              newErrors.purchasePrice = 'Valid purchase price required';\n                                                      if (!currentPrice || isNaN(parseFloat(currentPrice)) || parseFloat(currentPrice) < 0)\n                                                              newErrors.currentPrice = 'Valid current price required';\n                                                      setErrors(newErrors);\n                                                      return Object.keys(newErrors).length === 0;\n                                                };\n\n                                                const handleSave = async () => {\n                                                      if (!validateForm()) return;\n\n                                                      try {\n                                                              setLoading(true);\n                                                              const investmentData = {\n                                                                        name,\n                                                                        ticker,\n                                                                        quantity: parseFloat(quantity),\n                                                                        purchasePrice: parseFloat(purchasePrice),\n                                                                        currentPrice: parseFloat(currentPrice),\n                                                              };\n\n                                                              if (isEditing) {\n                                                                        await apiClient.updateInvestment(route.params.investmentId, investmentData);\n                                                                        Alert.alert('Success', 'Investment updated successfully');\n                                                                      } else {\n                                                                        await apiClient.addInvestment(investmentData);\n                                                                        Alert.alert('Success', 'Investment added successfully');\n                                                              }\n                                                              navigation.goBack();\n                                                      } catch (error) {\n                                                              Alert.alert('Error', 'Failed to save investment');\n                                                      } finally {\n                                                              setLoading(false);\n                                                      }\n                                                };\n\n                                                return (\n                                                      <KeyboardAvoidingView\n                                                              behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n                                                              le={stylesntainer}\n                                                            >\n                                                            <ScrollVis.title}>{isEditing ? 'Edit Invesle={styles.scroiew} contentContainerStyle={styles.content}>\n                                                                    <Texttment' : 'Add New Investment'}</KeyboardAvoidingView>Text>\n                                                  \n                                                          <VieVityles.label}>Investment Nam</VieVityles.label>{styles.formGroup}>\n                                                                      <Text ls</VieView>styles.fe *</Text>\n                                                          <TextInput\n                                                           placeholder=\"e.g., Apple Inc.\"{[styles.input, errors.name &es.inputErr\"\n                                                            value={name}\n                                                            onChangeText={setName}\n                                                            editable={!loading}\n                                              </View>\n                                              \n                                              {/* Ticker Symbol *icker Symbol *</Text>\n                                                          <TextInputorPL\"\n                                                            value={ticker}\n                                                            onChangeText={(text) => setTicker(text.toUpperCase())}\n                                                    editable={!loading}\n                                                maxLength={5}\n                                                              />\n                                                  {errors.ticker && <Tex          </View>\n                                                  \n                                      {/* Quantity */}\n                                                <Vi{styles.label}>Quantity *</Vi>Text>\n                                                              </Vi>{styles.formGroup}>\n                                                            <Text<TextInput\n                                     nputErro placeholder=\"e.g., 10\"\n                                                                            value={quantity}\n                                                                            onChangeText={setQuantity}\n                                                                            keyboardType=\"decimal-pad\"\n                                                                            editable={!loading}\n                                                                          />\n                                      {errors.quantity && <Tet>}\n                                      </Tet>View>\n                                        \n                                        {/* Purchase Price */}\n                                                    <TextInput\n                                      nputEr         placeholder=\"e.g., 150.25\"\n                                                      value={purchasePrice}\n                                                                      onChangeText={setPurchasePrice}\n                                                                                      keyboardType=\"decimal-pad\"\n                                                                                                      editable={!loading}\n                                                                                                                    />\n                                      {errors.purchasePrice && <Terice}</Text>}\n                                        </View>\n                                      \n                                       {/* Current Price */}\n                                               ent Price (per share) *</Text>\n                                                             <TextInput\n                                                                         r]}50\"\n                                                      value={currentPrice}\n                                                      onChangeText={setCurrentPrice}\n                                                      keyboardType=\"decimal-pad\"\n                                                      editable={!loading}\n                                              />\n                                  {errors.currentPrice && <TerrentPrice}</Text>}\n                                    </View>\n                                    \n                                   {/* Info Box */}\n                                   {quantity && purchasePrice && currentPrice && (\n                                                 <Vie <T</Text>\n                                                   <T   ${(parseFloat(quantity) * parseFloat(purchasePrice)).toFixed(2)}\n                                    </Text>\n                                                    <Texlue:</Text>\n                                                    <Text\n                                                 parseFloat(curr)\n                                                        .infoValentPrice) >= parseFloat(purchasePrice)\n                                                                 ]}\n                                                 >\n                                                            .gain\n                                                               ${(parseFloat(quantity) * parseFloat(currentPrice)).toFixed(2)}\n                                                 </>Text>\n                                                   </View>\n                                                             )}\n                                  </View>\n                                                   \n                                   {/* Buttons */}\n                                           <V         <TouchableOpacity\n                                                           onPress={() => nav={[styles.buttonigation.goBack()}\n                                                                         disabled={loading}\n                                              >\n                                                <Tex</TouchableOpacity>\n                                              <TouchableOpacity\n                                              onPress={handleSa          disabled={loading}\n                                                                 >\n                                                       {loading ? (\n                                                                       <ActivityIndicator color=\"#fff\" />\n                                                                     ) : (\n                                                                       <Teing ? 'Update' : 'Add'} Investment\n                                                                        </Text>\n                                                                                      )}\n                                                                          </TouchableOpacity>\n                                                       </View>\n                                                       </ScrollView>\n                                                       </KeyboardAvoidingView>\n                                                         );\n                                };\n                              \n                              consts = StyleShe,\n                                    backgroundColor: '#f5f5f5',\n                                },\n                                  scrollView: {\n                                        flex: 1,\n                                          },\n                                            content: {\n                                                  padding: 20,\n                                                        paddingBottom: 40,\n                                                    },\n                                                      title: {\n                                                        fontSize: 24,\n                                                              fontWeight: 'bold',\n                                                              marginBottom: 30,\n                                                              color: '#000',\n                                                          },\n                                                            form: {\n                                                                  marginBottom: 30,\n                                                                    },\n                                                                      formGroup: {\n                                                                            marginBottom: 20,\n                                                                              },\n                                                                                label: {\n                                                                                      fontSize: 14,\n                                                                                            fontWeight: '600',\n                                                                                            marginBottom: 8,\n                                                                                            color: '#333',\n                                                                                        },\n                                                                                          input: {\n                                                                                                backgroundColor: '#fff',\n                                                                                                      borderWidth: 1,\n                                                                                                      borderColor: '#ddd',\n                                                                                                      borderRadius: 8,\n                                                                                                      paddingHorizontal: 15,\n                                                                                                      paddingVertical: 12,\n                                                                                                      fontSize: 16,\n                                                                                                      color: '#000',\n                                                                                                  },\n                                                                                                    inputError: {\n                                                                                                          borderColor: '#FF3B30',\n                                                                                                                backgroundColor: '#fff5f5',\n                                                                                                            },\n                                                                                                              errorText: {\n                                                                                                                    color: '#FF3B30',\n                                                                                                                          fontSize: 12,\n                                                                                                                          marginTop: 5,\n                                                                                                                      },\n                                                                                                                        infoBox: {\n                                                                                                                          backgroundColor: '#f0f8ff',\n                                                                                                                                borderRadius: 10,\n                                                                                                                                padding: 15,\n                                                                                                                                borderLeftWidth: 4,\n                                                                                                                                borderLeftColor: '#007AFF',\n                                                                                                                            },\n                                                                                                                              infoLabel: {\n                                                                                                                                    fontSize: 12,\n                                                                                                                                          color: '#666',\n                                                                                                                                          marginBottom: 4,\n                                                                                                                                          marginTop: 8,\n                                                                                                                                      },\n                                                                                                                                        infoValue: {\n                                                                                                                                          fontSize: 18,\n                                                                                                                                                fontWeight: 'bold',\n                                                                                                                                                color: '#000',\n                                                                                                                                            },\n                                                                                                                                              gain: {\n                                                                                                                                                    color: '#34C759',\n                                                                                                                                                      },\n                                                                                                                                                        loss: {\n                                                                                                                                                              color: '#FF3B30',\n                                                                                                                                                                },\n                                                                                                                                                                  buttonGroup: {\n                                                                                                                                                                        flexDirection: 'row',\n                                                                                                                                                                              gap: 12,\n                                                                                                                                                                          },\n                                                                                                                                                                            button: {\n                                                                                                                                                                              flex: 1,\n                                                                                                                                                                                    paddingVertical: 14,\n                                                                                                                                                                                    borderRadius: 8,\n                                                                                                                                                                                    alignItems: 'center',\n                                                                                                                                                                                    justifyContent: 'center',\n                                                                                                                                                                                },\n                                                                                                                                                                                  cancelButton: {\n                                                                                                                                                                                        backgroundColor: '#f0f0f0',\n                                                                                                                                                                                              borderWidth: 1,\n                                                                                                                                                                                              borderColor: '#ddd',\n                                                                                                                                                                                          },\n                                                                                                                                                                      cancelButtonText: {\n                                                                                                                                                                            fontSize: 16,\n                                                                                                                                                                                  fontWeight: '600',\n                                                                                                                                                                                  color: '#333',\n                                                                                                                                                                              },\n                                                                                                                                                                                saveButton: {\n                                                                                                                                                                                      backgroundColor: '#007AFF',\n                                                                                                                                                                                        },\n                                                                                                                                                                                          saveButtonText: {\n                                                                                                                                                                                                fontSize: 16,\n                                                                                                                                                                                                      fontWeight: '600',\n                                                                                                                                                                                                      color: '#fff',\n                                                                                                                                                                                                  },\n                                                                                                                                                                    });create({\n                                  container: {\n                                        flex: 1{styles.saveButtonText}>\n                                                         {isEdit}\n                                                                     )\n                                                       )}\n                                                  ={[styles.button, .saveButton]}\n                                              styles.cancelButtonText}>Cancel</Text>Text>\n                                              </Text>cancelButton]}\n                                                   ={StyleSheet.buttonGroup}>\n                                            </View>loss,\n                                                                \n                                        ]}styles.infoLabel}>Current Va</Text>={styles.infoValue}>\n                                                  ={styles.infoLabel}>Total Invested:styles.infoBox}>\n                                                              </View>lstyles.errorText}>{errors.cupeholder=\"e.g., 175.\"={[styles.input, errors.currentPrice && styles.inputErroVie{styles.label}>Curr</Vie>styles.formGroup}>\n                                                             <Text </View>{styles.errorText}>{errors.purchaseP</Text>}]}\n                                           styles.input, errors.purchasePrice && li]}<VieText sty{styllabel}>Purchase Price (per share) *</Text>.formGroup}>\n                                                  </Tet>setyles.errorText}>{errors.quantity}</Tex}\n                                               styles.input, errors.quantity &&s.i]}=</View>styles.errorText}>{errors.ticker}</Text>Text>}\n                                                  </Text>placeholder=\"e.g., AA<View {styles.formGroup            ={[styles.input, errors.ticker &&s.inputErr]}                                                        <Text={styles.label}>T{errors.name && <Text={styles.errorText}>{errors.name}</Text>}\n                                              \"}\n                                                }>\n                                                            {/* Investment Name */}\n                                                                    <</View>=yle</KeyboardAvoidingView>\n                                                )\n                                                      }\n                                                      }\n                                                                      }\n                                                              }\n                                                              }\n                                                      }\n                                                }\n                                                }\n                                            }\n                                            })\n                                            }\n                                                  }\n                                                        }\n                                              }\n                                              }\n                                                    }\n                                              }\n                                    }\n                                    }\n                                          }\n                                }\n                                      }\n                                }\n                      }\n                      }\n                      }\n                      }\n                      }\n                      }\n                            }\n                  }\n                        }\n                  }\n        }\n        }\n        }\n              }\n    }\n                }\n          }\n    }","path":null,"size_bytes":38202,"size_tokens":null},"APP_STORE_DEPLOYMENT.md":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"client/screens/auth/LoginScreen.tsx":{"content":"import React, { useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Pressable,\n  ActivityIndicator,\n  Linking,\n  Platform,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport * as AppleAuthentication from 'expo-apple-authentication';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, {\n  FadeIn,\n  FadeInDown,\n  FadeInUp,\n} from 'react-native-reanimated';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport { colors, typography, spacing, layout, shadows } from '@/theme';\n\n/**\n * Login Screen\n * Centered content with logo, SSO buttons, and legal links\n */\nexport default function LoginScreen() {\n  const insets = useSafeAreaInsets();\n  const {\n    signInWithApple,\n    signInWithGoogle,\n    isLoading,\n    error,\n    clearError,\n    isAppleAuthAvailable,\n  } = useAuth();\n\n  // Clear error when component unmounts\n  useEffect(() => {\n    return () => clearError();\n  }, [clearError]);\n\n  const handlePrivacyPolicy = () => {\n    Linking.openURL('https://medinvest.app/privacy');\n  };\n\n  const handleTermsOfService = () => {\n    Linking.openURL('https://medinvest.app/terms');\n  };\n\n  return (\n    <View style={styles.container}>\n      {/* Background gradient */}\n      <LinearGradient\n        colors={[colors.background.primary, colors.background.secondary]}\n        style={StyleSheet.absoluteFill}\n      />\n\n      {/* Content */}\n      <View\n        style={[\n          styles.content,\n          {\n            paddingTop: insets.top + spacing.xl,\n            paddingBottom: insets.bottom + spacing.xl,\n          },\n        ]}\n      >\n        {/* Logo Section */}\n        <Animated.View \n          entering={FadeInDown.duration(600).delay(100)}\n          style={styles.logoSection}\n        >\n          {/* App Icon */}\n          <View style={styles.logoContainer}>\n            <LinearGradient\n              colors={colors.gradient.colors as unknown as string[]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.logoGradient}\n            >\n              <Feather name=\"trending-up\" size={40} color={colors.text.inverse} />\n            </LinearGradient>\n          </View>\n\n          {/* App Name */}\n          <Text style={styles.appName}>MedInvest</Text>\n          \n          {/* Tagline */}\n          <Text style={styles.tagline}>\n            Invest in Medical Innovation\n          </Text>\n        </Animated.View>\n\n        {/* Spacer */}\n        <View style={styles.spacer} />\n\n        {/* Auth Buttons Section */}\n        <Animated.View \n          entering={FadeInUp.duration(600).delay(300)}\n          style={styles.authSection}\n        >\n          {/* Error Message */}\n          {error && (\n            <Animated.View entering={FadeIn.duration(300)} style={styles.errorContainer}>\n              <Feather name=\"alert-circle\" size={16} color={colors.semantic.error} />\n              <Text style={styles.errorText}>{error}</Text>\n            </Animated.View>\n          )}\n\n          {/* Apple Sign In Button */}\n          {isAppleAuthAvailable && (\n            <AppleAuthentication.AppleAuthenticationButton\n              buttonType={AppleAuthentication.AppleAuthenticationButtonType.SIGN_IN}\n              buttonStyle={AppleAuthentication.AppleAuthenticationButtonStyle.BLACK}\n              cornerRadius={layout.radiusLarge}\n              style={styles.appleButton}\n              onPress={signInWithApple}\n            />\n          )}\n\n          {/* Google Sign In Button */}\n          <Pressable\n            style={({ pressed }) => [\n              styles.googleButton,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={signInWithGoogle}\n            disabled={isLoading}\n          >\n            {isLoading ? (\n              <ActivityIndicator color={colors.text.primary} />\n            ) : (\n              <>\n                <GoogleIcon />\n                <Text style={styles.googleButtonText}>Sign in with Google</Text>\n              </>\n            )}\n          </Pressable>\n\n          {/* Divider */}\n          <View style={styles.dividerContainer}>\n            <View style={styles.dividerLine} />\n            <Text style={styles.dividerText}>or</Text>\n            <View style={styles.dividerLine} />\n          </View>\n\n          {/* Email Sign In (placeholder for future) */}\n          <Pressable\n            style={({ pressed }) => [\n              styles.emailButton,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={() => {\n              // TODO: Navigate to email sign in\n            }}\n          >\n            <Feather name=\"mail\" size={20} color={colors.primary.main} />\n            <Text style={styles.emailButtonText}>Continue with Email</Text>\n          </Pressable>\n        </Animated.View>\n\n        {/* Legal Links */}\n        <Animated.View \n          entering={FadeIn.duration(600).delay(500)}\n          style={styles.legalSection}\n        >\n          <Text style={styles.legalText}>\n            By continuing, you agree to our{' '}\n            <Text style={styles.legalLink} onPress={handleTermsOfService}>\n              Terms of Service\n            </Text>\n            {' '}and{' '}\n            <Text style={styles.legalLink} onPress={handlePrivacyPolicy}>\n              Privacy Policy\n            </Text>\n          </Text>\n        </Animated.View>\n      </View>\n    </View>\n  );\n}\n\n/**\n * Google Icon Component\n */\nfunction GoogleIcon() {\n  return (\n    <View style={styles.googleIconContainer}>\n      <View style={styles.googleIcon}>\n        {/* Simplified Google \"G\" icon */}\n        <Text style={styles.googleIconText}>G</Text>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: spacing.xl,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  \n  // Logo Section\n  logoSection: {\n    alignItems: 'center',\n  },\n  logoContainer: {\n    marginBottom: spacing.lg,\n  },\n  logoGradient: {\n    width: 80,\n    height: 80,\n    borderRadius: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n    ...shadows.elevated,\n  },\n  appName: {\n    ...typography.hero,\n    color: colors.text.primary,\n    marginBottom: spacing.xs,\n  },\n  tagline: {\n    ...typography.body,\n    color: colors.text.secondary,\n    textAlign: 'center',\n  },\n\n  // Spacer\n  spacer: {\n    flex: 1,\n    minHeight: spacing['3xl'],\n    maxHeight: 120,\n  },\n\n  // Auth Section\n  authSection: {\n    width: '100%',\n    maxWidth: 320,\n    gap: spacing.md,\n  },\n  \n  // Error\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n    backgroundColor: 'rgba(220, 38, 38, 0.1)',\n    paddingHorizontal: spacing.lg,\n    paddingVertical: spacing.md,\n    borderRadius: layout.radiusMedium,\n    marginBottom: spacing.sm,\n  },\n  errorText: {\n    ...typography.caption,\n    color: colors.semantic.error,\n    flex: 1,\n  },\n\n  // Apple Button\n  appleButton: {\n    width: '100%',\n    height: layout.buttonHeightLarge,\n  },\n\n  // Google Button\n  googleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.md,\n    height: layout.buttonHeightLarge,\n    backgroundColor: colors.surface.primary,\n    borderRadius: layout.radiusLarge,\n    borderWidth: 1,\n    borderColor: colors.border.light,\n    ...shadows.card,\n  },\n  googleButtonText: {\n    ...typography.button.medium,\n    color: colors.text.primary,\n  },\n  googleIconContainer: {\n    width: 20,\n    height: 20,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  googleIcon: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    backgroundColor: colors.surface.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 1,\n    borderColor: colors.border.medium,\n  },\n  googleIconText: {\n    fontSize: 14,\n    fontWeight: '700',\n    color: colors.primary.main,\n  },\n\n  // Divider\n  dividerContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.md,\n    marginVertical: spacing.sm,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: colors.border.light,\n  },\n  dividerText: {\n    ...typography.caption,\n    color: colors.text.tertiary,\n  },\n\n  // Email Button\n  emailButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: spacing.md,\n    height: layout.buttonHeightLarge,\n    backgroundColor: 'transparent',\n    borderRadius: layout.radiusLarge,\n    borderWidth: 1,\n    borderColor: colors.primary.main,\n  },\n  emailButtonText: {\n    ...typography.button.medium,\n    color: colors.primary.main,\n  },\n\n  // Button pressed state\n  buttonPressed: {\n    opacity: 0.8,\n    transform: [{ scale: 0.98 }],\n  },\n\n  // Legal Section\n  legalSection: {\n    marginTop: spacing['2xl'],\n    paddingHorizontal: spacing.lg,\n  },\n  legalText: {\n    ...typography.small,\n    color: colors.text.tertiary,\n    textAlign: 'center',\n    lineHeight: 18,\n  },\n  legalLink: {\n    color: colors.primary.main,\n    textDecorationLine: 'underline',\n  },\n});\n","path":null,"size_bytes":9184,"size_tokens":null},"client/screens/LoginScreenNew.tsx":{"content":"/**\n * Login Screen\n * Email/password login with biometric authentication support\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n  ActivityIndicator,\n  Linking,\n  Image,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport * as Haptics from 'expo-haptics';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { apiClient } from '@/api/client';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { getApiUrl } from '@/lib/query-client';\nimport { biometricAuth, BiometricStatus } from '@/lib/biometric-auth';\nimport type { User } from '@/types';\n\nimport mmiLogo from '../../assets/images/mmi-logo.png';\n\nexport default function LoginScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { setAuthSession, signInWithGoogle, signInWithGithub, signInWithFacebook, signInWithApple, isAppleAuthAvailable, mockSignIn, error: authError, clearError, isLoading: authLoading } = useAuth();\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [loginError, setLoginError] = useState<string | null>(null);\n  const [biometricStatus, setBiometricStatus] = useState<BiometricStatus | null>(null);\n  const [isBiometricEnabled, setIsBiometricEnabled] = useState(false);\n\n  // Check biometric availability on mount and clear any stale errors\n  useEffect(() => {\n    clearError();\n    checkBiometricStatus();\n  }, []);\n\n  const checkBiometricStatus = async () => {\n    const status = await biometricAuth.checkBiometricAvailability();\n    setBiometricStatus(status);\n    \n    const enabled = await biometricAuth.isBiometricLoginEnabled();\n    setIsBiometricEnabled(enabled);\n    \n    // Auto-prompt biometric if enabled\n    if (enabled && status.isAvailable && status.isEnrolled) {\n      handleBiometricLogin();\n    }\n  };\n\n  // Login mutation\n  const loginMutation = useMutation({\n    mutationFn: async (credentials: { email: string; password: string }) => {\n      console.log('Login attempt:', { \n        email: credentials.email, \n        apiBaseUrl: apiClient.defaults.baseURL,\n        platform: Platform.OS,\n      });\n      const response = await apiClient.post<{ token: string; user: User }>('/auth/login', credentials);\n      console.log('Login response:', response.data);\n      return response.data;\n    },\n    onSuccess: async (data, variables) => {\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n      \n      // Prompt to enable biometric if not already enabled\n      if (biometricStatus?.isAvailable && biometricStatus?.isEnrolled && !isBiometricEnabled) {\n        biometricAuth.promptEnableBiometric(variables.email, variables.password);\n      }\n      \n      if (data?.token && data?.user) {\n        await setAuthSession(data.token, data.user);\n      }\n    },\n    onError: (error: any) => {\n      console.log('Login error:', JSON.stringify(error, null, 2));\n      if (Platform.OS !== 'web') {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n      }\n      const message = error?.response?.data?.message || error?.message || 'Login failed. Please check your credentials.';\n      setLoginError(message);\n    },\n  });\n\n  // Handle biometric login\n  const handleBiometricLogin = useCallback(async () => {\n    const credentials = await biometricAuth.getCredentialsWithBiometric();\n    \n    if (credentials) {\n      setEmail(credentials.email);\n      loginMutation.mutate(credentials);\n    }\n  }, [loginMutation]);\n\n  // Handle form submission\n  const handleLogin = useCallback(() => {\n    setLoginError(null);\n    if (!email.trim()) {\n      setLoginError('Please enter your email address.');\n      return;\n    }\n    if (!password) {\n      setLoginError('Please enter your password.');\n      return;\n    }\n    \n    loginMutation.mutate({ email: email.trim(), password });\n  }, [email, password, loginMutation]);\n\n  const handleForgotPassword = useCallback(() => {\n    navigation.navigate('ForgotPassword');\n  }, [navigation]);\n\n  const handleRegister = useCallback(() => {\n    navigation.navigate('Register');\n  }, [navigation]);\n\n  const biometricName = biometricStatus \n    ? biometricAuth.getBiometricName(biometricStatus.biometricType)\n    : 'Biometric';\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        <ScrollView\n          contentContainerStyle={styles.scrollContent}\n          keyboardShouldPersistTaps=\"handled\"\n          showsVerticalScrollIndicator={false}\n        >\n          {/* Logo */}\n          <View style={styles.logoContainer}>\n            <Image\n              source={mmiLogo}\n              style={styles.logoImage}\n              resizeMode=\"contain\"\n            />\n          </View>\n\n          <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>Welcome Back</ThemedText>\n          <ThemedText style={[styles.subtitle, { color: appColors.textSecondary }]}>\n            Sign in to continue to MedInvest\n          </ThemedText>\n\n          {/* Form */}\n          <View style={styles.form}>\n            {/* Email Input */}\n            <View style={[styles.inputContainer, { borderColor: appColors.border, backgroundColor: appColors.background }]}>\n              <Ionicons name=\"mail-outline\" size={20} color={appColors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder=\"Email address\"\n                placeholderTextColor={appColors.textSecondary}\n                value={email}\n                onChangeText={(text) => { setEmail(text); setLoginError(null); }}\n                keyboardType=\"email-address\"\n                autoCapitalize=\"none\"\n                autoCorrect={false}\n                editable={!loginMutation.isPending}\n                testID=\"input-email\"\n              />\n            </View>\n\n            {/* Password Input */}\n            <View style={[styles.inputContainer, { borderColor: appColors.border, backgroundColor: appColors.background }]}>\n              <Ionicons name=\"lock-closed-outline\" size={20} color={appColors.textSecondary} style={styles.inputIcon} />\n              <TextInput\n                style={[styles.input, { color: appColors.textPrimary }]}\n                placeholder=\"Password\"\n                placeholderTextColor={appColors.textSecondary}\n                value={password}\n                onChangeText={(text) => { setPassword(text); setLoginError(null); }}\n                secureTextEntry={!showPassword}\n                editable={!loginMutation.isPending}\n                testID=\"input-password\"\n              />\n              <TouchableOpacity\n                style={styles.passwordToggle}\n                onPress={() => setShowPassword(!showPassword)}\n              >\n                <Ionicons\n                  name={showPassword ? 'eye-off-outline' : 'eye-outline'}\n                  size={20}\n                  color={appColors.textSecondary}\n                />\n              </TouchableOpacity>\n            </View>\n\n            {/* Forgot Password */}\n            <TouchableOpacity style={styles.forgotPassword} onPress={handleForgotPassword}>\n              <ThemedText style={styles.forgotPasswordText}>Forgot Password?</ThemedText>\n            </TouchableOpacity>\n\n            {/* Login Error Display */}\n            {loginError ? (\n              <TouchableOpacity\n                onPress={() => setLoginError(null)}\n                style={[styles.errorBanner, { backgroundColor: appColors.error + '15', borderColor: appColors.error + '30' }]}\n                testID=\"login-error-banner\"\n                accessibilityRole=\"alert\"\n              >\n                <Ionicons name=\"alert-circle-outline\" size={18} color={appColors.error} />\n                <ThemedText style={[styles.errorBannerText, { color: appColors.error }]}>{loginError}</ThemedText>\n                <Ionicons name=\"close\" size={16} color={appColors.error} />\n              </TouchableOpacity>\n            ) : null}\n\n            {/* Login Button */}\n            <TouchableOpacity\n              style={[styles.loginButton, loginMutation.isPending && styles.loginButtonDisabled]}\n              onPress={handleLogin}\n              disabled={loginMutation.isPending}\n              testID=\"button-sign-in\"\n            >\n              <LinearGradient\n                colors={[Colors.primary, Colors.secondary]}\n                start={{ x: 0, y: 0 }}\n                end={{ x: 1, y: 0 }}\n                style={styles.loginButtonGradient}\n              >\n                {loginMutation.isPending ? (\n                  <ActivityIndicator color=\"white\" />\n                ) : (\n                  <ThemedText style={styles.loginButtonText}>Sign In</ThemedText>\n                )}\n              </LinearGradient>\n            </TouchableOpacity>\n\n            {/* Biometric Login Button */}\n            {biometricStatus?.isAvailable && biometricStatus?.isEnrolled && isBiometricEnabled && (\n              <TouchableOpacity\n                style={styles.biometricButton}\n                onPress={handleBiometricLogin}\n                disabled={loginMutation.isPending}\n              >\n                <Ionicons\n                  name={biometricStatus.biometricType === 'facial' ? 'scan-outline' : 'finger-print-outline'}\n                  size={24}\n                  color={Colors.primary}\n                />\n                <ThemedText style={styles.biometricButtonText}>\n                  Sign in with {biometricName}\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n\n            {/* Divider */}\n            <View style={styles.divider}>\n              <View style={[styles.dividerLine, { backgroundColor: appColors.border }]} />\n              <ThemedText style={[styles.dividerText, { color: appColors.textSecondary }]}>or continue with</ThemedText>\n              <View style={[styles.dividerLine, { backgroundColor: appColors.border }]} />\n            </View>\n\n            {/* Auth Error Display */}\n            {authError ? (\n              <TouchableOpacity onPress={clearError} style={[styles.errorBanner, { backgroundColor: appColors.error + '15', borderColor: appColors.error + '30' }]}>\n                <Ionicons name=\"alert-circle-outline\" size={18} color={appColors.error} />\n                <ThemedText style={[styles.errorBannerText, { color: appColors.error }]}>{authError}</ThemedText>\n                <Ionicons name=\"close\" size={16} color={appColors.error} />\n              </TouchableOpacity>\n            ) : null}\n\n            {/* Social Login */}\n            <View style={styles.socialButtons}>\n              <TouchableOpacity \n                style={[styles.socialButton, { borderColor: appColors.border, backgroundColor: appColors.surface }]}\n                onPress={() => {\n                  console.log('Google button pressed');\n                  signInWithGoogle();\n                }}\n                disabled={authLoading}\n                testID=\"button-google-login\"\n              >\n                <Ionicons name=\"logo-google\" size={20} color={appColors.textPrimary} />\n              </TouchableOpacity>\n              <TouchableOpacity \n                style={[styles.socialButton, { borderColor: appColors.border, backgroundColor: appColors.surface }]}\n                onPress={() => {\n                  console.log('GitHub button pressed');\n                  signInWithGithub();\n                }}\n                disabled={authLoading}\n                testID=\"button-github-login\"\n              >\n                <Ionicons name=\"logo-github\" size={20} color={appColors.textPrimary} />\n              </TouchableOpacity>\n              <TouchableOpacity \n                style={[styles.socialButton, { borderColor: appColors.border, backgroundColor: appColors.surface }]}\n                onPress={() => {\n                  console.log('Facebook button pressed');\n                  signInWithFacebook();\n                }}\n                disabled={authLoading}\n                testID=\"button-facebook-login\"\n              >\n                <Ionicons name=\"logo-facebook\" size={20} color={appColors.textPrimary} />\n              </TouchableOpacity>\n              {isAppleAuthAvailable && Platform.OS === 'ios' ? (\n                <TouchableOpacity \n                  style={[styles.socialButton, { borderColor: appColors.border, backgroundColor: appColors.surface }]}\n                  onPress={signInWithApple}\n                  disabled={authLoading}\n                  testID=\"button-apple-login\"\n                >\n                  <Ionicons name=\"logo-apple\" size={20} color={appColors.textPrimary} />\n                </TouchableOpacity>\n              ) : null}\n            </View>\n          </View>\n\n          {/* Register Link */}\n          <View style={styles.registerContainer}>\n            <ThemedText style={[styles.registerText, { color: appColors.textSecondary }]}>Don't have an account? </ThemedText>\n            <TouchableOpacity onPress={handleRegister}>\n              <ThemedText style={styles.registerLink}>Sign Up</ThemedText>\n            </TouchableOpacity>\n          </View>\n\n          {/* Demo Login */}\n          <TouchableOpacity\n            style={[styles.demoButton, { borderColor: appColors.border }]}\n            onPress={mockSignIn}\n            disabled={authLoading}\n            testID=\"button-demo-login\"\n          >\n            <Ionicons name=\"flask-outline\" size={18} color={appColors.textSecondary} />\n            <ThemedText style={[styles.demoButtonText, { color: appColors.textSecondary }]}>Try Demo Account</ThemedText>\n          </TouchableOpacity>\n\n          {/* Legal Links */}\n          <View style={styles.legalContainer}>\n            <ThemedText style={[styles.legalText, { color: appColors.textSecondary }]}>\n              By signing in, you agree to our{' '}\n            </ThemedText>\n            <TouchableOpacity\n              onPress={() => Linking.openURL(`${getApiUrl()}/terms`)}\n              testID=\"link-terms\"\n            >\n              <ThemedText style={styles.legalLink}>Terms of Service</ThemedText>\n            </TouchableOpacity>\n            <ThemedText style={[styles.legalText, { color: appColors.textSecondary }]}> and </ThemedText>\n            <TouchableOpacity\n              onPress={() => Linking.openURL(`${getApiUrl()}/privacy`)}\n              testID=\"link-privacy\"\n            >\n              <ThemedText style={styles.legalLink}>Privacy Policy</ThemedText>\n            </TouchableOpacity>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing['3xl'],\n    paddingBottom: Spacing.xl,\n  },\n  logoContainer: {\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  logoImage: {\n    width: 240,\n    height: 240,\n    borderRadius: 48,\n  },\n  title: {\n    ...Typography.hero,\n    textAlign: 'center',\n  },\n  subtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    marginBottom: Spacing.xl,\n  },\n  form: {\n    marginTop: Spacing.lg,\n  },\n  errorBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.sm,\n    paddingHorizontal: Spacing.md,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    marginBottom: Spacing.md,\n    gap: Spacing.sm,\n  },\n  errorBannerText: {\n    ...Typography.caption,\n    flex: 1,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.md,\n    borderWidth: 1,\n  },\n  inputIcon: {\n    marginLeft: Spacing.md,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    paddingVertical: Spacing.lg,\n    paddingHorizontal: Spacing.md,\n  },\n  passwordToggle: {\n    padding: Spacing.md,\n  },\n  forgotPassword: {\n    alignSelf: 'flex-end',\n    marginBottom: Spacing.xl,\n  },\n  forgotPasswordText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  loginButton: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  loginButtonDisabled: {\n    opacity: 0.7,\n  },\n  loginButtonGradient: {\n    paddingVertical: Spacing.lg,\n    alignItems: 'center',\n  },\n  loginButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '700',\n  },\n  biometricButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    marginTop: Spacing.md,\n    backgroundColor: Colors.primary + '10',\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  biometricButtonText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  divider: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginVertical: Spacing.xl,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n  },\n  dividerText: {\n    ...Typography.caption,\n    marginHorizontal: Spacing.md,\n  },\n  socialButtons: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    gap: Spacing.lg,\n  },\n  socialButton: {\n    width: 56,\n    height: 56,\n    borderRadius: BorderRadius.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 1,\n  },\n  registerContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    marginTop: Spacing.xl,\n  },\n  registerText: {\n    ...Typography.body,\n  },\n  registerLink: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  demoButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.md,\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.md,\n    gap: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    borderStyle: 'dashed',\n  },\n  demoButtonText: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  legalContainer: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    justifyContent: 'center',\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.md,\n    paddingHorizontal: Spacing.md,\n  },\n  legalText: {\n    fontSize: 12,\n    lineHeight: 18,\n  },\n  legalLink: {\n    fontSize: 12,\n    lineHeight: 18,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":19115,"size_tokens":null},"client/components/RoomFilter.tsx":{"content":"/**\n * RoomFilter Component\n * Horizontal scrollable list of room filters\n */\n\nimport React, { memo, useRef, useEffect } from 'react';\nimport {\n  View,\n  ScrollView,\n  StyleSheet,\n  TouchableOpacity,\n  Animated,\n} from 'react-native';\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { Room } from '@/types';\n\ninterface RoomFilterProps {\n  rooms: Room[];\n  selectedRoom: string | null;\n  onSelectRoom: (roomSlug: string | null) => void;\n}\n\nfunction RoomFilter({ rooms, selectedRoom, onSelectRoom }: RoomFilterProps) {\n  const appColors = useAppColors();\n  const scrollRef = useRef<ScrollView>(null);\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n\n  useEffect(() => {\n    Animated.timing(fadeAnim, {\n      toValue: 1,\n      duration: 300,\n      useNativeDriver: true,\n    }).start();\n  }, []);\n\n  const handleSelectRoom = (slug: string | null) => {\n    onSelectRoom(slug === selectedRoom ? null : slug);\n  };\n\n  return (\n    <Animated.View style={[styles.container, { opacity: fadeAnim }]}>\n      <ScrollView\n        ref={scrollRef}\n        horizontal\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.scrollContent}\n      >\n        {/* All Rooms Option */}\n        <TouchableOpacity\n          style={[\n            styles.roomChip,\n            selectedRoom === null && styles.roomChipActive,\n          ]}\n          onPress={() => handleSelectRoom(null)}\n        >\n          <ThemedText style={styles.roomIcon}>üåê</ThemedText>\n          <ThemedText\n            style={[\n              styles.roomName,\n              { color: appColors.textSecondary },\n              selectedRoom === null && styles.roomNameActive,\n            ]}\n          >\n            All\n          </ThemedText>\n        </TouchableOpacity>\n\n        {/* Room Options */}\n        {rooms.map((room) => (\n          <TouchableOpacity\n            key={room.slug}\n            style={[\n              styles.roomChip,\n              selectedRoom === room.slug && styles.roomChipActive,\n              selectedRoom === room.slug && { backgroundColor: room.color + '20' },\n            ]}\n            onPress={() => handleSelectRoom(room.slug)}\n          >\n            <ThemedText style={styles.roomIcon}>{room.icon}</ThemedText>\n            <ThemedText\n              style={[\n                styles.roomName,\n                { color: appColors.textSecondary },\n                selectedRoom === room.slug && styles.roomNameActive,\n                selectedRoom === room.slug && { color: room.color },\n              ]}\n            >\n              {room.name}\n            </ThemedText>\n            {room.posts_count > 0 && (\n              <View style={[styles.countBadge, { backgroundColor: room.color + '30' }]}>\n                <ThemedText style={[styles.countText, { color: room.color }]}>\n                  {room.posts_count > 99 ? '99+' : room.posts_count}\n                </ThemedText>\n              </View>\n            )}\n          </TouchableOpacity>\n        ))}\n      </ScrollView>\n    </Animated.View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingVertical: Spacing.md,\n  },\n  scrollContent: {\n    paddingHorizontal: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  roomChip: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n    gap: Spacing.xs,\n  },\n  roomChipActive: {\n    backgroundColor: Colors.primary + '15',\n  },\n  roomIcon: {\n    fontSize: 14,\n  },\n  roomName: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  roomNameActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  countBadge: {\n    paddingHorizontal: Spacing.xs,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.full,\n    marginLeft: Spacing.xs,\n  },\n  countText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n});\n\nexport default memo(RoomFilter);\n","path":null,"size_bytes":4083,"size_tokens":null},"client/screens/InvestmentDetailScreen.tsx":{"content":"import React from \"react\";\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  Image,\n  Pressable,\n  Share,\n  Platform,\n} from \"react-native\";\nimport { useRoute, useNavigation, RouteProp } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport * as Haptics from \"expo-haptics\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { investmentOpportunities } from \"@/lib/mockData\";\nimport { DiscoverStackParamList } from \"@/navigation/DiscoverStackNavigator\";\nimport { RootStackParamList } from \"@/navigation/RootStackNavigator\";\n\ntype RouteParams = RouteProp<DiscoverStackParamList, \"InvestmentDetail\">;\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport default function InvestmentDetailScreen() {\n  const route = useRoute<RouteParams>();\n  const navigation = useNavigation<NativeStackNavigationProp<RootStackParamList>>();\n  const insets = useSafeAreaInsets();\n  const { theme } = useTheme();\n  const appColors = useAppColors();\n  const scale = useSharedValue(1);\n\n  const opportunity = investmentOpportunities.find(\n    (opp) => opp.id === route.params.id\n  );\n\n  if (!opportunity) {\n    return (\n      <ThemedView style={styles.container}>\n        <ThemedText>Opportunity not found</ThemedText>\n      </ThemedView>\n    );\n  }\n\n  const progress = (opportunity.fundingRaised / opportunity.fundingGoal) * 100;\n\n  const handleShare = async () => {\n    try {\n      await Share.share({\n        message: `Check out this investment opportunity: ${opportunity.title} by ${opportunity.company}`,\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleInvest = () => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    navigation.navigate(\"InvestModal\", { opportunityId: opportunity.id });\n  };\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98, { damping: 15, stiffness: 150 });\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, { damping: 15, stiffness: 150 });\n  };\n\n  const getRiskColor = () => {\n    switch (opportunity.riskLevel) {\n      case \"low\":\n        return Colors.secondary;\n      case \"medium\":\n        return appColors.warning;\n      case \"high\":\n        return appColors.error;\n    }\n  };\n\n  React.useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: () => (\n        <Pressable onPress={handleShare} hitSlop={8}>\n          <Feather name=\"share\" size={22} color={theme.text} />\n        </Pressable>\n      ),\n    });\n  }, [navigation, theme]);\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <ScrollView\n        showsVerticalScrollIndicator={false}\n        contentContainerStyle={{ paddingBottom: 100 + insets.bottom }}\n      >\n        <Image\n          source={require(\"../../assets/images/investment-hero-placeholder.png\")}\n          style={styles.heroImage}\n          resizeMode=\"cover\"\n        />\n\n        <View style={styles.content}>\n          <View style={styles.badgeRow}>\n            <View\n              style={[styles.categoryBadge, { backgroundColor: Colors.primary + \"15\" }]}\n            >\n              <ThemedText\n                type=\"small\"\n                style={[styles.categoryText, { color: Colors.primary }]}\n              >\n                {opportunity.category.replace(\"-\", \" \").toUpperCase()}\n              </ThemedText>\n            </View>\n            <View\n              style={[styles.riskBadge, { backgroundColor: getRiskColor() + \"15\" }]}\n            >\n              <ThemedText\n                type=\"small\"\n                style={[styles.riskText, { color: getRiskColor() }]}\n              >\n                {opportunity.riskLevel.toUpperCase()} RISK\n              </ThemedText>\n            </View>\n          </View>\n\n          <ThemedText type=\"title\" style={styles.title}>\n            {opportunity.title}\n          </ThemedText>\n          <ThemedText\n            type=\"body\"\n            style={[styles.company, { color: theme.textSecondary }]}\n          >\n            by {opportunity.company}\n          </ThemedText>\n\n          <View\n            style={[styles.fundingCard, { backgroundColor: theme.backgroundDefault }, Shadows.card]}\n          >\n            <View style={styles.fundingHeader}>\n              <View>\n                <ThemedText type=\"hero\" style={{ color: Colors.primary }}>\n                  ${(opportunity.fundingRaised / 1000000).toFixed(2)}M\n                </ThemedText>\n                <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                  raised of ${(opportunity.fundingGoal / 1000000).toFixed(0)}M goal\n                </ThemedText>\n              </View>\n              <View style={styles.daysContainer}>\n                <ThemedText type=\"heading\" style={{ color: appColors.warning }}>\n                  {opportunity.daysRemaining}\n                </ThemedText>\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                  days left\n                </ThemedText>\n              </View>\n            </View>\n\n            <View style={[styles.progressBar, { backgroundColor: appColors.border }]}>\n              <LinearGradient\n                colors={[Colors.gradient.start, Colors.gradient.end]}\n                start={{ x: 0, y: 0 }}\n                end={{ x: 1, y: 0 }}\n                style={[styles.progressFill, { width: `${Math.min(progress, 100)}%` }]}\n              />\n            </View>\n          </View>\n\n          <View style={styles.metricsGrid}>\n            <MetricCard\n              label=\"Expected ROI\"\n              value={opportunity.expectedROI}\n              icon=\"trending-up\"\n            />\n            <MetricCard\n              label=\"Investors\"\n              value=\"247\"\n              icon=\"users\"\n            />\n            <MetricCard\n              label=\"Min. Investment\"\n              value=\"$1,000\"\n              icon=\"dollar-sign\"\n            />\n            <MetricCard\n              label=\"Risk Level\"\n              value={opportunity.riskLevel}\n              icon=\"shield\"\n            />\n          </View>\n\n          <View style={styles.section}>\n            <ThemedText type=\"heading\" style={styles.sectionTitle}>\n              About\n            </ThemedText>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              {opportunity.description}\n            </ThemedText>\n          </View>\n\n          <View style={styles.section}>\n            <ThemedText type=\"heading\" style={styles.sectionTitle}>\n              Key Highlights\n            </ThemedText>\n            {opportunity.highlights.map((highlight, index) => (\n              <View key={index} style={styles.highlightItem}>\n                <View\n                  style={[styles.highlightDot, { backgroundColor: Colors.secondary }]}\n                />\n                <ThemedText type=\"body\">{highlight}</ThemedText>\n              </View>\n            ))}\n          </View>\n\n          <View style={styles.section}>\n            <ThemedText type=\"heading\" style={styles.sectionTitle}>\n              Documents\n            </ThemedText>\n            {opportunity.documents.map((doc, index) => (\n              <Pressable\n                key={index}\n                style={[styles.documentItem, { backgroundColor: theme.backgroundDefault }]}\n              >\n                <Feather name=\"file-text\" size={20} color={Colors.primary} />\n                <ThemedText type=\"body\" style={styles.documentName}>\n                  {doc.name}\n                </ThemedText>\n                <Feather name=\"download\" size={18} color={theme.textSecondary} />\n              </Pressable>\n            ))}\n          </View>\n        </View>\n      </ScrollView>\n\n      <View\n        style={[\n          styles.bottomBar,\n          {\n            backgroundColor: theme.backgroundDefault,\n            paddingBottom: insets.bottom + Spacing.lg,\n            borderTopColor: appColors.border,\n          },\n        ]}\n      >\n        <AnimatedPressable\n          onPress={handleInvest}\n          onPressIn={handlePressIn}\n          onPressOut={handlePressOut}\n          style={[styles.investButton, animatedStyle]}\n        >\n          <LinearGradient\n            colors={[Colors.gradient.start, Colors.gradient.end]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 0 }}\n            style={styles.investButtonGradient}\n          >\n            <ThemedText type=\"body\" style={styles.investButtonText}>\n              Invest Now\n            </ThemedText>\n          </LinearGradient>\n        </AnimatedPressable>\n      </View>\n    </View>\n  );\n}\n\nfunction MetricCard({\n  label,\n  value,\n  icon,\n}: {\n  label: string;\n  value: string;\n  icon: string;\n}) {\n  const { theme } = useTheme();\n\n  return (\n    <View style={[styles.metricCard, { backgroundColor: theme.backgroundDefault }]}>\n      <Feather name={icon as any} size={20} color={Colors.primary} />\n      <ThemedText type=\"heading\" style={styles.metricValue}>\n        {value}\n      </ThemedText>\n      <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n        {label}\n      </ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  heroImage: {\n    width: \"100%\",\n    height: 200,\n  },\n  content: {\n    padding: Spacing.xl,\n  },\n  badgeRow: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n    marginBottom: Spacing.md,\n  },\n  categoryBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  categoryText: {\n    fontWeight: \"600\",\n  },\n  riskBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  riskText: {\n    fontWeight: \"600\",\n  },\n  title: {\n    marginBottom: Spacing.xs,\n  },\n  company: {\n    marginBottom: Spacing.xl,\n  },\n  fundingCard: {\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.xl,\n  },\n  fundingHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.lg,\n  },\n  daysContainer: {\n    alignItems: \"flex-end\",\n  },\n  progressBar: {\n    height: 8,\n    borderRadius: 4,\n    overflow: \"hidden\",\n  },\n  progressFill: {\n    height: \"100%\",\n    borderRadius: 4,\n  },\n  metricsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  metricCard: {\n    flex: 1,\n    minWidth: \"45%\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  metricValue: {\n    textTransform: \"capitalize\",\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    marginBottom: Spacing.md,\n  },\n  highlightItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.sm,\n  },\n  highlightDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  documentItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.sm,\n    gap: Spacing.md,\n  },\n  documentName: {\n    flex: 1,\n  },\n  bottomBar: {\n    position: \"absolute\",\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: Spacing.lg,\n    paddingTop: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  investButton: {\n    borderRadius: BorderRadius.full,\n    overflow: \"hidden\",\n  },\n  investButtonGradient: {\n    height: Spacing.buttonHeight,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  investButtonText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":12250,"size_tokens":null},"server/routes/investments.ts":{"content":"import { Router, Request, Response } from 'express';\nimport {\n  db,\n  investments,\n  investmentDocuments,\n  investmentTeamMembers,\n  investmentMilestones,\n} from '../db';\nimport { eq, and, or, gte, lte, like, desc, asc, sql, ilike } from 'drizzle-orm';\nimport { authMiddleware, optionalAuthMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\n/**\n * Helper to calculate days remaining\n */\nfunction calculateDaysRemaining(endDate: Date): number {\n  const now = new Date();\n  const diffTime = endDate.getTime() - now.getTime();\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  return Math.max(0, diffDays);\n}\n\n/**\n * Helper to format investment response\n */\nfunction formatInvestment(inv: any) {\n  return {\n    id: inv.id,\n    name: inv.name,\n    description: inv.description,\n    longDescription: inv.longDescription,\n    category: inv.category,\n    fundingGoal: parseFloat(inv.fundingGoal),\n    fundingCurrent: parseFloat(inv.fundingCurrent),\n    minimumInvestment: parseFloat(inv.minimumInvestment),\n    expectedROI: inv.expectedRoiMin && inv.expectedRoiMax\n      ? `${inv.expectedRoiMin}-${inv.expectedRoiMax}%`\n      : inv.expectedRoiMin\n      ? `${inv.expectedRoiMin}%+`\n      : 'TBD',\n    riskLevel: inv.riskLevel,\n    status: inv.status,\n    imageUrl: inv.imageUrl,\n    daysRemaining: calculateDaysRemaining(new Date(inv.endDate)),\n    startDate: inv.startDate,\n    endDate: inv.endDate,\n    investors: inv.investorCount,\n    createdAt: inv.createdAt,\n    updatedAt: inv.updatedAt,\n  };\n}\n\n/**\n * GET /api/investments\n * List investments with filters and pagination\n */\nrouter.get('/', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const {\n      page = '1',\n      limit = '10',\n      category,\n      riskLevel,\n      status = 'active',\n      minInvestment,\n      maxInvestment,\n      sortBy = 'newest',\n    } = req.query;\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Build where conditions\n    const conditions = [];\n\n    if (status) {\n      conditions.push(eq(investments.status, status as any));\n    }\n\n    if (category) {\n      conditions.push(eq(investments.category, category as any));\n    }\n\n    if (riskLevel) {\n      conditions.push(eq(investments.riskLevel, riskLevel as any));\n    }\n\n    if (minInvestment) {\n      conditions.push(gte(investments.minimumInvestment, minInvestment as string));\n    }\n\n    if (maxInvestment) {\n      conditions.push(lte(investments.minimumInvestment, maxInvestment as string));\n    }\n\n    // Build order by\n    let orderBy;\n    switch (sortBy) {\n      case 'endingSoon':\n        orderBy = asc(investments.endDate);\n        break;\n      case 'mostFunded':\n        orderBy = desc(investments.fundingCurrent);\n        break;\n      case 'highestROI':\n        orderBy = desc(investments.expectedRoiMax);\n        break;\n      case 'newest':\n      default:\n        orderBy = desc(investments.createdAt);\n    }\n\n    // Execute queries\n    const whereClause = conditions.length > 0 ? and(...conditions) : undefined;\n\n    const [investmentsList, [countResult]] = await Promise.all([\n      db\n        .select()\n        .from(investments)\n        .where(whereClause)\n        .orderBy(orderBy)\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(investments)\n        .where(whereClause),\n    ]);\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    res.json({\n      data: investmentsList.map(formatInvestment),\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('List investments error:', error);\n    res.status(500).json({ message: 'Failed to fetch investments' });\n  }\n});\n\n/**\n * GET /api/investments/search\n * Search investments\n */\nrouter.get('/search', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const {\n      q = '',\n      page = '1',\n      limit = '10',\n      category,\n      riskLevel,\n    } = req.query;\n\n    const searchQuery = (q as string).trim();\n    \n    if (searchQuery.length < 2) {\n      res.json({\n        data: [],\n        page: 1,\n        limit: 10,\n        totalItems: 0,\n        totalPages: 0,\n        hasMore: false,\n      });\n      return;\n    }\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Build conditions\n    const conditions = [\n      eq(investments.status, 'active'),\n      or(\n        ilike(investments.name, `%${searchQuery}%`),\n        ilike(investments.description, `%${searchQuery}%`)\n      ),\n    ];\n\n    if (category) {\n      conditions.push(eq(investments.category, category as any));\n    }\n\n    if (riskLevel) {\n      conditions.push(eq(investments.riskLevel, riskLevel as any));\n    }\n\n    const whereClause = and(...conditions);\n\n    const [investmentsList, [countResult]] = await Promise.all([\n      db\n        .select()\n        .from(investments)\n        .where(whereClause)\n        .orderBy(desc(investments.createdAt))\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(investments)\n        .where(whereClause),\n    ]);\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    res.json({\n      data: investmentsList.map(formatInvestment),\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('Search investments error:', error);\n    res.status(500).json({ message: 'Failed to search investments' });\n  }\n});\n\n/**\n * GET /api/investments/:id\n * Get investment detail\n */\nrouter.get('/:id', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    // Fetch investment with related data\n    const [investment] = await db\n      .select()\n      .from(investments)\n      .where(eq(investments.id, id))\n      .limit(1);\n\n    if (!investment) {\n      res.status(404).json({ message: 'Investment not found' });\n      return;\n    }\n\n    // Fetch related data\n    const [documents, teamMembers, milestones] = await Promise.all([\n      db\n        .select()\n        .from(investmentDocuments)\n        .where(eq(investmentDocuments.investmentId, id)),\n      db\n        .select()\n        .from(investmentTeamMembers)\n        .where(eq(investmentTeamMembers.investmentId, id))\n        .orderBy(investmentTeamMembers.sortOrder),\n      db\n        .select()\n        .from(investmentMilestones)\n        .where(eq(investmentMilestones.investmentId, id))\n        .orderBy(investmentMilestones.sortOrder),\n    ]);\n\n    res.json({\n      ...formatInvestment(investment),\n      documents: documents.map((d) => ({\n        id: d.id,\n        name: d.name,\n        type: d.type,\n        url: d.url,\n      })),\n      team: teamMembers.map((t) => ({\n        id: t.id,\n        name: t.name,\n        role: t.role,\n        avatarUrl: t.avatarUrl,\n        linkedInUrl: t.linkedInUrl,\n      })),\n      milestones: milestones.map((m) => ({\n        id: m.id,\n        title: m.title,\n        description: m.description,\n        targetDate: m.targetDate,\n        completed: m.completed,\n        completedAt: m.completedAt,\n      })),\n    });\n  } catch (error) {\n    console.error('Get investment error:', error);\n    res.status(500).json({ message: 'Failed to fetch investment' });\n  }\n});\n\n/**\n * GET /api/investments/categories/stats\n * Get investment counts by category\n */\nrouter.get('/categories/stats', async (req: Request, res: Response) => {\n  try {\n    const stats = await db\n      .select({\n        category: investments.category,\n        count: sql<number>`count(*)::int`,\n      })\n      .from(investments)\n      .where(eq(investments.status, 'active'))\n      .groupBy(investments.category);\n\n    res.json(stats);\n  } catch (error) {\n    console.error('Get category stats error:', error);\n    res.status(500).json({ message: 'Failed to fetch category stats' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":8364,"size_tokens":null},"client/screens/main/TransactionHistoryScreen.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  FlatList,\n  Pressable,\n  RefreshControl,\n} from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Feather } from '@expo/vector-icons';\nimport Animated, { FadeInDown } from 'react-native-reanimated';\n\nimport { colors, typography, spacing, layout } from '@/theme';\nimport {\n  Badge,\n  Card,\n  EmptyState,\n  SkeletonListItem,\n} from '@/components';\nimport { useTransactions } from '@/api';\nimport { useInfiniteList } from '@/hooks';\nimport type { Transaction } from '@/types';\n\ntype TransactionFilter = 'all' | 'investment' | 'dividend' | 'withdrawal';\n\nconst FILTERS: { key: TransactionFilter; label: string }[] = [\n  { key: 'all', label: 'All' },\n  { key: 'investment', label: 'Investments' },\n  { key: 'dividend', label: 'Dividends' },\n  { key: 'withdrawal', label: 'Withdrawals' },\n];\n\ninterface TransactionHistoryScreenProps {\n  navigation: any;\n}\n\nexport default function TransactionHistoryScreen({\n  navigation,\n}: TransactionHistoryScreenProps) {\n  const insets = useSafeAreaInsets();\n  const [filter, setFilter] = useState<TransactionFilter>('all');\n\n  const transactionsQuery = useTransactions(\n    filter === 'all' ? undefined : filter\n  );\n\n  const {\n    data: transactions,\n    isLoading,\n    refreshing,\n    onRefresh,\n    onEndReached,\n    isFetchingNextPage,\n    isEmpty,\n  } = useInfiniteList(transactionsQuery);\n\n  const handleBack = useCallback(() => {\n    navigation.goBack();\n  }, [navigation]);\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n    });\n  };\n\n  const formatTime = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString('en-US', {\n      hour: 'numeric',\n      minute: '2-digit',\n    });\n  };\n\n  const getTransactionIcon = (type: string): keyof typeof Feather.glyphMap => {\n    switch (type) {\n      case 'investment':\n        return 'trending-up';\n      case 'dividend':\n        return 'dollar-sign';\n      case 'withdrawal':\n        return 'arrow-down-circle';\n      case 'refund':\n        return 'rotate-ccw';\n      default:\n        return 'activity';\n    }\n  };\n\n  const getTransactionColor = (type: string) => {\n    switch (type) {\n      case 'investment':\n        return colors.primary.main;\n      case 'dividend':\n        return colors.semantic.success;\n      case 'withdrawal':\n        return colors.semantic.warning;\n      case 'refund':\n        return colors.text.secondary;\n      default:\n        return colors.text.primary;\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <Badge variant=\"success\" size=\"sm\">Completed</Badge>;\n      case 'pending':\n        return <Badge variant=\"warning\" size=\"sm\">Pending</Badge>;\n      case 'failed':\n        return <Badge variant=\"error\" size=\"sm\">Failed</Badge>;\n      default:\n        return null;\n    }\n  };\n\n  const renderTransaction = useCallback(\n    ({ item, index }: { item: Transaction; index: number }) => {\n      const icon = getTransactionIcon(item.type);\n      const iconColor = getTransactionColor(item.type);\n      const isPositive = item.type === 'dividend' || item.type === 'refund';\n\n      return (\n        <Animated.View entering={FadeInDown.delay(index * 50).duration(300)}>\n          <Card\n            variant=\"flat\"\n            padding=\"md\"\n            style={styles.transactionCard}\n          >\n            <View style={styles.transactionRow}>\n              {/* Icon */}\n              <View\n                style={[\n                  styles.iconContainer,\n                  { backgroundColor: `${iconColor}15` },\n                ]}\n              >\n                <Feather name={icon} size={20} color={iconColor} />\n              </View>\n\n              {/* Details */}\n              <View style={styles.transactionDetails}>\n                <View style={styles.transactionHeader}>\n                  <Text style={styles.transactionType}>\n                    {item.type.charAt(0).toUpperCase() + item.type.slice(1)}\n                  </Text>\n                  {getStatusBadge(item.status)}\n                </View>\n                \n                {item.investmentName && (\n                  <Text style={styles.investmentName} numberOfLines={1}>\n                    {item.investmentName}\n                  </Text>\n                )}\n                \n                <Text style={styles.transactionDate}>\n                  {formatDate(item.createdAt)} at {formatTime(item.createdAt)}\n                </Text>\n              </View>\n\n              {/* Amount */}\n              <Text\n                style={[\n                  styles.amount,\n                  isPositive ? styles.amountPositive : styles.amountNegative,\n                ]}\n              >\n                {isPositive ? '+' : '-'}${item.amount.toLocaleString()}\n              </Text>\n            </View>\n          </Card>\n        </Animated.View>\n      );\n    },\n    []\n  );\n\n  const renderSkeleton = () => (\n    <View style={styles.skeletonContainer}>\n      {Array.from({ length: 6 }).map((_, index) => (\n        <SkeletonListItem\n          key={index}\n          hasAvatar\n          avatarSize={44}\n          lines={2}\n          hasRightElement\n          style={styles.skeletonItem}\n        />\n      ))}\n    </View>\n  );\n\n  const renderEmpty = () => (\n    <EmptyState\n      icon=\"activity\"\n      title=\"No transactions yet\"\n      description=\"Your investment transactions will appear here once you start investing.\"\n      primaryAction={{\n        label: 'Explore Investments',\n        onPress: () => navigation.navigate('Discover'),\n      }}\n    />\n  );\n\n  const renderHeader = () => (\n    <View style={styles.filtersContainer}>\n      <FlatList\n        horizontal\n        data={FILTERS}\n        keyExtractor={(item) => item.key}\n        showsHorizontalScrollIndicator={false}\n        contentContainerStyle={styles.filtersList}\n        renderItem={({ item }) => (\n          <Pressable\n            onPress={() => setFilter(item.key)}\n            style={[\n              styles.filterChip,\n              filter === item.key && styles.filterChipActive,\n            ]}\n          >\n            <Text\n              style={[\n                styles.filterChipText,\n                filter === item.key && styles.filterChipTextActive,\n              ]}\n            >\n              {item.label}\n            </Text>\n          </Pressable>\n        )}\n      />\n    </View>\n  );\n\n  const renderFooter = () => {\n    if (!isFetchingNextPage) return null;\n    \n    return (\n      <View style={styles.footerLoader}>\n        <SkeletonListItem hasAvatar avatarSize={44} lines={2} hasRightElement />\n      </View>\n    );\n  };\n\n  return (\n    <View style={[styles.container, { paddingTop: insets.top }]}>\n      {/* Header */}\n      <View style={styles.header}>\n        <Pressable onPress={handleBack} style={styles.backButton} hitSlop={8}>\n          <Feather name=\"arrow-left\" size={24} color={colors.text.primary} />\n        </Pressable>\n        <Text style={styles.headerTitle}>Transaction History</Text>\n        <View style={styles.headerSpacer} />\n      </View>\n\n      {/* Filters */}\n      {renderHeader()}\n\n      {/* Transactions List */}\n      {isLoading ? (\n        renderSkeleton()\n      ) : isEmpty ? (\n        renderEmpty()\n      ) : (\n        <FlatList\n          data={transactions}\n          keyExtractor={(item) => item.id}\n          renderItem={renderTransaction}\n          contentContainerStyle={[\n            styles.listContent,\n            { paddingBottom: insets.bottom + spacing.lg },\n          ]}\n          showsVerticalScrollIndicator={false}\n          onEndReached={onEndReached}\n          onEndReachedThreshold={0.5}\n          ListFooterComponent={renderFooter}\n          refreshControl={\n            <RefreshControl\n              refreshing={refreshing}\n              onRefresh={onRefresh}\n              tintColor={colors.primary.main}\n            />\n          }\n        />\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: colors.background.primary,\n  },\n\n  // Header\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  backButton: {\n    padding: spacing.xs,\n  },\n  headerTitle: {\n    ...typography.heading,\n    color: colors.text.primary,\n  },\n  headerSpacer: {\n    width: 40,\n  },\n\n  // Filters\n  filtersContainer: {\n    borderBottomWidth: 1,\n    borderBottomColor: colors.border.light,\n  },\n  filtersList: {\n    paddingHorizontal: spacing.md,\n    paddingVertical: spacing.sm,\n    gap: spacing.sm,\n  },\n  filterChip: {\n    paddingVertical: spacing.sm,\n    paddingHorizontal: spacing.md,\n    borderRadius: layout.radiusFull,\n    backgroundColor: colors.background.secondary,\n    marginRight: spacing.sm,\n  },\n  filterChipActive: {\n    backgroundColor: colors.primary.main,\n  },\n  filterChipText: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    fontWeight: '500',\n  },\n  filterChipTextActive: {\n    color: colors.text.inverse,\n  },\n\n  // List\n  listContent: {\n    padding: spacing.md,\n    gap: spacing.sm,\n  },\n\n  // Transaction Card\n  transactionCard: {\n    marginBottom: spacing.xs,\n  },\n  transactionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  iconContainer: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: spacing.md,\n  },\n  transactionDetails: {\n    flex: 1,\n    marginRight: spacing.sm,\n  },\n  transactionHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: spacing.sm,\n    marginBottom: spacing.xs / 2,\n  },\n  transactionType: {\n    ...typography.bodyMedium,\n    color: colors.text.primary,\n  },\n  investmentName: {\n    ...typography.caption,\n    color: colors.text.secondary,\n    marginBottom: spacing.xs / 2,\n  },\n  transactionDate: {\n    ...typography.small,\n    color: colors.text.tertiary,\n  },\n  amount: {\n    ...typography.bodyMedium,\n    fontWeight: '600',\n  },\n  amountPositive: {\n    color: colors.semantic.success,\n  },\n  amountNegative: {\n    color: colors.text.primary,\n  },\n\n  // Skeleton\n  skeletonContainer: {\n    padding: spacing.md,\n  },\n  skeletonItem: {\n    marginBottom: spacing.sm,\n  },\n\n  // Footer\n  footerLoader: {\n    paddingVertical: spacing.md,\n  },\n});\n","path":null,"size_bytes":10652,"size_tokens":null},"client/screens/AchievementsScreen.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, FlatList, Pressable } from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport Animated, { FadeInDown } from \"react-native-reanimated\";\nimport { useNavigation } from \"@react-navigation/native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useThemeContext } from \"@/contexts/ThemeContext\";\nimport { Colors, Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { achievements, Achievement } from \"@/lib/mockData\";\n\nexport default function AchievementsScreen() {\n  const insets = useSafeAreaInsets();\n  const { colors } = useThemeContext();\n  const navigation = useNavigation();\n\n  const earnedCount = achievements.filter((a) => a.earned).length;\n  const totalPoints = achievements.filter((a) => a.earned).reduce((sum, a) => sum + a.points, 0);\n\n  const renderAchievement = ({ item, index }: { item: Achievement; index: number }) => (\n    <Animated.View entering={FadeInDown.delay(index * 60).springify()}>\n      <View\n        style={[\n          styles.achievementCard,\n          { backgroundColor: colors.surface },\n          Shadows.card,\n          !item.earned && styles.unearned,\n        ]}\n      >\n        <View\n          style={[\n            styles.iconContainer,\n            {\n              backgroundColor: item.earned ? Colors.primary + \"15\" : colors.backgroundSecondary,\n            },\n          ]}\n        >\n          <Feather\n            name={item.icon as any}\n            size={24}\n            color={item.earned ? Colors.primary : colors.textSecondary}\n          />\n        </View>\n\n        <View style={styles.achievementContent}>\n          <ThemedText\n            type=\"heading\"\n            style={{ color: item.earned ? colors.textPrimary : colors.textSecondary }}\n          >\n            {item.name}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: colors.textSecondary }}>\n            {item.description}\n          </ThemedText>\n          {item.earnedAt ? (\n            <ThemedText type=\"small\" style={{ color: Colors.secondary, marginTop: Spacing.xs }}>\n              Earned on {new Date(item.earnedAt).toLocaleDateString()}\n            </ThemedText>\n          ) : null}\n        </View>\n\n        <View style={styles.pointsBadge}>\n          <ThemedText\n            type=\"heading\"\n            style={{ color: item.earned ? Colors.primary : colors.textSecondary }}\n          >\n            +{item.points}\n          </ThemedText>\n          <ThemedText type=\"small\" style={{ color: colors.textSecondary }}>\n            pts\n          </ThemedText>\n        </View>\n      </View>\n    </Animated.View>\n  );\n\n  return (\n    <View style={[styles.container, { backgroundColor: colors.background }]}>\n      <View style={[styles.header, { paddingTop: insets.top + Spacing.lg }]}>\n        <Pressable\n          onPress={() => navigation.goBack()}\n          style={({ pressed }) => [\n            styles.backButton,\n            { backgroundColor: colors.backgroundSecondary, opacity: pressed ? 0.7 : 1 },\n          ]}\n        >\n          <Feather name=\"arrow-left\" size={20} color={colors.textPrimary} />\n        </Pressable>\n        <ThemedText type=\"title\" style={styles.headerTitle}>Achievements</ThemedText>\n        <View style={styles.headerSpacer} />\n      </View>\n\n      <LinearGradient\n        colors={[Colors.gradient.start, Colors.gradient.end]}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={styles.summaryCard}\n      >\n        <View style={styles.summaryItem}>\n          <ThemedText type=\"hero\" style={{ color: \"#FFFFFF\" }}>\n            {earnedCount}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: \"rgba(255,255,255,0.8)\" }}>\n            Earned\n          </ThemedText>\n        </View>\n        <View style={styles.summaryDivider} />\n        <View style={styles.summaryItem}>\n          <ThemedText type=\"hero\" style={{ color: \"#FFFFFF\" }}>\n            {achievements.length - earnedCount}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: \"rgba(255,255,255,0.8)\" }}>\n            Remaining\n          </ThemedText>\n        </View>\n        <View style={styles.summaryDivider} />\n        <View style={styles.summaryItem}>\n          <ThemedText type=\"hero\" style={{ color: \"#FFFFFF\" }}>\n            {totalPoints}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: \"rgba(255,255,255,0.8)\" }}>\n            Points\n          </ThemedText>\n        </View>\n      </LinearGradient>\n\n      <FlatList\n        data={achievements}\n        renderItem={renderAchievement}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={styles.list}\n        showsVerticalScrollIndicator={false}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingBottom: Spacing.lg,\n  },\n  backButton: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.sm,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  headerTitle: {\n    flex: 1,\n    textAlign: \"center\",\n  },\n  headerSpacer: {\n    width: 40,\n  },\n  summaryCard: {\n    flexDirection: \"row\",\n    marginHorizontal: Spacing.xl,\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.lg,\n    marginBottom: Spacing.xl,\n  },\n  summaryItem: {\n    flex: 1,\n    alignItems: \"center\",\n  },\n  summaryDivider: {\n    width: 1,\n    backgroundColor: \"rgba(255,255,255,0.3)\",\n  },\n  list: {\n    paddingHorizontal: Spacing.xl,\n    gap: Spacing.md,\n    paddingBottom: Spacing.xl,\n  },\n  achievementCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n    gap: Spacing.md,\n  },\n  unearned: {\n    opacity: 0.6,\n  },\n  iconContainer: {\n    width: 52,\n    height: 52,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  achievementContent: {\n    flex: 1,\n  },\n  pointsBadge: {\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":6173,"size_tokens":null},"client/screens/LeaderboardScreen.tsx":{"content":"/**\n * Leaderboard Screen\n * Points leaderboard rankings\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { gamificationApi } from '@/lib/api';\nimport { LeaderboardEntry } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { formatNumber } from '@/lib/utils';\n\ntype Period = 'weekly' | 'monthly' | 'all_time';\n\nexport default function LeaderboardScreen() {\n  const navigation = useNavigation<any>();\n  const { user: currentUser } = useAuth();\n  const [period, setPeriod] = useState<Period>('weekly');\n  const appColors = useAppColors();\n\n  const {\n    data: leaderboard,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['leaderboard', period],\n    queryFn: async () => {\n      const response = await gamificationApi.getLeaderboard(period);\n      return response.data?.leaderboard || [];\n    },\n  });\n\n  const { data: myStats } = useQuery({\n    queryKey: ['myStats'],\n    queryFn: async () => {\n      const response = await gamificationApi.getMyStats();\n      return response.data;\n    },\n  });\n\n  const getRankColor = (rank: number) => {\n    switch (rank) {\n      case 1: return '#FFD700';\n      case 2: return '#C0C0C0';\n      case 3: return '#CD7F32';\n      default: return appColors.textSecondary;\n    }\n  };\n\n  const getRankIcon = (rank: number) => {\n    if (rank <= 3) {\n      return <MaterialCommunityIcons name=\"trophy\" size={24} color={getRankColor(rank)} />;\n    }\n    return <ThemedText style={[styles.rankNumber, { color: appColors.textSecondary }]}>{rank}</ThemedText>;\n  };\n\n  const renderTopThree = () => {\n    if (!leaderboard || leaderboard.length < 3) return null;\n\n    const top3 = leaderboard.slice(0, 3);\n    const [first, second, third] = top3;\n\n    return (\n      <View style={[styles.topThreeContainer, { backgroundColor: appColors.surface }]}>\n        {/* Second Place */}\n        <View style={styles.topThreeItem}>\n          <View style={[styles.topThreeAvatar, styles.secondPlace]}>\n            {second.user.avatar_url ? (\n              <Image source={{ uri: second.user.avatar_url }} style={styles.topThreeImage} />\n            ) : (\n              <ThemedText style={styles.topThreeInitials}>\n                {second.user.first_name[0]}{second.user.last_name[0]}\n              </ThemedText>\n            )}\n            <View style={[styles.topThreeBadge, { backgroundColor: '#C0C0C0', borderColor: appColors.surface }]}>\n              <ThemedText style={styles.topThreeBadgeText}>2</ThemedText>\n            </View>\n          </View>\n          <ThemedText style={[styles.topThreeName, { color: appColors.textPrimary }]} numberOfLines={1}>\n            {second.user.first_name}\n          </ThemedText>\n          <ThemedText style={[styles.topThreePoints, { color: appColors.textSecondary }]}>{formatNumber(second.points)}</ThemedText>\n        </View>\n\n        {/* First Place */}\n        <View style={styles.topThreeItem}>\n          <View style={[styles.topThreeAvatar, styles.firstPlace]}>\n            {first.user.avatar_url ? (\n              <Image source={{ uri: first.user.avatar_url }} style={styles.topThreeImage} />\n            ) : (\n              <ThemedText style={styles.topThreeInitials}>\n                {first.user.first_name[0]}{first.user.last_name[0]}\n              </ThemedText>\n            )}\n            <View style={[styles.topThreeBadge, { backgroundColor: '#FFD700', borderColor: appColors.surface }]}>\n              <MaterialCommunityIcons name=\"crown\" size={14} color=\"white\" />\n            </View>\n          </View>\n          <ThemedText style={[styles.topThreeName, { color: appColors.textPrimary }]} numberOfLines={1}>\n            {first.user.first_name}\n          </ThemedText>\n          <ThemedText style={[styles.topThreePoints, { color: appColors.textSecondary }]}>{formatNumber(first.points)}</ThemedText>\n        </View>\n\n        {/* Third Place */}\n        <View style={styles.topThreeItem}>\n          <View style={[styles.topThreeAvatar, styles.thirdPlace]}>\n            {third.user.avatar_url ? (\n              <Image source={{ uri: third.user.avatar_url }} style={styles.topThreeImage} />\n            ) : (\n              <ThemedText style={styles.topThreeInitials}>\n                {third.user.first_name[0]}{third.user.last_name[0]}\n              </ThemedText>\n            )}\n            <View style={[styles.topThreeBadge, { backgroundColor: '#CD7F32', borderColor: appColors.surface }]}>\n              <ThemedText style={styles.topThreeBadgeText}>3</ThemedText>\n            </View>\n          </View>\n          <ThemedText style={[styles.topThreeName, { color: appColors.textPrimary }]} numberOfLines={1}>\n            {third.user.first_name}\n          </ThemedText>\n          <ThemedText style={[styles.topThreePoints, { color: appColors.textSecondary }]}>{formatNumber(third.points)}</ThemedText>\n        </View>\n      </View>\n    );\n  };\n\n  const renderEntry = ({ item }: { item: LeaderboardEntry }) => {\n    const isCurrentUser = item.user.id === currentUser?.id;\n\n    return (\n      <TouchableOpacity\n        style={[styles.entryItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }, isCurrentUser && styles.entryItemCurrent]}\n        onPress={() => navigation.navigate('UserProfile', { userId: item.user.id })}\n      >\n        <View style={styles.entryRank}>{getRankIcon(item.rank)}</View>\n        {item.user.avatar_url ? (\n          <Image source={{ uri: item.user.avatar_url }} style={styles.entryAvatar} />\n        ) : (\n          <View style={[styles.entryAvatar, styles.entryAvatarPlaceholder]}>\n            <ThemedText style={styles.entryAvatarText}>\n              {item.user.first_name[0]}{item.user.last_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View style={styles.entryInfo}>\n          <ThemedText style={[styles.entryName, { color: appColors.textPrimary }]}>{item.user.full_name}</ThemedText>\n          <ThemedText style={[styles.entryLevel, { color: appColors.textSecondary }]}>Level {item.user.level}</ThemedText>\n        </View>\n        <View style={styles.entryPoints}>\n          <ThemedText style={styles.entryPointsValue}>{formatNumber(item.points)}</ThemedText>\n          <ThemedText style={[styles.entryPointsLabel, { color: appColors.textSecondary }]}>pts</ThemedText>\n        </View>\n      </TouchableOpacity>\n    );\n  };\n\n  const renderHeader = () => (\n    <View>\n      {/* Period Selector */}\n      <View style={[styles.periodContainer, { backgroundColor: appColors.surface }]}>\n        {(['weekly', 'monthly', 'all_time'] as Period[]).map((p) => (\n          <TouchableOpacity\n            key={p}\n            style={[styles.periodButton, period === p && styles.periodButtonActive]}\n            onPress={() => setPeriod(p)}\n          >\n            <ThemedText style={[styles.periodText, { color: appColors.textSecondary }, period === p && styles.periodTextActive]}>\n              {p === 'all_time' ? 'All Time' : p.charAt(0).toUpperCase() + p.slice(1)}\n            </ThemedText>\n          </TouchableOpacity>\n        ))}\n      </View>\n\n      {/* Top 3 */}\n      {renderTopThree()}\n\n      {/* Your Stats */}\n      {myStats && (\n        <View style={styles.myStatsContainer}>\n          <ThemedText style={styles.myStatsTitle}>Your Stats</ThemedText>\n          <View style={styles.myStatsRow}>\n            <View style={styles.myStatItem}>\n              <ThemedText style={[styles.myStatValue, { color: appColors.textPrimary }]}>#{myStats.rank}</ThemedText>\n              <ThemedText style={[styles.myStatLabel, { color: appColors.textSecondary }]}>Rank</ThemedText>\n            </View>\n            <View style={styles.myStatItem}>\n              <ThemedText style={[styles.myStatValue, { color: appColors.textPrimary }]}>{formatNumber(myStats.points)}</ThemedText>\n              <ThemedText style={[styles.myStatLabel, { color: appColors.textSecondary }]}>Points</ThemedText>\n            </View>\n            <View style={styles.myStatItem}>\n              <ThemedText style={[styles.myStatValue, { color: appColors.textPrimary }]}>{myStats.streak}</ThemedText>\n              <ThemedText style={[styles.myStatLabel, { color: appColors.textSecondary }]}>Streak</ThemedText>\n            </View>\n          </View>\n        </View>\n      )}\n\n      {/* Rankings Header */}\n      <View style={styles.rankingsHeader}>\n        <ThemedText style={[styles.rankingsTitle, { color: appColors.textSecondary }]}>Rankings</ThemedText>\n      </View>\n    </View>\n  );\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Leaderboard</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      {/* Leaderboard List */}\n      <FlatList\n        data={leaderboard?.slice(3)}\n        renderItem={renderEntry}\n        keyExtractor={(item) => item.user.id.toString()}\n        ListHeaderComponent={renderHeader}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={styles.listContent}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  listContent: {\n    paddingBottom: Spacing.xl,\n  },\n  periodContainer: {\n    flexDirection: 'row',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n  },\n  periodButton: {\n    flex: 1,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n  },\n  periodButtonActive: {\n    backgroundColor: Colors.primary,\n  },\n  periodText: {\n    ...Typography.caption,\n    fontWeight: '500',\n  },\n  periodTextActive: {\n    color: 'white',\n    fontWeight: '600',\n  },\n  topThreeContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'flex-end',\n    padding: Spacing.xl,\n  },\n  topThreeItem: {\n    alignItems: 'center',\n    marginHorizontal: Spacing.md,\n  },\n  topThreeAvatar: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n    position: 'relative',\n    borderWidth: 3,\n  },\n  firstPlace: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    borderColor: '#FFD700',\n    marginBottom: Spacing.md,\n  },\n  secondPlace: {\n    borderColor: '#C0C0C0',\n  },\n  thirdPlace: {\n    borderColor: '#CD7F32',\n  },\n  topThreeImage: {\n    width: '100%',\n    height: '100%',\n    borderRadius: 40,\n  },\n  topThreeInitials: {\n    ...Typography.heading,\n    color: Colors.primary,\n  },\n  topThreeBadge: {\n    position: 'absolute',\n    bottom: -8,\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 2,\n  },\n  topThreeBadgeText: {\n    ...Typography.small,\n    color: 'white',\n    fontWeight: '700',\n  },\n  topThreeName: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginTop: Spacing.sm,\n  },\n  topThreePoints: {\n    ...Typography.small,\n  },\n  myStatsContainer: {\n    margin: Spacing.md,\n    padding: Spacing.lg,\n    backgroundColor: Colors.primary + '10',\n    borderRadius: BorderRadius.md,\n  },\n  myStatsTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    color: Colors.primary,\n    marginBottom: Spacing.md,\n  },\n  myStatsRow: {\n    flexDirection: 'row',\n  },\n  myStatItem: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  myStatValue: {\n    ...Typography.heading,\n  },\n  myStatLabel: {\n    ...Typography.small,\n  },\n  rankingsHeader: {\n    padding: Spacing.lg,\n    paddingBottom: Spacing.sm,\n  },\n  rankingsTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  entryItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  entryItemCurrent: {\n    backgroundColor: Colors.primary + '08',\n  },\n  entryRank: {\n    width: 32,\n    alignItems: 'center',\n    marginRight: Spacing.md,\n  },\n  rankNumber: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  entryAvatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    marginRight: Spacing.md,\n  },\n  entryAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  entryAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  entryInfo: {\n    flex: 1,\n  },\n  entryName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  entryLevel: {\n    ...Typography.small,\n  },\n  entryPoints: {\n    alignItems: 'flex-end',\n  },\n  entryPointsValue: {\n    ...Typography.body,\n    fontWeight: '700',\n    color: Colors.primary,\n  },\n  entryPointsLabel: {\n    ...Typography.small,\n  },\n});\n","path":null,"size_bytes":14152,"size_tokens":null},"client/components/OnboardingTooltips.tsx":{"content":"/**\n * Onboarding Tooltips\n * Guide new users through app features\n */\n\nimport React, { useState, useCallback, useEffect, useRef, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Modal,\n  Dimensions,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\nconst { width: SCREEN_WIDTH, height: SCREEN_HEIGHT } = Dimensions.get('window');\n\n// Tooltip positions\nexport type TooltipPosition = 'top' | 'bottom' | 'left' | 'right' | 'center';\n\n// Tooltip definition\nexport interface TooltipStep {\n  id: string;\n  title: string;\n  description: string;\n  targetRef?: React.RefObject<View>;\n  position?: TooltipPosition;\n  icon?: string;\n  highlightPadding?: number;\n}\n\n// Tour definition\nexport interface OnboardingTour {\n  id: string;\n  steps: TooltipStep[];\n  showOnce?: boolean;\n  delay?: number;\n}\n\n// Predefined tours\nexport const TOURS = {\n  HOME_FEED: {\n    id: 'home_feed_tour',\n    steps: [\n      {\n        id: 'welcome',\n        title: 'Welcome to MedInvest! üëã',\n        description: 'Let\\'s take a quick tour of the app to help you get started.',\n        position: 'center' as TooltipPosition,\n        icon: 'sparkles',\n      },\n      {\n        id: 'feed',\n        title: 'Your Feed',\n        description: 'See posts from people you follow and trending discussions in your specialty rooms.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'home-outline',\n      },\n      {\n        id: 'rooms',\n        title: 'Specialty Rooms',\n        description: 'Filter your feed by specialty. Tap here to see posts from specific medical communities.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'grid-outline',\n      },\n      {\n        id: 'create',\n        title: 'Share Your Insights',\n        description: 'Tap the + button to create a post, share cases, or ask questions.',\n        position: 'top' as TooltipPosition,\n        icon: 'add-circle-outline',\n      },\n    ],\n    showOnce: true,\n  },\n  \n  POST_CREATION: {\n    id: 'post_creation_tour',\n    steps: [\n      {\n        id: 'content',\n        title: 'Write Your Post',\n        description: 'Share your thoughts, cases, or questions with the community.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'create-outline',\n      },\n      {\n        id: 'media',\n        title: 'Add Media',\n        description: 'Attach images or videos to illustrate your point.',\n        position: 'top' as TooltipPosition,\n        icon: 'images-outline',\n      },\n      {\n        id: 'room',\n        title: 'Choose a Room',\n        description: 'Select a specialty room to reach the right audience.',\n        position: 'top' as TooltipPosition,\n        icon: 'medical-outline',\n      },\n      {\n        id: 'anonymous',\n        title: 'Post Anonymously',\n        description: 'Toggle this to share sensitive topics without revealing your identity.',\n        position: 'top' as TooltipPosition,\n        icon: 'eye-off-outline',\n      },\n    ],\n    showOnce: true,\n  },\n  \n  PROFILE: {\n    id: 'profile_tour',\n    steps: [\n      {\n        id: 'stats',\n        title: 'Your Profile',\n        description: 'See your posts, followers, and achievements all in one place.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'person-outline',\n      },\n      {\n        id: 'edit',\n        title: 'Complete Your Profile',\n        description: 'Add your specialty, credentials, and bio to build trust with the community.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'pencil-outline',\n      },\n    ],\n    showOnce: true,\n  },\n  \n  DEALS: {\n    id: 'deals_tour',\n    steps: [\n      {\n        id: 'browse',\n        title: 'Investment Opportunities',\n        description: 'Browse vetted healthcare investment opportunities exclusive to medical professionals.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'trending-up-outline',\n      },\n      {\n        id: 'filters',\n        title: 'Filter Deals',\n        description: 'Filter by stage, sector, and minimum investment to find opportunities that match your criteria.',\n        position: 'bottom' as TooltipPosition,\n        icon: 'options-outline',\n      },\n    ],\n    showOnce: true,\n  },\n};\n\n// Storage key for completed tours\nconst COMPLETED_TOURS_KEY = 'completed_onboarding_tours';\n\n// =============================================================================\n// TOOLTIP OVERLAY\n// =============================================================================\n\ninterface TooltipOverlayProps {\n  visible: boolean;\n  step: TooltipStep;\n  currentStep: number;\n  totalSteps: number;\n  onNext: () => void;\n  onPrev: () => void;\n  onSkip: () => void;\n  onComplete: () => void;\n}\n\nexport const TooltipOverlay = memo(function TooltipOverlay({\n  visible,\n  step,\n  currentStep,\n  totalSteps,\n  onNext,\n  onPrev,\n  onSkip,\n  onComplete,\n}: TooltipOverlayProps) {\n  const { colors } = useThemeContext();\n  const fadeAnim = useRef(new Animated.Value(0)).current;\n  const scaleAnim = useRef(new Animated.Value(0.9)).current;\n\n  useEffect(() => {\n    if (visible) {\n      Animated.parallel([\n        Animated.timing(fadeAnim, {\n          toValue: 1,\n          duration: 200,\n          useNativeDriver: true,\n        }),\n        Animated.spring(scaleAnim, {\n          toValue: 1,\n          friction: 8,\n          tension: 100,\n          useNativeDriver: true,\n        }),\n      ]).start();\n    } else {\n      fadeAnim.setValue(0);\n      scaleAnim.setValue(0.9);\n    }\n  }, [visible, step.id]);\n\n  if (!visible) return null;\n\n  const isFirstStep = currentStep === 0;\n  const isLastStep = currentStep === totalSteps - 1;\n  const isCentered = step.position === 'center';\n\n  return (\n    <Modal transparent visible={visible} animationType=\"none\">\n      <Animated.View style={[styles.overlay, { opacity: fadeAnim }]}>\n        {/* Background */}\n        <TouchableOpacity\n          style={styles.overlayBackground}\n          activeOpacity={1}\n          onPress={onSkip}\n        />\n\n        {/* Tooltip card */}\n        <Animated.View\n          style={[\n            styles.tooltipCard,\n            {\n              backgroundColor: colors.surface,\n              transform: [{ scale: scaleAnim }],\n            },\n            isCentered && styles.centeredCard,\n          ]}\n        >\n          {/* Icon */}\n          {step.icon && (\n            <View style={[styles.iconContainer, { backgroundColor: colors.primary + '20' }]}>\n              <Ionicons name={step.icon as any} size={32} color={colors.primary} />\n            </View>\n          )}\n\n          {/* Content */}\n          <ThemedText style={[styles.tooltipTitle, { color: colors.textPrimary }]}>\n            {step.title}\n          </ThemedText>\n          <ThemedText style={[styles.tooltipDescription, { color: colors.textSecondary }]}>\n            {step.description}\n          </ThemedText>\n\n          {/* Progress dots */}\n          <View style={styles.progressDots}>\n            {Array.from({ length: totalSteps }).map((_, index) => (\n              <View\n                key={index}\n                style={[\n                  styles.dot,\n                  {\n                    backgroundColor: index === currentStep ? colors.primary : colors.border,\n                  },\n                ]}\n              />\n            ))}\n          </View>\n\n          {/* Actions */}\n          <View style={styles.actions}>\n            {!isFirstStep && (\n              <TouchableOpacity\n                style={[styles.actionButton, styles.secondaryButton, { borderColor: colors.border }]}\n                onPress={() => {\n                  haptics.buttonPress();\n                  onPrev();\n                }}\n              >\n                <ThemedText style={[styles.actionButtonText, { color: colors.textPrimary }]}>\n                  Back\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n            \n            {isFirstStep && (\n              <TouchableOpacity\n                style={[styles.actionButton, styles.secondaryButton, { borderColor: colors.border }]}\n                onPress={() => {\n                  haptics.buttonPress();\n                  onSkip();\n                }}\n              >\n                <ThemedText style={[styles.actionButtonText, { color: colors.textSecondary }]}>\n                  Skip\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n\n            <TouchableOpacity\n              style={[styles.actionButton, styles.primaryButton, { backgroundColor: colors.primary }]}\n              onPress={() => {\n                haptics.buttonPress();\n                if (isLastStep) {\n                  onComplete();\n                } else {\n                  onNext();\n                }\n              }}\n            >\n              <ThemedText style={styles.primaryButtonText}>\n                {isLastStep ? 'Get Started' : 'Next'}\n              </ThemedText>\n            </TouchableOpacity>\n          </View>\n        </Animated.View>\n      </Animated.View>\n    </Modal>\n  );\n});\n\n// =============================================================================\n// SPOTLIGHT HIGHLIGHT\n// =============================================================================\n\ninterface SpotlightHighlightProps {\n  visible: boolean;\n  targetLayout?: { x: number; y: number; width: number; height: number };\n  padding?: number;\n}\n\nexport const SpotlightHighlight = memo(function SpotlightHighlight({\n  visible,\n  targetLayout,\n  padding = 8,\n}: SpotlightHighlightProps) {\n  if (!visible || !targetLayout) return null;\n\n  const { x, y, width, height } = targetLayout;\n\n  return (\n    <View style={styles.spotlightContainer} pointerEvents=\"none\">\n      {/* Top overlay */}\n      <View style={[styles.spotlightOverlay, { height: y - padding }]} />\n      \n      {/* Middle row */}\n      <View style={[styles.spotlightRow, { height: height + padding * 2 }]}>\n        {/* Left overlay */}\n        <View style={[styles.spotlightOverlay, { width: x - padding }]} />\n        \n        {/* Spotlight hole */}\n        <View\n          style={[\n            styles.spotlightHole,\n            {\n              width: width + padding * 2,\n              height: height + padding * 2,\n              borderRadius: BorderRadius.md,\n            },\n          ]}\n        />\n        \n        {/* Right overlay */}\n        <View style={[styles.spotlightOverlay, { flex: 1 }]} />\n      </View>\n      \n      {/* Bottom overlay */}\n      <View style={[styles.spotlightOverlay, { flex: 1 }]} />\n    </View>\n  );\n});\n\n// =============================================================================\n// ONBOARDING SERVICE\n// =============================================================================\n\nclass OnboardingService {\n  private completedTours: Set<string> = new Set();\n  private loaded = false;\n\n  async load(): Promise<void> {\n    if (this.loaded) return;\n\n    try {\n      const stored = await AsyncStorage.getItem(COMPLETED_TOURS_KEY);\n      if (stored) {\n        const completed = JSON.parse(stored) as string[];\n        this.completedTours = new Set(completed);\n      }\n      this.loaded = true;\n    } catch (error) {\n      console.error('[Onboarding] Error loading:', error);\n    }\n  }\n\n  async markTourComplete(tourId: string): Promise<void> {\n    this.completedTours.add(tourId);\n    await this.persist();\n  }\n\n  async isTourCompleted(tourId: string): Promise<boolean> {\n    await this.load();\n    return this.completedTours.has(tourId);\n  }\n\n  async shouldShowTour(tour: OnboardingTour): Promise<boolean> {\n    if (!tour.showOnce) return true;\n    return !(await this.isTourCompleted(tour.id));\n  }\n\n  async resetTour(tourId: string): Promise<void> {\n    this.completedTours.delete(tourId);\n    await this.persist();\n  }\n\n  async resetAllTours(): Promise<void> {\n    this.completedTours.clear();\n    await AsyncStorage.removeItem(COMPLETED_TOURS_KEY);\n  }\n\n  private async persist(): Promise<void> {\n    try {\n      await AsyncStorage.setItem(\n        COMPLETED_TOURS_KEY,\n        JSON.stringify(Array.from(this.completedTours))\n      );\n    } catch (error) {\n      console.error('[Onboarding] Error saving:', error);\n    }\n  }\n}\n\nexport const onboardingService = new OnboardingService();\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function useOnboardingTour(tour: OnboardingTour) {\n  const [isActive, setIsActive] = useState(false);\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n\n  useEffect(() => {\n    checkAndStart();\n  }, []);\n\n  const checkAndStart = async () => {\n    const shouldShow = await onboardingService.shouldShowTour(tour);\n    if (shouldShow) {\n      // Delay start slightly\n      setTimeout(() => {\n        setIsActive(true);\n      }, tour.delay || 500);\n    }\n  };\n\n  const startTour = useCallback(() => {\n    setCurrentStepIndex(0);\n    setIsActive(true);\n  }, []);\n\n  const nextStep = useCallback(() => {\n    if (currentStepIndex < tour.steps.length - 1) {\n      setCurrentStepIndex(prev => prev + 1);\n    }\n  }, [currentStepIndex, tour.steps.length]);\n\n  const prevStep = useCallback(() => {\n    if (currentStepIndex > 0) {\n      setCurrentStepIndex(prev => prev - 1);\n    }\n  }, [currentStepIndex]);\n\n  const skipTour = useCallback(async () => {\n    setIsActive(false);\n    if (tour.showOnce) {\n      await onboardingService.markTourComplete(tour.id);\n    }\n  }, [tour]);\n\n  const completeTour = useCallback(async () => {\n    setIsActive(false);\n    haptics.success();\n    await onboardingService.markTourComplete(tour.id);\n  }, [tour]);\n\n  const currentStep = tour.steps[currentStepIndex];\n\n  return {\n    isActive,\n    currentStep,\n    currentStepIndex,\n    totalSteps: tour.steps.length,\n    startTour,\n    nextStep,\n    prevStep,\n    skipTour,\n    completeTour,\n  };\n}\n\n// =============================================================================\n// FEATURE HIGHLIGHT COMPONENT\n// =============================================================================\n\ninterface FeatureHighlightProps {\n  children: React.ReactNode;\n  featureId: string;\n  title: string;\n  description: string;\n  position?: TooltipPosition;\n  showOnce?: boolean;\n}\n\nexport const FeatureHighlight = memo(function FeatureHighlight({\n  children,\n  featureId,\n  title,\n  description,\n  position = 'bottom',\n  showOnce = true,\n}: FeatureHighlightProps) {\n  const { colors } = useThemeContext();\n  const [showTooltip, setShowTooltip] = useState(false);\n  const [layout, setLayout] = useState<{ x: number; y: number; width: number; height: number } | null>(null);\n  const viewRef = useRef<View>(null);\n\n  useEffect(() => {\n    checkIfShouldShow();\n  }, []);\n\n  const checkIfShouldShow = async () => {\n    if (showOnce) {\n      const completed = await onboardingService.isTourCompleted(`feature_${featureId}`);\n      if (!completed) {\n        setTimeout(() => {\n          measureAndShow();\n        }, 1000);\n      }\n    }\n  };\n\n  const measureAndShow = () => {\n    viewRef.current?.measureInWindow((x, y, width, height) => {\n      setLayout({ x, y, width, height });\n      setShowTooltip(true);\n    });\n  };\n\n  const dismiss = async () => {\n    setShowTooltip(false);\n    if (showOnce) {\n      await onboardingService.markTourComplete(`feature_${featureId}`);\n    }\n  };\n\n  return (\n    <>\n      <View ref={viewRef} collapsable={false}>\n        {children}\n      </View>\n      \n      {showTooltip && layout && (\n        <Modal transparent visible={showTooltip} animationType=\"fade\">\n          <TouchableOpacity style={styles.overlay} activeOpacity={1} onPress={dismiss}>\n            <SpotlightHighlight visible targetLayout={layout} />\n            \n            <View\n              style={[\n                styles.featureTooltip,\n                { backgroundColor: colors.surface },\n                position === 'bottom' && { top: layout.y + layout.height + 12 },\n                position === 'top' && { bottom: SCREEN_HEIGHT - layout.y + 12 },\n              ]}\n            >\n              <ThemedText style={[styles.featureTitle, { color: colors.textPrimary }]}>\n                {title}\n              </ThemedText>\n              <ThemedText style={[styles.featureDescription, { color: colors.textSecondary }]}>\n                {description}\n              </ThemedText>\n              <TouchableOpacity\n                style={[styles.gotItButton, { backgroundColor: colors.primary }]}\n                onPress={dismiss}\n              >\n                <ThemedText style={styles.gotItText}>Got it</ThemedText>\n              </TouchableOpacity>\n            </View>\n          </TouchableOpacity>\n        </Modal>\n      )}\n    </>\n  );\n});\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  overlayBackground: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  tooltipCard: {\n    width: SCREEN_WIDTH - Spacing.xl * 2,\n    maxWidth: 340,\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.lg,\n    alignItems: 'center',\n    ...Shadows.card,\n  },\n  centeredCard: {\n    position: 'absolute',\n  },\n  iconContainer: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.lg,\n  },\n  tooltipTitle: {\n    ...Typography.title,\n    textAlign: 'center',\n    marginBottom: Spacing.sm,\n  },\n  tooltipDescription: {\n    ...Typography.body,\n    textAlign: 'center',\n    lineHeight: 22,\n  },\n  progressDots: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  dot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  actions: {\n    flexDirection: 'row',\n    marginTop: Spacing.xl,\n    gap: Spacing.md,\n  },\n  actionButton: {\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderRadius: BorderRadius.md,\n    minWidth: 100,\n    alignItems: 'center',\n  },\n  secondaryButton: {\n    borderWidth: 1,\n  },\n  primaryButton: {},\n  actionButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  primaryButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n    color: 'white',\n  },\n  spotlightContainer: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  spotlightOverlay: {\n    backgroundColor: 'rgba(0, 0, 0, 0.7)',\n  },\n  spotlightRow: {\n    flexDirection: 'row',\n  },\n  spotlightHole: {\n    backgroundColor: 'transparent',\n  },\n  featureTooltip: {\n    position: 'absolute',\n    left: Spacing.lg,\n    right: Spacing.lg,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  featureTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    marginBottom: Spacing.xs,\n  },\n  featureDescription: {\n    ...Typography.small,\n    lineHeight: 18,\n  },\n  gotItButton: {\n    marginTop: Spacing.md,\n    paddingVertical: Spacing.sm,\n    paddingHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    alignSelf: 'flex-end',\n  },\n  gotItText: {\n    ...Typography.small,\n    fontWeight: '600',\n    color: 'white',\n  },\n});\n","path":null,"size_bytes":19376,"size_tokens":null},"client/screens/CourseDetailScreen.tsx":{"content":"/**\n * CourseDetail Screen\n * View course info and lessons\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { contentApi } from '@/lib/api';\nimport { Course, Lesson } from '@/types';\nimport { formatDuration } from '@/lib/utils';\n\ntype CourseDetailRouteParams = {\n  CourseDetail: {\n    courseId: number;\n  };\n};\n\nexport default function CourseDetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<CourseDetailRouteParams, 'CourseDetail'>>();\n  const { courseId } = route.params;\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  // Fetch course details\n  const {\n    data: course,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['course', courseId],\n    queryFn: async () => {\n      const response = await contentApi.getCourse(courseId);\n      return response.data;\n    },\n  });\n\n  // Enroll mutation\n  const enrollMutation = useMutation({\n    mutationFn: async () => {\n      const response = await contentApi.enrollCourse(courseId);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to enroll');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['course', courseId] });\n    },\n  });\n\n  const handleEnroll = useCallback(() => {\n    enrollMutation.mutate();\n  }, [enrollMutation]);\n\n  const handleLessonPress = useCallback((lesson: Lesson) => {\n    // Navigate to lesson player/viewer\n    navigation.navigate('LessonDetail', { courseId, lessonId: lesson.id });\n  }, [navigation, courseId]);\n\n  const handleInstructorPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const renderLesson = (lesson: Lesson, index: number) => {\n    const isLocked = !course?.is_enrolled && !lesson.is_preview;\n    const isCompleted = lesson.is_completed;\n\n    return (\n      <TouchableOpacity\n        key={lesson.id}\n        style={[styles.lessonItem, { borderBottomColor: appColors.border }, isLocked && styles.lessonLocked]}\n        onPress={() => !isLocked && handleLessonPress(lesson)}\n        disabled={isLocked}\n      >\n        <View style={styles.lessonNumber}>\n          {isCompleted ? (\n            <Ionicons name=\"checkmark-circle\" size={24} color={Colors.secondary} />\n          ) : (\n            <ThemedText style={[styles.lessonNumberText, { color: appColors.textSecondary }]}>{index + 1}</ThemedText>\n          )}\n        </View>\n        <View style={styles.lessonContent}>\n          <ThemedText style={[styles.lessonTitle, { color: appColors.textPrimary }, isLocked && { color: appColors.textSecondary }]}>\n            {lesson.title}\n          </ThemedText>\n          <View style={styles.lessonMeta}>\n            <Ionicons name=\"time-outline\" size={14} color={appColors.textSecondary} />\n            <ThemedText style={[styles.lessonDuration, { color: appColors.textSecondary }]}>\n              {formatDuration(lesson.duration_minutes)}\n            </ThemedText>\n            {lesson.is_preview && (\n              <View style={styles.previewBadge}>\n                <ThemedText style={styles.previewBadgeText}>Preview</ThemedText>\n              </View>\n            )}\n          </View>\n        </View>\n        {isLocked ? (\n          <Ionicons name=\"lock-closed\" size={20} color={appColors.textSecondary} />\n        ) : (\n          <Ionicons name=\"play-circle-outline\" size={24} color={Colors.primary} />\n        )}\n      </TouchableOpacity>\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  if (!course) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ThemedText>Course not found</ThemedText>\n      </SafeAreaView>\n    );\n  }\n\n  const totalDuration = course.lessons?.reduce((sum, l) => sum + l.duration_minutes, 0) || 0;\n  const completedLessons = course.lessons?.filter(l => l.is_completed).length || 0;\n  const progress = course.lessons?.length ? (completedLessons / course.lessons.length) * 100 : 0;\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Course</ThemedText>\n        <TouchableOpacity style={styles.shareButton}>\n          <Ionicons name=\"share-outline\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView\n        style={styles.content}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      >\n        {/* Cover */}\n        {course.cover_image ? (\n          <Image source={{ uri: course.cover_image }} style={styles.coverImage} />\n        ) : (\n          <LinearGradient\n            colors={[Colors.primary, Colors.secondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.coverPlaceholder}\n          >\n            <MaterialCommunityIcons name=\"school\" size={64} color=\"white\" />\n          </LinearGradient>\n        )}\n\n        {/* Course Info */}\n        <View style={[styles.courseInfo, { backgroundColor: appColors.surface }]}>\n          <View style={styles.categoryBadge}>\n            <ThemedText style={styles.categoryText}>{course.category}</ThemedText>\n          </View>\n          <ThemedText style={[styles.courseTitle, { color: appColors.textPrimary }]}>{course.title}</ThemedText>\n          <ThemedText style={[styles.courseDescription, { color: appColors.textSecondary }]}>{course.description}</ThemedText>\n\n          {/* Stats */}\n          <View style={[styles.statsRow, { borderTopColor: appColors.border }]}>\n            <View style={styles.statItem}>\n              <Ionicons name=\"book-outline\" size={18} color={Colors.primary} />\n              <ThemedText style={[styles.statText, { color: appColors.textSecondary }]}>\n                {course.lessons?.length || 0} lessons\n              </ThemedText>\n            </View>\n            <View style={styles.statItem}>\n              <Ionicons name=\"time-outline\" size={18} color={Colors.primary} />\n              <ThemedText style={[styles.statText, { color: appColors.textSecondary }]}>\n                {formatDuration(totalDuration)}\n              </ThemedText>\n            </View>\n            <View style={styles.statItem}>\n              <Ionicons name=\"people-outline\" size={18} color={Colors.primary} />\n              <ThemedText style={[styles.statText, { color: appColors.textSecondary }]}>\n                {course.enrolled_count} enrolled\n              </ThemedText>\n            </View>\n          </View>\n\n          {/* Instructor */}\n          <TouchableOpacity\n            style={styles.instructorSection}\n            onPress={() => handleInstructorPress(course.instructor.id)}\n          >\n            {course.instructor.avatar_url ? (\n              <Image source={{ uri: course.instructor.avatar_url }} style={styles.instructorAvatar} />\n            ) : (\n              <View style={[styles.instructorAvatar, styles.instructorAvatarPlaceholder]}>\n                <ThemedText style={styles.instructorAvatarText}>\n                  {course.instructor.first_name[0]}{course.instructor.last_name[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={styles.instructorInfo}>\n              <ThemedText style={[styles.instructorLabel, { color: appColors.textSecondary }]}>Instructor</ThemedText>\n              <ThemedText style={[styles.instructorName, { color: appColors.textPrimary }]}>{course.instructor.full_name}</ThemedText>\n            </View>\n            <Ionicons name=\"chevron-forward\" size={20} color={appColors.textSecondary} />\n          </TouchableOpacity>\n\n          {/* Progress (if enrolled) */}\n          {course.is_enrolled && (\n            <View style={styles.progressSection}>\n              <View style={styles.progressHeader}>\n                <ThemedText style={[styles.progressLabel, { color: appColors.textSecondary }]}>Your Progress</ThemedText>\n                <ThemedText style={styles.progressPercent}>{Math.round(progress)}%</ThemedText>\n              </View>\n              <View style={styles.progressBar}>\n                <View style={[styles.progressFill, { width: `${progress}%` }]} />\n              </View>\n              <ThemedText style={[styles.progressText, { color: appColors.textSecondary }]}>\n                {completedLessons} of {course.lessons?.length} lessons completed\n              </ThemedText>\n            </View>\n          )}\n        </View>\n\n        {/* Lessons */}\n        <View style={[styles.lessonsSection, { backgroundColor: appColors.surface }]}>\n          <ThemedText style={[styles.lessonsTitle, { color: appColors.textPrimary }]}>Course Content</ThemedText>\n          {course.lessons?.map((lesson, index) => renderLesson(lesson, index))}\n        </View>\n\n        {/* What You'll Learn */}\n        {course.learning_points && course.learning_points.length > 0 && (\n          <View style={[styles.learningSection, { backgroundColor: appColors.surface }]}>\n            <ThemedText style={[styles.learningSectionTitle, { color: appColors.textPrimary }]}>What You'll Learn</ThemedText>\n            {course.learning_points.map((point, index) => (\n              <View key={index} style={styles.learningPoint}>\n                <Ionicons name=\"checkmark-circle\" size={18} color={Colors.secondary} />\n                <ThemedText style={[styles.learningPointText, { color: appColors.textPrimary }]}>{point}</ThemedText>\n              </View>\n            ))}\n          </View>\n        )}\n      </ScrollView>\n\n      {/* Enroll Button */}\n      {!course.is_enrolled && (\n        <View style={[styles.footer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <TouchableOpacity\n            style={styles.enrollButton}\n            onPress={handleEnroll}\n            disabled={enrollMutation.isPending}\n          >\n            <LinearGradient\n              colors={[Colors.primary, Colors.secondary]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 0 }}\n              style={styles.enrollGradient}\n            >\n              {enrollMutation.isPending ? (\n                <ActivityIndicator color=\"white\" />\n              ) : (\n                <>\n                  <MaterialCommunityIcons name=\"school\" size={20} color=\"white\" />\n                  <ThemedText style={styles.enrollButtonText}>\n                    {course.is_premium ? 'Enroll (Premium)' : 'Enroll Free'}\n                  </ThemedText>\n                </>\n              )}\n            </LinearGradient>\n          </TouchableOpacity>\n        </View>\n      )}\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  shareButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n  },\n  coverImage: {\n    width: '100%',\n    height: 200,\n    resizeMode: 'cover',\n  },\n  coverPlaceholder: {\n    width: '100%',\n    height: 200,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  courseInfo: {\n    padding: Spacing.lg,\n  },\n  categoryBadge: {\n    alignSelf: 'flex-start',\n    backgroundColor: Colors.primary + '15',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    marginBottom: Spacing.md,\n  },\n  categoryText: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  courseTitle: {\n    ...Typography.title,\n    marginBottom: Spacing.sm,\n  },\n  courseDescription: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    paddingTop: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  statItem: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  statText: {\n    ...Typography.caption,\n  },\n  instructorSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.lg,\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n  },\n  instructorAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  instructorAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  instructorAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  instructorInfo: {\n    flex: 1,\n  },\n  instructorLabel: {\n    ...Typography.small,\n  },\n  instructorName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  progressSection: {\n    marginTop: Spacing.lg,\n    padding: Spacing.md,\n    backgroundColor: Colors.secondary + '10',\n    borderRadius: BorderRadius.md,\n  },\n  progressHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: Spacing.sm,\n  },\n  progressLabel: {\n    ...Typography.caption,\n  },\n  progressPercent: {\n    ...Typography.caption,\n    color: Colors.secondary,\n    fontWeight: '600',\n  },\n  progressBar: {\n    height: 8,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: 4,\n    marginBottom: Spacing.sm,\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: Colors.secondary,\n    borderRadius: 4,\n  },\n  progressText: {\n    ...Typography.small,\n  },\n  lessonsSection: {\n    padding: Spacing.lg,\n    marginTop: Spacing.md,\n  },\n  lessonsTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.lg,\n  },\n  lessonItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  lessonLocked: {\n    opacity: 0.6,\n  },\n  lessonNumber: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: Colors.light.backgroundSecondary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  lessonNumberText: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  lessonContent: {\n    flex: 1,\n  },\n  lessonTitle: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  lessonMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n    marginTop: 4,\n  },\n  lessonDuration: {\n    ...Typography.small,\n  },\n  previewBadge: {\n    backgroundColor: Colors.primary + '20',\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.full,\n    marginLeft: Spacing.sm,\n  },\n  previewBadgeText: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  learningSection: {\n    padding: Spacing.lg,\n    marginTop: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  learningSectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.lg,\n  },\n  learningPoint: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.md,\n    gap: Spacing.sm,\n  },\n  learningPointText: {\n    ...Typography.body,\n    flex: 1,\n  },\n  footer: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  enrollButton: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.button,\n  },\n  enrollGradient: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  enrollButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '700',\n  },\n});\n","path":null,"size_bytes":17059,"size_tokens":null},"client/components/DiscoverMoreNews.tsx":{"content":"/**\n * Discover More News Component\n * News feed with healthcare/medical industry news\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  FlatList,\n  ActivityIndicator,\n  Linking,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { newsApi } from '@/lib/api';\nimport { formatRelativeTime } from '@/lib/utils';\n\ninterface NewsItem {\n  id: number;\n  title: string;\n  source: string;\n  source_icon?: string;\n  url: string;\n  published_at: string;\n  category?: string;\n  image_url?: string;\n}\n\ninterface DiscoverMoreNewsProps {\n  limit?: number;\n  showHeader?: boolean;\n  onViewAll?: () => void;\n}\n\nexport default function DiscoverMoreNews({\n  limit = 7,\n  showHeader = true,\n  onViewAll,\n}: DiscoverMoreNewsProps) {\n  const appColors = useAppColors();\n\n  const { data: news, isLoading } = useQuery({\n    queryKey: ['news', limit],\n    queryFn: async () => {\n      const response = await newsApi.getLatestNews(limit);\n      return response.data?.articles || [];\n    },\n  });\n\n  const handleNewsPress = useCallback((url: string) => {\n    Linking.openURL(url);\n  }, []);\n\n  const handleViewAll = useCallback(() => {\n    if (onViewAll) {\n      onViewAll();\n    } else {\n      Linking.openURL('https://medinvest.com/news');\n    }\n  }, [onViewAll]);\n\n  if (isLoading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <ActivityIndicator size=\"small\" color={Colors.primary} />\n      </View>\n    );\n  }\n\n  if (!news || news.length === 0) {\n    return null;\n  }\n\n  return (\n    <View style={[styles.container, { backgroundColor: appColors.surface }]}>\n      {showHeader && (\n        <View style={styles.header}>\n          <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Discover More News</ThemedText>\n        </View>\n      )}\n\n      <View style={styles.newsList}>\n        {news.map((item: NewsItem) => (\n          <NewsListItem\n            key={item.id}\n            item={item}\n            onPress={() => handleNewsPress(item.url)}\n          />\n        ))}\n      </View>\n\n      {onViewAll && (\n        <TouchableOpacity style={styles.viewAllButton} onPress={handleViewAll}>\n          <ThemedText style={styles.viewAllText}>View all news</ThemedText>\n          <Ionicons name=\"chevron-forward\" size={16} color={Colors.primary} />\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n}\n\ninterface NewsListItemProps {\n  item: NewsItem;\n  onPress: () => void;\n}\n\nfunction NewsListItem({ item, onPress }: NewsListItemProps) {\n  const appColors = useAppColors();\n  const formattedDate = formatNewsDate(item.published_at);\n\n  return (\n    <TouchableOpacity style={[styles.newsItem, { borderBottomColor: appColors.border }]} onPress={onPress}>\n      {/* Source Icon */}\n      <View style={styles.sourceIconContainer}>\n        {item.source_icon ? (\n          <Image source={{ uri: item.source_icon }} style={styles.sourceIcon} />\n        ) : (\n          <View style={[styles.sourceIcon, styles.sourceIconPlaceholder, { backgroundColor: appColors.error + '15' }]}>\n            <Ionicons name=\"newspaper-outline\" size={16} color={appColors.error} />\n          </View>\n        )}\n      </View>\n\n      {/* Content */}\n      <View style={styles.newsContent}>\n        <ThemedText style={[styles.newsTitle, { color: appColors.textPrimary }]} numberOfLines={2}>\n          {item.title}\n        </ThemedText>\n        {item.category && (\n          <ThemedText style={[styles.newsCategory, { color: appColors.textSecondary }]}>{item.category}</ThemedText>\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n}\n\nfunction formatNewsDate(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\n\n  if (diffDays === 0) {\n    return 'Today';\n  } else if (diffDays === 1) {\n    return 'Yesterday';\n  } else if (diffDays < 7) {\n    return `${diffDays} days ago`;\n  } else {\n    const options: Intl.DateTimeFormatOptions = { month: 'short', day: 'numeric', year: 'numeric' };\n    return date.toLocaleDateString('en-US', options);\n  }\n}\n\ninterface FeaturedNewsCardProps {\n  item: NewsItem;\n  onPress: () => void;\n}\n\nexport function FeaturedNewsCard({ item, onPress }: FeaturedNewsCardProps) {\n  const appColors = useAppColors();\n  return (\n    <TouchableOpacity style={[styles.featuredCard, { backgroundColor: appColors.surface }]} onPress={onPress}>\n      {item.image_url && (\n        <Image source={{ uri: item.image_url }} style={styles.featuredImage} />\n      )}\n      <View style={styles.featuredContent}>\n        <View style={styles.featuredMeta}>\n          <ThemedText style={styles.featuredSource}>{item.source}</ThemedText>\n          <ThemedText style={[styles.featuredDate, { color: appColors.textSecondary }]}>\n            {formatNewsDate(item.published_at)}\n          </ThemedText>\n        </View>\n        <ThemedText style={[styles.featuredTitle, { color: appColors.textPrimary }]} numberOfLines={2}>\n          {item.title}\n        </ThemedText>\n      </View>\n    </TouchableOpacity>\n  );\n}\n\nexport function DiscoverNewsCompact({ limit = 5 }: { limit?: number }) {\n  const appColors = useAppColors();\n  return (\n    <View style={[styles.compactContainer, { backgroundColor: appColors.surface }]}>\n      <DiscoverMoreNews limit={limit} showHeader={true} />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n  },\n  loadingContainer: {\n    padding: Spacing.xl,\n    alignItems: 'center',\n  },\n  header: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n  },\n  headerTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  newsList: {\n    paddingHorizontal: Spacing.lg,\n  },\n  newsItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  sourceIconContainer: {\n    marginRight: Spacing.md,\n  },\n  sourceIcon: {\n    width: 32,\n    height: 32,\n    borderRadius: 4,\n  },\n  sourceIconPlaceholder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  newsContent: {\n    flex: 1,\n  },\n  newsTitle: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  newsCategory: {\n    ...Typography.small,\n    marginTop: 4,\n  },\n  viewAllButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.lg,\n    gap: Spacing.xs,\n  },\n  viewAllText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n\n  featuredCard: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  featuredImage: {\n    width: '100%',\n    height: 160,\n  },\n  featuredContent: {\n    padding: Spacing.md,\n  },\n  featuredMeta: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.sm,\n  },\n  featuredSource: {\n    ...Typography.small,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  featuredDate: {\n    ...Typography.small,\n    marginLeft: Spacing.sm,\n  },\n  featuredTitle: {\n    ...Typography.body,\n    fontWeight: '600',\n    lineHeight: 22,\n  },\n\n  compactContainer: {\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n});\n","path":null,"size_bytes":7498,"size_tokens":null},"client/screens/FollowersScreen.tsx":{"content":"/**\n * Followers Screen\n * View followers or following list\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi } from '@/lib/api';\nimport { User } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\n\ntype FollowersRouteParams = {\n  Followers: {\n    userId: number;\n    type: 'followers' | 'following';\n  };\n};\n\nexport default function FollowersScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<FollowersRouteParams, 'Followers'>>();\n  const { userId, type } = route.params;\n  const { user: currentUser } = useAuth();\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  const [activeTab, setActiveTab] = useState<'followers' | 'following'>(type);\n\n  // Fetch users\n  const {\n    data: users,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: [activeTab, userId],\n    queryFn: async () => {\n      const response = activeTab === 'followers'\n        ? await usersApi.getFollowers(userId)\n        : await usersApi.getFollowing(userId);\n      return response.data?.users || [];\n    },\n  });\n\n  // Follow mutation\n  const followMutation = useMutation({\n    mutationFn: async ({ targetUserId, isFollowing }: { targetUserId: number; isFollowing: boolean }) => {\n      if (isFollowing) {\n        return usersApi.unfollow(targetUserId);\n      }\n      return usersApi.follow(targetUserId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [activeTab, userId] });\n    },\n  });\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.push('UserProfile', { userId });\n  }, [navigation]);\n\n  const handleFollowPress = useCallback((targetUser: User & { is_following?: boolean }) => {\n    followMutation.mutate({\n      targetUserId: targetUser.id,\n      isFollowing: targetUser.is_following || false,\n    });\n  }, [followMutation]);\n\n  const renderUser = ({ item }: { item: User & { is_following?: boolean } }) => {\n    const isCurrentUser = item.id === currentUser?.id;\n\n    return (\n      <TouchableOpacity\n        style={[styles.userItem, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}\n        onPress={() => handleUserPress(item.id)}\n      >\n        {item.avatar_url ? (\n          <Image source={{ uri: item.avatar_url }} style={styles.avatar} />\n        ) : (\n          <View style={[styles.avatar, styles.avatarPlaceholder]}>\n            <ThemedText style={styles.avatarText}>\n              {item.first_name[0]}{item.last_name[0]}\n            </ThemedText>\n          </View>\n        )}\n        <View style={styles.userInfo}>\n          <View style={styles.userNameRow}>\n            <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>{item.full_name}</ThemedText>\n            {item.is_verified && (\n              <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n            )}\n          </View>\n          {item.specialty && (\n            <ThemedText style={[styles.userSpecialty, { color: appColors.textSecondary }]}>{item.specialty}</ThemedText>\n          )}\n        </View>\n        {!isCurrentUser && (\n          <TouchableOpacity\n            style={[\n              styles.followButton,\n              item.is_following && styles.followingButton,\n            ]}\n            onPress={() => handleFollowPress(item)}\n          >\n            <ThemedText style={[\n              styles.followButtonText,\n              item.is_following && { color: appColors.textSecondary },\n            ]}>\n              {item.is_following ? 'Following' : 'Follow'}\n            </ThemedText>\n          </TouchableOpacity>\n        )}\n      </TouchableOpacity>\n    );\n  };\n\n  const renderEmpty = () => {\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={Colors.primary} />\n        </View>\n      );\n    }\n    return (\n      <View style={styles.emptyContainer}>\n        <Ionicons name=\"people-outline\" size={48} color={appColors.textSecondary} />\n        <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>\n          {activeTab === 'followers' ? 'No followers yet' : 'Not following anyone'}\n        </ThemedText>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Connections</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      {/* Tabs */}\n      <View style={[styles.tabsContainer, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'followers' && styles.tabActive]}\n          onPress={() => setActiveTab('followers')}\n        >\n          <ThemedText style={[\n            styles.tabText,\n            { color: appColors.textSecondary },\n            activeTab === 'followers' && styles.tabTextActive,\n          ]}>\n            Followers\n          </ThemedText>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.tab, activeTab === 'following' && styles.tabActive]}\n          onPress={() => setActiveTab('following')}\n        >\n          <ThemedText style={[\n            styles.tabText,\n            { color: appColors.textSecondary },\n            activeTab === 'following' && styles.tabTextActive,\n          ]}>\n            Following\n          </ThemedText>\n        </TouchableOpacity>\n      </View>\n\n      {/* Users List */}\n      <FlatList\n        data={users}\n        renderItem={renderUser}\n        keyExtractor={(item) => item.id.toString()}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        contentContainerStyle={users?.length === 0 ? styles.emptyList : undefined}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    alignItems: 'center',\n  },\n  tabActive: {\n    borderBottomWidth: 2,\n    borderBottomColor: Colors.primary,\n  },\n  tabText: {\n    ...Typography.body,\n  },\n  tabTextActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  userItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  avatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    marginRight: Spacing.md,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  userInfo: {\n    flex: 1,\n  },\n  userNameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userSpecialty: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  followButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    backgroundColor: Colors.primary,\n  },\n  followingButton: {\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  followButtonText: {\n    ...Typography.caption,\n    color: 'white',\n    fontWeight: '600',\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyList: {\n    flex: 1,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":9172,"size_tokens":null},"client/lib/app-shortcuts.ts":{"content":"/**\n * App Shortcuts (3D Touch / Haptic Touch Quick Actions)\n * Quick actions from home screen icon press\n */\n\nimport { Platform, NativeModules, Linking } from 'react-native';\nimport { useEffect, useCallback } from 'react';\n\n// Shortcut types\nexport interface AppShortcut {\n  type: string;\n  title: string;\n  subtitle?: string;\n  iconName?: string; // SF Symbol name for iOS\n  userInfo?: Record<string, any>;\n}\n\n// Predefined shortcuts\nexport const APP_SHORTCUTS = {\n  NEW_POST: {\n    type: 'com.medinvest.newpost',\n    title: 'New Post',\n    subtitle: 'Create a new post',\n    iconName: 'square.and.pencil',\n  },\n  SEARCH: {\n    type: 'com.medinvest.search',\n    title: 'Search',\n    subtitle: 'Search posts and users',\n    iconName: 'magnifyingglass',\n  },\n  MESSAGES: {\n    type: 'com.medinvest.messages',\n    title: 'Messages',\n    subtitle: 'View your messages',\n    iconName: 'message.fill',\n  },\n  NOTIFICATIONS: {\n    type: 'com.medinvest.notifications',\n    title: 'Notifications',\n    subtitle: 'View notifications',\n    iconName: 'bell.fill',\n  },\n  AI_CHAT: {\n    type: 'com.medinvest.aichat',\n    title: 'Ask AI',\n    subtitle: 'Chat with MedInvest AI',\n    iconName: 'sparkles',\n  },\n} as const;\n\nexport type ShortcutType = keyof typeof APP_SHORTCUTS;\n\n/**\n * App Shortcuts Service\n */\nclass AppShortcutsService {\n  private isIOS = Platform.OS === 'ios';\n  private pendingShortcut: string | null = null;\n  private shortcutHandlers: Map<string, () => void> = new Map();\n\n  /**\n   * Initialize shortcuts on app start\n   */\n  async initialize(): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      // Set up default shortcuts\n      await this.setShortcuts([\n        APP_SHORTCUTS.NEW_POST,\n        APP_SHORTCUTS.SEARCH,\n        APP_SHORTCUTS.MESSAGES,\n        APP_SHORTCUTS.NOTIFICATIONS,\n      ]);\n\n      // Check for pending shortcut from cold start\n      await this.checkPendingShortcut();\n    } catch (error) {\n      console.error('[AppShortcuts] Error initializing:', error);\n    }\n  }\n\n  /**\n   * Set the available shortcuts\n   */\n  async setShortcuts(shortcuts: AppShortcut[]): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      if (NativeModules.QuickActions) {\n        await NativeModules.QuickActions.setShortcuts(shortcuts);\n      }\n    } catch (error) {\n      console.log('[AppShortcuts] QuickActions native module not available');\n    }\n  }\n\n  /**\n   * Add a dynamic shortcut\n   */\n  async addShortcut(shortcut: AppShortcut): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      if (NativeModules.QuickActions) {\n        await NativeModules.QuickActions.addShortcut(shortcut);\n      }\n    } catch (error) {\n      console.log('[AppShortcuts] Could not add shortcut');\n    }\n  }\n\n  /**\n   * Remove a shortcut\n   */\n  async removeShortcut(type: string): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      if (NativeModules.QuickActions) {\n        await NativeModules.QuickActions.removeShortcut(type);\n      }\n    } catch (error) {\n      console.log('[AppShortcuts] Could not remove shortcut');\n    }\n  }\n\n  /**\n   * Clear all shortcuts\n   */\n  async clearAllShortcuts(): Promise<void> {\n    if (!this.isIOS) return;\n\n    try {\n      if (NativeModules.QuickActions) {\n        await NativeModules.QuickActions.clearShortcuts();\n      }\n    } catch (error) {\n      console.log('[AppShortcuts] Could not clear shortcuts');\n    }\n  }\n\n  /**\n   * Check for pending shortcut (from cold start)\n   */\n  async checkPendingShortcut(): Promise<string | null> {\n    if (!this.isIOS) return null;\n\n    try {\n      if (NativeModules.QuickActions) {\n        const shortcut = await NativeModules.QuickActions.getPendingShortcut();\n        if (shortcut) {\n          this.pendingShortcut = shortcut;\n          return shortcut;\n        }\n      }\n    } catch (error) {\n      console.log('[AppShortcuts] Could not get pending shortcut');\n    }\n    return null;\n  }\n\n  /**\n   * Get and clear pending shortcut\n   */\n  consumePendingShortcut(): string | null {\n    const shortcut = this.pendingShortcut;\n    this.pendingShortcut = null;\n    return shortcut;\n  }\n\n  /**\n   * Register a handler for a shortcut type\n   */\n  registerHandler(type: string, handler: () => void): () => void {\n    this.shortcutHandlers.set(type, handler);\n    return () => this.shortcutHandlers.delete(type);\n  }\n\n  /**\n   * Handle a shortcut action\n   */\n  handleShortcut(type: string): void {\n    const handler = this.shortcutHandlers.get(type);\n    if (handler) {\n      handler();\n    } else {\n      console.log('[AppShortcuts] No handler for shortcut:', type);\n    }\n  }\n\n  /**\n   * Update shortcuts based on user state\n   */\n  async updateShortcutsForUser(user: { isPremium?: boolean; hasUnread?: boolean }): Promise<void> {\n    const shortcuts: AppShortcut[] = [\n      APP_SHORTCUTS.NEW_POST,\n      APP_SHORTCUTS.SEARCH,\n      APP_SHORTCUTS.MESSAGES,\n    ];\n\n    // Add AI chat for premium users\n    if (user.isPremium) {\n      shortcuts.push(APP_SHORTCUTS.AI_CHAT);\n    }\n\n    // Add notifications with badge if unread\n    if (user.hasUnread) {\n      shortcuts.push({\n        ...APP_SHORTCUTS.NOTIFICATIONS,\n        subtitle: 'You have new notifications',\n      });\n    } else {\n      shortcuts.push(APP_SHORTCUTS.NOTIFICATIONS);\n    }\n\n    await this.setShortcuts(shortcuts);\n  }\n\n  /**\n   * Map shortcut type to navigation route\n   */\n  getRouteForShortcut(type: string): { screen: string; params?: any } | null {\n    switch (type) {\n      case APP_SHORTCUTS.NEW_POST.type:\n        return { screen: 'CreatePost' };\n      case APP_SHORTCUTS.SEARCH.type:\n        return { screen: 'Search' };\n      case APP_SHORTCUTS.MESSAGES.type:\n        return { screen: 'Messages' };\n      case APP_SHORTCUTS.NOTIFICATIONS.type:\n        return { screen: 'Notifications' };\n      case APP_SHORTCUTS.AI_CHAT.type:\n        return { screen: 'AIChat' };\n      default:\n        return null;\n    }\n  }\n}\n\nexport const appShortcutsService = new AppShortcutsService();\n\n/**\n * Hook to handle app shortcuts\n */\nexport function useAppShortcuts(navigation: any) {\n  // Handle shortcut navigation\n  const handleShortcut = useCallback((type: string) => {\n    const route = appShortcutsService.getRouteForShortcut(type);\n    if (route) {\n      navigation.navigate(route.screen, route.params);\n    }\n  }, [navigation]);\n\n  // Initialize and check for pending shortcut\n  useEffect(() => {\n    const init = async () => {\n      await appShortcutsService.initialize();\n      \n      // Handle pending shortcut from cold start\n      const pending = appShortcutsService.consumePendingShortcut();\n      if (pending) {\n        // Delay to ensure navigation is ready\n        setTimeout(() => handleShortcut(pending), 500);\n      }\n    };\n\n    init();\n\n    // Register handlers for all shortcuts\n    const unsubscribers = Object.values(APP_SHORTCUTS).map(shortcut =>\n      appShortcutsService.registerHandler(shortcut.type, () => handleShortcut(shortcut.type))\n    );\n\n    return () => {\n      unsubscribers.forEach(unsub => unsub());\n    };\n  }, [handleShortcut]);\n\n  return {\n    handleShortcut,\n    updateShortcuts: (user: any) => appShortcutsService.updateShortcutsForUser(user),\n  };\n}\n\n/**\n * Android App Shortcuts (for completeness)\n * Android uses a different mechanism - shortcuts in AndroidManifest.xml\n * and ShortcutManager for dynamic shortcuts\n */\nexport const ANDROID_SHORTCUTS = `\n<!-- Add to android/app/src/main/AndroidManifest.xml -->\n<shortcuts xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    <shortcut\n        android:shortcutId=\"new_post\"\n        android:enabled=\"true\"\n        android:icon=\"@drawable/ic_shortcut_post\"\n        android:shortcutShortLabel=\"@string/shortcut_new_post\"\n        android:shortcutLongLabel=\"@string/shortcut_new_post_long\">\n        <intent\n            android:action=\"android.intent.action.VIEW\"\n            android:targetPackage=\"com.medinvest.app\"\n            android:targetClass=\"com.medinvest.app.MainActivity\"\n            android:data=\"medinvest://post/new\" />\n    </shortcut>\n    <shortcut\n        android:shortcutId=\"search\"\n        android:enabled=\"true\"\n        android:icon=\"@drawable/ic_shortcut_search\"\n        android:shortcutShortLabel=\"@string/shortcut_search\"\n        android:shortcutLongLabel=\"@string/shortcut_search_long\">\n        <intent\n            android:action=\"android.intent.action.VIEW\"\n            android:targetPackage=\"com.medinvest.app\"\n            android:targetClass=\"com.medinvest.app.MainActivity\"\n            android:data=\"medinvest://search\" />\n    </shortcut>\n    <shortcut\n        android:shortcutId=\"messages\"\n        android:enabled=\"true\"\n        android:icon=\"@drawable/ic_shortcut_messages\"\n        android:shortcutShortLabel=\"@string/shortcut_messages\"\n        android:shortcutLongLabel=\"@string/shortcut_messages_long\">\n        <intent\n            android:action=\"android.intent.action.VIEW\"\n            android:targetPackage=\"com.medinvest.app\"\n            android:targetClass=\"com.medinvest.app.MainActivity\"\n            android:data=\"medinvest://messages\" />\n    </shortcut>\n</shortcuts>\n`;\n","path":null,"size_bytes":9086,"size_tokens":null},"server/replit_integrations/chat/index.ts":{"content":"export { registerChatRoutes } from \"./routes\";\nexport { chatStorage, type IChatStorage } from \"./storage\";\n\n","path":null,"size_bytes":108,"size_tokens":null},"server/routes/auth.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { db, users, userSessions, notificationPreferences, passwordResetTokens } from '../db';\nimport { eq, and, gt, isNull } from 'drizzle-orm';\nimport { authMiddleware, generateToken } from '../middleware/auth';\nimport { verifyAppleToken, verifyGoogleToken, verifyGithubToken, verifyFacebookToken } from '../services/socialAuth';\nimport bcrypt from 'bcrypt';\nimport crypto from 'crypto';\n\nfunction cleanEnv(key: string): string | undefined {\n  const val = process.env[key];\n  if (!val) return undefined;\n  let cleaned = val.trim();\n  cleaned = cleaned.replace(/[\\r\\n]+.*$/s, '');\n  cleaned = cleaned.replace(/\\\\n.*$/s, '');\n  cleaned = cleaned.replace(/[\\x00-\\x1F\\x7F]/g, '');\n  return cleaned || undefined;\n}\n\nfunction getGoogleClientId(): string | undefined {\n  return cleanEnv('GOOGLE_WEB_CLIENT_ID') || cleanEnv('EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID');\n}\n\nfunction getGoogleClientSecret(): string | undefined {\n  return cleanEnv('GOOGLE_WEB_CLIENT_SECRET');\n}\n\nfunction getGithubClientId(mobile = false): string | undefined {\n  if (mobile) {\n    return cleanEnv('GITHUB_MOBILE_CLIENT_ID') || cleanEnv('EXPO_PUBLIC_GITHUB_MOBILE_CLIENT_ID');\n  }\n  return cleanEnv('GITHUB_CLIENT_ID') || cleanEnv('EXPO_PUBLIC_GITHUB_CLIENT_ID');\n}\n\nfunction getGithubClientSecret(mobile = false): string | undefined {\n  return mobile ? cleanEnv('GITHUB_MOBILE_CLIENT_SECRET') : cleanEnv('GITHUB_CLIENT_SECRET');\n}\n\nfunction getFacebookAppId(): string | undefined {\n  return cleanEnv('FACEBOOK_APP_ID') || cleanEnv('EXPO_PUBLIC_FACEBOOK_APP_ID');\n}\n\nfunction getFacebookAppSecret(): string | undefined {\n  return cleanEnv('FACEBOOK_APP_SECRET');\n}\n\n// OAuth redirect base URL - must match registered URIs in OAuth apps\nconst OAUTH_REDIRECT_BASE = process.env.OAUTH_REDIRECT_BASE || 'https://themedicineandmoneyshow.com';\n\nconst router = Router();\n\nconst STATE_SECRET = process.env.SESSION_SECRET || crypto.randomBytes(32).toString('hex');\n\nfunction createSignedOAuthState(provider: string, flow: 'popup' | 'mobile' | 'landing', appRedirectUri?: string): string {\n  const payload: Record<string, string> = { p: provider, f: flow, n: crypto.randomBytes(16).toString('hex') };\n  if (appRedirectUri) {\n    payload.r = appRedirectUri;\n  }\n  const data = Buffer.from(JSON.stringify(payload)).toString('base64url');\n  const sig = crypto.createHmac('sha256', STATE_SECRET).update(data).digest('base64url');\n  return `${data}.${sig}`;\n}\n\nfunction verifySignedOAuthState(state: string): { provider: string; flow: string; appRedirectUri?: string } | null {\n  try {\n    const dotIdx = state.indexOf('.');\n    if (dotIdx === -1) return null;\n    const data = state.substring(0, dotIdx);\n    const sig = state.substring(dotIdx + 1);\n    const expectedSig = crypto.createHmac('sha256', STATE_SECRET).update(data).digest('base64url');\n    if (sig !== expectedSig) {\n      console.error('[OAuth] Invalid state signature');\n      return null;\n    }\n    const payload = JSON.parse(Buffer.from(data, 'base64url').toString());\n    return { provider: payload.p, flow: payload.f || 'landing', appRedirectUri: payload.r };\n  } catch (err) {\n    console.error('[OAuth] Failed to decode state:', err);\n    return null;\n  }\n}\n\n/**\n * POST /api/auth/register\n * Email/password registration\n */\nrouter.post('/register', async (req: Request, res: Response) => {\n  try {\n    const { email, password, first_name, last_name } = req.body;\n\n    if (!email || !password) {\n      res.status(400).json({ message: 'Email and password are required' });\n      return;\n    }\n\n    if (!first_name || !last_name) {\n      res.status(400).json({ message: 'First and last name are required' });\n      return;\n    }\n\n    // Password validation\n    if (password.length < 8) {\n      res.status(400).json({ message: 'Password must be at least 8 characters' });\n      return;\n    }\n\n    const hasUppercase = /[A-Z]/.test(password);\n    const hasLowercase = /[a-z]/.test(password);\n    const hasNumber = /[0-9]/.test(password);\n\n    if (!hasUppercase || !hasLowercase || !hasNumber) {\n      res.status(400).json({ \n        message: 'Password must contain uppercase, lowercase, and number' \n      });\n      return;\n    }\n\n    // Check if user already exists\n    const [existingUser] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, email.toLowerCase()))\n      .limit(1);\n\n    if (existingUser) {\n      res.status(409).json({ message: 'An account with this email already exists' });\n      return;\n    }\n\n    // Hash password with bcrypt (10 salt rounds)\n    const SALT_ROUNDS = 10;\n    const passwordHash = await bcrypt.hash(password, SALT_ROUNDS);\n\n    // Create new user with hashed password\n    const [newUser] = await db\n      .insert(users)\n      .values({\n        email: email.toLowerCase(),\n        passwordHash,\n        firstName: first_name,\n        lastName: last_name,\n        provider: 'email',\n        isVerified: false,\n        lastLoginAt: new Date(),\n      })\n      .returning();\n\n    // Create default notification preferences\n    await db.insert(notificationPreferences).values({\n      userId: newUser.id,\n    });\n\n    // Create session\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30);\n\n    const [session] = await db\n      .insert(userSessions)\n      .values({\n        userId: newUser.id,\n        token: crypto.randomUUID(),\n        expiresAt,\n      })\n      .returning();\n\n    // Generate JWT\n    const jwtToken = generateToken(newUser.id, session.id);\n\n    res.status(201).json({\n      token: jwtToken,\n      user: {\n        id: newUser.id,\n        email: newUser.email,\n        firstName: newUser.firstName,\n        lastName: newUser.lastName,\n        isVerified: newUser.isVerified,\n        fullName: [newUser.firstName, newUser.lastName].filter(Boolean).join(' '),\n      },\n    });\n  } catch (error) {\n    console.error('Registration error:', error);\n    res.status(500).json({ message: 'Registration failed' });\n  }\n});\n\n/**\n * POST /api/auth/login\n * Email/password login\n */\nrouter.post('/login', async (req: Request, res: Response) => {\n  try {\n    const { email, password } = req.body;\n\n    if (!email || !password) {\n      res.status(400).json({ message: 'Email and password are required' });\n      return;\n    }\n\n    // Find user by email\n    const [user] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, email.toLowerCase()))\n      .limit(1);\n\n    if (!user || !user.passwordHash) {\n      res.status(401).json({ message: 'Invalid email or password' });\n      return;\n    }\n\n    // Verify password\n    const isValidPassword = await bcrypt.compare(password, user.passwordHash);\n    if (!isValidPassword) {\n      res.status(401).json({ message: 'Invalid email or password' });\n      return;\n    }\n\n    // Update last login\n    await db\n      .update(users)\n      .set({ lastLoginAt: new Date() })\n      .where(eq(users.id, user.id));\n\n    // Create session\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30);\n\n    const [session] = await db\n      .insert(userSessions)\n      .values({\n        userId: user.id,\n        token: crypto.randomUUID(),\n        expiresAt,\n      })\n      .returning();\n\n    // Generate JWT\n    const jwtToken = generateToken(user.id, session.id);\n\n    res.json({\n      token: jwtToken,\n      user: {\n        id: user.id,\n        email: user.email,\n        firstName: user.firstName,\n        lastName: user.lastName,\n        avatarUrl: user.avatarUrl,\n        isVerified: user.isVerified,\n        fullName: [user.firstName, user.lastName].filter(Boolean).join(' '),\n      },\n    });\n  } catch (error) {\n    console.error('Login error:', error);\n    res.status(500).json({ message: 'Login failed' });\n  }\n});\n\n/**\n * POST /api/auth/google/token\n * Exchange Google authorization code for access token (web redirect flow)\n */\nrouter.post('/google/token', async (req: Request, res: Response) => {\n  try {\n    const { code, redirect_uri } = req.body;\n\n    if (!code) {\n      res.status(400).json({ message: 'Authorization code is required' });\n      return;\n    }\n\n    const clientId = getGoogleClientId();\n    const clientSecret = getGoogleClientSecret();\n\n    if (!clientId || !clientSecret) {\n      res.status(500).json({ message: 'Google OAuth is not configured' });\n      return;\n    }\n\n    console.log('Google token exchange: redirect_uri =', redirect_uri);\n\n    const tokenResponse = await fetch('https://oauth2.googleapis.com/token', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: new URLSearchParams({\n        code,\n        client_id: clientId,\n        client_secret: clientSecret,\n        redirect_uri:`${OAUTH_REDIRECT_BASE}/api/auth/google/callback`,\n        grant_type: 'authorization_code',\n      }).toString(),\n    });\n\n    const tokenData = await tokenResponse.json();\n\n    if (tokenData.error) {\n      console.error('Google token exchange error:', tokenData);\n      res.status(401).json({ message: tokenData.error_description || 'Failed to exchange code' });\n      return;\n    }\n\n    res.json({ access_token: tokenData.access_token });\n  } catch (error) {\n    console.error('Google token exchange error:', error);\n    res.status(500).json({ message: 'Token exchange failed' });\n  }\n});\n\n/**\n * POST /api/auth/github/token\n * Exchange GitHub authorization code for access token\n * Supports both web and mobile OAuth apps\n */\nrouter.post('/github/token', async (req: Request, res: Response) => {\n  try {\n    const { code, redirect_uri, platform } = req.body;\n\n    if (!code) {\n      res.status(400).json({ message: 'Authorization code is required' });\n      return;\n    }\n\n    const isMobile = platform === 'mobile' || platform === 'ios' || platform === 'android';\n    \n    let clientId = getGithubClientId(isMobile);\n    let clientSecret = getGithubClientSecret(isMobile);\n    \n    if (isMobile && (!clientId || !clientSecret)) {\n      console.log('Mobile GitHub credentials not found, falling back to web credentials');\n      clientId = getGithubClientId(false);\n      clientSecret = getGithubClientSecret(false);\n    }\n\n    if (!clientId || !clientSecret) {\n      res.status(500).json({ message: 'GitHub OAuth is not configured' });\n      return;\n    }\n\n    console.log(`GitHub token exchange: platform=${platform}, isMobile=${isMobile}`);\n\n    // Exchange code for access token\n    const tokenResponse = await fetch('https://github.com/login/oauth/access_token', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n      },\n      body: JSON.stringify({\n        client_id: clientId,\n        client_secret: clientSecret,\n        code,\n        redirect_uri: `${OAUTH_REDIRECT_BASE}/api/auth/github/callback`,\n      }),\n    });\n\n    const tokenData = await tokenResponse.json();\n\n    if (tokenData.error) {\n      console.error('GitHub token exchange error:', tokenData);\n      res.status(401).json({ message: tokenData.error_description || 'Failed to exchange code' });\n      return;\n    }\n\n    res.json({ access_token: tokenData.access_token });\n  } catch (error) {\n    console.error('GitHub token exchange error:', error);\n    res.status(500).json({ message: 'Token exchange failed' });\n  }\n});\n\n/**\n * POST /api/auth/facebook/token\n * Exchange Facebook authorization code for access token\n */\nrouter.post('/facebook/token', async (req: Request, res: Response) => {\n  try {\n    const { code, redirect_uri } = req.body;\n\n    if (!code) {\n      res.status(400).json({ message: 'Authorization code is required' });\n      return;\n    }\n\n    const appId = getFacebookAppId();\n    const appSecret = getFacebookAppSecret();\n\n    if (!appId || !appSecret) {\n      res.status(500).json({ message: 'Facebook OAuth is not configured' });\n      return;\n    }\n\n    const tokenUrl = new URL('https://graph.facebook.com/v18.0/oauth/access_token');\n    tokenUrl.searchParams.append('client_id', appId);\n    tokenUrl.searchParams.append('client_secret', appSecret);\n    tokenUrl.searchParams.append('redirect_uri', `${OAUTH_REDIRECT_BASE}/api/auth/facebook/callback`);\n    tokenUrl.searchParams.append('code', code);\n\n    const tokenResponse = await fetch(tokenUrl.toString());\n    const tokenData = await tokenResponse.json();\n\n    if (tokenData.error) {\n      console.error('Facebook token exchange error:', tokenData);\n      res.status(401).json({ message: tokenData.error.message || 'Failed to exchange code' });\n      return;\n    }\n\n    res.json({ access_token: tokenData.access_token });\n  } catch (error) {\n    console.error('Facebook token exchange error:', error);\n    res.status(500).json({ message: 'Token exchange failed' });\n  }\n});\n\n/**\n * Helper to construct the callback URI.\n * Uses a stable published domain so the redirect_uri is consistent\n * and matches what's registered with OAuth providers.\n * The dev domain changes every restart - never use it for OAuth.\n */\nfunction getBaseUri(): string {\n  const oauthDomain = process.env.OAUTH_CALLBACK_DOMAIN;\n  if (oauthDomain) {\n    return `https://${oauthDomain}`;\n  }\n\n  const publishedDomain = process.env.EXPO_PUBLIC_DOMAIN?.replace(/:5000$/, '');\n  if (publishedDomain && !publishedDomain.includes('localhost')) {\n    return `https://${publishedDomain}`;\n  }\n\n  return 'http://localhost:5000';\n}\n\nfunction getCallbackUri(_provider?: string): string {\n  const base = getBaseUri();\n  return `${base}/api/auth/callback`;\n}\n\n/**\n * GET /api/auth/google/start\n * Server-side Google OAuth initiation - redirects to Google with correct redirect_uri\n */\nrouter.get('/google/start', (req: Request, res: Response) => {\n  const clientId = getGoogleClientId();\n  if (!clientId) {\n    res.status(500).json({ message: 'Google OAuth is not configured' });\n    return;\n  }\n\n  const callbackUri = getCallbackUri('google');\n  const flow = (req.query.flow as string) || 'landing';\n  const appRedirectUri = req.query.app_redirect_uri as string;\n  const state = createSignedOAuthState('google', flow as any, appRedirectUri);\n\n  console.log(`[OAuth Start] Google - redirect_uri: ${callbackUri}, flow: ${flow}`);\n\n  const params = new URLSearchParams({\n    client_id: clientId,\n    redirect_uri: callbackUri,\n    response_type: 'code',\n    scope: 'openid profile email',\n    state,\n    access_type: 'offline',\n    prompt: 'select_account',\n  });\n\n  res.redirect(`https://accounts.google.com/o/oauth2/v2/auth?${params.toString()}`);\n});\n\n/**\n * GET /api/auth/github/start\n * Server-side GitHub OAuth initiation\n */\nrouter.get('/github/start', (req: Request, res: Response) => {\n  const clientId = getGithubClientId() || getGithubClientId(true);\n  if (!clientId) {\n    res.status(500).json({ message: 'GitHub OAuth is not configured' });\n    return;\n  }\n\n  const callbackUri = getCallbackUri('github');\n  const flow = (req.query.flow as string) || 'landing';\n  const appRedirectUri = req.query.app_redirect_uri as string;\n  const state = createSignedOAuthState('github', flow as any, appRedirectUri);\n\n  console.log(`[OAuth Start] GitHub - redirect_uri: ${callbackUri}, flow: ${flow}`);\n\n  const params = new URLSearchParams({\n    client_id: clientId,\n    redirect_uri: callbackUri,\n    scope: 'user:email read:user',\n    state,\n  });\n\n  res.redirect(`https://github.com/login/oauth/authorize?${params.toString()}`);\n});\n\n/**\n * GET /api/auth/facebook/start\n * Server-side Facebook OAuth initiation\n */\nrouter.get('/facebook/start', (req: Request, res: Response) => {\n  const appId = getFacebookAppId();\n  if (!appId) {\n    res.status(500).json({ message: 'Facebook OAuth is not configured' });\n    return;\n  }\n\n  const callbackUri = getCallbackUri('facebook');\n  const flow = (req.query.flow as string) || 'landing';\n  const appRedirectUri = req.query.app_redirect_uri as string;\n  const state = createSignedOAuthState('facebook', flow as any, appRedirectUri);\n\n  console.log(`[OAuth Start] Facebook - redirect_uri: ${callbackUri}, flow: ${flow}`);\n\n  const params = new URLSearchParams({\n    client_id: appId,\n    redirect_uri: callbackUri,\n    scope: 'email,public_profile',\n    state,\n    response_type: 'code',\n  });\n\n  res.redirect(`https://www.facebook.com/v18.0/dialog/oauth?${params.toString()}`);\n});\n\n/**\n * GET /api/auth/mobile-callback\n * Mobile OAuth redirect target - this URL is used as the redirect URI for\n * openAuthSessionAsync. The browser will navigate here but the auth session\n * intercepts it before the page loads, capturing the token from query params.\n */\nrouter.get('/mobile-callback', (req: Request, res: Response) => {\n  const token = req.query.token as string;\n  const error = req.query.error as string;\n  \n  if (token) {\n    res.send('<html><body><p>Authentication successful. You can close this window.</p></body></html>');\n  } else if (error) {\n    res.send(`<html><body><p>Authentication failed: ${error}</p></body></html>`);\n  } else {\n    res.send('<html><body><p>Authentication in progress...</p></body></html>');\n  }\n});\n\n/**\n * GET /api/auth/callback\n * Server-side OAuth callback handler\n * Handles the redirect from OAuth providers, exchanges code for token,\n * creates/finds user, generates JWT, and passes it back via cookie\n */\nrouter.get('/callback', async (req: Request, res: Response) => {\n  try {\n    const { code, state, error: oauthError, error_description } = req.query;\n    const stateStr = typeof state === 'string' ? state : '';\n\n    const stateData = stateStr ? verifySignedOAuthState(stateStr) : null;\n\n    const sendError = (msg: string, statusCode = 400) => {\n      if (stateData?.flow === 'popup') {\n        return res.status(statusCode).send(getPopupErrorPage(msg));\n      }\n      if (stateData?.appRedirectUri) {\n        const appUri = stateData.appRedirectUri;\n        const separator = appUri.includes('?') ? '&' : '?';\n        const errorRedirect = `${appUri}${separator}error=${encodeURIComponent(msg)}`;\n        if (appUri.startsWith('http')) {\n          return res.redirect(errorRedirect);\n        }\n        return res.send(`<!DOCTYPE html><html><head><meta charset=\"utf-8\"></head><body><script>window.location.href=${JSON.stringify(errorRedirect)};</script></body></html>`);\n      }\n      return res.status(statusCode).send(getOAuthResultPage('error', msg));\n    };\n\n    if (oauthError) {\n      console.error('[OAuth Callback] Error from provider:', oauthError, error_description);\n      return sendError(`Authentication failed: ${error_description || oauthError}`);\n    }\n\n    if (!code || !state || typeof code !== 'string' || typeof state !== 'string') {\n      return sendError('Missing authorization code or state');\n    }\n\n    if (!stateData) {\n      console.error('[OAuth Callback] Invalid or tampered state parameter');\n      return res.status(400).send(getOAuthResultPage('error', 'Invalid state parameter. Please try again.'));\n    }\n\n    const provider = stateData.provider;\n    if (!['google', 'github', 'facebook'].includes(provider)) {\n      return sendError('Unknown provider');\n    }\n\n    console.log(`[OAuth Callback] Provider: ${provider}, code length: ${code.length}, has appRedirectUri: ${!!stateData.appRedirectUri}`);\n\n    const callbackUri = getCallbackUri(provider);\n    console.log(`[OAuth Callback] Using redirect_uri for token exchange: ${callbackUri}`);\n\n    let accessToken: string | undefined;\n\n    if (provider === 'github') {\n      const clientId = getGithubClientId() || getGithubClientId(true);\n      const clientSecret = getGithubClientSecret() || getGithubClientSecret(true);\n      if (!clientId || !clientSecret) {\n        console.error('[OAuth Callback] GitHub missing config - clientId:', !!clientId, 'clientSecret:', !!clientSecret);\n        return sendError('GitHub OAuth is not configured', 500);\n      }\n      const tokenResponse = await fetch('https://github.com/login/oauth/access_token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },\n        body: JSON.stringify({ client_id: clientId, client_secret: clientSecret, code, redirect_uri: callbackUri }),\n      });\n      const tokenData = await tokenResponse.json();\n      if (tokenData.error) {\n        console.error('[OAuth Callback] GitHub token error:', tokenData);\n        return sendError(tokenData.error_description || 'GitHub token exchange failed', 401);\n      }\n      accessToken = tokenData.access_token;\n    } else if (provider === 'google') {\n      const clientId = getGoogleClientId();\n      const clientSecret = getGoogleClientSecret();\n      if (!clientId || !clientSecret) {\n        console.error(`[OAuth Callback] Google OAuth missing config - clientId: ${!!clientId}, clientSecret: ${!!clientSecret}`);\n        return sendError('Google OAuth is not configured', 500);\n      }\n      console.log(`[OAuth Callback] Google token exchange - redirect_uri: \"${callbackUri}\", code length: ${code.length}`);\n      const tokenBody = new URLSearchParams({ code, client_id: clientId, client_secret: clientSecret, redirect_uri: callbackUri, grant_type: 'authorization_code' });\n      const tokenResponse = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: tokenBody.toString(),\n      });\n      const tokenData = await tokenResponse.json();\n      if (tokenData.error) {\n        console.error('[OAuth Callback] Google token error:', JSON.stringify(tokenData));\n        return sendError(`Google login failed: ${tokenData.error} - ${tokenData.error_description || 'unknown'}`, 401);\n      }\n      accessToken = tokenData.access_token;\n    } else if (provider === 'facebook') {\n      const appId = getFacebookAppId();\n      const appSecret = getFacebookAppSecret();\n      if (!appId || !appSecret) {\n        return sendError('Facebook OAuth is not configured', 500);\n      }\n      console.log(`[OAuth Callback] Facebook token exchange - redirect_uri: \"${callbackUri}\", code length: ${code.length}`);\n      const tokenUrl = new URL('https://graph.facebook.com/v18.0/oauth/access_token');\n      tokenUrl.searchParams.append('client_id', appId);\n      tokenUrl.searchParams.append('client_secret', appSecret);\n      tokenUrl.searchParams.append('code', code);\n      tokenUrl.searchParams.append('redirect_uri', callbackUri);\n      const tokenResponse = await fetch(tokenUrl.toString());\n      const tokenData = await tokenResponse.json();\n      if (tokenData.error) {\n        console.error('[OAuth Callback] Facebook token error:', JSON.stringify(tokenData));\n        const fbErrMsg = tokenData.error?.message || 'Facebook token exchange failed';\n        if (fbErrMsg.includes(\"domain\") && fbErrMsg.includes(\"app's domains\")) {\n          return sendError('Facebook login configuration error. The callback domain needs to be added to the Facebook app settings.', 401);\n        }\n        return sendError(fbErrMsg, 401);\n      }\n      accessToken = tokenData.access_token;\n    }\n\n    if (!accessToken) {\n      return sendError('Failed to obtain access token', 401);\n    }\n\n    let verifiedEmail: string | undefined;\n    let providerUserId: string | undefined;\n    let verifiedFirstName: string | undefined;\n    let verifiedLastName: string | undefined;\n    let verifiedAvatarUrl: string | undefined;\n\n    if (provider === 'google') {\n      const googleData = await verifyGoogleToken(accessToken);\n      if (!googleData) return sendError('Invalid Google token', 401);\n      verifiedEmail = googleData.email;\n      providerUserId = googleData.sub;\n      verifiedFirstName = googleData.given_name;\n      verifiedLastName = googleData.family_name;\n      verifiedAvatarUrl = googleData.picture;\n    } else if (provider === 'github') {\n      const githubData = await verifyGithubToken(accessToken);\n      if (!githubData) return sendError('Invalid GitHub token', 401);\n      verifiedEmail = githubData.email;\n      providerUserId = githubData.sub;\n      if (githubData.name) {\n        const nameParts = githubData.name.split(' ');\n        verifiedFirstName = nameParts[0];\n        verifiedLastName = nameParts.slice(1).join(' ');\n      }\n      verifiedAvatarUrl = githubData.picture;\n    } else if (provider === 'facebook') {\n      const facebookData = await verifyFacebookToken(accessToken);\n      if (!facebookData) return sendError('Invalid Facebook token', 401);\n      verifiedEmail = facebookData.email;\n      providerUserId = facebookData.sub;\n      verifiedFirstName = facebookData.first_name;\n      verifiedLastName = facebookData.last_name;\n      verifiedAvatarUrl = facebookData.picture;\n    }\n\n    if (!verifiedEmail) {\n      return sendError('Email is required. Please ensure your account has a verified email.');\n    }\n\n    let [existingUser] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, verifiedEmail))\n      .limit(1);\n\n    let userId: string;\n\n    if (existingUser) {\n      userId = existingUser.id;\n      await db\n        .update(users)\n        .set({\n          provider: provider as any,\n          providerUserId,\n          lastLoginAt: new Date(),\n          updatedAt: new Date(),\n          ...(verifiedFirstName ? { firstName: verifiedFirstName } : {}),\n          ...(verifiedLastName ? { lastName: verifiedLastName } : {}),\n          ...(verifiedAvatarUrl ? { avatarUrl: verifiedAvatarUrl } : {}),\n        })\n        .where(eq(users.id, userId));\n    } else {\n      const [newUser] = await db\n        .insert(users)\n        .values({\n          email: verifiedEmail,\n          firstName: verifiedFirstName || null,\n          lastName: verifiedLastName || null,\n          avatarUrl: verifiedAvatarUrl || null,\n          provider: provider as any,\n          providerUserId,\n          isVerified: true,\n          lastLoginAt: new Date(),\n        })\n        .returning();\n      userId = newUser.id;\n      await db.insert(notificationPreferences).values({ userId });\n    }\n\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30);\n\n    const [session] = await db\n      .insert(userSessions)\n      .values({ userId, token: crypto.randomUUID(), expiresAt })\n      .returning();\n\n    const jwtToken = generateToken(userId, session.id);\n\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n      })\n      .from(users)\n      .where(eq(users.id, userId))\n      .limit(1);\n\n    const userData = {\n      ...user,\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || undefined,\n    };\n\n    console.log(`[OAuth Callback] Success: ${verifiedEmail} via ${provider}, flow: ${stateData.flow}`);\n\n    if (stateData.flow === 'popup') {\n      console.log(`[OAuth Callback] Popup flow - sending postMessage with token`);\n      return res.send(getPopupPostMessagePage(jwtToken, userData));\n    }\n\n    if (stateData.flow === 'mobile' && stateData.appRedirectUri) {\n      const appUri = stateData.appRedirectUri;\n      const separator = appUri.includes('?') ? '&' : '?';\n      const redirectUrl = `${appUri}${separator}token=${encodeURIComponent(jwtToken)}`;\n      console.log(`[OAuth Callback] Redirecting to mobile app: ${redirectUrl}`);\n\n      if (appUri.startsWith('http')) {\n        return res.redirect(redirectUrl);\n      }\n\n      return res.send(`<!DOCTYPE html><html><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><title>Redirecting...</title></head><body><p>Redirecting to app...</p><script>window.location.href=${JSON.stringify(redirectUrl)};</script></body></html>`);\n    }\n\n    console.log(`[OAuth Callback] Landing page flow - redirecting with auth token`);\n    const baseUri = getBaseUri();\n    const userDataEncoded = encodeURIComponent(JSON.stringify(userData));\n    return res.redirect(`${baseUri}/?auth_token=${encodeURIComponent(jwtToken)}&auth_user=${userDataEncoded}`);\n  } catch (error) {\n    console.error('[OAuth Callback] Error:', error);\n    return res.status(500).send(getOAuthResultPage('error', 'Authentication failed. Please try again.'));\n  }\n});\n\nfunction getOAuthResultPage(status: 'success' | 'error', message: string, token?: string, user?: any, appRedirectUri?: string): string {\n  const isSuccess = status === 'success';\n  const deepLinkUrl = appRedirectUri \n    ? `${appRedirectUri}${appRedirectUri.includes('?') ? '&' : '?'}token=${token}`\n    : `medinvest://auth?token=${token}`;\n  const userJson = user ? JSON.stringify(user).replace(/</g, '\\\\u003c').replace(/>/g, '\\\\u003e') : 'null';\n  return `<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>MedInvest - ${isSuccess ? 'Login Successful' : 'Login Failed'}</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #fff; display: flex; align-items: center; justify-content: center; min-height: 100vh; }\n    .container { text-align: center; padding: 40px; max-width: 400px; }\n    .icon { font-size: 64px; margin-bottom: 20px; }\n    h1 { font-size: 24px; margin-bottom: 12px; }\n    p { color: #999; font-size: 16px; margin-bottom: 24px; }\n    .btn { display: inline-block; padding: 14px 32px; background: linear-gradient(135deg, #0066CC, #00A86B); color: #fff; text-decoration: none; border-radius: 12px; font-size: 16px; font-weight: 600; border: none; cursor: pointer; }\n    .spinner { border: 3px solid #333; border-top: 3px solid #0066CC; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-bottom: 16px; }\n    @keyframes spin { to { transform: rotate(360deg); } }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    ${isSuccess ? `\n      <div class=\"spinner\"></div>\n      <h1>Login Successful</h1>\n      <p id=\"status-msg\">Signing you in...</p>\n      <script>\n        (function() {\n          try {\n            var token = ${JSON.stringify(token || '')};\n            var userData = ${userJson};\n            var deepLink = ${JSON.stringify(deepLinkUrl)};\n            var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n\n            // Store token and user data in cookies for the app to read\n            document.cookie = 'medinvest_auth_token=' + encodeURIComponent(token) + '; Path=/; Max-Age=300; SameSite=Lax; Secure';\n            if (userData) {\n              document.cookie = 'medinvest_auth_user=' + encodeURIComponent(JSON.stringify(userData)) + '; Path=/; Max-Age=300; SameSite=Lax; Secure';\n            }\n\n            // Also store in localStorage as backup for the Expo web app\n            try {\n              localStorage.setItem('medinvest_oauth_token', token);\n              if (userData) localStorage.setItem('medinvest_oauth_user', JSON.stringify(userData));\n            } catch(e) {}\n\n            if (isMobile) {\n              // Try deep link for native app\n              document.getElementById('status-msg').textContent = 'Opening the app...';\n              window.location.href = deepLink;\n              setTimeout(function() {\n                window.location.href = 'medinvest://auth?token=' + encodeURIComponent(token);\n              }, 500);\n              setTimeout(function() {\n                document.getElementById('status-msg').textContent = 'Login successful! You can return to the app.';\n              }, 3000);\n            } else {\n              // Web: redirect to app root so cookie-reading code picks it up\n              document.getElementById('status-msg').textContent = 'Redirecting...';\n              setTimeout(function() {\n                window.location.href = '/';\n              }, 500);\n            }\n          } catch(e) {\n            document.getElementById('status-msg').textContent = 'Login successful! You can close this tab.';\n          }\n        })();\n      </script>\n    ` : `\n      <div class=\"icon\">&#10060;</div>\n      <h1>Login Failed</h1>\n      <p>${message}</p>\n      <a href=\"/\" class=\"btn\">Try Again</a>\n    `}\n  </div>\n</body>\n</html>`;\n}\n\nfunction getPopupPostMessagePage(token: string, user: any): string {\n  const userJson = JSON.stringify(user).replace(/</g, '\\\\u003c').replace(/>/g, '\\\\u003e');\n  return `<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>MedInvest - Login Successful</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #fff; display: flex; align-items: center; justify-content: center; min-height: 100vh; }\n    .container { text-align: center; padding: 40px; max-width: 400px; }\n    .spinner { border: 3px solid #333; border-top: 3px solid #0066CC; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-bottom: 16px; }\n    @keyframes spin { to { transform: rotate(360deg); } }\n    h1 { font-size: 24px; margin-bottom: 12px; }\n    p { color: #999; font-size: 16px; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"spinner\"></div>\n    <h1>Login Successful</h1>\n    <p id=\"status\">Completing sign-in...</p>\n  </div>\n  <script>\n    (function() {\n      var token = ${JSON.stringify(token)};\n      var user = ${userJson};\n      var sent = false;\n\n      try {\n        localStorage.setItem('medinvest_oauth_token', token);\n        localStorage.setItem('medinvest_oauth_user', JSON.stringify(user));\n      } catch(e) {}\n\n      try {\n        if (window.opener && !window.opener.closed) {\n          window.opener.postMessage({ type: 'medinvest-oauth-success', token: token, user: user }, '*');\n          sent = true;\n        }\n      } catch(e) {}\n\n      if (sent) {\n        document.getElementById('status').textContent = 'You can close this window.';\n        setTimeout(function() { try { window.close(); } catch(e) {} }, 1500);\n      } else {\n        document.getElementById('status').textContent = 'Completing sign-in...';\n        setTimeout(function() {\n          document.getElementById('status').textContent = 'You can close this window and return to the app.';\n        }, 2000);\n      }\n    })();\n  </script>\n</body>\n</html>`;\n}\n\nfunction getPopupErrorPage(message: string): string {\n  return `<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>MedInvest - Login Failed</title>\n  <style>\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a0a; color: #fff; display: flex; align-items: center; justify-content: center; min-height: 100vh; }\n    .container { text-align: center; padding: 40px; max-width: 400px; }\n    h1 { font-size: 24px; margin-bottom: 12px; }\n    p { color: #999; font-size: 16px; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h1>Login Failed</h1>\n    <p>${message}</p>\n  </div>\n  <script>\n    (function() {\n      try {\n        if (window.opener) {\n          window.opener.postMessage({ type: 'medinvest-oauth-error', error: ${JSON.stringify(message)} }, '*');\n          setTimeout(function() { window.close(); }, 3000);\n        }\n      } catch(e) {}\n    })();\n  </script>\n</body>\n</html>`;\n}\n\n/**\n * POST /api/auth/social\n * Social sign in (Apple/Google/GitHub/Facebook)\n */\nrouter.post('/social', async (req: Request, res: Response) => {\n  try {\n    const { provider, token, email, firstName, lastName, avatarUrl, identityToken } = req.body;\n\n    if (!provider || !token) {\n      res.status(400).json({ message: 'Provider and token are required' });\n      return;\n    }\n\n    let verifiedEmail: string | undefined;\n    let providerUserId: string | undefined;\n    let verifiedFirstName: string | undefined;\n    let verifiedLastName: string | undefined;\n    let verifiedAvatarUrl: string | undefined;\n\n    // Verify token based on provider\n    if (provider === 'apple') {\n      const appleData = await verifyAppleToken(identityToken || token);\n      if (!appleData) {\n        res.status(401).json({ message: 'Invalid Apple token' });\n        return;\n      }\n      verifiedEmail = appleData.email || email;\n      providerUserId = appleData.sub;\n      // Apple doesn't provide avatar, use client-provided values\n      verifiedFirstName = firstName;\n      verifiedLastName = lastName;\n      verifiedAvatarUrl = avatarUrl;\n    } else if (provider === 'google') {\n      const googleData = await verifyGoogleToken(token);\n      if (!googleData) {\n        res.status(401).json({ message: 'Invalid Google token' });\n        return;\n      }\n      verifiedEmail = googleData.email || email;\n      providerUserId = googleData.sub;\n      verifiedFirstName = googleData.given_name || firstName;\n      verifiedLastName = googleData.family_name || lastName;\n      verifiedAvatarUrl = googleData.picture || avatarUrl;\n    } else if (provider === 'github') {\n      const githubData = await verifyGithubToken(token);\n      if (!githubData) {\n        res.status(401).json({ message: 'Invalid GitHub token' });\n        return;\n      }\n      verifiedEmail = githubData.email || email;\n      providerUserId = githubData.sub;\n      // GitHub provides full name, try to split it\n      if (githubData.name) {\n        const nameParts = githubData.name.split(' ');\n        verifiedFirstName = nameParts[0] || firstName;\n        verifiedLastName = nameParts.slice(1).join(' ') || lastName;\n      } else {\n        verifiedFirstName = firstName;\n        verifiedLastName = lastName;\n      }\n      verifiedAvatarUrl = githubData.picture || avatarUrl;\n    } else if (provider === 'facebook') {\n      const facebookData = await verifyFacebookToken(token);\n      if (!facebookData) {\n        res.status(401).json({ message: 'Invalid Facebook token' });\n        return;\n      }\n      verifiedEmail = facebookData.email || email;\n      providerUserId = facebookData.sub;\n      verifiedFirstName = facebookData.first_name || firstName;\n      verifiedLastName = facebookData.last_name || lastName;\n      verifiedAvatarUrl = facebookData.picture || avatarUrl;\n    } else {\n      res.status(400).json({ message: 'Invalid provider' });\n      return;\n    }\n\n    if (!verifiedEmail) {\n      res.status(400).json({ message: 'Email is required' });\n      return;\n    }\n\n    // Check if user exists\n    let [existingUser] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, verifiedEmail))\n      .limit(1);\n\n    let userId: string;\n\n    if (existingUser) {\n      // Update existing user\n      userId = existingUser.id;\n      \n      await db\n        .update(users)\n        .set({\n          provider,\n          providerUserId,\n          lastLoginAt: new Date(),\n          updatedAt: new Date(),\n          // Always update profile data from social provider if available\n          ...(verifiedFirstName ? { firstName: verifiedFirstName } : {}),\n          ...(verifiedLastName ? { lastName: verifiedLastName } : {}),\n          ...(verifiedAvatarUrl ? { avatarUrl: verifiedAvatarUrl } : {}),\n        })\n        .where(eq(users.id, userId));\n    } else {\n      // Create new user\n      const [newUser] = await db\n        .insert(users)\n        .values({\n          email: verifiedEmail,\n          firstName: verifiedFirstName,\n          lastName: verifiedLastName,\n          avatarUrl: verifiedAvatarUrl,\n          provider,\n          providerUserId,\n          isVerified: true, // Social auth users are auto-verified\n          lastLoginAt: new Date(),\n        })\n        .returning();\n\n      userId = newUser.id;\n\n      // Create default notification preferences\n      await db.insert(notificationPreferences).values({\n        userId,\n      });\n    }\n\n    // Create session\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30); // 30 days\n\n    const [session] = await db\n      .insert(userSessions)\n      .values({\n        userId,\n        token: crypto.randomUUID(),\n        expiresAt,\n      })\n      .returning();\n\n    // Generate JWT\n    const jwtToken = generateToken(userId, session.id);\n\n    // Fetch user data\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n      })\n      .from(users)\n      .where(eq(users.id, userId))\n      .limit(1);\n\n    res.json({\n      token: jwtToken,\n      user: {\n        ...user,\n        fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || undefined,\n      },\n    });\n  } catch (error) {\n    console.error('Social auth error:', error);\n    res.status(500).json({ message: 'Authentication failed' });\n  }\n});\n\n/**\n * GET /api/auth/me\n * Get current user profile\n */\nrouter.get('/me', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        phone: users.phone,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n        updatedAt: users.updatedAt,\n      })\n      .from(users)\n      .where(eq(users.id, req.user!.id))\n      .limit(1);\n\n    if (!user) {\n      res.status(404).json({ message: 'User not found' });\n      return;\n    }\n\n    res.json({\n      ...user,\n      fullName: [user.firstName, user.lastName].filter(Boolean).join(' ') || undefined,\n    });\n  } catch (error) {\n    console.error('Get profile error:', error);\n    res.status(500).json({ message: 'Failed to get profile' });\n  }\n});\n\n/**\n * PATCH /api/auth/me\n * Update current user profile\n */\nrouter.patch('/me', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { firstName, lastName, phone } = req.body;\n\n    const [updatedUser] = await db\n      .update(users)\n      .set({\n        firstName,\n        lastName,\n        phone,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, req.user!.id))\n      .returning({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        phone: users.phone,\n        avatarUrl: users.avatarUrl,\n        provider: users.provider,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n        createdAt: users.createdAt,\n        updatedAt: users.updatedAt,\n      });\n\n    res.json({\n      ...updatedUser,\n      fullName: [updatedUser.firstName, updatedUser.lastName]\n        .filter(Boolean)\n        .join(' ') || undefined,\n    });\n  } catch (error) {\n    console.error('Update profile error:', error);\n    res.status(500).json({ message: 'Failed to update profile' });\n  }\n});\n\n/**\n * POST /api/auth/logout\n * Logout current session\n */\nrouter.post('/logout', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    // Delete current session\n    await db\n      .delete(userSessions)\n      .where(eq(userSessions.token, req.token!));\n\n    res.json({ message: 'Logged out successfully' });\n  } catch (error) {\n    console.error('Logout error:', error);\n    res.status(500).json({ message: 'Logout failed' });\n  }\n});\n\n/**\n * POST /api/auth/logout-all\n * Logout all sessions\n */\nrouter.post('/logout-all', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    await db\n      .delete(userSessions)\n      .where(eq(userSessions.userId, req.user!.id));\n\n    res.json({ message: 'Logged out from all devices' });\n  } catch (error) {\n    console.error('Logout all error:', error);\n    res.status(500).json({ message: 'Logout failed' });\n  }\n});\n\n/**\n * POST /api/auth/demo\n * Demo/guest login - creates or finds a demo user with a real JWT\n */\nrouter.post('/demo', async (req: Request, res: Response) => {\n  try {\n    const demoEmail = 'demo@medinvest.com';\n\n    let [demoUser] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, demoEmail))\n      .limit(1);\n\n    const demoPassword = 'Demo1234';\n    const demoPasswordHash = await bcrypt.hash(demoPassword, 10);\n\n    if (!demoUser) {\n      [demoUser] = await db\n        .insert(users)\n        .values({\n          email: demoEmail,\n          firstName: 'Demo',\n          lastName: 'User',\n          provider: 'demo',\n          passwordHash: demoPasswordHash,\n          isVerified: true,\n          lastLoginAt: new Date(),\n        })\n        .returning();\n\n      await db.insert(notificationPreferences).values({\n        userId: demoUser.id,\n      });\n    } else {\n      const updates: Record<string, any> = { lastLoginAt: new Date() };\n      if (!demoUser.passwordHash) {\n        updates.passwordHash = demoPasswordHash;\n      }\n      await db\n        .update(users)\n        .set(updates)\n        .where(eq(users.id, demoUser.id));\n    }\n\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30);\n\n    const [session] = await db\n      .insert(userSessions)\n      .values({\n        userId: demoUser.id,\n        token: crypto.randomUUID(),\n        expiresAt,\n      })\n      .returning();\n\n    const jwtToken = generateToken(demoUser.id, session.id);\n\n    res.json({\n      token: jwtToken,\n      user: {\n        id: demoUser.id,\n        email: demoUser.email,\n        firstName: demoUser.firstName,\n        lastName: demoUser.lastName,\n        isVerified: demoUser.isVerified,\n        fullName: [demoUser.firstName, demoUser.lastName].filter(Boolean).join(' '),\n        provider: 'demo',\n      },\n    });\n  } catch (error) {\n    console.error('Demo login error:', error);\n    res.status(500).json({ message: 'Demo login failed' });\n  }\n});\n\n/**\n * GET /api/auth/fb-delete\n * Facebook Data Deletion Instructions Page (short URL for Facebook console)\n */\nrouter.get('/fb-delete', (_req: Request, res: Response) => {\n  res.redirect('/api/auth/facebook/data-deletion');\n});\n\n/**\n * POST /api/auth/facebook/setup-deletion-url\n * One-time admin endpoint to set the Facebook data deletion URL via Graph API\n * Bypasses the Facebook developer console UI validation bug\n */\nrouter.post('/facebook/setup-deletion-url', async (req: Request, res: Response) => {\n  try {\n    const appId = getFacebookAppId();\n    const appSecret = getFacebookAppSecret();\n    if (!appId || !appSecret) {\n      res.status(500).json({ message: 'Facebook credentials not configured' });\n      return;\n    }\n\n    const callbackDomain = process.env.FACEBOOK_CALLBACK_DOMAIN || req.get('host');\n    const protocol = req.get('x-forwarded-proto') || req.protocol;\n    const deletionUrl = `${protocol}://${callbackDomain}/api/auth/facebook/data-deletion`;\n\n    const appAccessToken = `${appId}|${appSecret}`;\n    const graphUrl = new URL(`https://graph.facebook.com/v18.0/${appId}`);\n\n    const updateResponse = await fetch(graphUrl.toString(), {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n      body: new URLSearchParams({\n        access_token: appAccessToken,\n        user_data_deletion_callback_url: deletionUrl,\n      }).toString(),\n    });\n\n    const result = await updateResponse.json();\n    if (result.error) {\n      console.error('[Facebook Setup] Error setting deletion URL:', result.error);\n      res.status(400).json({ message: result.error.message, deletionUrl });\n      return;\n    }\n\n    console.log('[Facebook Setup] Successfully set data deletion URL:', deletionUrl);\n    res.json({ success: true, deletionUrl, result });\n  } catch (error) {\n    console.error('[Facebook Setup] Error:', error);\n    res.status(500).json({ message: 'Failed to set deletion URL' });\n  }\n});\n\n/**\n * GET /api/auth/facebook/data-deletion\n * Facebook Data Deletion Instructions Page\n * Can be used as \"Data Deletion Instructions URL\" in Facebook developer console\n */\nrouter.get('/facebook/data-deletion', (_req: Request, res: Response) => {\n  res.send(`<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <title>Data Deletion - MedInvest</title>\n  <style>\n    body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; color: #333; }\n    h1 { color: #1a73e8; }\n    ol { line-height: 1.8; }\n    .contact { background: #f5f5f5; padding: 16px; border-radius: 8px; margin-top: 20px; }\n  </style>\n</head>\n<body>\n  <h1>Data Deletion Request</h1>\n  <p>If you signed in to MedInvest using Facebook, you can request deletion of your data by following these steps:</p>\n  <ol>\n    <li>Open the MedInvest app</li>\n    <li>Go to your Profile</li>\n    <li>Tap \"Delete Account\"</li>\n    <li>Confirm the deletion</li>\n  </ol>\n  <p>Your data will be permanently deleted within 30 days of your request.</p>\n  <p>You can also remove MedInvest from your Facebook settings:</p>\n  <ol>\n    <li>Go to your <a href=\"https://www.facebook.com/settings?tab=applications\">Facebook App Settings</a></li>\n    <li>Find MedInvest and click \"Remove\"</li>\n  </ol>\n  <div class=\"contact\">\n    <strong>Need help?</strong>\n    <p>Contact us at support@medinvest.app to request data deletion.</p>\n  </div>\n</body>\n</html>`);\n});\n\n/**\n * POST /api/auth/facebook/data-deletion\n * Facebook Data Deletion Callback (POST version)\n * Required by Facebook for apps using Facebook Login\n */\nrouter.post('/facebook/data-deletion', async (req: Request, res: Response) => {\n  try {\n    const { signed_request } = req.body;\n\n    if (!signed_request) {\n      res.status(400).json({ message: 'Missing signed_request parameter' });\n      return;\n    }\n\n    const confirmationCode = `del_${Date.now()}_${Math.random().toString(36).substring(2, 10)}`;\n\n    const protocol = req.get('x-forwarded-proto') || req.protocol;\n    const statusUrl = `${protocol}://${req.get('host')}/api/auth/facebook/deletion-status?code=${confirmationCode}`;\n\n    console.log(`Facebook data deletion request received. Confirmation: ${confirmationCode}`);\n\n    res.json({\n      url: statusUrl,\n      confirmation_code: confirmationCode,\n    });\n  } catch (error) {\n    console.error('Facebook data deletion error:', error);\n    res.status(500).json({ message: 'Data deletion request failed' });\n  }\n});\n\nrouter.post('/facebook/data-deletion/callback', async (req: Request, res: Response) => {\n  try {\n    const { signed_request } = req.body;\n\n    if (!signed_request) {\n      res.status(400).json({ message: 'Missing signed_request parameter' });\n      return;\n    }\n\n    const confirmationCode = `del_${Date.now()}_${Math.random().toString(36).substring(2, 10)}`;\n    const protocol = req.get('x-forwarded-proto') || req.protocol;\n    const statusUrl = `${protocol}://${req.get('host')}/api/auth/facebook/deletion-status?code=${confirmationCode}`;\n\n    console.log(`Facebook data deletion request received. Confirmation: ${confirmationCode}`);\n\n    res.json({\n      url: statusUrl,\n      confirmation_code: confirmationCode,\n    });\n  } catch (error) {\n    console.error('Facebook data deletion error:', error);\n    res.status(500).json({ message: 'Data deletion request failed' });\n  }\n});\n\n/**\n * GET /api/auth/facebook/deletion-status\n * Check status of a Facebook data deletion request\n */\nrouter.get('/facebook/deletion-status', (req: Request, res: Response) => {\n  const { code } = req.query;\n\n  if (!code) {\n    res.status(400).json({ message: 'Missing confirmation code' });\n    return;\n  }\n\n  res.json({\n    confirmation_code: code,\n    status: 'completed',\n    message: 'Your data has been deleted from MedInvest.',\n  });\n});\n\n/**\n * POST /api/auth/forgot-password\n * Request a password reset link\n */\nrouter.post('/forgot-password', async (req: Request, res: Response) => {\n  try {\n    const { email } = req.body;\n\n    if (!email) {\n      res.status(400).json({ message: 'Email is required' });\n      return;\n    }\n\n    const [user] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, email.toLowerCase()))\n      .limit(1);\n\n    if (!user) {\n      res.json({ success: true, message: 'If an account with that email exists, we have sent password reset instructions.' });\n      return;\n    }\n\n    const resetToken = crypto.randomBytes(32).toString('hex');\n    const expiresAt = new Date();\n    expiresAt.setHours(expiresAt.getHours() + 1);\n\n    await db.insert(passwordResetTokens).values({\n      userId: user.id,\n      token: resetToken,\n      expiresAt,\n    });\n\n    console.log(`[Auth] Password reset requested for ${email}. Token: ${resetToken}`);\n\n    res.json({\n      success: true,\n      message: 'If an account with that email exists, we have sent password reset instructions.',\n    });\n  } catch (error) {\n    console.error('[Auth] Forgot password error:', error);\n    res.status(500).json({ message: 'Something went wrong. Please try again.' });\n  }\n});\n\n/**\n * POST /api/auth/reset-password\n * Reset password using a token\n */\nrouter.post('/reset-password', async (req: Request, res: Response) => {\n  try {\n    const { token, newPassword } = req.body;\n\n    if (!token || !newPassword) {\n      res.status(400).json({ message: 'Token and new password are required' });\n      return;\n    }\n\n    if (newPassword.length < 8) {\n      res.status(400).json({ message: 'Password must be at least 8 characters' });\n      return;\n    }\n\n    const hasUppercase = /[A-Z]/.test(newPassword);\n    const hasLowercase = /[a-z]/.test(newPassword);\n    const hasNumber = /[0-9]/.test(newPassword);\n\n    if (!hasUppercase || !hasLowercase || !hasNumber) {\n      res.status(400).json({\n        message: 'Password must contain uppercase, lowercase, and number',\n      });\n      return;\n    }\n\n    const [resetRecord] = await db\n      .select()\n      .from(passwordResetTokens)\n      .where(\n        and(\n          eq(passwordResetTokens.token, token),\n          gt(passwordResetTokens.expiresAt, new Date()),\n          isNull(passwordResetTokens.usedAt)\n        )\n      )\n      .limit(1);\n\n    if (!resetRecord) {\n      res.status(400).json({ message: 'Invalid or expired reset link. Please request a new one.' });\n      return;\n    }\n\n    const passwordHash = await bcrypt.hash(newPassword, 12);\n\n    await db\n      .update(users)\n      .set({ passwordHash, updatedAt: new Date() })\n      .where(eq(users.id, resetRecord.userId));\n\n    await db\n      .update(passwordResetTokens)\n      .set({ usedAt: new Date() })\n      .where(eq(passwordResetTokens.id, resetRecord.id));\n\n    console.log(`[Auth] Password reset completed for user ${resetRecord.userId}`);\n\n    res.json({ success: true, message: 'Password has been reset successfully. You can now sign in with your new password.' });\n  } catch (error) {\n    console.error('[Auth] Reset password error:', error);\n    res.status(500).json({ message: 'Something went wrong. Please try again.' });\n  }\n});\n\n/**\n * GET /api/auth/oauth-debug\n * Shows exact redirect URIs that need to be registered with OAuth providers\n */\nrouter.get('/oauth-debug', (req: Request, res: Response) => {\n  const forwardedProto = req.header('x-forwarded-proto') || req.protocol || 'https';\n  const forwardedHost = req.header('x-forwarded-host') || req.get('host');\n  const currentOrigin = `${forwardedProto}://${forwardedHost}`;\n  const callbackUri = `${currentOrigin}/api/auth/callback`;\n\n  const devDomain = process.env.REPLIT_DEV_DOMAIN;\n  const pubDomains = process.env.REPLIT_DOMAINS;\n\n  const allCallbackUris: string[] = [callbackUri];\n  if (devDomain) {\n    allCallbackUris.push(`https://${devDomain}/api/auth/callback`);\n  }\n  if (pubDomains) {\n    const domainList = pubDomains.split(',');\n    for (const d of domainList) {\n      const uri = `https://${d.trim()}/api/auth/callback`;\n      if (!allCallbackUris.includes(uri)) allCallbackUris.push(uri);\n    }\n  }\n  const knownDomains = ['themedicineandmoneyshow.com', 'medinvest-mobile--rsmolarz.replit.app'];\n  for (const d of knownDomains) {\n    const uri = `https://${d}/api/auth/callback`;\n    if (!allCallbackUris.includes(uri)) allCallbackUris.push(uri);\n  }\n\n  const hasGoogle = !!getGoogleClientId();\n  const hasGithub = !!getGithubClientId();\n  const hasFacebook = !!getFacebookAppId();\n\n  const html = `<!DOCTYPE html><html><head><title>OAuth Debug</title>\n  <style>body{font-family:system-ui;max-width:800px;margin:40px auto;padding:20px;background:#1a1a2e;color:#e0e0e0}\n  h1{color:#00a86b}h2{color:#0066cc;margin-top:30px}code{background:#2d2d44;padding:4px 8px;border-radius:4px;display:block;margin:5px 0;word-break:break-all;font-size:14px}\n  .status{padding:4px 8px;border-radius:4px;font-weight:bold}.ok{background:#00a86b33;color:#00a86b}.missing{background:#cc000033;color:#cc4444}\n  .section{background:#2d2d44;padding:15px;border-radius:8px;margin:10px 0}</style></head>\n  <body><h1>OAuth Redirect URI Debug</h1>\n  <div class=\"section\"><h2>Current Request Origin</h2><code>${currentOrigin}</code></div>\n  <div class=\"section\"><h2>Callback URIs (used by OAuth start endpoints)</h2>\n  <p>Google: <code>${getCallbackUri('google')}</code></p>\n  <p>GitHub: <code>${getCallbackUri('github')}</code></p>\n  <p>Facebook: <code>${getCallbackUri('facebook')}</code></p></div>\n  <div class=\"section\"><h2>All Redirect URIs to Register</h2>\n  <p>Copy-paste ALL of these into each OAuth provider's console:</p>\n  ${allCallbackUris.map(u => `<code>${u}</code>`).join('')}</div>\n  <div class=\"section\"><h2>Provider Status</h2>\n  <p>Google: <span class=\"status ${hasGoogle ? 'ok' : 'missing'}\">${hasGoogle ? 'Configured' : 'Missing credentials'}</span></p>\n  <p>GitHub: <span class=\"status ${hasGithub ? 'ok' : 'missing'}\">${hasGithub ? 'Configured' : 'Missing credentials'}</span></p>\n  <p>Facebook: <span class=\"status ${hasFacebook ? 'ok' : 'missing'}\">${hasFacebook ? 'Configured' : 'Missing credentials'}</span></p></div>\n  <div class=\"section\"><h2>Google Console Setup</h2>\n  <p>In <a href=\"https://console.cloud.google.com/apis/credentials\" style=\"color:#00a86b\">Google Cloud Console</a>:</p>\n  <p><b>Authorized JavaScript Origins:</b></p>\n  ${[...new Set(allCallbackUris.map(u => u.replace(/\\/api\\/auth\\/callback$/, '')))].map(u => `<code>${u}</code>`).join('')}\n  <p><b>Authorized Redirect URIs:</b></p>\n  ${allCallbackUris.map(u => `<code>${u}</code>`).join('')}\n  <p><b>OAuth Consent Screen:</b> Must be \"External\" user type and \"In production\" (or add test users)</p></div>\n  <div class=\"section\"><h2>GitHub Console Setup</h2>\n  <p>In <a href=\"https://github.com/settings/developers\" style=\"color:#00a86b\">GitHub Developer Settings</a>:</p>\n  <p><b>Authorization callback URL:</b> (can only have ONE per app)</p>\n  <code>${callbackUri}</code>\n  <p>Note: If testing from multiple domains, you may need separate GitHub OAuth apps.</p></div>\n  <div class=\"section\"><h2>Facebook Console Setup</h2>\n  <p>In <a href=\"https://developers.facebook.com\" style=\"color:#00a86b\">Facebook Developers</a> &gt; App Settings &gt; Facebook Login &gt; Settings:</p>\n  <p><b>Valid OAuth Redirect URIs:</b></p>\n  ${allCallbackUris.map(u => `<code>${u}</code>`).join('')}</div>\n  </body></html>`;\n\n  res.send(html);\n});\n\n// Temporary credential diagnostic endpoint\nrouter.get('/cred-check', (req: Request, res: Response) => {\n  const mask = (s: string | undefined) => s ? `${s.substring(0, 12)}...${s.slice(-4)} (len=${s.length})` : 'UNDEFINED';\n  const raw = (key: string) => {\n    const v = process.env[key];\n    return v ? `raw_len=${v.length}, cleaned_len=${cleanEnv(key)?.length || 0}` : 'NOT SET';\n  };\n  \n  const googleId = getGoogleClientId();\n  const googleSecret = getGoogleClientSecret();\n  \n  res.json({\n    google_client_id: mask(googleId),\n    google_client_secret: mask(googleSecret),\n    env_detail: {\n      EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID: raw('EXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID'),\n      GOOGLE_WEB_CLIENT_ID: raw('GOOGLE_WEB_CLIENT_ID'),\n      GOOGLE_WEB_CLIENT_SECRET: raw('GOOGLE_WEB_CLIENT_SECRET'),\n    },\n    github_client_id: mask(getGithubClientId()),\n    facebook_app_id: mask(getFacebookAppId()),\n  });\n});\n\nexport default router;\n","path":null,"size_bytes":60454,"size_tokens":null},"client/screens/TermsOfServiceScreen.tsx":{"content":"/**\n * Terms of Service Screen\n * Display app terms of service\n */\n\nimport React from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Linking,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\n\nconst TERMS_URL = 'https://medinvest.com/terms';\nconst SUPPORT_EMAIL = 'legal@medinvest.com';\n\nexport default function TermsOfServiceScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n\n  const handleOpenWebsite = () => {\n    Linking.openURL(TERMS_URL);\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Terms of Service</ThemedText>\n        <TouchableOpacity style={styles.webButton} onPress={handleOpenWebsite}>\n          <Ionicons name=\"open-outline\" size={20} color={Colors.primary} />\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        <ThemedText style={[styles.lastUpdated, { color: appColors.textSecondary }]}>Last updated: January 2026</ThemedText>\n\n        <Section title=\"1. Agreement to Terms\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            By accessing or using MedInvest, you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use our services.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"2. Eligibility\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            You must be at least 18 years old to use MedInvest. By using our services, you represent that you meet this requirement and have the legal capacity to enter into this agreement.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"3. Your Account\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            You are responsible for maintaining the confidentiality of your account credentials and for all activities under your account. You agree to:\n          </ThemedText>\n          <BulletList items={[\n            'Provide accurate and complete information',\n            'Keep your password secure and confidential',\n            'Notify us immediately of any unauthorized access',\n            'Not share your account with others',\n          ]} />\n        </Section>\n\n        <Section title=\"4. Acceptable Use\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            You agree not to:\n          </ThemedText>\n          <BulletList items={[\n            'Post false, misleading, or fraudulent content',\n            'Harass, threaten, or intimidate other users',\n            'Share confidential investment information unlawfully',\n            'Manipulate or attempt to manipulate markets',\n            'Violate any applicable laws or regulations',\n            'Impersonate others or misrepresent your credentials',\n            'Use automated systems to access the service',\n            'Attempt to circumvent security measures',\n          ]} />\n        </Section>\n\n        <Section title=\"5. User Content\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            You retain ownership of content you post but grant us a license to use, display, and distribute it on our platform. You are solely responsible for your content and must ensure it does not infringe on others' rights.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"6. Investment Disclaimer\">\n          <View style={styles.warningBox}>\n            <Ionicons name=\"warning-outline\" size={24} color={appColors.warning} />\n            <ThemedText style={[styles.warningText, { color: appColors.textPrimary }]}>\n              MedInvest does not provide investment advice. All investment information is for educational purposes only. Always consult with qualified financial professionals before making investment decisions.\n            </ThemedText>\n          </View>\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We do not guarantee the accuracy of any investment-related content posted by users or third parties. Investment in healthcare ventures involves significant risk, including potential loss of capital.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"7. Premium Subscription\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            Premium subscriptions are billed according to the plan selected. Subscriptions auto-renew unless cancelled 24 hours before the renewal date. Refunds are subject to our refund policy and app store guidelines.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"8. Termination\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We may suspend or terminate your account for violations of these terms. You may delete your account at any time through the app settings.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"9. Limitation of Liability\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            To the maximum extent permitted by law, MedInvest shall not be liable for any indirect, incidental, special, consequential, or punitive damages arising from your use of our services.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"10. Changes to Terms\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            We reserve the right to modify these terms at any time. We will notify you of significant changes. Continued use of the service after changes constitutes acceptance of the new terms.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"11. Governing Law\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            These terms are governed by the laws of the State of Delaware, United States, without regard to conflict of law principles.\n          </ThemedText>\n        </Section>\n\n        <Section title=\"12. Contact\">\n          <ThemedText style={[styles.paragraph, { color: appColors.textSecondary }]}>\n            For questions about these terms, contact us at:\n          </ThemedText>\n          <TouchableOpacity \n            style={styles.contactButton} \n            onPress={() => Linking.openURL(`mailto:${SUPPORT_EMAIL}`)}\n          >\n            <Ionicons name=\"mail-outline\" size={20} color={Colors.primary} />\n            <ThemedText style={styles.contactText}>{SUPPORT_EMAIL}</ThemedText>\n          </TouchableOpacity>\n        </Section>\n\n        <View style={styles.bottomPadding} />\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nfunction Section({ title, children }: { title: string; children: React.ReactNode }) {\n  const appColors = useAppColors();\n  return (\n    <View style={styles.section}>\n      <ThemedText style={[styles.sectionTitle, { color: appColors.textPrimary }]}>{title}</ThemedText>\n      {children}\n    </View>\n  );\n}\n\nfunction BulletList({ items }: { items: string[] }) {\n  const appColors = useAppColors();\n  return (\n    <View style={styles.bulletList}>\n      {items.map((item, index) => (\n        <View key={index} style={styles.bulletItem}>\n          <View style={styles.bullet} />\n          <ThemedText style={[styles.bulletText, { color: appColors.textSecondary }]}>{item}</ThemedText>\n        </View>\n      ))}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  webButton: {\n    padding: Spacing.sm,\n  },\n  content: {\n    flex: 1,\n    paddingHorizontal: Spacing.lg,\n  },\n  lastUpdated: {\n    ...Typography.small,\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  section: {\n    marginBottom: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.heading,\n    marginBottom: Spacing.md,\n  },\n  paragraph: {\n    ...Typography.body,\n    lineHeight: 24,\n    marginBottom: Spacing.md,\n  },\n  bulletList: {\n    marginLeft: Spacing.sm,\n    marginBottom: Spacing.md,\n  },\n  bulletItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginBottom: Spacing.sm,\n  },\n  bullet: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n    backgroundColor: Colors.primary,\n    marginTop: 8,\n    marginRight: Spacing.md,\n  },\n  bulletText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  warningBox: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    backgroundColor: Colors.light.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.lg,\n    gap: Spacing.md,\n  },\n  warningText: {\n    ...Typography.body,\n    flex: 1,\n    lineHeight: 22,\n  },\n  contactButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.primary + '10',\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.md,\n  },\n  contactText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  bottomPadding: {\n    height: Spacing['3xl'],\n  },\n});\n","path":null,"size_bytes":10179,"size_tokens":null},"server/services/ai.ts":{"content":"/**\n * AI Features for MedInvest\n * - Content moderation\n * - Post summarization\n * - Deal analysis\n * - Smart search\n * - Personalized recommendations\n */\n\nimport OpenAI from 'openai';\n\nfunction getOpenAIClient(): OpenAI | null {\n  const apiKey = process.env.OPENAI_API_KEY;\n  if (!apiKey) {\n    console.warn('OpenAI API key not configured - AI features will be limited');\n    return null;\n  }\n  return new OpenAI({ apiKey });\n}\n\nexport interface ModerationResult {\n  flagged: boolean;\n  categories: {\n    harassment: boolean;\n    hate: boolean;\n    selfHarm: boolean;\n    sexual: boolean;\n    violence: boolean;\n    spam: boolean;\n    misinformation: boolean;\n  };\n  confidence: number;\n  action: 'allow' | 'flag' | 'block';\n  reason?: string;\n}\n\nexport async function moderateContent(content: string): Promise<ModerationResult> {\n  const openai = getOpenAIClient();\n  if (!openai) {\n    return {\n      flagged: false,\n      categories: {\n        harassment: false,\n        hate: false,\n        selfHarm: false,\n        sexual: false,\n        violence: false,\n        spam: false,\n        misinformation: false,\n      },\n      confidence: 0,\n      action: 'allow',\n    };\n  }\n  \n  try {\n    const moderation = await openai.moderations.create({\n      input: content,\n    });\n    \n    const result = moderation.results[0];\n    const healthcareCheck = await analyzeHealthcareContent(content);\n    \n    return {\n      flagged: result.flagged || healthcareCheck.flagged,\n      categories: {\n        harassment: result.categories.harassment,\n        hate: result.categories.hate,\n        selfHarm: result.categories['self-harm'],\n        sexual: result.categories.sexual,\n        violence: result.categories.violence,\n        spam: healthcareCheck.isSpam,\n        misinformation: healthcareCheck.isMisinformation,\n      },\n      confidence: Math.max(...Object.values(result.category_scores)),\n      action: determineAction(result, healthcareCheck),\n      reason: healthcareCheck.reason,\n    };\n  } catch (error) {\n    console.error('Moderation error:', error);\n    return {\n      flagged: false,\n      categories: {\n        harassment: false,\n        hate: false,\n        selfHarm: false,\n        sexual: false,\n        violence: false,\n        spam: false,\n        misinformation: false,\n      },\n      confidence: 0,\n      action: 'allow',\n    };\n  }\n}\n\nasync function analyzeHealthcareContent(content: string) {\n  const openai = getOpenAIClient();\n  if (!openai) return { flagged: false, isSpam: false, isMisinformation: false };\n  \n  try {\n    const response = await openai.chat.completions.create({\n      model: 'gpt-4-turbo-preview',\n      messages: [\n        {\n          role: 'system',\n          content: `You are a healthcare content moderator. Analyze the following content for:\n1. Medical misinformation (dangerous health claims, anti-vaccine content, etc.)\n2. Spam or promotional content\n3. Unverified medical advice that could be harmful\n\nRespond in JSON format:\n{\n  \"flagged\": boolean,\n  \"isSpam\": boolean,\n  \"isMisinformation\": boolean,\n  \"reason\": \"explanation if flagged\"\n}`\n        },\n        {\n          role: 'user',\n          content,\n        },\n      ],\n      response_format: { type: 'json_object' },\n      max_tokens: 200,\n    });\n    \n    return JSON.parse(response.choices[0].message.content || '{}');\n  } catch {\n    return { flagged: false, isSpam: false, isMisinformation: false };\n  }\n}\n\nfunction determineAction(modResult: any, healthcareCheck: any): 'allow' | 'flag' | 'block' {\n  if (modResult.categories.hate || modResult.categories['self-harm'] || healthcareCheck.isMisinformation) {\n    return 'block';\n  }\n  if (modResult.flagged || healthcareCheck.flagged) {\n    return 'flag';\n  }\n  return 'allow';\n}\n\nexport interface PostSummary {\n  summary: string;\n  keyPoints: string[];\n  sentiment: 'positive' | 'negative' | 'neutral';\n  topics: string[];\n}\n\nexport async function summarizePost(content: string): Promise<PostSummary> {\n  const openai = getOpenAIClient();\n  if (!openai) {\n    return { summary: '', keyPoints: [], sentiment: 'neutral', topics: [] };\n  }\n  \n  const response = await openai.chat.completions.create({\n    model: 'gpt-4-turbo-preview',\n    messages: [\n      {\n        role: 'system',\n        content: `Summarize healthcare investment content. Return JSON:\n{\n  \"summary\": \"2-3 sentence summary\",\n  \"keyPoints\": [\"key point 1\", \"key point 2\"],\n  \"sentiment\": \"positive\" | \"negative\" | \"neutral\",\n  \"topics\": [\"topic1\", \"topic2\"]\n}`\n      },\n      {\n        role: 'user',\n        content,\n      },\n    ],\n    response_format: { type: 'json_object' },\n    max_tokens: 300,\n  });\n  \n  return JSON.parse(response.choices[0].message.content || '{}');\n}\n\nexport interface DealAnalysis {\n  riskLevel: 'low' | 'medium' | 'high';\n  strengths: string[];\n  concerns: string[];\n  marketAnalysis: string;\n  recommendation: string;\n  keyMetrics: {\n    name: string;\n    value: string;\n    assessment: string;\n  }[];\n}\n\nexport async function analyzeDeal(dealInfo: {\n  title: string;\n  description: string;\n  stage: string;\n  targetRaise: number;\n  sector: string;\n}): Promise<DealAnalysis> {\n  const openai = getOpenAIClient();\n  if (!openai) {\n    return { riskLevel: 'medium', strengths: [], concerns: [], marketAnalysis: '', recommendation: '', keyMetrics: [] };\n  }\n  \n  const response = await openai.chat.completions.create({\n    model: 'gpt-4-turbo-preview',\n    messages: [\n      {\n        role: 'system',\n        content: `You are a healthcare investment analyst. Analyze the deal and provide structured analysis in JSON:\n{\n  \"riskLevel\": \"low\" | \"medium\" | \"high\",\n  \"strengths\": [\"strength1\", \"strength2\"],\n  \"concerns\": [\"concern1\", \"concern2\"],\n  \"marketAnalysis\": \"brief market context\",\n  \"recommendation\": \"investment recommendation\",\n  \"keyMetrics\": [{\"name\": \"metric\", \"value\": \"value\", \"assessment\": \"good/bad/neutral\"}]\n}`\n      },\n      {\n        role: 'user',\n        content: JSON.stringify(dealInfo),\n      },\n    ],\n    response_format: { type: 'json_object' },\n    max_tokens: 500,\n  });\n  \n  return JSON.parse(response.choices[0].message.content || '{}');\n}\n\nexport interface SearchEnhancement {\n  expandedQuery: string;\n  suggestedFilters: string[];\n  relatedTerms: string[];\n}\n\nexport async function enhanceSearch(query: string): Promise<SearchEnhancement> {\n  const openai = getOpenAIClient();\n  if (!openai) {\n    return { expandedQuery: query, suggestedFilters: [], relatedTerms: [] };\n  }\n  \n  const response = await openai.chat.completions.create({\n    model: 'gpt-4-turbo-preview',\n    messages: [\n      {\n        role: 'system',\n        content: `Enhance healthcare investment search queries. Return JSON:\n{\n  \"expandedQuery\": \"expanded search query with medical/investment synonyms\",\n  \"suggestedFilters\": [\"filter1\", \"filter2\"],\n  \"relatedTerms\": [\"term1\", \"term2\"]\n}`\n      },\n      {\n        role: 'user',\n        content: query,\n      },\n    ],\n    response_format: { type: 'json_object' },\n    max_tokens: 200,\n  });\n  \n  return JSON.parse(response.choices[0].message.content || '{}');\n}\n\nexport interface Recommendation {\n  id: string;\n  type: 'deal' | 'post' | 'user' | 'room';\n  score: number;\n  reason: string;\n}\n\nexport async function getRecommendations(userContext: {\n  interests: string[];\n  recentActivity: string[];\n  specialty?: string;\n}): Promise<Recommendation[]> {\n  const openai = getOpenAIClient();\n  if (!openai) return [];\n  \n  const response = await openai.chat.completions.create({\n    model: 'gpt-4-turbo-preview',\n    messages: [\n      {\n        role: 'system',\n        content: `Generate personalized healthcare investment recommendations. Return JSON array:\n[{\n  \"id\": \"item_id\",\n  \"type\": \"deal\" | \"post\" | \"user\" | \"room\",\n  \"score\": 0.0-1.0,\n  \"reason\": \"why recommended\"\n}]`\n      },\n      {\n        role: 'user',\n        content: JSON.stringify(userContext),\n      },\n    ],\n    response_format: { type: 'json_object' },\n    max_tokens: 400,\n  });\n  \n  const result = JSON.parse(response.choices[0].message.content || '{}');\n  return result.recommendations || [];\n}\n\ninterface ChatMessage {\n  role: 'user' | 'assistant';\n  content: string;\n}\n\nexport async function chatWithAssistant(\n  messages: ChatMessage[],\n  userContext?: { specialty?: string; investorType?: string }\n): Promise<string> {\n  const systemPrompt = `You are MedInvest AI, a helpful assistant for healthcare investing.\n${userContext?.specialty ? `User specialty: ${userContext.specialty}` : ''}\n${userContext?.investorType ? `Investor type: ${userContext.investorType}` : ''}\n\nHelp users with:\n- Understanding healthcare investment opportunities\n- Explaining medical/biotech concepts\n- Navigating the MedInvest platform\n- Investment analysis and due diligence\n\nBe professional, accurate, and helpful. If unsure about medical advice, recommend consulting professionals.`;\n\n  const openai = getOpenAIClient();\n  if (!openai) {\n    return 'AI assistant is not available. Please try again later.';\n  }\n\n  const response = await openai.chat.completions.create({\n    model: 'gpt-4-turbo-preview',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      ...messages.map(m => ({ role: m.role as 'user' | 'assistant', content: m.content })),\n    ],\n    max_tokens: 500,\n    temperature: 0.7,\n  });\n  \n  return response.choices[0].message.content || 'I apologize, I could not generate a response.';\n}\n\nexport async function generateEmbedding(text: string): Promise<number[]> {\n  const openai = getOpenAIClient();\n  if (!openai) return [];\n  \n  const response = await openai.embeddings.create({\n    model: 'text-embedding-3-small',\n    input: text,\n  });\n  \n  return response.data[0].embedding;\n}\n\nexport const AIService = {\n  moderateContent,\n  summarizePost,\n  analyzeDeal,\n  enhanceSearch,\n  getRecommendations,\n  chatWithAssistant,\n  generateEmbedding,\n};\n\nexport default AIService;\n","path":null,"size_bytes":9864,"size_tokens":null},"client/constants/theme.ts":{"content":"import { Platform } from \"react-native\";\n\nexport const Colors = {\n  primary: \"#0066CC\",\n  secondary: \"#00A86B\",\n  gradient: {\n    start: \"#0066CC\",\n    end: \"#00A86B\",\n  },\n  background: \"#F8F9FA\",\n  surface: \"#FFFFFF\",\n  textPrimary: \"#1A1A1A\",\n  textSecondary: \"#6B7280\",\n  error: \"#DC2626\",\n  warning: \"#F59E0B\",\n  border: \"#E5E7EB\",\n  light: {\n    text: \"#1A1A1A\",\n    textSecondary: \"#6B7280\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#6B7280\",\n    tabIconSelected: \"#0066CC\",\n    link: \"#0066CC\",\n    backgroundRoot: \"#F8F9FA\",\n    backgroundDefault: \"#FFFFFF\",\n    backgroundSecondary: \"#F2F2F2\",\n    backgroundTertiary: \"#E5E7EB\",\n  },\n  dark: {\n    text: \"#ECEDEE\",\n    textSecondary: \"#9BA1A6\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#9BA1A6\",\n    tabIconSelected: \"#0A84FF\",\n    link: \"#0A84FF\",\n    backgroundRoot: \"#1A1A1A\",\n    backgroundDefault: \"#2A2C2E\",\n    backgroundSecondary: \"#353739\",\n    backgroundTertiary: \"#404244\",\n  },\n};\n\nexport const Spacing = {\n  xs: 4,\n  sm: 8,\n  md: 12,\n  lg: 16,\n  xl: 20,\n  \"2xl\": 24,\n  \"3xl\": 32,\n  \"4xl\": 40,\n  \"5xl\": 48,\n  inputHeight: 48,\n  buttonHeight: 52,\n};\n\nexport const BorderRadius = {\n  xs: 8,\n  sm: 12,\n  md: 18,\n  lg: 24,\n  xl: 30,\n  \"2xl\": 40,\n  \"3xl\": 50,\n  full: 9999,\n};\n\nexport const Typography = {\n  hero: {\n    fontSize: 32,\n    fontWeight: \"700\" as const,\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: \"700\" as const,\n  },\n  heading: {\n    fontSize: 18,\n    fontWeight: \"600\" as const,\n  },\n  body: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n  caption: {\n    fontSize: 14,\n    fontWeight: \"400\" as const,\n  },\n  small: {\n    fontSize: 12,\n    fontWeight: \"400\" as const,\n  },\n  link: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n};\n\nexport const Shadows = {\n  card: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.08,\n    shadowRadius: 8,\n    elevation: 3,\n  },\n  fab: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 4,\n  },\n};\n\nexport const Fonts = Platform.select({\n  ios: {\n    sans: \"system-ui\",\n    serif: \"ui-serif\",\n    rounded: \"ui-rounded\",\n    mono: \"ui-monospace\",\n  },\n  default: {\n    sans: \"normal\",\n    serif: \"serif\",\n    rounded: \"normal\",\n    mono: \"monospace\",\n  },\n  web: {\n    sans: \"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n    serif: \"Georgia, 'Times New Roman', serif\",\n    rounded:\n      \"'SF Pro Rounded', 'Hiragino Maru Gothic ProN', Meiryo, 'MS PGothic', sans-serif\",\n    mono: \"SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\n  },\n});\n","path":null,"size_bytes":2705,"size_tokens":null},"client/theme/spacing.ts":{"content":"/**\n * MedInvest Spacing System\n * Consistent spacing throughout the app\n * Base unit: 4px\n */\n\n// Base spacing unit\nconst BASE_UNIT = 4;\n\n/**\n * Spacing scale using 4px base\n * - xs: 4px\n * - sm: 8px\n * - md: 12px\n * - lg: 16px\n * - xl: 24px\n * - 2xl: 32px\n * - 3xl: 48px\n * - 4xl: 64px\n */\nexport const spacing = {\n  /** 4px */\n  xs: BASE_UNIT,\n  /** 8px */\n  sm: BASE_UNIT * 2,\n  /** 12px */\n  md: BASE_UNIT * 3,\n  /** 16px */\n  lg: BASE_UNIT * 4,\n  /** 24px */\n  xl: BASE_UNIT * 6,\n  /** 32px */\n  '2xl': BASE_UNIT * 8,\n  /** 48px */\n  '3xl': BASE_UNIT * 12,\n  /** 64px */\n  '4xl': BASE_UNIT * 16,\n} as const;\n\n/**\n * Layout-specific spacing\n */\nexport const layout = {\n  // Screen padding\n  screenPaddingHorizontal: spacing.lg,\n  screenPaddingVertical: spacing.xl,\n\n  // Card padding\n  cardPadding: spacing.lg,\n  cardPaddingLarge: spacing.xl,\n\n  // Section spacing\n  sectionGap: spacing.xl,\n  itemGap: spacing.md,\n\n  // Header heights\n  headerHeight: 56,\n  tabBarHeight: 84, // Including bottom safe area typically\n\n  // FAB dimensions\n  fabSize: 56,\n  fabBottomOffset: 16,\n\n  // Input heights\n  inputHeight: 48,\n  inputHeightLarge: 56,\n\n  // Button heights\n  buttonHeightSmall: 36,\n  buttonHeightMedium: 44,\n  buttonHeightLarge: 52,\n\n  // Avatar sizes\n  avatarSmall: 32,\n  avatarMedium: 48,\n  avatarLarge: 80,\n  avatarXLarge: 120,\n\n  // Icon sizes\n  iconSmall: 16,\n  iconMedium: 20,\n  iconLarge: 24,\n  iconXLarge: 32,\n\n  // Progress bar\n  progressBarHeight: 8,\n\n  // Border radius\n  radiusSmall: 6,\n  radiusMedium: 8,\n  radiusLarge: 12,\n  radiusXLarge: 16,\n  radiusFull: 9999,\n} as const;\n\n/**\n * Border widths\n */\nexport const borders = {\n  thin: 1,\n  medium: 2,\n  thick: 3,\n} as const;\n\n/**\n * Shadow definitions\n */\nexport const shadows = {\n  // Subtle shadow for cards\n  card: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.05,\n    shadowRadius: 2,\n    elevation: 1,\n  },\n\n  // Medium shadow for elevated elements\n  elevated: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.08,\n    shadowRadius: 4,\n    elevation: 2,\n  },\n\n  // Strong shadow for modals/FAB\n  modal: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.15,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n\n  // FAB specific shadow (as per design guidelines)\n  fab: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 2,\n    elevation: 3,\n  },\n\n  // Bottom sheet shadow\n  bottomSheet: {\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: -4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 8,\n  },\n} as const;\n\n/**\n * Z-index levels\n */\nexport const zIndex = {\n  base: 0,\n  card: 1,\n  sticky: 10,\n  header: 100,\n  overlay: 200,\n  modal: 300,\n  toast: 400,\n  tooltip: 500,\n} as const;\n\nexport type Spacing = typeof spacing;\nexport type Layout = typeof layout;\nexport type Shadows = typeof shadows;\n","path":null,"size_bytes":2979,"size_tokens":null},"client/components/Avatar.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  Image,\n  StyleSheet,\n  Pressable,\n  type ImageSourcePropType,\n  type StyleProp,\n  type ViewStyle,\n} from 'react-native';\nimport { Feather } from '@expo/vector-icons';\n\nimport { colors, typography, spacing } from '@/theme';\n\nexport type AvatarSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl';\n\nexport interface AvatarProps {\n  /** Image source (URL or require) */\n  source?: ImageSourcePropType | string;\n  /** User's name for initials fallback */\n  name?: string;\n  /** Size preset */\n  size?: AvatarSize;\n  /** Make avatar pressable */\n  onPress?: () => void;\n  /** Show edit badge */\n  showEditBadge?: boolean;\n  /** Show online indicator */\n  showOnlineIndicator?: boolean;\n  /** Is user online */\n  isOnline?: boolean;\n  /** Custom background color */\n  backgroundColor?: string;\n  /** Custom text color */\n  textColor?: string;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nconst SIZE_CONFIG = {\n  xs: { size: 24, fontSize: 10, iconSize: 12, badgeSize: 12, borderWidth: 1 },\n  sm: { size: 32, fontSize: 12, iconSize: 14, badgeSize: 14, borderWidth: 2 },\n  md: { size: 40, fontSize: 14, iconSize: 16, badgeSize: 16, borderWidth: 2 },\n  lg: { size: 56, fontSize: 18, iconSize: 20, badgeSize: 20, borderWidth: 2 },\n  xl: { size: 72, fontSize: 24, iconSize: 28, badgeSize: 24, borderWidth: 3 },\n  '2xl': { size: 100, fontSize: 32, iconSize: 40, badgeSize: 28, borderWidth: 3 },\n};\n\n/**\n * Get initials from name\n */\nfunction getInitials(name?: string): string {\n  if (!name) return '';\n  \n  const parts = name.trim().split(/\\s+/);\n  if (parts.length >= 2) {\n    return `${parts[0][0]}${parts[parts.length - 1][0]}`.toUpperCase();\n  }\n  return name.substring(0, 2).toUpperCase();\n}\n\n/**\n * Generate consistent color from name\n */\nfunction getColorFromName(name?: string): string {\n  if (!name) return colors.primary.main;\n  \n  const colorOptions = [\n    colors.primary.main,\n    colors.secondary.main,\n    '#6366F1', // Indigo\n    '#8B5CF6', // Violet\n    '#EC4899', // Pink\n    '#F59E0B', // Amber\n    '#10B981', // Emerald\n    '#3B82F6', // Blue\n  ];\n  \n  let hash = 0;\n  for (let i = 0; i < name.length; i++) {\n    hash = name.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  \n  return colorOptions[Math.abs(hash) % colorOptions.length];\n}\n\nexport function Avatar({\n  source,\n  name,\n  size = 'md',\n  onPress,\n  showEditBadge = false,\n  showOnlineIndicator = false,\n  isOnline = false,\n  backgroundColor,\n  textColor,\n  style,\n}: AvatarProps) {\n  const [imageError, setImageError] = useState(false);\n  const config = SIZE_CONFIG[size];\n  const initials = getInitials(name);\n  const bgColor = backgroundColor || getColorFromName(name);\n  const txtColor = textColor || colors.text.inverse;\n\n  const hasValidSource = source && !imageError;\n  const imageSource = typeof source === 'string' ? { uri: source } : source;\n\n  const containerStyle = [\n    styles.container,\n    {\n      width: config.size,\n      height: config.size,\n      borderRadius: config.size / 2,\n      backgroundColor: hasValidSource ? colors.background.secondary : bgColor,\n    },\n    style,\n  ];\n\n  const content = hasValidSource ? (\n    <Image\n      source={imageSource as ImageSourcePropType}\n      style={[\n        styles.image,\n        {\n          width: config.size,\n          height: config.size,\n          borderRadius: config.size / 2,\n        },\n      ]}\n      onError={() => setImageError(true)}\n    />\n  ) : initials ? (\n    <Text\n      style={[\n        styles.initials,\n        { fontSize: config.fontSize, color: txtColor },\n      ]}\n    >\n      {initials}\n    </Text>\n  ) : (\n    <Feather name=\"user\" size={config.iconSize} color={txtColor} />\n  );\n\n  const avatar = (\n    <View style={containerStyle}>\n      {content}\n\n      {/* Edit Badge */}\n      {showEditBadge && (\n        <View\n          style={[\n            styles.editBadge,\n            {\n              width: config.badgeSize,\n              height: config.badgeSize,\n              borderRadius: config.badgeSize / 2,\n              borderWidth: config.borderWidth,\n            },\n          ]}\n        >\n          <Feather\n            name=\"camera\"\n            size={config.badgeSize * 0.5}\n            color={colors.text.inverse}\n          />\n        </View>\n      )}\n\n      {/* Online Indicator */}\n      {showOnlineIndicator && (\n        <View\n          style={[\n            styles.onlineIndicator,\n            {\n              width: config.badgeSize * 0.6,\n              height: config.badgeSize * 0.6,\n              borderRadius: config.badgeSize * 0.3,\n              borderWidth: config.borderWidth,\n              backgroundColor: isOnline\n                ? colors.semantic.success\n                : colors.text.tertiary,\n            },\n          ]}\n        />\n      )}\n    </View>\n  );\n\n  if (onPress) {\n    return (\n      <Pressable onPress={onPress} style={styles.pressable}>\n        {avatar}\n      </Pressable>\n    );\n  }\n\n  return avatar;\n}\n\n// Avatar Group component\nexport interface AvatarGroupProps {\n  /** Array of avatar data */\n  avatars: Array<{ source?: string; name?: string }>;\n  /** Maximum avatars to show */\n  max?: number;\n  /** Size of avatars */\n  size?: AvatarSize;\n  /** Custom container style */\n  style?: StyleProp<ViewStyle>;\n}\n\nexport function AvatarGroup({\n  avatars,\n  max = 4,\n  size = 'md',\n  style,\n}: AvatarGroupProps) {\n  const config = SIZE_CONFIG[size];\n  const visibleAvatars = avatars.slice(0, max);\n  const remaining = avatars.length - max;\n  const overlap = config.size * 0.3;\n\n  return (\n    <View style={[styles.groupContainer, style]}>\n      {visibleAvatars.map((avatar, index) => (\n        <View\n          key={index}\n          style={[\n            styles.groupAvatar,\n            { marginLeft: index === 0 ? 0 : -overlap, zIndex: visibleAvatars.length - index },\n          ]}\n        >\n          <Avatar\n            source={avatar.source}\n            name={avatar.name}\n            size={size}\n            style={styles.groupAvatarBorder}\n          />\n        </View>\n      ))}\n      \n      {remaining > 0 && (\n        <View\n          style={[\n            styles.remainingBadge,\n            {\n              width: config.size,\n              height: config.size,\n              borderRadius: config.size / 2,\n              marginLeft: -overlap,\n            },\n          ]}\n        >\n          <Text\n            style={[\n              styles.remainingText,\n              { fontSize: config.fontSize * 0.8 },\n            ]}\n          >\n            +{remaining}\n          </Text>\n        </View>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    overflow: 'hidden',\n  },\n  pressable: {\n    // Pressable wrapper\n  },\n  image: {\n    resizeMode: 'cover',\n  },\n  initials: {\n    fontWeight: '600',\n  },\n  editBadge: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    backgroundColor: colors.primary.main,\n    borderColor: colors.background.primary,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  onlineIndicator: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    borderColor: colors.background.primary,\n  },\n\n  // Avatar Group\n  groupContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  groupAvatar: {\n    // Overlapping avatar\n  },\n  groupAvatarBorder: {\n    borderWidth: 2,\n    borderColor: colors.background.primary,\n  },\n  remainingBadge: {\n    backgroundColor: colors.background.secondary,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderWidth: 2,\n    borderColor: colors.background.primary,\n  },\n  remainingText: {\n    ...typography.captionMedium,\n    color: colors.text.secondary,\n  },\n});\n\nexport default Avatar;\n","path":null,"size_bytes":7750,"size_tokens":null},"client/contexts/AuthContext.tsx":{"content":"import React, {\n  createContext,\n  useContext,\n  useState,\n  useEffect,\n  useCallback,\n  useMemo,\n  type ReactNode,\n} from 'react';\nimport * as AppleAuthentication from 'expo-apple-authentication';\nimport * as WebBrowser from 'expo-web-browser';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform, Linking } from 'react-native';\nimport { apiClient } from '@/api/client';\nimport { getApiUrl } from '@/lib/query-client';\nimport type { User } from '@/types';\nimport { AUTH_TOKEN_KEY, USER_DATA_KEY } from '@/constants/auth';\n\nWebBrowser.maybeCompleteAuthSession();\n\n\nexport interface AuthState {\n  user: User | null;\n  token: string | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  error: string | null;\n}\n\nexport interface RegisterData {\n  email: string;\n  password: string;\n  first_name: string;\n  last_name: string;\n  specialty?: string;\n  referral_code?: string;\n}\n\nexport interface LoginData {\n  email: string;\n  password: string;\n}\n\nexport interface AuthContextType extends AuthState {\n  signInWithApple: () => Promise<void>;\n  signInWithGoogle: () => Promise<void>;\n  signInWithGithub: () => Promise<void>;\n  signInWithFacebook: () => Promise<void>;\n  signOut: () => Promise<void>;\n  register: (data: RegisterData) => Promise<boolean>;\n  login: (data: LoginData) => Promise<boolean>;\n  setAuthSession: (token: string, user: User) => Promise<void>;\n  clearError: () => void;\n  refreshUser: () => Promise<void>;\n  updateUser: (userData: Partial<User>) => Promise<void>;\n  mockSignIn: () => Promise<void>;\n  forgotPassword: (email: string) => Promise<boolean>;\n  isAppleAuthAvailable: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<User | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isAppleAuthAvailable, setIsAppleAuthAvailable] = useState(false);\n\n  useEffect(() => {\n    const checkAppleAuth = async () => {\n      if (Platform.OS === 'ios') {\n        try {\n          const available = await AppleAuthentication.isAvailableAsync();\n          setIsAppleAuthAvailable(available);\n        } catch {\n          setIsAppleAuthAvailable(false);\n        }\n      }\n    };\n    checkAppleAuth();\n  }, []);\n\n  useEffect(() => {\n    const loadStoredAuth = async () => {\n      try {\n        const storedToken = await AsyncStorage.getItem(AUTH_TOKEN_KEY);\n\n        if (storedToken) {\n          setToken(storedToken);\n          \n          try {\n            const response = await apiClient.get('/users/me', {\n              headers: { Authorization: `Bearer ${storedToken}` },\n            });\n            const userData = response.data as User;\n            setUser(userData);\n            await AsyncStorage.setItem(USER_DATA_KEY, JSON.stringify(userData));\n          } catch (error: any) {\n            console.error('Failed to fetch user on startup:', error);\n            if (error?.status === 401 || error?.response?.status === 401) {\n              await AsyncStorage.removeItem(AUTH_TOKEN_KEY);\n              await AsyncStorage.removeItem(USER_DATA_KEY);\n              setToken(null);\n              setUser(null);\n            } else {\n              const storedUser = await AsyncStorage.getItem(USER_DATA_KEY);\n              if (storedUser) {\n                setUser(JSON.parse(storedUser));\n              }\n            }\n          }\n        }\n      } catch (err) {\n        console.error('Failed to load stored auth:', err);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadStoredAuth();\n  }, []);\n\n  useEffect(() => {\n    if (Platform.OS !== 'web') return;\n    if (typeof window === 'undefined') return;\n    \n    const handleLandingPageAuth = async () => {\n      try {\n        const params = new URLSearchParams(window.location.search);\n        const authToken = params.get('auth_token');\n        const authUserRaw = params.get('auth_user');\n\n        if (!authToken) return;\n\n        console.log('[OAuth] Found auth token from landing page redirect');\n        window.history.replaceState({}, '', window.location.pathname);\n\n        let userData: User | null = null;\n        if (authUserRaw) { try { userData = JSON.parse(decodeURIComponent(authUserRaw)); } catch {} }\n        if (userData) {\n          await saveAuthData(authToken, userData);\n        } else {\n          try {\n            const response = await apiClient.get('/users/me', { headers: { Authorization: `Bearer ${authToken}` } });\n            await saveAuthData(authToken, response.data as User);\n          } catch (err) { console.error('[OAuth] Failed to verify token:', err); }\n        }\n      } catch (err) {\n        console.error('[OAuth] Landing page auth error:', err);\n      }\n    };\n\n    handleLandingPageAuth();\n  }, []);\n\n  useEffect(() => {\n    if (Platform.OS === 'web') return;\n\n    const handleOAuthDeepLink = async (url: string) => {\n      try {\n        const parsed = new URL(url.replace('medinvest://', 'https://medinvest.app/'));\n        const authToken = parsed.searchParams.get('token');\n        const error = parsed.searchParams.get('error');\n\n        if (error) {\n          console.error('[OAuth] Deep link error:', error);\n          setError(decodeURIComponent(error));\n          return;\n        }\n\n        if (authToken && parsed.pathname === '/auth') {\n          console.log('[OAuth] Received token via deep link');\n          setIsLoading(true);\n          try {\n            const response = await apiClient.get('/users/me', {\n              headers: { Authorization: `Bearer ${authToken}` },\n            });\n            await saveAuthData(authToken, response.data as User);\n            console.log('[OAuth] Logged in via deep link callback');\n          } catch (err) {\n            console.error('[OAuth] Failed to verify deep link token:', err);\n            setError('Failed to complete sign-in. Please try again.');\n          } finally {\n            setIsLoading(false);\n          }\n        }\n      } catch (err) {\n        console.error('[OAuth] Deep link parse error:', err);\n      }\n    };\n\n    const handleUrl = ({ url }: { url: string }) => {\n      if (url.includes('auth') && (url.includes('token=') || url.includes('error='))) {\n        handleOAuthDeepLink(url);\n      }\n    };\n\n    Linking.getInitialURL().then((url) => {\n      if (url) handleUrl({ url });\n    });\n\n    const subscription = Linking.addEventListener('url', handleUrl);\n    return () => subscription.remove();\n  }, []);\n\n  const saveAuthData = async (authToken: string, userData: User) => {\n    await Promise.all([\n      AsyncStorage.setItem(AUTH_TOKEN_KEY, authToken),\n      AsyncStorage.setItem(USER_DATA_KEY, JSON.stringify(userData)),\n    ]);\n\n    setToken(authToken);\n    setUser(userData);\n  };\n\n  const clearAuthData = async () => {\n    await Promise.all([\n      AsyncStorage.removeItem(AUTH_TOKEN_KEY),\n      AsyncStorage.removeItem(USER_DATA_KEY),\n    ]);\n\n    setToken(null);\n    setUser(null);\n  };\n\n  const authenticateWithBackend = useCallback(async (\n    provider: 'apple' | 'google' | 'github' | 'facebook',\n    tokenData: {\n      token: string;\n      identityToken?: string;\n      email?: string;\n      firstName?: string;\n      lastName?: string;\n      avatarUrl?: string;\n    }\n  ) => {\n    const maxRetries = 2;\n    let lastError: any;\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        if (attempt > 0) {\n          console.log(`[Auth] Retry attempt ${attempt} for ${provider} login`);\n          await new Promise(r => setTimeout(r, 1000 * attempt));\n        }\n\n        const response = await apiClient.post('/auth/social', {\n          provider,\n          ...tokenData,\n        });\n\n        const { token: authToken, user: userData } = response.data as {\n          token: string;\n          user: User;\n        };\n\n        await saveAuthData(authToken, userData);\n        return;\n      } catch (err: any) {\n        lastError = err;\n        if (!err?.isNetworkError) {\n          throw err;\n        }\n        console.warn(`[Auth] Network error on attempt ${attempt + 1}:`, err?.url || 'unknown URL');\n      }\n    }\n\n    throw lastError;\n  }, []);\n\n  const signInWithApple = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const credential = await AppleAuthentication.signInAsync({\n        requestedScopes: [\n          AppleAuthentication.AppleAuthenticationScope.FULL_NAME,\n          AppleAuthentication.AppleAuthenticationScope.EMAIL,\n        ],\n      });\n\n      const { identityToken, email, fullName } = credential;\n\n      if (!identityToken) {\n        throw new Error('No identity token received from Apple');\n      }\n\n      await authenticateWithBackend('apple', {\n        token: credential.user,\n        identityToken,\n        email: email || undefined,\n        firstName: fullName?.givenName || undefined,\n        lastName: fullName?.familyName || undefined,\n      });\n    } catch (err: any) {\n      if (err.code === 'ERR_REQUEST_CANCELED' || err.code === 'ERR_CANCELED') {\n        return;\n      }\n\n      if (err?.isNetworkError) {\n        setError('Unable to connect to the server. Please check your internet connection and try again.');\n        console.error('[Auth] Apple sign-in network error. API URL:', err?.url);\n      } else {\n        const message = err instanceof Error ? err.message : (err?.message || 'Apple sign-in failed');\n        setError(message);\n      }\n      console.error('[Auth] Apple sign-in error:', JSON.stringify(err));\n    } finally {\n      setIsLoading(false);\n    }\n  }, [authenticateWithBackend]);\n\n  const [isOAuthInProgress, setIsOAuthInProgress] = useState(false);\n\n  const openOAuthPopup = useCallback((provider: string): Promise<{ token: string; user: any } | null> => {\n    return new Promise((resolve) => {\n      const baseUrl = getApiUrl();\n      const startUrl = `${baseUrl}api/auth/${provider}/start?flow=popup`;\n      const width = 500;\n      const height = 650;\n      const left = window.screenX + (window.innerWidth - width) / 2;\n      const top = window.screenY + (window.innerHeight - height) / 2;\n\n      try {\n        localStorage.removeItem('medinvest_oauth_token');\n        localStorage.removeItem('medinvest_oauth_user');\n      } catch {}\n\n      const popup = window.open(startUrl, `medinvest_${provider}_auth`, `width=${width},height=${height},left=${left},top=${top},toolbar=no,menubar=no`);\n\n      if (!popup) {\n        resolve(null);\n        return;\n      }\n\n      let resolved = false;\n      let popupAppearedClosed = false;\n      let popupClosedAt = 0;\n      const GRACE_PERIOD = 15000;\n\n      const cleanup = () => {\n        clearInterval(pollTimer);\n        window.removeEventListener('message', handleMessage);\n      };\n\n      const finishWith = (result: { token: string; user: any } | null) => {\n        if (resolved) return;\n        resolved = true;\n        cleanup();\n        try {\n          localStorage.removeItem('medinvest_oauth_token');\n          localStorage.removeItem('medinvest_oauth_user');\n        } catch {}\n        resolve(result);\n      };\n\n      const checkLocalStorage = (): boolean => {\n        try {\n          const storedToken = localStorage.getItem('medinvest_oauth_token');\n          if (storedToken) {\n            const storedUserStr = localStorage.getItem('medinvest_oauth_user');\n            const storedUser = storedUserStr ? JSON.parse(storedUserStr) : null;\n            console.log(`[OAuth] Found token in localStorage for ${provider}`);\n            try { popup.close(); } catch {}\n            finishWith({ token: storedToken, user: storedUser });\n            return true;\n          }\n        } catch {}\n        return false;\n      };\n\n      const handleMessage = (event: MessageEvent) => {\n        const data = event.data;\n        if (!data || typeof data !== 'object') return;\n        if (data.type === 'medinvest-oauth-success' && data.token) {\n          console.log(`[OAuth] Popup success via postMessage for ${provider}`);\n          finishWith({ token: data.token, user: data.user });\n        } else if (data.type === 'medinvest-oauth-error') {\n          console.error(`[OAuth] Popup error:`, data.error);\n          finishWith(null);\n        }\n      };\n\n      window.addEventListener('message', handleMessage);\n\n      const pollTimer = setInterval(() => {\n        if (checkLocalStorage()) return;\n\n        let isClosed = false;\n        try {\n          isClosed = popup.closed;\n        } catch {\n          isClosed = true;\n        }\n\n        if (isClosed && !popupAppearedClosed) {\n          popupAppearedClosed = true;\n          popupClosedAt = Date.now();\n          console.log(`[OAuth] Popup appears closed for ${provider}, waiting grace period for localStorage...`);\n        }\n\n        if (popupAppearedClosed && Date.now() - popupClosedAt > GRACE_PERIOD) {\n          if (!checkLocalStorage()) {\n            console.log(`[OAuth] Grace period expired, no token found for ${provider}`);\n            finishWith(null);\n          }\n        }\n      }, 500);\n\n      setTimeout(() => {\n        try { popup.close(); } catch {}\n        finishWith(null);\n      }, 300000);\n    });\n  }, []);\n\n  const handleServerSideOAuth = useCallback(async (provider: string) => {\n    if (isOAuthInProgress) {\n      console.log('[OAuth] Another sign-in is already in progress');\n      return;\n    }\n\n    try {\n      setIsOAuthInProgress(true);\n      setIsLoading(true);\n      setError(null);\n\n      if (Platform.OS === 'web' && typeof window !== 'undefined') {\n        console.log(`[OAuth] Opening ${provider} popup window`);\n        const result = await openOAuthPopup(provider);\n        if (result) {\n          const normalizeUser = (u: any): User => ({\n            id: u.id,\n            email: u.email,\n            first_name: u.first_name || u.firstName,\n            last_name: u.last_name || u.lastName,\n            full_name: u.full_name || u.fullName,\n            avatar_url: u.avatar_url || u.avatarUrl,\n            provider: u.provider,\n            is_verified: u.is_verified ?? u.isVerified,\n            is_accredited: u.is_accredited ?? u.isAccredited,\n            created_at: u.created_at || u.createdAt,\n          });\n\n          if (result.user) {\n            await saveAuthData(result.token, normalizeUser(result.user));\n          } else {\n            const response = await apiClient.get('/users/me', {\n              headers: { Authorization: `Bearer ${result.token}` },\n            });\n            await saveAuthData(result.token, normalizeUser(response.data));\n          }\n          console.log(`[OAuth] Logged in via ${provider} popup`);\n        }\n        return;\n      }\n\n      const deepLinkCallback = 'medinvest://auth';\n      const baseUrl = getApiUrl();\n      const serverStartUrl = `${baseUrl}api/auth/${provider}/start?flow=mobile&app_redirect_uri=${encodeURIComponent(deepLinkCallback)}`;\n      console.log(`[OAuth] Opening server-side ${provider} OAuth:`, serverStartUrl);\n\n      const result = await WebBrowser.openAuthSessionAsync(\n        serverStartUrl,\n        deepLinkCallback\n      );\n\n      console.log(`[OAuth] ${provider} browser result type:`, result.type);\n\n      if (result.type === 'success' && result.url) {\n        let tokenFromUrl: string | null = null;\n        let errorFromUrl: string | null = null;\n\n        try {\n          const parsed = new URL(result.url);\n          tokenFromUrl = parsed.searchParams.get('token');\n          errorFromUrl = parsed.searchParams.get('error');\n        } catch {\n          const tokenMatch = result.url.match(/[?&]token=([^&]+)/);\n          const errorMatch = result.url.match(/[?&]error=([^&]+)/);\n          tokenFromUrl = tokenMatch ? decodeURIComponent(tokenMatch[1]) : null;\n          errorFromUrl = errorMatch ? decodeURIComponent(errorMatch[1]) : null;\n        }\n\n        if (errorFromUrl) {\n          setError(decodeURIComponent(errorFromUrl));\n          return;\n        }\n\n        if (tokenFromUrl) {\n          const response = await apiClient.get('/users/me', {\n            headers: { Authorization: `Bearer ${tokenFromUrl}` },\n          });\n          await saveAuthData(tokenFromUrl, response.data as User);\n          console.log(`[OAuth] Logged in via server-side ${provider} OAuth`);\n        } else {\n          setError('Authentication completed but no token received. Please try again.');\n        }\n      }\n    } catch (err) {\n      const message = err instanceof Error ? err.message : `${provider} sign-in failed`;\n      setError(message);\n      console.error(`[OAuth] ${provider} sign-in error:`, err);\n    } finally {\n      setIsLoading(false);\n      setIsOAuthInProgress(false);\n    }\n  }, [isOAuthInProgress, openOAuthPopup]);\n\n  const signInWithGoogle = useCallback(async () => {\n    await handleServerSideOAuth('google');\n  }, [handleServerSideOAuth]);\n\n  const signInWithGithub = useCallback(async () => {\n    await handleServerSideOAuth('github');\n  }, [handleServerSideOAuth]);\n\n  const signInWithFacebook = useCallback(async () => {\n    await handleServerSideOAuth('facebook');\n  }, [handleServerSideOAuth]);\n\n  const mockSignIn = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const response = await apiClient.post('/auth/demo');\n      const { token: authToken, user: userData } = response.data;\n\n      await saveAuthData(authToken, {\n        ...userData,\n        fullName: userData.fullName || [userData.firstName, userData.lastName].filter(Boolean).join(' '),\n      });\n    } catch (err: any) {\n      const message = err?.response?.data?.message || err?.message || 'Demo sign-in failed';\n      setError(message);\n      console.error('Demo sign-in error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const register = useCallback(async (data: RegisterData): Promise<boolean> => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const response = await apiClient.post('/auth/register', data);\n      const { token: authToken, user: userData } = response.data;\n\n      await saveAuthData(authToken, {\n        ...userData,\n        fullName: userData.fullName || [userData.firstName, userData.lastName].filter(Boolean).join(' '),\n      });\n\n      return true;\n    } catch (err: any) {\n      const message = err?.response?.data?.message || err?.message || 'Registration failed';\n      setError(message);\n      console.error('Registration error:', err);\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const login = useCallback(async (data: LoginData): Promise<boolean> => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const response = await apiClient.post('/auth/login', data);\n      const { token: authToken, user: userData } = response.data;\n\n      await saveAuthData(authToken, {\n        ...userData,\n        fullName: userData.fullName || [userData.firstName, userData.lastName].filter(Boolean).join(' '),\n      });\n\n      return true;\n    } catch (err: any) {\n      if (err?.isNetworkError) {\n        setError('Unable to connect to the server. Please check your internet connection and try again.');\n        console.error('[Auth] Login network error. API URL:', err?.url);\n      } else {\n        const message = err?.response?.data?.message || err?.message || 'Login failed';\n        setError(message);\n      }\n      console.error('[Auth] Login error:', JSON.stringify(err));\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const signOut = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      await clearAuthData();\n    } catch (err) {\n      console.error('Sign out error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const refreshUser = useCallback(async () => {\n    if (!token) return;\n    \n    try {\n      const response = await apiClient.get('/users/me');\n      const userData = response.data as User;\n      \n      setUser(userData);\n      await AsyncStorage.setItem(USER_DATA_KEY, JSON.stringify(userData));\n    } catch (error: any) {\n      console.error('Failed to refresh user:', error);\n      if (error?.status === 401 || error?.response?.status === 401) {\n        await clearAuthData();\n      }\n    }\n  }, [token]);\n\n  const updateUser = useCallback(async (userData: Partial<User>) => {\n    if (!user) return;\n    \n    const updatedUser = { ...user, ...userData };\n    setUser(updatedUser);\n    await AsyncStorage.setItem(USER_DATA_KEY, JSON.stringify(updatedUser));\n  }, [user]);\n\n  const setAuthSession = useCallback(async (authToken: string, userData: User) => {\n    const normalizedUser: User = {\n      id: userData.id,\n      email: userData.email,\n      first_name: userData.first_name,\n      last_name: userData.last_name,\n      full_name: userData.full_name || [userData.first_name, userData.last_name].filter(Boolean).join(' '),\n      avatar_url: userData.avatar_url,\n      provider: userData.provider,\n      is_verified: userData.is_verified,\n      is_accredited: userData.is_accredited,\n      created_at: userData.created_at,\n    };\n    await saveAuthData(authToken, normalizedUser);\n  }, []);\n\n  const forgotPassword = useCallback(async (email: string): Promise<boolean> => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      await apiClient.post('/auth/forgot-password', { email });\n      return true;\n    } catch (err: any) {\n      const message = err?.response?.data?.message || err?.message || 'Failed to send reset link';\n      setError(message);\n      console.error('Forgot password error:', err);\n      return false;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const isAuthenticated = useMemo(() => {\n    return !!user && !!token;\n  }, [user, token]);\n\n  const value = useMemo<AuthContextType>(\n    () => ({\n      user,\n      token,\n      isLoading,\n      isAuthenticated,\n      error,\n      signInWithApple,\n      signInWithGoogle,\n      signInWithGithub,\n      signInWithFacebook,\n      signOut,\n      register,\n      login,\n      setAuthSession,\n      clearError,\n      refreshUser,\n      updateUser,\n      mockSignIn,\n      forgotPassword,\n      isAppleAuthAvailable,\n    }),\n    [\n      user,\n      token,\n      isLoading,\n      isAuthenticated,\n      error,\n      signInWithApple,\n      signInWithGoogle,\n      signInWithGithub,\n      signInWithFacebook,\n      signOut,\n      register,\n      login,\n      setAuthSession,\n      clearError,\n      refreshUser,\n      updateUser,\n      mockSignIn,\n      forgotPassword,\n      isAppleAuthAvailable,\n    ]\n  );\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth(): AuthContextType {\n  const context = useContext(AuthContext);\n\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n\n  return context;\n}\n\nexport default AuthContext;\n","path":null,"size_bytes":23067,"size_tokens":null},"client/screens/ConversationScreen.tsx":{"content":"/**\n * Conversation Screen\n * Individual message thread with real-time messaging\n */\n\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TextInput,\n  TouchableOpacity,\n  Image,\n  KeyboardAvoidingView,\n  Platform,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { messagesApi, ApiUser, Message } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { formatRelativeTime } from '@/lib/utils';\nimport { videoCallService } from '@/lib/video/VideoCallService';\n\ntype ConversationRouteParams = {\n  Conversation: {\n    userId: string;\n  };\n};\n\nexport default function ConversationScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<ConversationRouteParams, 'Conversation'>>();\n  const { userId } = route.params;\n  const { user: currentUser } = useAuth();\n  const queryClient = useQueryClient();\n  const flatListRef = useRef<FlatList>(null);\n  const appColors = useAppColors();\n\n  const [messageText, setMessageText] = useState('');\n  const [otherUser, setOtherUser] = useState<ApiUser | null>(null);\n\n  // Fetch messages\n  const {\n    data: messagesData,\n    isLoading,\n    refetch,\n  } = useQuery({\n    queryKey: ['conversation', userId],\n    queryFn: async () => {\n      const response = await messagesApi.getConversation(userId);\n      if (response.data?.other_user) {\n        setOtherUser(response.data.other_user);\n      }\n      return response.data?.messages || [];\n    },\n    refetchInterval: 3000,\n  });\n\n  const messages = messagesData || [];\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      const response = await messagesApi.sendMessage(userId, content);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to send message');\n      }\n      return response.data;\n    },\n    onSuccess: () => {\n      setMessageText('');\n      refetch();\n      setTimeout(() => {\n        flatListRef.current?.scrollToEnd({ animated: true });\n      }, 100);\n    },\n  });\n\n  const handleSend = useCallback(() => {\n    if (!messageText.trim()) return;\n    sendMessageMutation.mutate(messageText.trim());\n  }, [messageText, sendMessageMutation]);\n\n  const handleUserPress = useCallback(() => {\n    if (otherUser) {\n      navigation.navigate('UserProfile', { userId: otherUser.id });\n    }\n  }, [navigation, otherUser]);\n\n  const handleVoiceCall = useCallback(async () => {\n    if (!otherUser) return;\n    navigation.navigate('VoiceCall', {\n      recipientId: otherUser.id,\n      recipientName: otherUser.full_name || `${otherUser.first_name} ${otherUser.last_name}`,\n      recipientAvatar: otherUser.avatar_url,\n      callType: 'audio',\n    });\n  }, [navigation, otherUser]);\n\n  const handleVideoCall = useCallback(async () => {\n    if (!otherUser) return;\n    navigation.navigate('VoiceCall', {\n      recipientId: otherUser.id,\n      recipientName: otherUser.full_name || `${otherUser.first_name} ${otherUser.last_name}`,\n      recipientAvatar: otherUser.avatar_url,\n      callType: 'video',\n    });\n  }, [navigation, otherUser]);\n\n  // Scroll to bottom on initial load\n  useEffect(() => {\n    if (messages.length > 0) {\n      setTimeout(() => {\n        flatListRef.current?.scrollToEnd({ animated: false });\n      }, 100);\n    }\n  }, [messages.length]);\n\n  const renderMessage = ({ item, index }: { item: Message; index: number }) => {\n    const isOwn = item.sender.id === currentUser?.id;\n    const showAvatar = !isOwn && (index === 0 || messages[index - 1]?.sender.id !== item.sender.id);\n    const showTimestamp = index === messages.length - 1 || \n      messages[index + 1]?.sender.id !== item.sender.id;\n\n    return (\n      <View style={[styles.messageContainer, isOwn && styles.messageContainerOwn]}>\n        {showAvatar && !isOwn && (\n          otherUser?.avatar_url ? (\n            <Image source={{ uri: otherUser.avatar_url }} style={styles.messageAvatar} />\n          ) : (\n            <View style={[styles.messageAvatar, styles.messageAvatarPlaceholder]}>\n              <ThemedText style={styles.messageAvatarText}>\n                {otherUser?.first_name?.[0]}{otherUser?.last_name?.[0]}\n              </ThemedText>\n            </View>\n          )\n        )}\n        {!showAvatar && !isOwn && <View style={styles.messageAvatarSpacer} />}\n        \n        <View style={[styles.messageBubble, isOwn ? styles.messageBubbleOwn : styles.messageBubbleOther]}>\n          <ThemedText style={[styles.messageText, { color: appColors.textPrimary }, isOwn && styles.messageTextOwn]}>\n            {item.content}\n          </ThemedText>\n        </View>\n\n        {showTimestamp && (\n          <ThemedText style={[styles.messageTimestamp, { color: appColors.textSecondary }]}>\n            {formatRelativeTime(item.created_at)}\n          </ThemedText>\n        )}\n      </View>\n    );\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n        keyboardVerticalOffset={Platform.OS === 'ios' ? 0 : 20}\n      >\n        {/* Header */}\n        <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n            <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n          \n          <TouchableOpacity style={styles.headerUser} onPress={handleUserPress}>\n            {otherUser?.avatar_url ? (\n              <Image source={{ uri: otherUser.avatar_url }} style={styles.headerAvatar} />\n            ) : (\n              <View style={[styles.headerAvatar, styles.headerAvatarPlaceholder]}>\n                <ThemedText style={styles.headerAvatarText}>\n                  {otherUser?.first_name?.[0]}{otherUser?.last_name?.[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={styles.headerInfo}>\n              <View style={styles.headerNameRow}>\n                <ThemedText style={[styles.headerName, { color: appColors.textPrimary }]} numberOfLines={1}>\n                  {otherUser?.full_name}\n                </ThemedText>\n                {otherUser?.is_verified && (\n                  <Ionicons name=\"checkmark-circle\" size={14} color={Colors.primary} />\n                )}\n              </View>\n              {otherUser?.specialty && (\n                <ThemedText style={[styles.headerSpecialty, { color: appColors.textSecondary }]} numberOfLines={1}>\n                  {otherUser.specialty}\n                </ThemedText>\n              )}\n            </View>\n          </TouchableOpacity>\n\n          <TouchableOpacity style={styles.callButton} onPress={handleVoiceCall}>\n            <Ionicons name=\"call-outline\" size={22} color={Colors.primary} />\n          </TouchableOpacity>\n\n          <TouchableOpacity style={styles.callButton} onPress={handleVideoCall}>\n            <Ionicons name=\"videocam-outline\" size={22} color={Colors.primary} />\n          </TouchableOpacity>\n\n          <TouchableOpacity style={styles.moreButton}>\n            <Ionicons name=\"ellipsis-horizontal\" size={24} color={appColors.textPrimary} />\n          </TouchableOpacity>\n        </View>\n\n        {/* Messages */}\n        <FlatList\n          ref={flatListRef}\n          data={messages}\n          renderItem={renderMessage}\n          keyExtractor={(item) => item.id.toString()}\n          contentContainerStyle={styles.messagesList}\n          showsVerticalScrollIndicator={false}\n          ListEmptyComponent={\n            <View style={styles.emptyContainer}>\n              <ThemedText style={[styles.emptyText, { color: appColors.textSecondary }]}>\n                Start your conversation with {otherUser?.first_name}\n              </ThemedText>\n            </View>\n          }\n        />\n\n        {/* Input */}\n        <View style={[styles.inputContainer, { backgroundColor: appColors.surface, borderTopColor: appColors.border }]}>\n          <View style={styles.inputWrapper}>\n            <TextInput\n              style={[styles.input, { color: appColors.textPrimary }]}\n              placeholder=\"Type a message...\"\n              placeholderTextColor={appColors.textSecondary}\n              value={messageText}\n              onChangeText={setMessageText}\n              multiline\n              maxLength={2000}\n            />\n            <TouchableOpacity style={styles.attachButton}>\n              <Ionicons name=\"add-circle-outline\" size={24} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          </View>\n          <TouchableOpacity\n            style={[styles.sendButton, !messageText.trim() && styles.sendButtonDisabled]}\n            onPress={handleSend}\n            disabled={!messageText.trim() || sendMessageMutation.isPending}\n          >\n            {sendMessageMutation.isPending ? (\n              <ActivityIndicator size=\"small\" color=\"white\" />\n            ) : (\n              <Ionicons name=\"send\" size={20} color=\"white\" />\n            )}\n          </TouchableOpacity>\n        </View>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n    marginRight: Spacing.xs,\n  },\n  headerUser: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  headerAvatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    marginRight: Spacing.md,\n  },\n  headerAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  headerAvatarText: {\n    ...Typography.caption,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  headerInfo: {\n    flex: 1,\n  },\n  headerNameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  headerName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  headerSpecialty: {\n    ...Typography.small,\n  },\n  callButton: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginLeft: Spacing.xs,\n  },\n  moreButton: {\n    padding: Spacing.sm,\n  },\n  messagesList: {\n    padding: Spacing.md,\n    flexGrow: 1,\n  },\n  messageContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    marginBottom: Spacing.sm,\n  },\n  messageContainerOwn: {\n    justifyContent: 'flex-end',\n  },\n  messageAvatar: {\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    marginRight: Spacing.sm,\n  },\n  messageAvatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  messageAvatarText: {\n    fontSize: 10,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  messageAvatarSpacer: {\n    width: 28,\n    marginRight: Spacing.sm,\n  },\n  messageBubble: {\n    maxWidth: '75%',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n  },\n  messageBubbleOwn: {\n    backgroundColor: Colors.primary,\n    borderBottomRightRadius: 4,\n  },\n  messageBubbleOther: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderBottomLeftRadius: 4,\n  },\n  messageText: {\n    ...Typography.body,\n  },\n  messageTextOwn: {\n    color: 'white',\n  },\n  messageTimestamp: {\n    ...Typography.small,\n    marginLeft: Spacing.sm,\n    marginBottom: 2,\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyText: {\n    ...Typography.body,\n    textAlign: 'center',\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    padding: Spacing.md,\n    borderTopWidth: 1,\n    gap: Spacing.sm,\n  },\n  inputWrapper: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n  },\n  input: {\n    flex: 1,\n    ...Typography.body,\n    maxHeight: 100,\n    paddingVertical: 0,\n  },\n  attachButton: {\n    marginLeft: Spacing.sm,\n  },\n  sendButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  sendButtonDisabled: {\n    opacity: 0.5,\n  },\n});\n","path":null,"size_bytes":13516,"size_tokens":null},"client/navigation/RootStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport MainTabNavigator from \"@/navigation/MainTabNavigator\";\nimport LoginScreen from \"@/screens/LoginScreen\";\nimport InvestModalScreen from \"@/screens/InvestModalScreen\";\nimport { useScreenOptions } from \"@/hooks/useScreenOptions\";\nimport { useAuth } from \"@/contexts/AuthContext\";\n\nexport type RootStackParamList = {\n  Main: undefined;\n  Login: undefined;\n  InvestModal: { opportunityId?: string };\n};\n\nconst Stack = createNativeStackNavigator<RootStackParamList>();\n\nexport default function RootStackNavigator() {\n  const screenOptions = useScreenOptions();\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return null;\n  }\n\n  return (\n    <Stack.Navigator screenOptions={screenOptions}>\n      {isAuthenticated ? (\n        <>\n          <Stack.Screen\n            name=\"Main\"\n            component={MainTabNavigator}\n            options={{ headerShown: false }}\n          />\n          <Stack.Screen\n            name=\"InvestModal\"\n            component={InvestModalScreen}\n            options={{\n              presentation: \"modal\",\n              headerTitle: \"Invest\",\n            }}\n          />\n        </>\n      ) : (\n        <Stack.Screen\n          name=\"Login\"\n          component={LoginScreen}\n          options={{ headerShown: false }}\n        />\n      )}\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1425,"size_tokens":null},"client/components/Spacer.tsx":{"content":"import { View } from \"react-native\";\n\ntype Props = {\n  width?: number;\n  height?: number;\n};\n\nexport default function Spacer(props: Props) {\n  const width: number = props.width ?? 1;\n  const height: number = props.height ?? 1;\n\n  return (\n    <View\n      style={{\n        width,\n        height,\n      }}\n    />\n  );\n}\n","path":null,"size_bytes":318,"size_tokens":null},"server/replit_integrations/batch/utils.ts":{"content":"import pLimit from \"p-limit\";\nimport pRetry, { AbortError } from \"p-retry\";\n\n/**\n * Batch Processing Utilities\n *\n * This module provides a generic batch processing function with built-in\n * rate limiting and automatic retries. Use it for any task that requires\n * processing multiple items through an LLM or external API.\n *\n * USAGE:\n * ```typescript\n * import { batchProcess, isRateLimitError } from \"./replit_integrations/batch\";\n *\n * const results = await batchProcess(\n *   artworks,\n *   async (artwork) => {\n *     // Your custom LLM logic here\n *     const response = await openai.chat.completions.create({\n *       model: \"gpt-5.1\",\n *       messages: [{ role: \"user\", content: `Categorize: ${artwork.name}` }],\n *       response_format: { type: \"json_object\" },\n *     });\n *     return JSON.parse(response.choices[0]?.message?.content || \"{}\");\n *   },\n *   { concurrency: 2, retries: 5 }\n * );\n * ```\n */\n\nexport interface BatchOptions {\n  /** Max concurrent requests (default: 2) */\n  concurrency?: number;\n  /** Max retry attempts for rate limit errors (default: 7) */\n  retries?: number;\n  /** Initial retry delay in ms (default: 2000) */\n  minTimeout?: number;\n  /** Max retry delay in ms (default: 128000) */\n  maxTimeout?: number;\n  /** Callback for progress updates */\n  onProgress?: (completed: number, total: number, item: unknown) => void;\n}\n\n/**\n * Check if an error is a rate limit or quota violation.\n * Use this in custom error handling if needed.\n */\nexport function isRateLimitError(error: unknown): boolean {\n  const errorMsg = error instanceof Error ? error.message : String(error);\n  return (\n    errorMsg.includes(\"429\") ||\n    errorMsg.includes(\"RATELIMIT_EXCEEDED\") ||\n    errorMsg.toLowerCase().includes(\"quota\") ||\n    errorMsg.toLowerCase().includes(\"rate limit\")\n  );\n}\n\n/**\n * Process items in batches with rate limiting and automatic retries.\n *\n * @param items - Array of items to process\n * @param processor - Async function to process each item (write your LLM logic here)\n * @param options - Concurrency and retry settings\n * @returns Promise resolving to array of results in the same order as input\n *\n * @example\n * // Process CSV artwork data with custom categorization\n * const categorized = await batchProcess(\n *   csvRows,\n *   async (row) => {\n *     const response = await openai.chat.completions.create({\n *       model: \"gpt-5.1\", // the newest OpenAI model\n *       messages: [{ role: \"user\", content: `Categorize artwork: ${row.name}` }],\n *       response_format: { type: \"json_object\" },\n *     });\n *     return { ...row, category: JSON.parse(response.choices[0]?.message?.content || \"{}\") };\n *   }\n * );\n */\nexport async function batchProcess<T, R>(\n  items: T[],\n  processor: (item: T, index: number) => Promise<R>,\n  options: BatchOptions = {}\n): Promise<R[]> {\n  const {\n    concurrency = 2,\n    retries = 7,\n    minTimeout = 2000,\n    maxTimeout = 128000,\n    onProgress,\n  } = options;\n\n  const limit = pLimit(concurrency);\n  let completed = 0;\n\n  const promises = items.map((item, index) =>\n    limit(() =>\n      pRetry(\n        async () => {\n          try {\n            const result = await processor(item, index);\n            completed++;\n            onProgress?.(completed, items.length, item);\n            return result;\n          } catch (error: unknown) {\n            if (isRateLimitError(error)) {\n              throw error; // Rethrow to trigger p-retry\n            }\n            // For non-rate-limit errors, abort immediately\n            throw new AbortError(\n              error instanceof Error ? error : new Error(String(error))\n            );\n          }\n        },\n        { retries, minTimeout, maxTimeout, factor: 2 }\n      )\n    )\n  );\n\n  return Promise.all(promises);\n}\n\n/**\n * Process items sequentially with SSE progress streaming.\n * Use this when you need real-time progress updates to the client.\n *\n * @param items - Array of items to process\n * @param processor - Async function to process each item\n * @param sendEvent - Function to send SSE events to the client\n * @param options - Retry settings (concurrency is always 1 for sequential)\n */\nexport async function batchProcessWithSSE<T, R>(\n  items: T[],\n  processor: (item: T, index: number) => Promise<R>,\n  sendEvent: (event: { type: string; [key: string]: unknown }) => void,\n  options: Omit<BatchOptions, \"concurrency\" | \"onProgress\"> = {}\n): Promise<R[]> {\n  const { retries = 5, minTimeout = 1000, maxTimeout = 15000 } = options;\n\n  sendEvent({ type: \"started\", total: items.length });\n\n  const results: R[] = [];\n  let errors = 0;\n\n  for (let index = 0; index < items.length; index++) {\n    const item = items[index];\n    sendEvent({ type: \"processing\", index, item });\n\n    try {\n      const result = await pRetry(\n        () => processor(item, index),\n        {\n          retries,\n          minTimeout,\n          maxTimeout,\n          factor: 2,\n          onFailedAttempt: (error) => {\n            if (!isRateLimitError(error)) {\n              throw new AbortError(\n                error instanceof Error ? error : new Error(String(error))\n              );\n            }\n          },\n        }\n      );\n      results.push(result);\n      sendEvent({ type: \"progress\", index, result });\n    } catch (error) {\n      errors++;\n      results.push(undefined as R); // Placeholder for failed items\n      sendEvent({\n        type: \"progress\",\n        index,\n        error: error instanceof Error ? error.message : \"Processing failed\",\n      });\n    }\n  }\n\n  sendEvent({ type: \"complete\", processed: items.length, errors });\n  return results;\n}\n\n","path":null,"size_bytes":5595,"size_tokens":null},"server/routes/articles.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { db, articles, articleBookmarks } from '../db';\nimport { eq, and, desc, asc, sql, ilike, or } from 'drizzle-orm';\nimport { authMiddleware, optionalAuthMiddleware } from '../middleware/auth';\n\nconst router = Router();\n\n/**\n * Helper to format article response\n */\nfunction formatArticle(article: any, isBookmarked: boolean = false) {\n  let tags: string[] = [];\n  try {\n    tags = article.tags ? JSON.parse(article.tags) : [];\n  } catch {\n    tags = [];\n  }\n\n  return {\n    id: article.id,\n    title: article.title,\n    summary: article.summary,\n    content: article.content,\n    source: article.source,\n    sourceUrl: article.sourceUrl,\n    author: article.author,\n    imageUrl: article.imageUrl,\n    category: article.category,\n    tags,\n    readTime: article.readTime,\n    isFeatured: article.isFeatured,\n    isBookmarked,\n    viewCount: article.viewCount,\n    publishedAt: article.publishedAt,\n  };\n}\n\n/**\n * GET /api/articles\n * List articles with filters and pagination\n */\nrouter.get('/', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const {\n      page = '1',\n      limit = '15',\n      category,\n      featured,\n      search,\n      sortBy = 'newest',\n    } = req.query;\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Build conditions\n    const conditions = [];\n\n    if (category) {\n      conditions.push(eq(articles.category, category as any));\n    }\n\n    if (featured === 'true') {\n      conditions.push(eq(articles.isFeatured, true));\n    }\n\n    if (search) {\n      conditions.push(\n        or(\n          ilike(articles.title, `%${search}%`),\n          ilike(articles.summary, `%${search}%`)\n        )\n      );\n    }\n\n    // Build order by\n    let orderBy;\n    switch (sortBy) {\n      case 'popular':\n        orderBy = desc(articles.viewCount);\n        break;\n      case 'readTime':\n        orderBy = asc(articles.readTime);\n        break;\n      case 'newest':\n      default:\n        orderBy = desc(articles.publishedAt);\n    }\n\n    const whereClause = conditions.length > 0 ? and(...conditions) : undefined;\n\n    // Fetch articles\n    const [articlesList, [countResult]] = await Promise.all([\n      db\n        .select()\n        .from(articles)\n        .where(whereClause)\n        .orderBy(orderBy)\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(articles)\n        .where(whereClause),\n    ]);\n\n    // Get bookmarks if user is authenticated\n    let bookmarkedIds = new Set<string>();\n    \n    if (req.user) {\n      const bookmarks = await db\n        .select({ articleId: articleBookmarks.articleId })\n        .from(articleBookmarks)\n        .where(eq(articleBookmarks.userId, req.user.id));\n      \n      bookmarkedIds = new Set(bookmarks.map((b) => b.articleId));\n    }\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    res.json({\n      data: articlesList.map((a) => formatArticle(a, bookmarkedIds.has(a.id))),\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('List articles error:', error);\n    res.status(500).json({ message: 'Failed to fetch articles' });\n  }\n});\n\n/**\n * GET /api/articles/bookmarked\n * Get user's bookmarked articles\n */\nrouter.get('/bookmarked', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const userId = req.user!.id;\n    const { page = '1', limit = '15' } = req.query;\n\n    const pageNum = Math.max(1, parseInt(page as string));\n    const limitNum = Math.min(50, Math.max(1, parseInt(limit as string)));\n    const offset = (pageNum - 1) * limitNum;\n\n    // Fetch bookmarked articles\n    const [bookmarkedArticles, [countResult]] = await Promise.all([\n      db\n        .select({\n          id: articles.id,\n          title: articles.title,\n          summary: articles.summary,\n          source: articles.source,\n          sourceUrl: articles.sourceUrl,\n          author: articles.author,\n          imageUrl: articles.imageUrl,\n          category: articles.category,\n          tags: articles.tags,\n          readTime: articles.readTime,\n          isFeatured: articles.isFeatured,\n          viewCount: articles.viewCount,\n          publishedAt: articles.publishedAt,\n          bookmarkedAt: articleBookmarks.createdAt,\n        })\n        .from(articleBookmarks)\n        .innerJoin(articles, eq(articleBookmarks.articleId, articles.id))\n        .where(eq(articleBookmarks.userId, userId))\n        .orderBy(desc(articleBookmarks.createdAt))\n        .limit(limitNum)\n        .offset(offset),\n      db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(articleBookmarks)\n        .where(eq(articleBookmarks.userId, userId)),\n    ]);\n\n    const totalItems = countResult?.count || 0;\n    const totalPages = Math.ceil(totalItems / limitNum);\n\n    res.json({\n      data: bookmarkedArticles.map((a) => formatArticle(a, true)),\n      page: pageNum,\n      limit: limitNum,\n      totalItems,\n      totalPages,\n      hasMore: pageNum < totalPages,\n    });\n  } catch (error) {\n    console.error('Get bookmarked articles error:', error);\n    res.status(500).json({ message: 'Failed to fetch bookmarked articles' });\n  }\n});\n\n/**\n * GET /api/articles/:id\n * Get article detail\n */\nrouter.get('/:id', optionalAuthMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    // Fetch article\n    const [article] = await db\n      .select()\n      .from(articles)\n      .where(eq(articles.id, id))\n      .limit(1);\n\n    if (!article) {\n      res.status(404).json({ message: 'Article not found' });\n      return;\n    }\n\n    // Increment view count\n    await db\n      .update(articles)\n      .set({ viewCount: sql`${articles.viewCount} + 1` })\n      .where(eq(articles.id, id));\n\n    // Check if bookmarked\n    let isBookmarked = false;\n    \n    if (req.user) {\n      const [bookmark] = await db\n        .select()\n        .from(articleBookmarks)\n        .where(\n          and(\n            eq(articleBookmarks.userId, req.user.id),\n            eq(articleBookmarks.articleId, id)\n          )\n        )\n        .limit(1);\n      \n      isBookmarked = !!bookmark;\n    }\n\n    res.json(formatArticle(article, isBookmarked));\n  } catch (error) {\n    console.error('Get article error:', error);\n    res.status(500).json({ message: 'Failed to fetch article' });\n  }\n});\n\n/**\n * POST /api/articles/:id/bookmark\n * Toggle article bookmark\n */\nrouter.post('/:id/bookmark', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const userId = req.user!.id;\n\n    // Check article exists\n    const [article] = await db\n      .select({ id: articles.id })\n      .from(articles)\n      .where(eq(articles.id, id))\n      .limit(1);\n\n    if (!article) {\n      res.status(404).json({ message: 'Article not found' });\n      return;\n    }\n\n    // Check if already bookmarked\n    const [existingBookmark] = await db\n      .select()\n      .from(articleBookmarks)\n      .where(\n        and(\n          eq(articleBookmarks.userId, userId),\n          eq(articleBookmarks.articleId, id)\n        )\n      )\n      .limit(1);\n\n    if (existingBookmark) {\n      // Remove bookmark\n      await db\n        .delete(articleBookmarks)\n        .where(eq(articleBookmarks.id, existingBookmark.id));\n\n      res.json({ isBookmarked: false, message: 'Bookmark removed' });\n    } else {\n      // Add bookmark\n      await db.insert(articleBookmarks).values({\n        userId,\n        articleId: id,\n      });\n\n      res.json({ isBookmarked: true, message: 'Article bookmarked' });\n    }\n  } catch (error) {\n    console.error('Toggle bookmark error:', error);\n    res.status(500).json({ message: 'Failed to toggle bookmark' });\n  }\n});\n\n/**\n * GET /api/articles/categories/list\n * Get available article categories\n */\nrouter.get('/categories/list', async (req: Request, res: Response) => {\n  try {\n    const categories = await db\n      .select({\n        category: articles.category,\n        count: sql<number>`count(*)::int`,\n      })\n      .from(articles)\n      .groupBy(articles.category)\n      .orderBy(desc(sql`count(*)`));\n\n    res.json(categories);\n  } catch (error) {\n    console.error('Get categories error:', error);\n    res.status(500).json({ message: 'Failed to fetch categories' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":8593,"size_tokens":null},"client/screens/EditProfileScreen.tsx":{"content":"/**\n * EditProfile Screen\n * Edit user profile information and avatar\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  TextInput,\n  Image,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as ImagePicker from 'expo-image-picker';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi } from '@/lib/api';\nimport { useAuth } from '@/contexts/AuthContext';\n\nconst SPECIALTIES = [\n  'Internal Medicine',\n  'Cardiology',\n  'Oncology',\n  'Neurology',\n  'Orthopedics',\n  'Dermatology',\n  'Pediatrics',\n  'Psychiatry',\n  'Radiology',\n  'Surgery',\n  'Family Medicine',\n  'Emergency Medicine',\n  'Investor',\n  'Healthcare Executive',\n  'Researcher',\n  'Other',\n];\n\nexport default function EditProfileScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const { user, updateUser, refreshUser } = useAuth();\n\n  const [firstName, setFirstName] = useState(user?.first_name || '');\n  const [lastName, setLastName] = useState(user?.last_name || '');\n  const [bio, setBio] = useState(user?.bio || '');\n  const [specialty, setSpecialty] = useState(user?.specialty || '');\n  const [avatarUri, setAvatarUri] = useState(user?.avatar_url || '');\n  const [showSpecialtyPicker, setShowSpecialtyPicker] = useState(false);\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async () => {\n      const response = await usersApi.updateProfile({\n        first_name: firstName.trim(),\n        last_name: lastName.trim(),\n        bio: bio.trim(),\n        specialty: specialty || undefined,\n      });\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to update profile');\n      }\n      return response.data;\n    },\n    onSuccess: (data) => {\n      if (data) {\n        updateUser(data);\n      }\n      Alert.alert('Success', 'Profile updated successfully');\n      navigation.goBack();\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const uploadAvatarMutation = useMutation({\n    mutationFn: async (uri: string) => {\n      const formData = new FormData();\n      formData.append('avatar', {\n        uri,\n        name: 'avatar.jpg',\n        type: 'image/jpeg',\n      } as any);\n      \n      const response = await usersApi.uploadAvatar(formData);\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to upload avatar');\n      }\n      return response.data;\n    },\n    onSuccess: (data) => {\n      if (data?.avatar_url) {\n        setAvatarUri(data.avatar_url);\n        updateUser({ avatar_url: data.avatar_url });\n      }\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const handlePickImage = async () => {\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\n      allowsEditing: true,\n      aspect: [1, 1],\n      quality: 0.8,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      uploadAvatarMutation.mutate(result.assets[0].uri);\n    }\n  };\n\n  const handleSave = () => {\n    if (!firstName.trim() || !lastName.trim()) {\n      Alert.alert('Error', 'First name and last name are required');\n      return;\n    }\n    updateProfileMutation.mutate();\n  };\n\n  const hasChanges = \n    firstName !== user?.first_name ||\n    lastName !== user?.last_name ||\n    bio !== (user?.bio || '') ||\n    specialty !== (user?.specialty || '');\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.surface }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.cancelButton} onPress={() => navigation.goBack()}>\n          <ThemedText style={[styles.cancelText, { color: appColors.textSecondary }]}>Cancel</ThemedText>\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]}>Edit Profile</ThemedText>\n        <TouchableOpacity\n          style={[styles.saveButton, !hasChanges && styles.saveButtonDisabled]}\n          onPress={handleSave}\n          disabled={!hasChanges || updateProfileMutation.isPending}\n        >\n          {updateProfileMutation.isPending ? (\n            <ActivityIndicator size=\"small\" color={Colors.primary} />\n          ) : (\n            <ThemedText style={[styles.saveText, !hasChanges && { color: appColors.textSecondary }]}>\n              Save\n            </ThemedText>\n          )}\n        </TouchableOpacity>\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Avatar Section */}\n        <View style={[styles.avatarSection, { borderBottomColor: appColors.border }]}>\n          <TouchableOpacity style={styles.avatarContainer} onPress={handlePickImage}>\n            {avatarUri ? (\n              <Image source={{ uri: avatarUri }} style={styles.avatar} />\n            ) : (\n              <View style={[styles.avatar, styles.avatarPlaceholder]}>\n                <ThemedText style={styles.avatarText}>\n                  {firstName[0]}{lastName[0]}\n                </ThemedText>\n              </View>\n            )}\n            <View style={[styles.avatarEditBadge, { borderColor: appColors.surface }]}>\n              {uploadAvatarMutation.isPending ? (\n                <ActivityIndicator size=\"small\" color=\"white\" />\n              ) : (\n                <Ionicons name=\"camera\" size={16} color=\"white\" />\n              )}\n            </View>\n          </TouchableOpacity>\n          <TouchableOpacity onPress={handlePickImage}>\n            <ThemedText style={styles.changePhotoText}>Change Photo</ThemedText>\n          </TouchableOpacity>\n        </View>\n\n        {/* Form Fields */}\n        <View style={styles.form}>\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>First Name</ThemedText>\n            <TextInput\n              style={[styles.input, { color: appColors.textPrimary, borderColor: appColors.border }]}\n              value={firstName}\n              onChangeText={setFirstName}\n              placeholder=\"Enter your first name\"\n              placeholderTextColor={appColors.textSecondary}\n              autoCapitalize=\"words\"\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Last Name</ThemedText>\n            <TextInput\n              style={[styles.input, { color: appColors.textPrimary, borderColor: appColors.border }]}\n              value={lastName}\n              onChangeText={setLastName}\n              placeholder=\"Enter your last name\"\n              placeholderTextColor={appColors.textSecondary}\n              autoCapitalize=\"words\"\n            />\n          </View>\n\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Bio</ThemedText>\n            <TextInput\n              style={[styles.input, styles.bioInput, { color: appColors.textPrimary, borderColor: appColors.border }]}\n              value={bio}\n              onChangeText={setBio}\n              placeholder=\"Tell us about yourself\"\n              placeholderTextColor={appColors.textSecondary}\n              multiline\n              numberOfLines={4}\n              maxLength={500}\n              textAlignVertical=\"top\"\n            />\n            <ThemedText style={[styles.charCount, { color: appColors.textSecondary }]}>{bio.length}/500</ThemedText>\n          </View>\n\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Specialty</ThemedText>\n            <TouchableOpacity\n              style={[styles.pickerButton, { borderColor: appColors.border }]}\n              onPress={() => setShowSpecialtyPicker(!showSpecialtyPicker)}\n            >\n              <ThemedText style={specialty ? [styles.pickerText, { color: appColors.textPrimary }] : [styles.pickerPlaceholder, { color: appColors.textSecondary }]}>\n                {specialty || 'Select your specialty'}\n              </ThemedText>\n              <Ionicons name=\"chevron-down\" size={20} color={appColors.textSecondary} />\n            </TouchableOpacity>\n          </View>\n\n          {showSpecialtyPicker && (\n            <View style={[styles.specialtyPicker, { borderColor: appColors.border }]}>\n              {SPECIALTIES.map((s) => (\n                <TouchableOpacity\n                  key={s}\n                  style={[\n                    styles.specialtyOption,\n                    { borderBottomColor: appColors.border },\n                    specialty === s && styles.specialtyOptionSelected,\n                  ]}\n                  onPress={() => {\n                    setSpecialty(s);\n                    setShowSpecialtyPicker(false);\n                  }}\n                >\n                  <ThemedText style={[\n                    styles.specialtyOptionText,\n                    { color: appColors.textPrimary },\n                    specialty === s && styles.specialtyOptionTextSelected,\n                  ]}>\n                    {s}\n                  </ThemedText>\n                  {specialty === s && (\n                    <Ionicons name=\"checkmark\" size={20} color={Colors.primary} />\n                  )}\n                </TouchableOpacity>\n              ))}\n            </View>\n          )}\n\n          {/* Email (read-only) */}\n          <View style={styles.inputGroup}>\n            <ThemedText style={[styles.label, { color: appColors.textSecondary }]}>Email</ThemedText>\n            <View style={[styles.readOnlyInput, { borderColor: appColors.border }]}>\n              <ThemedText style={[styles.readOnlyText, { color: appColors.textSecondary }]}>{user?.email}</ThemedText>\n              <Ionicons name=\"lock-closed\" size={16} color={appColors.textSecondary} />\n            </View>\n          </View>\n        </View>\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  cancelButton: {\n    padding: Spacing.sm,\n  },\n  cancelText: {\n    ...Typography.body,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  saveButton: {\n    padding: Spacing.sm,\n  },\n  saveButtonDisabled: {\n    opacity: 0.5,\n  },\n  saveText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  content: {\n    flex: 1,\n  },\n  avatarSection: {\n    alignItems: 'center',\n    paddingVertical: Spacing.xl,\n    borderBottomWidth: 1,\n  },\n  avatarContainer: {\n    position: 'relative',\n    marginBottom: Spacing.md,\n  },\n  avatar: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.title,\n    color: Colors.primary,\n  },\n  avatarEditBadge: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: Colors.primary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 2,\n  },\n  changePhotoText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  form: {\n    padding: Spacing.lg,\n  },\n  inputGroup: {\n    marginBottom: Spacing.lg,\n  },\n  label: {\n    ...Typography.caption,\n    fontWeight: '600',\n    marginBottom: Spacing.sm,\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n  },\n  input: {\n    ...Typography.body,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderWidth: 1,\n  },\n  bioInput: {\n    minHeight: 100,\n    paddingTop: Spacing.md,\n  },\n  charCount: {\n    ...Typography.small,\n    textAlign: 'right',\n    marginTop: Spacing.xs,\n  },\n  pickerButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderWidth: 1,\n  },\n  pickerText: {\n    ...Typography.body,\n  },\n  pickerPlaceholder: {\n    ...Typography.body,\n  },\n  specialtyPicker: {\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    marginTop: -Spacing.md,\n    marginBottom: Spacing.lg,\n    borderWidth: 1,\n    maxHeight: 200,\n  },\n  specialtyOption: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  specialtyOptionSelected: {\n    backgroundColor: Colors.primary + '10',\n  },\n  specialtyOptionText: {\n    ...Typography.body,\n  },\n  specialtyOptionTextSelected: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  readOnlyInput: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: Colors.light.backgroundTertiary,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.md,\n    borderWidth: 1,\n  },\n  readOnlyText: {\n    ...Typography.body,\n  },\n});\n","path":null,"size_bytes":13867,"size_tokens":null},"client/lib/analytics/index.ts":{"content":"import * as Device from 'expo-device';\nimport Constants from 'expo-constants';\nimport { Platform } from 'react-native';\n\ntype EventProperties = Record<string, string | number | boolean | undefined>;\n\ninterface UserProperties {\n  userId?: string;\n  email?: string;\n  firstName?: string;\n  lastName?: string;\n  provider?: string;\n  isVerified?: boolean;\n  isAccredited?: boolean;\n  [key: string]: string | number | boolean | undefined;\n}\n\ninterface AnalyticsConfig {\n  debug?: boolean;\n  enabled?: boolean;\n}\n\nclass Analytics {\n  private debug: boolean;\n  private enabled: boolean;\n  private userId: string | null = null;\n  private userProperties: UserProperties = {};\n  private sessionId: string;\n  private sessionStartTime: number;\n\n  constructor(config: AnalyticsConfig = {}) {\n    this.debug = config.debug ?? __DEV__;\n    this.enabled = config.enabled ?? true;\n    this.sessionId = this.generateSessionId();\n    this.sessionStartTime = Date.now();\n  }\n\n  private generateSessionId(): string {\n    return `session_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n  }\n\n  private log(message: string, data?: unknown): void {\n    if (this.debug) {\n      console.log(`[Analytics] ${message}`, data ?? '');\n    }\n  }\n\n  private getDeviceInfo() {\n    return {\n      platform: Platform.OS,\n      platformVersion: Platform.Version,\n      deviceBrand: Device.brand,\n      deviceModel: Device.modelName,\n      deviceType: Device.deviceType,\n      isDevice: Device.isDevice,\n      appVersion: Constants.expoConfig?.version ?? '1.0.0',\n      appName: Constants.expoConfig?.name ?? 'MedInvest',\n    };\n  }\n\n  identify(userId: string, properties?: UserProperties): void {\n    if (!this.enabled) return;\n\n    this.userId = userId;\n    this.userProperties = { ...this.userProperties, ...properties };\n    \n    this.log('User identified', { userId, properties });\n  }\n\n  setUserProperties(properties: UserProperties): void {\n    if (!this.enabled) return;\n\n    this.userProperties = { ...this.userProperties, ...properties };\n    this.log('User properties updated', properties);\n  }\n\n  track(eventName: string, properties?: EventProperties): void {\n    if (!this.enabled) return;\n\n    const event = {\n      name: eventName,\n      timestamp: new Date().toISOString(),\n      userId: this.userId,\n      sessionId: this.sessionId,\n      properties: {\n        ...properties,\n        ...this.getDeviceInfo(),\n      },\n    };\n\n    this.log(`Event: ${eventName}`, event);\n  }\n\n  screen(screenName: string, properties?: EventProperties): void {\n    this.track('Screen View', {\n      screen_name: screenName,\n      ...properties,\n    });\n  }\n\n  trackInvestmentView(investmentId: string, investmentName: string): void {\n    this.track('Investment Viewed', {\n      investment_id: investmentId,\n      investment_name: investmentName,\n    });\n  }\n\n  trackInvestmentStarted(investmentId: string, amount: number): void {\n    this.track('Investment Started', {\n      investment_id: investmentId,\n      amount,\n    });\n  }\n\n  trackInvestmentCompleted(investmentId: string, amount: number): void {\n    this.track('Investment Completed', {\n      investment_id: investmentId,\n      amount,\n    });\n  }\n\n  trackArticleRead(articleId: string, articleTitle: string, readTime?: number): void {\n    this.track('Article Read', {\n      article_id: articleId,\n      article_title: articleTitle,\n      read_time_seconds: readTime,\n    });\n  }\n\n  trackSearch(query: string, resultsCount: number, category?: string): void {\n    this.track('Search Performed', {\n      query,\n      results_count: resultsCount,\n      category,\n    });\n  }\n\n  trackSignIn(provider: string): void {\n    this.track('Sign In', { provider });\n  }\n\n  trackSignOut(): void {\n    this.track('Sign Out');\n  }\n\n  trackError(error: Error, context?: string): void {\n    this.track('Error', {\n      error_message: error.message,\n      error_name: error.name,\n      context,\n    });\n  }\n\n  trackButtonPress(buttonName: string, screen?: string): void {\n    this.track('Button Press', {\n      button_name: buttonName,\n      screen,\n    });\n  }\n\n  startSession(): void {\n    this.sessionId = this.generateSessionId();\n    this.sessionStartTime = Date.now();\n    this.track('Session Started');\n  }\n\n  endSession(): void {\n    const sessionDuration = Math.floor((Date.now() - this.sessionStartTime) / 1000);\n    this.track('Session Ended', {\n      session_duration_seconds: sessionDuration,\n    });\n  }\n\n  reset(): void {\n    this.userId = null;\n    this.userProperties = {};\n    this.startSession();\n    this.log('Analytics reset');\n  }\n\n  setEnabled(enabled: boolean): void {\n    this.enabled = enabled;\n    this.log(`Analytics ${enabled ? 'enabled' : 'disabled'}`);\n  }\n\n  setDebug(debug: boolean): void {\n    this.debug = debug;\n  }\n}\n\nexport const analytics = new Analytics();\n\nexport default analytics;\n","path":null,"size_bytes":4837,"size_tokens":null},"client/lib/utils.ts":{"content":"/**\n * Utility Functions\n */\n\n/**\n * Format a number with K/M suffixes\n */\nexport function formatNumber(num: number): string {\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1).replace(/\\.0$/, '') + 'M';\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(1).replace(/\\.0$/, '') + 'K';\n  }\n  return num.toString();\n}\n\n/**\n * Format a date as relative time (e.g., \"2h ago\", \"3d ago\")\n */\nexport function formatRelativeTime(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n\n  if (diffInSeconds < 60) {\n    return 'just now';\n  }\n\n  const diffInMinutes = Math.floor(diffInSeconds / 60);\n  if (diffInMinutes < 60) {\n    return `${diffInMinutes}m`;\n  }\n\n  const diffInHours = Math.floor(diffInMinutes / 60);\n  if (diffInHours < 24) {\n    return `${diffInHours}h`;\n  }\n\n  const diffInDays = Math.floor(diffInHours / 24);\n  if (diffInDays < 7) {\n    return `${diffInDays}d`;\n  }\n\n  const diffInWeeks = Math.floor(diffInDays / 7);\n  if (diffInWeeks < 4) {\n    return `${diffInWeeks}w`;\n  }\n\n  const diffInMonths = Math.floor(diffInDays / 30);\n  if (diffInMonths < 12) {\n    return `${diffInMonths}mo`;\n  }\n\n  const diffInYears = Math.floor(diffInDays / 365);\n  return `${diffInYears}y`;\n}\n\n/**\n * Format a date for display\n */\nexport function formatDate(dateString: string, includeTime = false): string {\n  const date = new Date(dateString);\n  const options: Intl.DateTimeFormatOptions = {\n    month: 'short',\n    day: 'numeric',\n    year: date.getFullYear() !== new Date().getFullYear() ? 'numeric' : undefined,\n  };\n\n  if (includeTime) {\n    options.hour = 'numeric';\n    options.minute = '2-digit';\n  }\n\n  return date.toLocaleDateString('en-US', options);\n}\n\n/**\n * Format currency\n */\nexport function formatCurrency(amount: number, currency = 'USD'): string {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency,\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  }).format(amount);\n}\n\n/**\n * Format percentage\n */\nexport function formatPercentage(value: number, decimals = 1): string {\n  return `${value >= 0 ? '+' : ''}${value.toFixed(decimals)}%`;\n}\n\n/**\n * Format duration in minutes to readable string\n */\nexport function formatDuration(minutes: number): string {\n  if (minutes < 60) {\n    return `${minutes} min`;\n  }\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n  if (mins === 0) {\n    return `${hours}h`;\n  }\n  return `${hours}h ${mins}m`;\n}\n\n/**\n * Truncate text with ellipsis\n */\nexport function truncateText(text: string, maxLength: number): string {\n  if (text.length <= maxLength) return text;\n  return text.slice(0, maxLength - 3) + '...';\n}\n\n/**\n * Extract hashtags from text\n */\nexport function extractHashtags(text: string): string[] {\n  const regex = /#(\\w+)/g;\n  const matches = text.match(regex);\n  return matches ? matches.map(tag => tag.slice(1)) : [];\n}\n\n/**\n * Extract mentions from text\n */\nexport function extractMentions(text: string): string[] {\n  const regex = /@(\\w+)/g;\n  const matches = text.match(regex);\n  return matches ? matches.map(mention => mention.slice(1)) : [];\n}\n\n/**\n * Generate initials from name\n */\nexport function getInitials(firstName: string, lastName: string): string {\n  return `${firstName.charAt(0)}${lastName.charAt(0)}`.toUpperCase();\n}\n\n/**\n * Validate email format\n */\nexport function isValidEmail(email: string): boolean {\n  const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return regex.test(email);\n}\n\n/**\n * Validate password strength\n */\nexport function validatePassword(password: string): {\n  isValid: boolean;\n  errors: string[];\n} {\n  const errors: string[] = [];\n  \n  if (password.length < 8) {\n    errors.push('Password must be at least 8 characters');\n  }\n  if (!/[A-Z]/.test(password)) {\n    errors.push('Password must contain an uppercase letter');\n  }\n  if (!/[a-z]/.test(password)) {\n    errors.push('Password must contain a lowercase letter');\n  }\n  if (!/[0-9]/.test(password)) {\n    errors.push('Password must contain a number');\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n  };\n}\n\n/**\n * Debounce function\n */\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout;\n  \n  return function executedFunction(...args: Parameters<T>) {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Generate a random color for avatars\n */\nexport function getAvatarColor(name: string): string {\n  const colors = [\n    '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',\n    '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9',\n  ];\n  \n  let hash = 0;\n  for (let i = 0; i < name.length; i++) {\n    hash = name.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  \n  return colors[Math.abs(hash) % colors.length];\n}\n\n/**\n * Calculate reading time for content\n */\nexport function calculateReadingTime(content: string): number {\n  const wordsPerMinute = 200;\n  const words = content.trim().split(/\\s+/).length;\n  return Math.ceil(words / wordsPerMinute);\n}\n\n/**\n * Parse URL parameters\n */\nexport function parseQueryString(queryString: string): Record<string, string> {\n  const params: Record<string, string> = {};\n  const searchParams = new URLSearchParams(queryString);\n  \n  searchParams.forEach((value, key) => {\n    params[key] = value;\n  });\n  \n  return params;\n}\n\n/**\n * Check if date is today\n */\nexport function isToday(dateString: string): boolean {\n  const date = new Date(dateString);\n  const today = new Date();\n  return date.toDateString() === today.toDateString();\n}\n\n/**\n * Check if date is in the past\n */\nexport function isPast(dateString: string): boolean {\n  return new Date(dateString) < new Date();\n}\n\n/**\n * Sleep/delay function\n */\nexport function sleep(ms: number): Promise<void> {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/**\n * Clamp a number between min and max\n */\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\n/**\n * Generate unique ID\n */\nexport function generateId(): string {\n  return Math.random().toString(36).substring(2) + Date.now().toString(36);\n}\n\nexport default {\n  formatNumber,\n  formatRelativeTime,\n  formatDate,\n  formatCurrency,\n  formatPercentage,\n  formatDuration,\n  truncateText,\n  extractHashtags,\n  extractMentions,\n  getInitials,\n  isValidEmail,\n  validatePassword,\n  debounce,\n  getAvatarColor,\n  calculateReadingTime,\n  parseQueryString,\n  isToday,\n  isPast,\n  sleep,\n  clamp,\n  generateId,\n};\n","path":null,"size_bytes":6648,"size_tokens":null},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { db, userSessions, users } from '../db';\nimport { eq, and, gt } from 'drizzle-orm';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\n\nexport interface AuthUser {\n  id: string;\n  email: string;\n  firstName?: string | null;\n  lastName?: string | null;\n  isVerified: boolean;\n  isAccredited: boolean;\n}\n\n// Extend Express Request type\ndeclare global {\n  namespace Express {\n    interface Request {\n      user?: AuthUser;\n      token?: string;\n    }\n  }\n}\n\n/**\n * Generate JWT token\n */\nexport function generateToken(userId: string, sessionId: string): string {\n  return jwt.sign(\n    { userId, sessionId },\n    JWT_SECRET,\n    { expiresIn: '30d' }\n  );\n}\n\n/**\n * Verify JWT token\n */\nexport function verifyToken(token: string): { userId: string; sessionId: string } | null {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as {\n      userId: string;\n      sessionId: string;\n    };\n    return decoded;\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Auth middleware - requires valid token\n */\nexport async function authMiddleware(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  try {\n    // Get token from header\n    const authHeader = req.headers.authorization;\n    \n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      res.status(401).json({ message: 'No token provided' });\n      return;\n    }\n\n    const token = authHeader.substring(7);\n    \n    // Verify token\n    const decoded = verifyToken(token);\n    \n    if (!decoded) {\n      res.status(401).json({ message: 'Invalid token' });\n      return;\n    }\n\n    // Check session exists and is not expired\n    const [session] = await db\n      .select()\n      .from(userSessions)\n      .where(\n        and(\n          eq(userSessions.id, decoded.sessionId),\n          eq(userSessions.userId, decoded.userId),\n          gt(userSessions.expiresAt, new Date())\n        )\n      )\n      .limit(1);\n\n    if (!session) {\n      res.status(401).json({ message: 'Session expired' });\n      return;\n    }\n\n    // Get user\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n      })\n      .from(users)\n      .where(eq(users.id, decoded.userId))\n      .limit(1);\n\n    if (!user) {\n      res.status(401).json({ message: 'User not found' });\n      return;\n    }\n\n    // Attach user and token to request\n    req.user = user;\n    req.token = token;\n\n    next();\n  } catch (error) {\n    console.error('Auth middleware error:', error);\n    res.status(500).json({ message: 'Authentication error' });\n  }\n}\n\n/**\n * Optional auth middleware - attaches user if token present\n */\nexport async function optionalAuthMiddleware(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  try {\n    const authHeader = req.headers.authorization;\n    \n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      next();\n      return;\n    }\n\n    const token = authHeader.substring(7);\n    const decoded = verifyToken(token);\n    \n    if (!decoded) {\n      next();\n      return;\n    }\n\n    const [session] = await db\n      .select()\n      .from(userSessions)\n      .where(\n        and(\n          eq(userSessions.id, decoded.sessionId),\n          eq(userSessions.userId, decoded.userId),\n          gt(userSessions.expiresAt, new Date())\n        )\n      )\n      .limit(1);\n\n    if (!session) {\n      next();\n      return;\n    }\n\n    const [user] = await db\n      .select({\n        id: users.id,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        isVerified: users.isVerified,\n        isAccredited: users.isAccredited,\n      })\n      .from(users)\n      .where(eq(users.id, decoded.userId))\n      .limit(1);\n\n    if (user) {\n      req.user = user;\n      req.token = token;\n    }\n\n    next();\n  } catch (error) {\n    // Don't fail on optional auth\n    next();\n  }\n}\n","path":null,"size_bytes":4135,"size_tokens":null},"client/lib/mockData.ts":{"content":"export interface InvestmentOpportunity {\n  id: string;\n  title: string;\n  company: string;\n  description: string;\n  category: \"biotech\" | \"medtech\" | \"pharma\" | \"digital-health\" | \"diagnostics\";\n  fundingGoal: number;\n  fundingRaised: number;\n  daysRemaining: number;\n  expectedROI: string;\n  riskLevel: \"low\" | \"medium\" | \"high\";\n  imageUrl?: string;\n  documents: { name: string; type: string }[];\n  highlights: string[];\n}\n\nexport interface Article {\n  id: string;\n  title: string;\n  source: string;\n  publishedAt: string;\n  thumbnail?: string;\n  category: string;\n  readTime: string;\n  featured?: boolean;\n}\n\nexport const categories = [\n  { id: \"all\", name: \"All\" },\n  { id: \"biotech\", name: \"Biotech\" },\n  { id: \"medtech\", name: \"MedTech\" },\n  { id: \"pharma\", name: \"Pharma\" },\n  { id: \"digital-health\", name: \"Digital Health\" },\n  { id: \"diagnostics\", name: \"Diagnostics\" },\n];\n\nexport const investmentOpportunities: InvestmentOpportunity[] = [\n  {\n    id: \"1\",\n    title: \"AI-Powered Cancer Screening\",\n    company: \"OncoDetect AI\",\n    description:\n      \"Revolutionary machine learning platform that detects early-stage cancers from routine blood tests with 98% accuracy. Our proprietary algorithms analyze biomarkers invisible to traditional testing methods.\",\n    category: \"diagnostics\",\n    fundingGoal: 5000000,\n    fundingRaised: 3750000,\n    daysRemaining: 18,\n    expectedROI: \"25-35%\",\n    riskLevel: \"medium\",\n    documents: [\n      { name: \"Investment Prospectus\", type: \"pdf\" },\n      { name: \"Clinical Trial Results\", type: \"pdf\" },\n      { name: \"Financial Projections\", type: \"xlsx\" },\n    ],\n    highlights: [\n      \"FDA breakthrough designation\",\n      \"3 major hospital partnerships\",\n      \"Patent-protected technology\",\n    ],\n  },\n  {\n    id: \"2\",\n    title: \"Wearable Cardiac Monitor\",\n    company: \"HeartSync Medical\",\n    description:\n      \"Next-generation continuous cardiac monitoring device with AI-powered arrhythmia detection. Slim, waterproof design with 14-day battery life and real-time physician alerts.\",\n    category: \"medtech\",\n    fundingGoal: 3000000,\n    fundingRaised: 2100000,\n    daysRemaining: 25,\n    expectedROI: \"20-28%\",\n    riskLevel: \"low\",\n    documents: [\n      { name: \"Investment Prospectus\", type: \"pdf\" },\n      { name: \"Regulatory Approval Status\", type: \"pdf\" },\n    ],\n    highlights: [\n      \"CE marked, FDA pending\",\n      \"100,000 pre-orders\",\n      \"Reimbursement secured\",\n    ],\n  },\n  {\n    id: \"3\",\n    title: \"Gene Therapy Platform\",\n    company: \"GeneCure Labs\",\n    description:\n      \"Developing breakthrough gene therapies for rare genetic diseases. Our CRISPR-based platform enables precise genetic corrections with minimal off-target effects.\",\n    category: \"biotech\",\n    fundingGoal: 10000000,\n    fundingRaised: 4500000,\n    daysRemaining: 45,\n    expectedROI: \"40-60%\",\n    riskLevel: \"high\",\n    documents: [\n      { name: \"Investment Prospectus\", type: \"pdf\" },\n      { name: \"Phase I Results\", type: \"pdf\" },\n      { name: \"IP Portfolio\", type: \"pdf\" },\n    ],\n    highlights: [\n      \"Orphan drug designation\",\n      \"Lead asset in Phase II\",\n      \"Strategic pharma interest\",\n    ],\n  },\n  {\n    id: \"4\",\n    title: \"Digital Mental Health Platform\",\n    company: \"MindWell Health\",\n    description:\n      \"Comprehensive digital therapeutics platform for anxiety and depression. Combines CBT-based modules with AI coaching and optional therapist support.\",\n    category: \"digital-health\",\n    fundingGoal: 2000000,\n    fundingRaised: 1600000,\n    daysRemaining: 12,\n    expectedROI: \"18-25%\",\n    riskLevel: \"low\",\n    documents: [\n      { name: \"Investment Prospectus\", type: \"pdf\" },\n      { name: \"Efficacy Studies\", type: \"pdf\" },\n    ],\n    highlights: [\n      \"500K active users\",\n      \"12 enterprise clients\",\n      \"Clinically validated\",\n    ],\n  },\n  {\n    id: \"5\",\n    title: \"Novel Antibiotic Compound\",\n    company: \"ResistEnd Pharma\",\n    description:\n      \"Addressing the antibiotic resistance crisis with a new class of broad-spectrum antibiotics effective against multidrug-resistant bacteria including MRSA.\",\n    category: \"pharma\",\n    fundingGoal: 8000000,\n    fundingRaised: 2400000,\n    daysRemaining: 60,\n    expectedROI: \"35-50%\",\n    riskLevel: \"high\",\n    documents: [\n      { name: \"Investment Prospectus\", type: \"pdf\" },\n      { name: \"Preclinical Data\", type: \"pdf\" },\n      { name: \"Market Analysis\", type: \"pdf\" },\n    ],\n    highlights: [\n      \"CARB-X funding secured\",\n      \"Novel mechanism of action\",\n      \"Strong IP protection\",\n    ],\n  },\n];\n\nexport const articles: Article[] = [\n  {\n    id: \"a1\",\n    title: \"FDA Approves Revolutionary CAR-T Therapy for Solid Tumors\",\n    source: \"MedTech Today\",\n    publishedAt: \"2 hours ago\",\n    category: \"Biotech\",\n    readTime: \"5 min read\",\n    featured: true,\n  },\n  {\n    id: \"a2\",\n    title: \"AI Diagnostics Market to Reach $15B by 2028\",\n    source: \"Healthcare Investor\",\n    publishedAt: \"4 hours ago\",\n    category: \"Market Analysis\",\n    readTime: \"3 min read\",\n  },\n  {\n    id: \"a3\",\n    title: \"Digital Health Startups Attract Record Venture Funding in Q4\",\n    source: \"Venture Health\",\n    publishedAt: \"6 hours ago\",\n    category: \"Investment\",\n    readTime: \"4 min read\",\n  },\n  {\n    id: \"a4\",\n    title: \"New Study Shows Promise for mRNA-Based Cancer Vaccines\",\n    source: \"Science Daily\",\n    publishedAt: \"8 hours ago\",\n    category: \"Research\",\n    readTime: \"6 min read\",\n  },\n  {\n    id: \"a5\",\n    title: \"Wearable Tech Companies Report Strong Q3 Earnings\",\n    source: \"Tech Health\",\n    publishedAt: \"1 day ago\",\n    category: \"MedTech\",\n    readTime: \"4 min read\",\n  },\n  {\n    id: \"a6\",\n    title: \"Regulatory Changes Could Accelerate Medical Device Approvals\",\n    source: \"Regulatory Affairs\",\n    publishedAt: \"1 day ago\",\n    category: \"Policy\",\n    readTime: \"5 min read\",\n  },\n];\n\nexport const menuItems = [\n  { id: \"documents\", title: \"Documents\", icon: \"file-text\" as const },\n  { id: \"payment\", title: \"Payment Methods\", icon: \"credit-card\" as const },\n  { id: \"notifications\", title: \"Notifications\", icon: \"bell\" as const },\n  { id: \"support\", title: \"Support\", icon: \"help-circle\" as const },\n  { id: \"legal\", title: \"Legal\", icon: \"shield\" as const },\n];\n\nexport interface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  points: number;\n  earned: boolean;\n  earnedAt?: string;\n}\n\nexport const achievements: Achievement[] = [\n  {\n    id: \"first-investment\",\n    name: \"First Steps\",\n    description: \"Make your first investment\",\n    icon: \"award\",\n    points: 100,\n    earned: true,\n    earnedAt: \"2025-01-15T10:30:00Z\",\n  },\n  {\n    id: \"diversified-portfolio\",\n    name: \"Diversified\",\n    description: \"Invest in 5 different categories\",\n    icon: \"pie-chart\",\n    points: 250,\n    earned: true,\n    earnedAt: \"2025-02-20T14:45:00Z\",\n  },\n  {\n    id: \"research-pro\",\n    name: \"Research Pro\",\n    description: \"Read 50 research articles\",\n    icon: \"book-open\",\n    points: 150,\n    earned: false,\n  },\n  {\n    id: \"early-bird\",\n    name: \"Early Bird\",\n    description: \"Be among the first 100 investors in a deal\",\n    icon: \"sunrise\",\n    points: 200,\n    earned: true,\n    earnedAt: \"2025-03-10T08:15:00Z\",\n  },\n  {\n    id: \"community-star\",\n    name: \"Community Star\",\n    description: \"Get 100 likes on your posts\",\n    icon: \"star\",\n    points: 300,\n    earned: false,\n  },\n  {\n    id: \"knowledge-seeker\",\n    name: \"Knowledge Seeker\",\n    description: \"Complete 10 courses\",\n    icon: \"book\",\n    points: 500,\n    earned: false,\n  },\n  {\n    id: \"ai-explorer\",\n    name: \"AI Explorer\",\n    description: \"Have 25 conversations with AI assistant\",\n    icon: \"cpu\",\n    points: 150,\n    earned: false,\n  },\n  {\n    id: \"big-investor\",\n    name: \"Big Investor\",\n    description: \"Invest over $10,000 total\",\n    icon: \"trending-up\",\n    points: 1000,\n    earned: false,\n  },\n];\n","path":null,"size_bytes":7939,"size_tokens":null},"client/components/MuteUser.tsx":{"content":"/**\n * Mute User Service and Components\n * Hide content without blocking\n */\n\nimport React, { useState, useCallback, useEffect, memo } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Modal,\n  FlatList,\n  Alert,\n  ActivityIndicator,\n  Image,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\nimport { usersApi } from '@/lib/api';\n\n// Types\nexport interface MutedUser {\n  id: number;\n  full_name: string;\n  username?: string;\n  avatar_url?: string;\n  muted_at: string;\n  mute_posts: boolean;\n  mute_comments: boolean;\n  mute_messages: boolean;\n  mute_notifications: boolean;\n  duration?: 'forever' | '1day' | '7days' | '30days';\n  expires_at?: string;\n}\n\nexport interface MuteOptions {\n  mute_posts: boolean;\n  mute_comments: boolean;\n  mute_messages: boolean;\n  mute_notifications: boolean;\n  duration: 'forever' | '1day' | '7days' | '30days';\n}\n\nconst STORAGE_KEY = 'muted_users';\n\n// =============================================================================\n// MUTE SERVICE\n// =============================================================================\n\nclass MuteService {\n  private mutedUsers: Map<number, MutedUser> = new Map();\n  private loaded: boolean = false;\n\n  async loadMutedUsers(): Promise<MutedUser[]> {\n    if (this.loaded) {\n      return Array.from(this.mutedUsers.values());\n    }\n\n    try {\n      const stored = await AsyncStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        const parsed = JSON.parse(stored) as MutedUser[];\n        // Filter out expired mutes\n        const now = new Date();\n        parsed.forEach(user => {\n          if (!user.expires_at || new Date(user.expires_at) > now) {\n            this.mutedUsers.set(user.id, user);\n          }\n        });\n      }\n      this.loaded = true;\n      return Array.from(this.mutedUsers.values());\n    } catch (error) {\n      console.error('[MuteService] Error loading muted users:', error);\n      return [];\n    }\n  }\n\n  private async persist(): Promise<void> {\n    try {\n      const users = Array.from(this.mutedUsers.values());\n      await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(users));\n    } catch (error) {\n      console.error('[MuteService] Error saving muted users:', error);\n    }\n  }\n\n  async muteUser(user: { id: number; full_name: string; username?: string; avatar_url?: string }, options: MuteOptions): Promise<void> {\n    await this.loadMutedUsers();\n\n    const now = new Date();\n    let expiresAt: string | undefined;\n\n    if (options.duration !== 'forever') {\n      const expiryDate = new Date(now);\n      switch (options.duration) {\n        case '1day':\n          expiryDate.setDate(expiryDate.getDate() + 1);\n          break;\n        case '7days':\n          expiryDate.setDate(expiryDate.getDate() + 7);\n          break;\n        case '30days':\n          expiryDate.setDate(expiryDate.getDate() + 30);\n          break;\n      }\n      expiresAt = expiryDate.toISOString();\n    }\n\n    const mutedUser: MutedUser = {\n      id: user.id,\n      full_name: user.full_name,\n      username: user.username,\n      avatar_url: user.avatar_url,\n      muted_at: now.toISOString(),\n      mute_posts: options.mute_posts,\n      mute_comments: options.mute_comments,\n      mute_messages: options.mute_messages,\n      mute_notifications: options.mute_notifications,\n      duration: options.duration,\n      expires_at: expiresAt,\n    };\n\n    this.mutedUsers.set(user.id, mutedUser);\n    await this.persist();\n\n    // TODO: Sync with backend\n    // await api.post(`/users/${user.id}/mute`, options);\n  }\n\n  async unmuteUser(userId: number): Promise<void> {\n    await this.loadMutedUsers();\n    this.mutedUsers.delete(userId);\n    await this.persist();\n\n    // TODO: Sync with backend\n    // await api.delete(`/users/${userId}/mute`);\n  }\n\n  async isUserMuted(userId: number): Promise<boolean> {\n    await this.loadMutedUsers();\n    const muted = this.mutedUsers.get(userId);\n    if (!muted) return false;\n\n    // Check if expired\n    if (muted.expires_at && new Date(muted.expires_at) <= new Date()) {\n      this.mutedUsers.delete(userId);\n      await this.persist();\n      return false;\n    }\n\n    return true;\n  }\n\n  async getMuteSettings(userId: number): Promise<MutedUser | null> {\n    await this.loadMutedUsers();\n    return this.mutedUsers.get(userId) || null;\n  }\n\n  async getAllMutedUsers(): Promise<MutedUser[]> {\n    await this.loadMutedUsers();\n    return Array.from(this.mutedUsers.values())\n      .sort((a, b) => new Date(b.muted_at).getTime() - new Date(a.muted_at).getTime());\n  }\n\n  shouldHidePost(userId: number): boolean {\n    const muted = this.mutedUsers.get(userId);\n    return muted?.mute_posts ?? false;\n  }\n\n  shouldHideComment(userId: number): boolean {\n    const muted = this.mutedUsers.get(userId);\n    return muted?.mute_comments ?? false;\n  }\n\n  shouldBlockMessages(userId: number): boolean {\n    const muted = this.mutedUsers.get(userId);\n    return muted?.mute_messages ?? false;\n  }\n\n  shouldHideNotifications(userId: number): boolean {\n    const muted = this.mutedUsers.get(userId);\n    return muted?.mute_notifications ?? false;\n  }\n}\n\nexport const muteService = new MuteService();\n\n// =============================================================================\n// MUTE OPTIONS MODAL\n// =============================================================================\n\ninterface MuteOptionsModalProps {\n  visible: boolean;\n  user: { id: number; full_name: string; username?: string; avatar_url?: string } | null;\n  onClose: () => void;\n  onMute: (options: MuteOptions) => void;\n}\n\nexport const MuteOptionsModal = memo(function MuteOptionsModal({\n  visible,\n  user,\n  onClose,\n  onMute,\n}: MuteOptionsModalProps) {\n  const { colors } = useThemeContext();\n  const [options, setOptions] = useState<MuteOptions>({\n    mute_posts: true,\n    mute_comments: true,\n    mute_messages: false,\n    mute_notifications: true,\n    duration: 'forever',\n  });\n\n  const durations = [\n    { value: '1day', label: '24 hours' },\n    { value: '7days', label: '7 days' },\n    { value: '30days', label: '30 days' },\n    { value: 'forever', label: 'Forever' },\n  ] as const;\n\n  const handleMute = () => {\n    haptics.buttonPress();\n    onMute(options);\n    onClose();\n  };\n\n  if (!user) return null;\n\n  return (\n    <Modal\n      visible={visible}\n      animationType=\"slide\"\n      presentationStyle=\"pageSheet\"\n      onRequestClose={onClose}\n    >\n      <View style={[styles.modalContainer, { backgroundColor: colors.background }]}>\n        {/* Header */}\n        <View style={[styles.modalHeader, { borderBottomColor: colors.border }]}>\n          <TouchableOpacity onPress={onClose}>\n            <ThemedText style={[styles.cancelText, { color: colors.textSecondary }]}>\n              Cancel\n            </ThemedText>\n          </TouchableOpacity>\n          <ThemedText style={[styles.modalTitle, { color: colors.textPrimary }]}>\n            Mute {user.full_name.split(' ')[0]}\n          </ThemedText>\n          <TouchableOpacity onPress={handleMute}>\n            <ThemedText style={[styles.muteText, { color: colors.primary }]}>\n              Mute\n            </ThemedText>\n          </TouchableOpacity>\n        </View>\n\n        {/* User info */}\n        <View style={styles.userInfo}>\n          {user.avatar_url ? (\n            <Image source={{ uri: user.avatar_url }} style={styles.avatar} />\n          ) : (\n            <View style={[styles.avatar, styles.avatarPlaceholder, { backgroundColor: colors.primary }]}>\n              <ThemedText style={styles.avatarText}>\n                {user.full_name.split(' ').map(n => n[0]).join('')}\n              </ThemedText>\n            </View>\n          )}\n          <View style={styles.userDetails}>\n            <ThemedText style={[styles.userName, { color: colors.textPrimary }]}>\n              {user.full_name}\n            </ThemedText>\n            {user.username && (\n              <ThemedText style={[styles.userHandle, { color: colors.textSecondary }]}>\n                @{user.username}\n              </ThemedText>\n            )}\n          </View>\n        </View>\n\n        {/* Info */}\n        <View style={[styles.infoBox, { backgroundColor: colors.backgroundSecondary }]}>\n          <Ionicons name=\"information-circle-outline\" size={20} color={colors.textSecondary} />\n          <ThemedText style={[styles.infoText, { color: colors.textSecondary }]}>\n            Muted users won't know they've been muted. You can unmute them anytime.\n          </ThemedText>\n        </View>\n\n        {/* Options */}\n        <View style={styles.optionsSection}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            WHAT TO MUTE\n          </ThemedText>\n          <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n            <TouchableOpacity\n              style={[styles.optionRow, { borderBottomColor: colors.border }]}\n              onPress={() => {\n                haptics.selection();\n                setOptions(o => ({ ...o, mute_posts: !o.mute_posts }));\n              }}\n            >\n              <Ionicons name=\"document-text-outline\" size={20} color={colors.textPrimary} />\n              <ThemedText style={[styles.optionLabel, { color: colors.textPrimary }]}>\n                Posts\n              </ThemedText>\n              <Ionicons\n                name={options.mute_posts ? 'checkbox' : 'square-outline'}\n                size={22}\n                color={options.mute_posts ? colors.primary : colors.textSecondary}\n              />\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={[styles.optionRow, { borderBottomColor: colors.border }]}\n              onPress={() => {\n                haptics.selection();\n                setOptions(o => ({ ...o, mute_comments: !o.mute_comments }));\n              }}\n            >\n              <Ionicons name=\"chatbubble-outline\" size={20} color={colors.textPrimary} />\n              <ThemedText style={[styles.optionLabel, { color: colors.textPrimary }]}>\n                Comments\n              </ThemedText>\n              <Ionicons\n                name={options.mute_comments ? 'checkbox' : 'square-outline'}\n                size={22}\n                color={options.mute_comments ? colors.primary : colors.textSecondary}\n              />\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={[styles.optionRow, { borderBottomColor: colors.border }]}\n              onPress={() => {\n                haptics.selection();\n                setOptions(o => ({ ...o, mute_messages: !o.mute_messages }));\n              }}\n            >\n              <Ionicons name=\"mail-outline\" size={20} color={colors.textPrimary} />\n              <ThemedText style={[styles.optionLabel, { color: colors.textPrimary }]}>\n                Messages\n              </ThemedText>\n              <Ionicons\n                name={options.mute_messages ? 'checkbox' : 'square-outline'}\n                size={22}\n                color={options.mute_messages ? colors.primary : colors.textSecondary}\n              />\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={styles.optionRow}\n              onPress={() => {\n                haptics.selection();\n                setOptions(o => ({ ...o, mute_notifications: !o.mute_notifications }));\n              }}\n            >\n              <Ionicons name=\"notifications-outline\" size={20} color={colors.textPrimary} />\n              <ThemedText style={[styles.optionLabel, { color: colors.textPrimary }]}>\n                Notifications\n              </ThemedText>\n              <Ionicons\n                name={options.mute_notifications ? 'checkbox' : 'square-outline'}\n                size={22}\n                color={options.mute_notifications ? colors.primary : colors.textSecondary}\n              />\n            </TouchableOpacity>\n          </View>\n        </View>\n\n        {/* Duration */}\n        <View style={styles.optionsSection}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            DURATION\n          </ThemedText>\n          <View style={[styles.optionsContainer, { backgroundColor: colors.surface }]}>\n            {durations.map((duration, index) => (\n              <TouchableOpacity\n                key={duration.value}\n                style={[\n                  styles.optionRow,\n                  index < durations.length - 1 && { borderBottomColor: colors.border, borderBottomWidth: 1 },\n                ]}\n                onPress={() => {\n                  haptics.selection();\n                  setOptions(o => ({ ...o, duration: duration.value }));\n                }}\n              >\n                <ThemedText style={[styles.optionLabel, { color: colors.textPrimary, marginLeft: 0 }]}>\n                  {duration.label}\n                </ThemedText>\n                {options.duration === duration.value && (\n                  <Ionicons name=\"checkmark\" size={22} color={colors.primary} />\n                )}\n              </TouchableOpacity>\n            ))}\n          </View>\n        </View>\n      </View>\n    </Modal>\n  );\n});\n\n// =============================================================================\n// MUTED USERS SCREEN\n// =============================================================================\n\nexport function MutedUsersScreen({ navigation }: any) {\n  const { colors } = useThemeContext();\n  const [mutedUsers, setMutedUsers] = useState<MutedUser[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    loadMutedUsers();\n  }, []);\n\n  const loadMutedUsers = async () => {\n    setIsLoading(true);\n    const users = await muteService.getAllMutedUsers();\n    setMutedUsers(users);\n    setIsLoading(false);\n  };\n\n  const handleUnmute = useCallback((user: MutedUser) => {\n    Alert.alert(\n      'Unmute User',\n      `Are you sure you want to unmute ${user.full_name}?`,\n      [\n        { text: 'Cancel', style: 'cancel' },\n        {\n          text: 'Unmute',\n          onPress: async () => {\n            haptics.buttonPress();\n            await muteService.unmuteUser(user.id);\n            setMutedUsers(prev => prev.filter(u => u.id !== user.id));\n          },\n        },\n      ]\n    );\n  }, []);\n\n  const formatDuration = (user: MutedUser): string => {\n    if (user.duration === 'forever') return 'Forever';\n    if (user.expires_at) {\n      const expires = new Date(user.expires_at);\n      const now = new Date();\n      const diff = expires.getTime() - now.getTime();\n      const days = Math.ceil(diff / (1000 * 60 * 60 * 24));\n      if (days <= 0) return 'Expired';\n      if (days === 1) return '1 day left';\n      return `${days} days left`;\n    }\n    return '';\n  };\n\n  const renderMutedUser = ({ item }: { item: MutedUser }) => (\n    <View style={[styles.mutedUserItem, { backgroundColor: colors.surface }]}>\n      {item.avatar_url ? (\n        <Image source={{ uri: item.avatar_url }} style={styles.listAvatar} />\n      ) : (\n        <View style={[styles.listAvatar, styles.avatarPlaceholder, { backgroundColor: colors.primary }]}>\n          <ThemedText style={styles.avatarText}>\n            {item.full_name.split(' ').map(n => n[0]).join('')}\n          </ThemedText>\n        </View>\n      )}\n      \n      <View style={styles.mutedUserInfo}>\n        <ThemedText style={[styles.mutedUserName, { color: colors.textPrimary }]}>\n          {item.full_name}\n        </ThemedText>\n        <ThemedText style={[styles.mutedUserMeta, { color: colors.textSecondary }]}>\n          {formatDuration(item)}\n        </ThemedText>\n      </View>\n\n      <TouchableOpacity\n        style={[styles.unmuteButton, { borderColor: colors.border }]}\n        onPress={() => handleUnmute(item)}\n      >\n        <ThemedText style={[styles.unmuteButtonText, { color: colors.textPrimary }]}>\n          Unmute\n        </ThemedText>\n      </TouchableOpacity>\n    </View>\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"volume-high-outline\" size={64} color={colors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: colors.textPrimary }]}>\n        No muted users\n      </ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: colors.textSecondary }]}>\n        Users you mute will appear here\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <View style={[styles.loadingContainer, { backgroundColor: colors.background }]}>\n        <ActivityIndicator size=\"large\" color={colors.primary} />\n      </View>\n    );\n  }\n\n  return (\n    <View style={[styles.screenContainer, { backgroundColor: colors.background }]}>\n      <FlatList\n        data={mutedUsers}\n        renderItem={renderMutedUser}\n        keyExtractor={(item) => item.id.toString()}\n        contentContainerStyle={mutedUsers.length === 0 ? styles.emptyList : styles.listContent}\n        ListEmptyComponent={renderEmpty}\n        ItemSeparatorComponent={() => <View style={{ height: Spacing.sm }} />}\n      />\n    </View>\n  );\n}\n\n// =============================================================================\n// HOOK\n// =============================================================================\n\nexport function useMuteUser() {\n  const [modalVisible, setModalVisible] = useState(false);\n  const [targetUser, setTargetUser] = useState<{ id: number; full_name: string; username?: string; avatar_url?: string } | null>(null);\n\n  const openMuteModal = useCallback((user: typeof targetUser) => {\n    setTargetUser(user);\n    setModalVisible(true);\n    haptics.modalOpen();\n  }, []);\n\n  const closeMuteModal = useCallback(() => {\n    setModalVisible(false);\n    setTargetUser(null);\n  }, []);\n\n  const handleMute = useCallback(async (options: MuteOptions) => {\n    if (!targetUser) return;\n    \n    await muteService.muteUser(targetUser, options);\n    haptics.success();\n    Alert.alert('User Muted', `${targetUser.full_name} has been muted.`);\n  }, [targetUser]);\n\n  const handleUnmute = useCallback(async (userId: number) => {\n    await muteService.unmuteUser(userId);\n    haptics.success();\n  }, []);\n\n  const isUserMuted = useCallback(async (userId: number) => {\n    return muteService.isUserMuted(userId);\n  }, []);\n\n  return {\n    modalVisible,\n    targetUser,\n    openMuteModal,\n    closeMuteModal,\n    handleMute,\n    handleUnmute,\n    isUserMuted,\n    MuteModal: () => (\n      <MuteOptionsModal\n        visible={modalVisible}\n        user={targetUser}\n        onClose={closeMuteModal}\n        onMute={handleMute}\n      />\n    ),\n  };\n}\n\nconst styles = StyleSheet.create({\n  // Modal styles\n  modalContainer: {\n    flex: 1,\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  cancelText: {\n    ...Typography.body,\n  },\n  modalTitle: {\n    ...Typography.heading,\n  },\n  muteText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n  },\n  avatar: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n  },\n  avatarPlaceholder: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  userDetails: {\n    marginLeft: Spacing.md,\n  },\n  userName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  userHandle: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  infoBox: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    marginHorizontal: Spacing.lg,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  infoText: {\n    ...Typography.small,\n    flex: 1,\n    lineHeight: 18,\n  },\n  optionsSection: {\n    marginTop: Spacing.xl,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    letterSpacing: 0.5,\n    marginHorizontal: Spacing.lg,\n    marginBottom: Spacing.sm,\n  },\n  optionsContainer: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  optionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  optionLabel: {\n    ...Typography.body,\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n\n  // Screen styles\n  screenContainer: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  listContent: {\n    padding: Spacing.lg,\n  },\n  emptyList: {\n    flexGrow: 1,\n  },\n  mutedUserItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    ...Shadows.card,\n  },\n  listAvatar: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n  },\n  mutedUserInfo: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  mutedUserName: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  mutedUserMeta: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  unmuteButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n  },\n  unmuteButtonText: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  emptyContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    marginTop: Spacing.sm,\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":21890,"size_tokens":null},"client/screens/RoomDetailScreen.tsx":{"content":"/**\n * RoomDetail Screen\n * View room info, members, and posts\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient, useInfiniteQuery } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { roomsApi, feedApi } from '@/lib/api';\nimport { Room, Post } from '@/types';\nimport { formatNumber } from '@/lib/utils';\nimport PostCard from '@/components/PostCard';\n\ntype RoomDetailRouteParams = {\n  RoomDetail: {\n    roomSlug: string;\n  };\n};\n\nexport default function RoomDetailScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<RoomDetailRouteParams, 'RoomDetail'>>();\n  const { roomSlug } = route.params;\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  // Fetch room details\n  const {\n    data: room,\n    isLoading: roomLoading,\n  } = useQuery({\n    queryKey: ['room', roomSlug],\n    queryFn: async () => {\n      const response = await roomsApi.getRoom(roomSlug);\n      return response.data;\n    },\n  });\n\n  // Fetch room posts\n  const {\n    data: feedData,\n    fetchNextPage,\n    hasNextPage,\n    isFetchingNextPage,\n    isRefetching,\n    refetch,\n  } = useInfiniteQuery({\n    queryKey: ['roomFeed', roomSlug],\n    queryFn: async ({ pageParam }) => {\n      const response = await feedApi.getRoomFeed(roomSlug, pageParam);\n      return response.data;\n    },\n    getNextPageParam: (lastPage) => lastPage?.next_cursor,\n    initialPageParam: undefined as string | undefined,\n  });\n\n  const posts = feedData?.pages.flatMap(page => page?.posts || []) || [];\n\n  // Join/Leave room mutation\n  const membershipMutation = useMutation({\n    mutationFn: async () => {\n      if (room?.is_member) {\n        return roomsApi.leaveRoom(roomSlug);\n      }\n      return roomsApi.joinRoom(roomSlug);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['room', roomSlug] });\n    },\n  });\n\n  const handleRefresh = useCallback(() => {\n    refetch();\n  }, [refetch]);\n\n  const handleLoadMore = useCallback(() => {\n    if (hasNextPage && !isFetchingNextPage) {\n      fetchNextPage();\n    }\n  }, [hasNextPage, isFetchingNextPage, fetchNextPage]);\n\n  const handleCreatePost = useCallback(() => {\n    navigation.navigate('CreatePost', { roomSlug });\n  }, [navigation, roomSlug]);\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const renderHeader = () => {\n    if (!room) return null;\n\n    return (\n      <View style={[styles.header, { backgroundColor: appColors.surface }]}>\n        {/* Room Banner */}\n        <LinearGradient\n          colors={[room.color, room.color + 'CC']}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.banner}\n        >\n          <ThemedText style={styles.roomIcon}>{room.icon}</ThemedText>\n        </LinearGradient>\n\n        {/* Room Info */}\n        <View style={styles.roomInfo}>\n          <ThemedText style={[styles.roomName, { color: appColors.textPrimary }]}>{room.name}</ThemedText>\n          <ThemedText style={[styles.roomDescription, { color: appColors.textSecondary }]}>{room.description}</ThemedText>\n\n          {/* Stats */}\n          <View style={[styles.statsRow, { borderColor: appColors.border }]}>\n            <View style={styles.statItem}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>\n                {formatNumber(room.members_count)}\n              </ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Members</ThemedText>\n            </View>\n            <View style={[styles.statDivider, { backgroundColor: appColors.border }]} />\n            <View style={styles.statItem}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>\n                {formatNumber(room.posts_count)}\n              </ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Posts</ThemedText>\n            </View>\n          </View>\n\n          {/* Actions */}\n          <View style={styles.actionsRow}>\n            <TouchableOpacity\n              style={[\n                styles.joinButton,\n                room.is_member && styles.joinedButton,\n              ]}\n              onPress={() => membershipMutation.mutate()}\n              disabled={membershipMutation.isPending}\n            >\n              {membershipMutation.isPending ? (\n                <ActivityIndicator size=\"small\" color={room.is_member ? appColors.textSecondary : 'white'} />\n              ) : (\n                <>\n                  <Ionicons\n                    name={room.is_member ? 'checkmark' : 'add'}\n                    size={18}\n                    color={room.is_member ? appColors.textSecondary : 'white'}\n                  />\n                  <ThemedText style={[\n                    styles.joinButtonText,\n                    room.is_member && [styles.joinedButtonText, { color: appColors.textSecondary }],\n                  ]}>\n                    {room.is_member ? 'Joined' : 'Join'}\n                  </ThemedText>\n                </>\n              )}\n            </TouchableOpacity>\n\n            {room.is_member && (\n              <TouchableOpacity style={styles.createButton} onPress={handleCreatePost}>\n                <Ionicons name=\"create-outline\" size={18} color={Colors.primary} />\n                <ThemedText style={styles.createButtonText}>Create Post</ThemedText>\n              </TouchableOpacity>\n            )}\n          </View>\n\n          {/* Rules */}\n          {room.rules && room.rules.length > 0 && (\n            <View style={styles.rulesSection}>\n              <ThemedText style={[styles.rulesTitle, { color: appColors.textSecondary }]}>Room Rules</ThemedText>\n              {room.rules.map((rule, index) => (\n                <View key={index} style={styles.ruleItem}>\n                  <ThemedText style={[styles.ruleNumber, { color: appColors.textSecondary }]}>{index + 1}.</ThemedText>\n                  <ThemedText style={[styles.ruleText, { color: appColors.textPrimary }]}>{rule}</ThemedText>\n                </View>\n              ))}\n            </View>\n          )}\n        </View>\n\n        {/* Posts Header */}\n        <View style={[styles.postsHeader, { borderTopColor: appColors.border }]}>\n          <ThemedText style={[styles.postsTitle, { color: appColors.textPrimary }]}>Posts</ThemedText>\n        </View>\n      </View>\n    );\n  };\n\n  const renderPost = ({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item.id)}\n      onUserPress={() => handleUserPress(item.author.id)}\n      onVote={() => {}}\n      onBookmark={() => {}}\n    />\n  );\n\n  const renderFooter = () => {\n    if (!isFetchingNextPage) return null;\n    return (\n      <View style={styles.loadingFooter}>\n        <ActivityIndicator size=\"small\" color={Colors.primary} />\n      </View>\n    );\n  };\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons name=\"document-text-outline\" size={48} color={appColors.textSecondary} />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No posts yet</ThemedText>\n      <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n        Be the first to post in this room!\n      </ThemedText>\n      {room?.is_member && (\n        <TouchableOpacity style={styles.emptyButton} onPress={handleCreatePost}>\n          <ThemedText style={styles.emptyButtonText}>Create Post</ThemedText>\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n\n  if (roomLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Navigation Header */}\n      <View style={[styles.navHeader, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.navTitle, { color: appColors.textPrimary }]} numberOfLines={1}>\n          {room?.name}\n        </ThemedText>\n        <TouchableOpacity style={styles.moreButton}>\n          <Ionicons name=\"ellipsis-horizontal\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      {/* Posts List */}\n      <FlatList\n        data={posts}\n        renderItem={renderPost}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderHeader}\n        ListFooterComponent={renderFooter}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={handleRefresh}\n            tintColor={Colors.primary}\n          />\n        }\n        onEndReached={handleLoadMore}\n        onEndReachedThreshold={0.5}\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  navHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  navTitle: {\n    ...Typography.heading,\n    flex: 1,\n    textAlign: 'center',\n  },\n  moreButton: {\n    padding: Spacing.sm,\n  },\n  header: {\n    marginBottom: Spacing.md,\n  },\n  banner: {\n    height: 120,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  roomIcon: {\n    fontSize: 48,\n  },\n  roomInfo: {\n    padding: Spacing.lg,\n  },\n  roomName: {\n    ...Typography.title,\n    marginBottom: Spacing.xs,\n  },\n  roomDescription: {\n    ...Typography.body,\n    lineHeight: 22,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginTop: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderTopWidth: 1,\n    borderBottomWidth: 1,\n  },\n  statItem: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  statDivider: {\n    width: 1,\n    height: 32,\n  },\n  statValue: {\n    ...Typography.heading,\n  },\n  statLabel: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  actionsRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.md,\n  },\n  joinButton: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.xs,\n  },\n  joinedButton: {\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  joinButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  joinedButtonText: {\n  },\n  createButton: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary + '15',\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.xs,\n  },\n  createButtonText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  rulesSection: {\n    marginTop: Spacing.lg,\n    padding: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n  },\n  rulesTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n    marginBottom: Spacing.sm,\n  },\n  ruleItem: {\n    flexDirection: 'row',\n    marginBottom: Spacing.xs,\n  },\n  ruleNumber: {\n    ...Typography.caption,\n    width: 20,\n  },\n  ruleText: {\n    ...Typography.caption,\n    flex: 1,\n  },\n  postsHeader: {\n    padding: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  postsTitle: {\n    ...Typography.heading,\n  },\n  loadingFooter: {\n    paddingVertical: Spacing.xl,\n    alignItems: 'center',\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n  emptyButton: {\n    marginTop: Spacing.xl,\n    backgroundColor: Colors.primary,\n    paddingHorizontal: Spacing.xl,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  emptyButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":13474,"size_tokens":null},"client/lib/storage.ts":{"content":"import AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst KEYS = {\n  AUTH_TOKEN: \"@medinvest/auth_token\",\n  USER: \"@medinvest/user\",\n  INVESTMENTS: \"@medinvest/investments\",\n  BOOKMARKS: \"@medinvest/bookmarks\",\n};\n\nexport interface User {\n  id: string;\n  name: string;\n  email: string;\n  verified: boolean;\n  avatarUrl?: string;\n}\n\nexport interface Investment {\n  id: string;\n  opportunityId: string;\n  amount: number;\n  date: string;\n  status: \"pending\" | \"active\" | \"completed\";\n}\n\nexport const storage = {\n  async getUser(): Promise<User | null> {\n    try {\n      const data = await AsyncStorage.getItem(KEYS.USER);\n      return data ? JSON.parse(data) : null;\n    } catch {\n      return null;\n    }\n  },\n\n  async setUser(user: User): Promise<void> {\n    try {\n      await AsyncStorage.setItem(KEYS.USER, JSON.stringify(user));\n    } catch (error) {\n      console.error(\"Failed to save user:\", error);\n    }\n  },\n\n  async clearUser(): Promise<void> {\n    try {\n      await AsyncStorage.removeItem(KEYS.USER);\n      await AsyncStorage.removeItem(KEYS.AUTH_TOKEN);\n    } catch (error) {\n      console.error(\"Failed to clear user:\", error);\n    }\n  },\n\n  async getInvestments(): Promise<Investment[]> {\n    try {\n      const data = await AsyncStorage.getItem(KEYS.INVESTMENTS);\n      return data ? JSON.parse(data) : [];\n    } catch {\n      return [];\n    }\n  },\n\n  async saveInvestment(investment: Investment): Promise<void> {\n    try {\n      const investments = await this.getInvestments();\n      investments.push(investment);\n      await AsyncStorage.setItem(KEYS.INVESTMENTS, JSON.stringify(investments));\n    } catch (error) {\n      console.error(\"Failed to save investment:\", error);\n    }\n  },\n\n  async clearInvestments(): Promise<void> {\n    try {\n      await AsyncStorage.removeItem(KEYS.INVESTMENTS);\n    } catch (error) {\n      console.error(\"Failed to clear investments:\", error);\n    }\n  },\n\n  async getBookmarks(): Promise<string[]> {\n    try {\n      const data = await AsyncStorage.getItem(KEYS.BOOKMARKS);\n      return data ? JSON.parse(data) : [];\n    } catch {\n      return [];\n    }\n  },\n\n  async toggleBookmark(articleId: string): Promise<boolean> {\n    try {\n      const bookmarks = await this.getBookmarks();\n      const index = bookmarks.indexOf(articleId);\n      if (index > -1) {\n        bookmarks.splice(index, 1);\n      } else {\n        bookmarks.push(articleId);\n      }\n      await AsyncStorage.setItem(KEYS.BOOKMARKS, JSON.stringify(bookmarks));\n      return index === -1;\n    } catch {\n      return false;\n    }\n  },\n\n  async clearAll(): Promise<void> {\n    try {\n      await AsyncStorage.multiRemove(Object.values(KEYS));\n    } catch (error) {\n      console.error(\"Failed to clear storage:\", error);\n    }\n  },\n};\n","path":null,"size_bytes":2765,"size_tokens":null},"client/lib/error-tracking.ts":{"content":"/**\n * Error Tracking Service\n * Sentry integration for error monitoring\n */\n\nimport * as Sentry from '@sentry/react-native';\nimport { Platform } from 'react-native';\n\n// Error severity levels\nexport type ErrorSeverity = 'fatal' | 'error' | 'warning' | 'info' | 'debug';\n\n// Error context\nexport interface ErrorContext {\n  screen?: string;\n  action?: string;\n  userId?: number;\n  extra?: Record<string, unknown>;\n}\n\nclass ErrorTrackingService {\n  private isInitialized: boolean = false;\n  private userId: string | null = null;\n\n  /**\n   * Initialize Sentry\n   */\n  initialize(): void {\n    if (this.isInitialized) return;\n\n    const dsn = process.env.EXPO_PUBLIC_SENTRY_DSN;\n    \n    if (!dsn) {\n      console.warn('[ErrorTracking] Sentry DSN not configured');\n      return;\n    }\n\n    Sentry.init({\n      dsn,\n      environment: __DEV__ ? 'development' : 'production',\n      enableAutoSessionTracking: true,\n      sessionTrackingIntervalMillis: 30000,\n      enableNativeCrashHandling: true,\n      attachStacktrace: true,\n      \n      // Performance monitoring\n      tracesSampleRate: __DEV__ ? 1.0 : 0.2,\n      \n      // Release info\n      release: process.env.EXPO_PUBLIC_APP_VERSION || '1.0.0',\n      dist: process.env.EXPO_PUBLIC_BUILD_NUMBER || '1',\n      \n      // Filter events\n      beforeSend: (event) => {\n        // Don't send events in development\n        if (__DEV__) {\n          console.log('[ErrorTracking] Event captured (dev):', event);\n          return null;\n        }\n\n        // Filter out known non-errors\n        if (event.exception?.values?.[0]?.type === 'NetworkError') {\n          // Log network errors but don't send to Sentry\n          return null;\n        }\n\n        return event;\n      },\n\n      // Configure breadcrumbs\n      beforeBreadcrumb: (breadcrumb) => {\n        // Filter out noisy breadcrumbs\n        if (breadcrumb.category === 'console' && breadcrumb.level === 'debug') {\n          return null;\n        }\n        return breadcrumb;\n      },\n\n      // Integrations\n      integrations: [\n        // Add custom integrations here\n      ],\n    });\n\n    // Set default context\n    Sentry.setContext('app', {\n      platform: Platform.OS,\n      platformVersion: Platform.Version,\n    });\n\n    this.isInitialized = true;\n    console.log('[ErrorTracking] Sentry initialized');\n  }\n\n  /**\n   * Identify user for error tracking\n   */\n  identifyUser(userId: number, email?: string, username?: string): void {\n    this.userId = userId.toString();\n\n    Sentry.setUser({\n      id: userId.toString(),\n      email,\n      username,\n    });\n  }\n\n  /**\n   * Clear user identity\n   */\n  clearUser(): void {\n    this.userId = null;\n    Sentry.setUser(null);\n  }\n\n  /**\n   * Capture an exception\n   */\n  captureException(error: Error, context?: ErrorContext): string {\n    if (!this.isInitialized) {\n      console.error('[ErrorTracking] Not initialized:', error);\n      return '';\n    }\n\n    // Set scope context\n    Sentry.withScope((scope) => {\n      if (context?.screen) {\n        scope.setTag('screen', context.screen);\n      }\n      if (context?.action) {\n        scope.setTag('action', context.action);\n      }\n      if (context?.userId) {\n        scope.setUser({ id: context.userId.toString() });\n      }\n      if (context?.extra) {\n        scope.setExtras(context.extra);\n      }\n\n      Sentry.captureException(error);\n    });\n\n    return Sentry.lastEventId() || '';\n  }\n\n  /**\n   * Capture a message\n   */\n  captureMessage(message: string, severity: ErrorSeverity = 'info', context?: ErrorContext): void {\n    if (!this.isInitialized) {\n      console.log('[ErrorTracking] Not initialized:', message);\n      return;\n    }\n\n    Sentry.withScope((scope) => {\n      scope.setLevel(severity);\n      \n      if (context?.screen) {\n        scope.setTag('screen', context.screen);\n      }\n      if (context?.extra) {\n        scope.setExtras(context.extra);\n      }\n\n      Sentry.captureMessage(message);\n    });\n  }\n\n  /**\n   * Add breadcrumb\n   */\n  addBreadcrumb(\n    message: string,\n    category: string = 'custom',\n    level: ErrorSeverity = 'info',\n    data?: Record<string, unknown>\n  ): void {\n    Sentry.addBreadcrumb({\n      message,\n      category,\n      level,\n      data,\n      timestamp: Date.now() / 1000,\n    });\n  }\n\n  /**\n   * Set tag for all future events\n   */\n  setTag(key: string, value: string): void {\n    Sentry.setTag(key, value);\n  }\n\n  /**\n   * Set extra context for all future events\n   */\n  setExtra(key: string, value: unknown): void {\n    Sentry.setExtra(key, value);\n  }\n\n  /**\n   * Set context for all future events\n   */\n  setContext(name: string, context: Record<string, unknown>): void {\n    Sentry.setContext(name, context);\n  }\n\n  /**\n   * Start a transaction for performance monitoring\n   */\n  startTransaction(name: string, operation: string): Sentry.Transaction | null {\n    if (!this.isInitialized) return null;\n\n    return Sentry.startTransaction({\n      name,\n      op: operation,\n    });\n  }\n\n  /**\n   * Wrap an async function with error tracking\n   */\n  async wrapAsync<T>(\n    fn: () => Promise<T>,\n    operationName: string,\n    context?: ErrorContext\n  ): Promise<T> {\n    const transaction = this.startTransaction(operationName, 'task');\n    \n    try {\n      const result = await fn();\n      transaction?.setStatus('ok');\n      return result;\n    } catch (error) {\n      transaction?.setStatus('internal_error');\n      this.captureException(error as Error, context);\n      throw error;\n    } finally {\n      transaction?.finish();\n    }\n  }\n\n  /**\n   * Create error boundary handler\n   */\n  createErrorBoundaryHandler(componentName: string) {\n    return (error: Error, componentStack: string) => {\n      this.captureException(error, {\n        screen: componentName,\n        extra: { componentStack },\n      });\n    };\n  }\n\n  /**\n   * Flush pending events\n   */\n  async flush(timeout: number = 2000): Promise<boolean> {\n    return Sentry.flush(timeout);\n  }\n\n  /**\n   * Close Sentry\n   */\n  async close(timeout: number = 2000): Promise<void> {\n    await Sentry.close(timeout);\n    this.isInitialized = false;\n  }\n}\n\nexport const errorTracking = new ErrorTrackingService();\n\n// Global error handler for unhandled errors\nexport function setupGlobalErrorHandler(): void {\n  const defaultHandler = ErrorUtils.getGlobalHandler();\n\n  ErrorUtils.setGlobalHandler((error, isFatal) => {\n    errorTracking.captureException(error, {\n      extra: { isFatal },\n    });\n\n    // Call default handler\n    defaultHandler?.(error, isFatal);\n  });\n\n  // Handle unhandled promise rejections\n  if (typeof global !== 'undefined') {\n    const originalHandler = (global as any).onunhandledrejection;\n    \n    (global as any).onunhandledrejection = (event: PromiseRejectionEvent) => {\n      errorTracking.captureException(\n        event.reason instanceof Error ? event.reason : new Error(String(event.reason)),\n        { extra: { type: 'unhandled_promise_rejection' } }\n      );\n      \n      originalHandler?.(event);\n    };\n  }\n}\n\n// React error boundary wrapper\nexport const SentryErrorBoundary = Sentry.ErrorBoundary;\n\n// HOC for wrapping screens with error boundary\nexport function withErrorBoundary<P extends object>(\n  Component: React.ComponentType<P>,\n  fallback?: React.ReactNode\n) {\n  return Sentry.withErrorBoundary(Component, {\n    fallback: fallback as React.ReactElement,\n    showDialog: false,\n  });\n}\n","path":null,"size_bytes":7359,"size_tokens":null},"client/screens/ContentPreferencesScreen.tsx":{"content":"/**\n * Content Preferences Screen\n * Filter and customize content settings\n */\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport {\n  View,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Switch,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useThemeContext } from '@/contexts/ThemeContext';\nimport { haptics } from '@/lib/haptics';\n\n// Content preferences\ninterface ContentPreferences {\n  // Content filtering\n  hideNSFW: boolean;\n  blurSensitiveImages: boolean;\n  hideSpoilers: boolean;\n  \n  // Feed preferences\n  showTrendingPosts: boolean;\n  showSuggestedUsers: boolean;\n  showPromotedContent: boolean;\n  \n  // Post display\n  autoplayVideos: 'always' | 'wifi' | 'never';\n  reduceAnimations: boolean;\n  compactMode: boolean;\n  \n  // Language & Region\n  contentLanguages: string[];\n  translatePosts: boolean;\n  \n  // Keywords\n  mutedKeywords: string[];\n  \n  // Interaction preferences\n  showPostMetrics: boolean; // likes, comments count\n  showUserBadges: boolean;\n  confirmBeforePosting: boolean;\n}\n\nconst DEFAULT_PREFERENCES: ContentPreferences = {\n  hideNSFW: true,\n  blurSensitiveImages: true,\n  hideSpoilers: false,\n  showTrendingPosts: true,\n  showSuggestedUsers: true,\n  showPromotedContent: true,\n  autoplayVideos: 'wifi',\n  reduceAnimations: false,\n  compactMode: false,\n  contentLanguages: ['en'],\n  translatePosts: false,\n  mutedKeywords: [],\n  showPostMetrics: true,\n  showUserBadges: true,\n  confirmBeforePosting: false,\n};\n\nconst STORAGE_KEY = 'content_preferences';\n\nexport default function ContentPreferencesScreen() {\n  const navigation = useNavigation<any>();\n  const { colors } = useThemeContext();\n  const [preferences, setPreferences] = useState<ContentPreferences>(DEFAULT_PREFERENCES);\n  const [isLoading, setIsLoading] = useState(true);\n  const [newKeyword, setNewKeyword] = useState('');\n\n  useEffect(() => {\n    loadPreferences();\n  }, []);\n\n  const loadPreferences = async () => {\n    try {\n      const stored = await AsyncStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        setPreferences({ ...DEFAULT_PREFERENCES, ...JSON.parse(stored) });\n      }\n    } catch (error) {\n      console.error('Error loading content preferences:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const savePreferences = async (newPrefs: ContentPreferences) => {\n    try {\n      await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(newPrefs));\n    } catch (error) {\n      console.error('Error saving content preferences:', error);\n    }\n  };\n\n  const updatePreference = useCallback(<K extends keyof ContentPreferences>(\n    key: K,\n    value: ContentPreferences[K]\n  ) => {\n    haptics.toggle();\n    const newPrefs = { ...preferences, [key]: value };\n    setPreferences(newPrefs);\n    savePreferences(newPrefs);\n  }, [preferences]);\n\n  const addMutedKeyword = useCallback(() => {\n    const keyword = newKeyword.trim().toLowerCase();\n    if (!keyword) return;\n    if (preferences.mutedKeywords.includes(keyword)) {\n      Alert.alert('Already Added', 'This keyword is already in your muted list.');\n      return;\n    }\n\n    haptics.success();\n    const newKeywords = [...preferences.mutedKeywords, keyword];\n    updatePreference('mutedKeywords', newKeywords);\n    setNewKeyword('');\n  }, [newKeyword, preferences.mutedKeywords, updatePreference]);\n\n  const removeMutedKeyword = useCallback((keyword: string) => {\n    haptics.buttonPress();\n    const newKeywords = preferences.mutedKeywords.filter(k => k !== keyword);\n    updatePreference('mutedKeywords', newKeywords);\n  }, [preferences.mutedKeywords, updatePreference]);\n\n  const renderSwitch = (\n    key: keyof ContentPreferences,\n    label: string,\n    description?: string\n  ) => (\n    <View style={[styles.settingRow, { borderBottomColor: colors.border }]}>\n      <View style={styles.settingInfo}>\n        <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n          {label}\n        </ThemedText>\n        {description && (\n          <ThemedText style={[styles.settingDescription, { color: colors.textSecondary }]}>\n            {description}\n          </ThemedText>\n        )}\n      </View>\n      <Switch\n        value={preferences[key] as boolean}\n        onValueChange={(value) => updatePreference(key, value)}\n        trackColor={{ false: colors.border, true: colors.primary + '80' }}\n        thumbColor={preferences[key] ? colors.primary : colors.textSecondary}\n      />\n    </View>\n  );\n\n  const renderSelectOption = (\n    key: keyof ContentPreferences,\n    label: string,\n    options: { value: string; label: string }[],\n    description?: string\n  ) => (\n    <View style={styles.settingSection}>\n      <View style={styles.settingHeader}>\n        <ThemedText style={[styles.settingLabel, { color: colors.textPrimary }]}>\n          {label}\n        </ThemedText>\n        {description && (\n          <ThemedText style={[styles.settingDescription, { color: colors.textSecondary }]}>\n            {description}\n          </ThemedText>\n        )}\n      </View>\n      <View style={styles.optionsRow}>\n        {options.map((option) => (\n          <TouchableOpacity\n            key={option.value}\n            style={[\n              styles.optionButton,\n              {\n                backgroundColor: preferences[key] === option.value\n                  ? colors.primary\n                  : colors.backgroundSecondary,\n                borderColor: preferences[key] === option.value\n                  ? colors.primary\n                  : colors.border,\n              },\n            ]}\n            onPress={() => updatePreference(key, option.value as any)}\n          >\n            <ThemedText\n              style={[\n                styles.optionText,\n                { color: preferences[key] === option.value ? 'white' : colors.textPrimary },\n              ]}\n            >\n              {option.label}\n            </ThemedText>\n          </TouchableOpacity>\n        ))}\n      </View>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={colors.primary} />\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { borderBottomColor: colors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={colors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: colors.textPrimary }]}>\n          Content Preferences\n        </ThemedText>\n        <View style={styles.headerRight} />\n      </View>\n\n      <ScrollView style={styles.content} showsVerticalScrollIndicator={false}>\n        {/* Content Filtering */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            CONTENT FILTERING\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('hideNSFW', 'Hide sensitive content', 'Hide posts marked as sensitive')}\n          {renderSwitch('blurSensitiveImages', 'Blur sensitive images', 'Blur images until you tap to reveal')}\n          {renderSwitch('hideSpoilers', 'Hide spoilers', 'Collapse spoiler-tagged content')}\n        </View>\n\n        {/* Feed Preferences */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            FEED PREFERENCES\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('showTrendingPosts', 'Show trending posts', 'Include trending content in your feed')}\n          {renderSwitch('showSuggestedUsers', 'Show suggested users', 'See people you may want to follow')}\n          {renderSwitch('showPromotedContent', 'Show promoted content', 'See sponsored posts and deals')}\n        </View>\n\n        {/* Media Settings */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            MEDIA\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface, paddingVertical: Spacing.md }]}>\n          {renderSelectOption(\n            'autoplayVideos',\n            'Autoplay videos',\n            [\n              { value: 'always', label: 'Always' },\n              { value: 'wifi', label: 'Wi-Fi only' },\n              { value: 'never', label: 'Never' },\n            ],\n            'Automatically play videos in feed'\n          )}\n        </View>\n\n        {/* Display */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            DISPLAY\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('compactMode', 'Compact mode', 'Show more posts with smaller cards')}\n          {renderSwitch('reduceAnimations', 'Reduce animations', 'Minimize motion effects')}\n          {renderSwitch('showPostMetrics', 'Show post metrics', 'Display likes and comment counts')}\n          {renderSwitch('showUserBadges', 'Show user badges', 'Display verification and achievement badges')}\n        </View>\n\n        {/* Posting */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            POSTING\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {renderSwitch('confirmBeforePosting', 'Confirm before posting', 'Show confirmation dialog before publishing')}\n          {renderSwitch('translatePosts', 'Auto-translate posts', 'Translate posts in other languages')}\n        </View>\n\n        {/* Muted Keywords */}\n        <View style={styles.sectionHeader}>\n          <ThemedText style={[styles.sectionTitle, { color: colors.textSecondary }]}>\n            MUTED KEYWORDS\n          </ThemedText>\n          <ThemedText style={[styles.sectionSubtitle, { color: colors.textSecondary }]}>\n            Posts containing these words will be hidden from your feed\n          </ThemedText>\n        </View>\n        <View style={[styles.section, { backgroundColor: colors.surface }]}>\n          {/* Add keyword input */}\n          <TouchableOpacity\n            style={[styles.addKeywordButton, { borderBottomColor: colors.border }]}\n            onPress={() => {\n              Alert.prompt(\n                'Add Muted Keyword',\n                'Enter a word or phrase to mute',\n                [\n                  { text: 'Cancel', style: 'cancel' },\n                  {\n                    text: 'Add',\n                    onPress: (text) => {\n                      if (text?.trim()) {\n                        const keyword = text.trim().toLowerCase();\n                        if (!preferences.mutedKeywords.includes(keyword)) {\n                          haptics.success();\n                          updatePreference('mutedKeywords', [...preferences.mutedKeywords, keyword]);\n                        }\n                      }\n                    },\n                  },\n                ],\n                'plain-text'\n              );\n            }}\n          >\n            <Ionicons name=\"add-circle-outline\" size={22} color={colors.primary} />\n            <ThemedText style={[styles.addKeywordText, { color: colors.primary }]}>\n              Add keyword\n            </ThemedText>\n          </TouchableOpacity>\n\n          {/* Keyword list */}\n          {preferences.mutedKeywords.length === 0 ? (\n            <View style={styles.emptyKeywords}>\n              <ThemedText style={[styles.emptyKeywordsText, { color: colors.textSecondary }]}>\n                No muted keywords\n              </ThemedText>\n            </View>\n          ) : (\n            <View style={styles.keywordsList}>\n              {preferences.mutedKeywords.map((keyword) => (\n                <View\n                  key={keyword}\n                  style={[styles.keywordChip, { backgroundColor: colors.backgroundSecondary }]}\n                >\n                  <ThemedText style={[styles.keywordText, { color: colors.textPrimary }]}>\n                    {keyword}\n                  </ThemedText>\n                  <TouchableOpacity\n                    style={styles.removeKeyword}\n                    onPress={() => removeMutedKeyword(keyword)}\n                  >\n                    <Ionicons name=\"close-circle\" size={18} color={colors.textSecondary} />\n                  </TouchableOpacity>\n                </View>\n              ))}\n            </View>\n          )}\n        </View>\n\n        {/* Reset */}\n        <TouchableOpacity\n          style={[styles.resetButton, { borderColor: colors.error }]}\n          onPress={() => {\n            Alert.alert(\n              'Reset Preferences',\n              'Are you sure you want to reset all content preferences to default?',\n              [\n                { text: 'Cancel', style: 'cancel' },\n                {\n                  text: 'Reset',\n                  style: 'destructive',\n                  onPress: () => {\n                    haptics.warning();\n                    setPreferences(DEFAULT_PREFERENCES);\n                    savePreferences(DEFAULT_PREFERENCES);\n                  },\n                },\n              ]\n            );\n          }}\n        >\n          <ThemedText style={[styles.resetButtonText, { color: colors.error }]}>\n            Reset to Defaults\n          </ThemedText>\n        </TouchableOpacity>\n\n        <View style={{ height: 40 }} />\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\n// Export preferences service for use in other components\nexport const contentPreferencesService = {\n  async get(): Promise<ContentPreferences> {\n    try {\n      const stored = await AsyncStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        return { ...DEFAULT_PREFERENCES, ...JSON.parse(stored) };\n      }\n    } catch (error) {\n      console.error('Error loading content preferences:', error);\n    }\n    return DEFAULT_PREFERENCES;\n  },\n\n  async shouldHidePost(content: string, keywords: string[]): Promise<boolean> {\n    const prefs = await this.get();\n    const mutedKeywords = prefs.mutedKeywords;\n    if (mutedKeywords.length === 0) return false;\n\n    const lowerContent = content.toLowerCase();\n    return mutedKeywords.some(keyword => lowerContent.includes(keyword));\n  },\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n  },\n  headerRight: {\n    width: 40,\n  },\n  content: {\n    flex: 1,\n  },\n  sectionHeader: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.xl,\n    paddingBottom: Spacing.sm,\n  },\n  sectionTitle: {\n    ...Typography.small,\n    fontWeight: '600',\n    letterSpacing: 0.5,\n  },\n  sectionSubtitle: {\n    ...Typography.small,\n    marginTop: 4,\n  },\n  section: {\n    marginHorizontal: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n    ...Shadows.card,\n  },\n  settingRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n  },\n  settingInfo: {\n    flex: 1,\n    marginRight: Spacing.md,\n  },\n  settingLabel: {\n    ...Typography.body,\n  },\n  settingDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  settingSection: {\n    padding: Spacing.lg,\n  },\n  settingHeader: {\n    marginBottom: Spacing.md,\n  },\n  optionsRow: {\n    flexDirection: 'row',\n    gap: Spacing.sm,\n  },\n  optionButton: {\n    flex: 1,\n    paddingVertical: Spacing.sm,\n    paddingHorizontal: Spacing.md,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    alignItems: 'center',\n  },\n  optionText: {\n    ...Typography.caption,\n    fontWeight: '600',\n  },\n  addKeywordButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    gap: Spacing.sm,\n  },\n  addKeywordText: {\n    ...Typography.body,\n    fontWeight: '500',\n  },\n  emptyKeywords: {\n    padding: Spacing.lg,\n    alignItems: 'center',\n  },\n  emptyKeywordsText: {\n    ...Typography.caption,\n  },\n  keywordsList: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    padding: Spacing.md,\n    gap: Spacing.sm,\n  },\n  keywordChip: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingLeft: Spacing.md,\n    paddingRight: Spacing.xs,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  keywordText: {\n    ...Typography.caption,\n  },\n  removeKeyword: {\n    padding: 2,\n  },\n  resetButton: {\n    marginHorizontal: Spacing.lg,\n    marginTop: Spacing.xl,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    alignItems: 'center',\n  },\n  resetButtonText: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n});\n","path":null,"size_bytes":17904,"size_tokens":null},"client/lib/api.ts":{"content":"/**\n * MedInvest API Client\n * Connects to the Flask backend REST API\n */\n\nimport * as SecureStore from 'expo-secure-store';\nimport { Platform } from 'react-native';\nimport { Notification as NotificationFromTypes } from '@/types';\n\n// Configuration\nconst getApiBaseUrl = () => {\n  const domain = process.env.EXPO_PUBLIC_DOMAIN || 'localhost:5000';\n  const protocol = domain.includes('localhost') ? 'http' : 'https';\n  return `${protocol}://${domain}/api`;\n};\n\nconst API_BASE_URL = getApiBaseUrl();\n\n// Token storage keys\nconst ACCESS_TOKEN_KEY = 'medinvest_access_token';\nconst REFRESH_TOKEN_KEY = 'medinvest_refresh_token';\n\n// Types\nexport interface ApiError {\n  error: string;\n  message?: string;\n  status?: number;\n}\n\nexport interface ApiResponse<T> {\n  data?: T;\n  error?: ApiError;\n  success: boolean;\n}\n\n// Token management\nclass TokenManager {\n  private accessToken: string | null = null;\n  private refreshToken: string | null = null;\n\n  async getAccessToken(): Promise<string | null> {\n    if (this.accessToken) return this.accessToken;\n    \n    if (Platform.OS === 'web') {\n      this.accessToken = localStorage.getItem(ACCESS_TOKEN_KEY);\n    } else {\n      this.accessToken = await SecureStore.getItemAsync(ACCESS_TOKEN_KEY);\n    }\n    return this.accessToken;\n  }\n\n  async getRefreshToken(): Promise<string | null> {\n    if (this.refreshToken) return this.refreshToken;\n    \n    if (Platform.OS === 'web') {\n      this.refreshToken = localStorage.getItem(REFRESH_TOKEN_KEY);\n    } else {\n      this.refreshToken = await SecureStore.getItemAsync(REFRESH_TOKEN_KEY);\n    }\n    return this.refreshToken;\n  }\n\n  async setTokens(access: string, refresh: string): Promise<void> {\n    this.accessToken = access;\n    this.refreshToken = refresh;\n    \n    if (Platform.OS === 'web') {\n      localStorage.setItem(ACCESS_TOKEN_KEY, access);\n      localStorage.setItem(REFRESH_TOKEN_KEY, refresh);\n    } else {\n      await SecureStore.setItemAsync(ACCESS_TOKEN_KEY, access);\n      await SecureStore.setItemAsync(REFRESH_TOKEN_KEY, refresh);\n    }\n  }\n\n  async clearTokens(): Promise<void> {\n    this.accessToken = null;\n    this.refreshToken = null;\n    \n    if (Platform.OS === 'web') {\n      localStorage.removeItem(ACCESS_TOKEN_KEY);\n      localStorage.removeItem(REFRESH_TOKEN_KEY);\n    } else {\n      await SecureStore.deleteItemAsync(ACCESS_TOKEN_KEY);\n      await SecureStore.deleteItemAsync(REFRESH_TOKEN_KEY);\n    }\n  }\n}\n\nexport const tokenManager = new TokenManager();\n\n// API Client\nclass ApiClient {\n  private baseUrl: string;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<ApiResponse<T>> {\n    const url = `${this.baseUrl}${endpoint}`;\n    const accessToken = await tokenManager.getAccessToken();\n\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    if (accessToken) {\n      (headers as Record<string, string>)['Authorization'] = `Bearer ${accessToken}`;\n    }\n\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers,\n      });\n\n      // Handle token refresh on 401\n      if (response.status === 401 && !endpoint.includes('/auth/')) {\n        const refreshed = await this.refreshAccessToken();\n        if (refreshed) {\n          // Retry the request with new token\n          const newAccessToken = await tokenManager.getAccessToken();\n          (headers as Record<string, string>)['Authorization'] = `Bearer ${newAccessToken}`;\n          const retryResponse = await fetch(url, { ...options, headers });\n          return this.handleResponse<T>(retryResponse);\n        }\n      }\n\n      return this.handleResponse<T>(response);\n    } catch (error) {\n      return {\n        success: false,\n        error: {\n          error: 'network_error',\n          message: error instanceof Error ? error.message : 'Network request failed',\n        },\n      };\n    }\n  }\n\n  private async handleResponse<T>(response: Response): Promise<ApiResponse<T>> {\n    try {\n      const data = await response.json();\n      \n      if (!response.ok) {\n        return {\n          success: false,\n          error: {\n            error: data.error || 'request_failed',\n            message: data.message || `Request failed with status ${response.status}`,\n            status: response.status,\n          },\n        };\n      }\n\n      return {\n        success: true,\n        data,\n      };\n    } catch {\n      return {\n        success: false,\n        error: {\n          error: 'parse_error',\n          message: 'Failed to parse response',\n          status: response.status,\n        },\n      };\n    }\n  }\n\n  private async refreshAccessToken(): Promise<boolean> {\n    const refreshToken = await tokenManager.getRefreshToken();\n    if (!refreshToken) return false;\n\n    try {\n      const response = await fetch(`${this.baseUrl}/auth/refresh`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${refreshToken}`,\n        },\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        await tokenManager.setTokens(data.access_token, data.refresh_token);\n        return true;\n      }\n    } catch {\n      // Refresh failed\n    }\n\n    await tokenManager.clearTokens();\n    return false;\n  }\n\n  // HTTP methods\n  async get<T>(endpoint: string): Promise<ApiResponse<T>> {\n    return this.request<T>(endpoint, { method: 'GET' });\n  }\n\n  async post<T>(endpoint: string, body?: unknown): Promise<ApiResponse<T>> {\n    return this.request<T>(endpoint, {\n      method: 'POST',\n      body: body ? JSON.stringify(body) : undefined,\n    });\n  }\n\n  async put<T>(endpoint: string, body?: unknown): Promise<ApiResponse<T>> {\n    return this.request<T>(endpoint, {\n      method: 'PUT',\n      body: body ? JSON.stringify(body) : undefined,\n    });\n  }\n\n  async patch<T>(endpoint: string, body?: unknown): Promise<ApiResponse<T>> {\n    return this.request<T>(endpoint, {\n      method: 'PATCH',\n      body: body ? JSON.stringify(body) : undefined,\n    });\n  }\n\n  async delete<T>(endpoint: string): Promise<ApiResponse<T>> {\n    return this.request<T>(endpoint, { method: 'DELETE' });\n  }\n\n  // File upload\n  async upload<T>(endpoint: string, formData: FormData): Promise<ApiResponse<T>> {\n    const url = `${this.baseUrl}${endpoint}`;\n    const accessToken = await tokenManager.getAccessToken();\n\n    const headers: HeadersInit = {};\n    if (accessToken) {\n      (headers as Record<string, string>)['Authorization'] = `Bearer ${accessToken}`;\n    }\n\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        headers,\n        body: formData,\n      });\n\n      return this.handleResponse<T>(response);\n    } catch (error) {\n      return {\n        success: false,\n        error: {\n          error: 'upload_error',\n          message: error instanceof Error ? error.message : 'Upload failed',\n        },\n      };\n    }\n  }\n}\n\nexport const api = new ApiClient(API_BASE_URL);\n\n// =============================================================================\n// AUTH API\n// =============================================================================\n\nexport interface LoginRequest {\n  email: string;\n  password: string;\n}\n\nexport interface RegisterRequest {\n  email: string;\n  password: string;\n  first_name: string;\n  last_name: string;\n  specialty?: string;\n  referral_code?: string;\n}\n\nexport interface AuthResponse {\n  access_token: string;\n  refresh_token: string;\n  user: User;\n}\n\nexport interface User {\n  id: number;\n  email: string;\n  first_name: string;\n  last_name: string;\n  full_name: string;\n  specialty?: string;\n  bio?: string;\n  avatar_url?: string;\n  is_verified: boolean;\n  is_premium: boolean;\n  subscription_tier: 'free' | 'premium';\n  points: number;\n  level: number;\n  login_streak: number;\n  referral_code: string;\n  followers_count: number;\n  following_count: number;\n  posts_count: number;\n  created_at: string;\n}\n\nexport const authApi = {\n  login: async (data: LoginRequest) => {\n    const response = await api.post<AuthResponse>('/auth/login', data);\n    if (response.success && response.data) {\n      await tokenManager.setTokens(\n        response.data.access_token,\n        response.data.refresh_token\n      );\n    }\n    return response;\n  },\n\n  register: async (data: RegisterRequest) => {\n    const response = await api.post<AuthResponse>('/auth/register', data);\n    if (response.success && response.data) {\n      await tokenManager.setTokens(\n        response.data.access_token,\n        response.data.refresh_token\n      );\n    }\n    return response;\n  },\n\n  logout: async () => {\n    await tokenManager.clearTokens();\n    return { success: true };\n  },\n\n  getCurrentUser: () => api.get<User>('/auth/me'),\n\n  forgotPassword: (email: string) => \n    api.post('/auth/forgot-password', { email }),\n\n  resetPassword: (token: string, password: string) =>\n    api.post('/auth/reset-password', { token, password }),\n\n  changePassword: (data: { current_password: string; new_password: string }) =>\n    api.post('/auth/change-password', data),\n\n  verifyEmail: (token: string) =>\n    api.post(`/auth/verify-email/${token}`),\n\n  resendVerification: () =>\n    api.post('/auth/resend-verification'),\n    \n  resendVerificationEmail: (email: string) =>\n    api.post('/auth/resend-verification', { email }),\n    \n  deleteAccount: (data: { reason: string; other_reason?: string; password: string }) =>\n    api.post('/auth/delete-account', data),\n    \n  deactivateAccount: () =>\n    api.post('/auth/deactivate'),\n};\n\n// =============================================================================\n// FEED API\n// =============================================================================\n\nexport interface Post {\n  id: number;\n  content: string;\n  author: User;\n  room: Room;\n  images: string[];\n  video_url?: string;\n  is_anonymous: boolean;\n  mentions: string[];\n  hashtags: string[];\n  upvotes: number;\n  downvotes: number;\n  comments_count: number;\n  user_vote?: 'up' | 'down' | null;\n  is_bookmarked: boolean;\n  feed_score: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface Room {\n  id: number;\n  name: string;\n  slug: string;\n  description: string;\n  icon: string;\n  color: string;\n  posts_count: number;\n  members_count: number;\n  is_member: boolean;\n}\n\nexport interface FeedResponse {\n  posts: Post[];\n  has_more: boolean;\n  next_cursor?: string;\n  feed_style: 'algorithmic' | 'chronological' | 'discovery';\n}\n\nexport interface TrendingTopic {\n  hashtag: string;\n  count: number;\n  trend: 'up' | 'down' | 'stable';\n}\n\nexport const feedApi = {\n  getFeed: (cursor?: string, style?: string) => {\n    let endpoint = '/feed';\n    const params = new URLSearchParams();\n    if (cursor) params.append('cursor', cursor);\n    if (style) params.append('style', style);\n    if (params.toString()) endpoint += `?${params.toString()}`;\n    return api.get<FeedResponse>(endpoint);\n  },\n\n  getTrending: () => api.get<{ topics: TrendingTopic[] }>('/feed/trending'),\n\n  getRoomFeed: (roomSlug: string, cursor?: string) => {\n    let endpoint = `/rooms/${roomSlug}/posts`;\n    if (cursor) endpoint += `?cursor=${cursor}`;\n    return api.get<FeedResponse>(endpoint);\n  },\n};\n\n// =============================================================================\n// POSTS API\n// =============================================================================\n\nexport interface CreatePostRequest {\n  content: string;\n  room_id: number;\n  is_anonymous?: boolean;\n  images?: string[];\n  video?: string; // Local video URI for upload\n  video_url?: string; // Remote video URL\n}\n\nexport interface Comment {\n  id: number;\n  content: string;\n  author: User;\n  post_id: number;\n  parent_id?: number;\n  upvotes: number;\n  downvotes: number;\n  user_vote?: 'up' | 'down' | null;\n  replies_count: number;\n  created_at: string;\n}\n\nexport const postsApi = {\n  getPost: (id: number) => api.get<Post>(`/posts/${id}`),\n\n  createPost: (data: CreatePostRequest) => api.post<Post>('/posts', data),\n\n  updatePost: (id: number, content: string) =>\n    api.put<Post>(`/posts/${id}`, { content }),\n\n  deletePost: (id: number) => api.delete(`/posts/${id}`),\n\n  vote: (id: number, direction: 'up' | 'down') =>\n    api.post<{ upvotes: number; downvotes: number }>(`/posts/${id}/vote`, { direction }),\n\n  removeVote: (id: number) => api.delete(`/posts/${id}/vote`),\n\n  bookmark: (id: number) => api.post(`/posts/${id}/bookmark`),\n\n  removeBookmark: (id: number) => api.delete(`/posts/${id}/bookmark`),\n\n  getComments: (postId: number) =>\n    api.get<{ comments: Comment[] }>(`/posts/${postId}/comments`),\n\n  addComment: (postId: number, content: string, parentId?: number) =>\n    api.post<Comment>(`/posts/${postId}/comments`, { content, parent_id: parentId }),\n\n  deleteComment: (postId: number, commentId: number) =>\n    api.delete(`/posts/${postId}/comments/${commentId}`),\n\n  uploadMedia: (formData: FormData) =>\n    api.upload<{ urls: string[] }>('/posts/upload', formData),\n};\n\n// =============================================================================\n// ROOMS API\n// =============================================================================\n\nexport const roomsApi = {\n  getRooms: () => api.get<{ rooms: Room[] }>('/rooms'),\n\n  getRoom: (slug: string) => api.get<Room>(`/rooms/${slug}`),\n\n  joinRoom: (slug: string) => api.post(`/rooms/${slug}/join`),\n\n  leaveRoom: (slug: string) => api.delete(`/rooms/${slug}/join`),\n};\n\n// =============================================================================\n// USERS API\n// =============================================================================\n\nexport interface UserProfile extends User {\n  posts: Post[];\n  is_following: boolean;\n}\n\nexport const usersApi = {\n  getProfile: (id: number) => api.get<UserProfile>(`/users/${id}`),\n  \n  getUser: (id: number) => api.get<UserProfile>(`/users/${id}`),\n\n  updateProfile: (data: Partial<User>) => api.put<User>('/users/me', data),\n\n  uploadAvatar: (formData: FormData) =>\n    api.upload<{ avatar_url: string }>('/users/me/avatar', formData),\n\n  follow: (id: number) => api.post(`/users/${id}/follow`),\n\n  unfollow: (id: number) => api.delete(`/users/${id}/follow`),\n\n  getFollowers: (id: string | number) => api.get<{ users: User[] }>(`/users/${id}/followers`),\n\n  getFollowing: (id: string | number) => api.get<{ users: User[] }>(`/users/${id}/following`),\n\n  search: (query: string) => api.get<{ users: User[] }>(`/users/search?q=${encodeURIComponent(query)}`),\n\n  explore: () => api.get<{ users: User[] }>('/users/explore'),\n\n  getBookmarks: () => api.get<{ posts: Post[] }>('/users/me/bookmarks'),\n  \n  // Block/Unblock\n  block: (id: number) => api.post(`/users/${id}/block`),\n  \n  unblock: (id: number) => api.delete(`/users/${id}/block`),\n  \n  blockUser: (id: number) => api.post(`/users/${id}/block`),\n  \n  unblockUser: (id: number) => api.delete(`/users/${id}/block`),\n  \n  getBlockedUsers: () => api.get<{ blocked_users: Array<{ id: number; user: User; blocked_at: string }> }>('/users/me/blocked'),\n  \n  // User Posts\n  getUserPosts: (id: number) => api.get<{ posts: Post[] }>(`/users/${id}/posts`),\n  \n  getUserComments: (id: number) => api.get<{ posts: Post[] }>(`/users/${id}/comments`),\n  \n  getUserLikes: (id: number) => api.get<{ posts: Post[] }>(`/users/${id}/likes`),\n  \n  // Suggested Users (People You May Know)\n  getSuggestedUsers: (limit: number = 6) => \n    api.get<{ users: Array<{\n      id: number;\n      first_name: string;\n      last_name: string;\n      full_name: string;\n      avatar_url?: string;\n      specialty?: string;\n      location?: string;\n      mutual_connections?: number;\n      reason?: string;\n    }> }>(`/users/suggestions?limit=${limit}`),\n};\n\n// =============================================================================\n// NEWS API\n// =============================================================================\n\nexport interface NewsArticle {\n  id: number;\n  title: string;\n  source: string;\n  source_icon?: string;\n  url: string;\n  published_at: string;\n  category?: string;\n  image_url?: string;\n}\n\nexport const newsApi = {\n  getLatestNews: (limit: number = 10) => \n    api.get<{ articles: NewsArticle[] }>(`/news?limit=${limit}`),\n  \n  getNewsByCategory: (category: string, limit: number = 10) =>\n    api.get<{ articles: NewsArticle[] }>(`/news?category=${category}&limit=${limit}`),\n  \n  getFeaturedNews: () =>\n    api.get<{ articles: NewsArticle[] }>('/news/featured'),\n};\n\n// =============================================================================\n// NOTIFICATIONS API\n// =============================================================================\n\nexport type Notification = NotificationFromTypes;\n\nexport const notificationsApi = {\n  getNotifications: (page?: number) => {\n    let endpoint = '/notifications';\n    if (page) endpoint += `?page=${page}`;\n    return api.get<{ notifications: Notification[]; unread_count: number }>(endpoint);\n  },\n\n  markAsRead: (id: number) => api.post(`/notifications/${id}/read`),\n\n  markAllAsRead: () => api.post('/notifications/read-all'),\n\n  getUnreadCount: () => api.get<{ count: number }>('/notifications/unread-count'),\n\n  registerPushToken: (data: { token: string; platform: string; deviceId?: string }) =>\n    api.post('/notifications/push-token', data),\n\n  unregisterPushToken: (token: string) =>\n    api.delete(`/notifications/push-token/${token}`),\n\n  updatePreferences: (preferences: {\n    push_enabled?: boolean;\n    email_enabled?: boolean;\n    likes?: boolean;\n    comments?: boolean;\n    follows?: boolean;\n    mentions?: boolean;\n    messages?: boolean;\n    deals?: boolean;\n    amas?: boolean;\n  }) => api.put('/notifications/preferences', preferences),\n\n  getPreferences: () =>\n    api.get<{\n      push_enabled: boolean;\n      email_enabled: boolean;\n      likes: boolean;\n      comments: boolean;\n      follows: boolean;\n      mentions: boolean;\n      messages: boolean;\n      deals: boolean;\n      amas: boolean;\n    }>('/notifications/preferences'),\n};\n\n// =============================================================================\n// MESSAGES API\n// =============================================================================\n\nexport interface ApiUser {\n  id: string;\n  email: string;\n  first_name: string;\n  last_name: string;\n  full_name: string;\n  avatar_url: string | null;\n  is_verified: boolean;\n  specialty?: string;\n}\n\nexport interface Conversation {\n  id: string;\n  other_user: ApiUser;\n  last_message?: string;\n  last_message_at?: string;\n  unread_count: number;\n  is_muted: boolean;\n}\n\nexport interface Message {\n  id: string;\n  conversation_id: string;\n  content: string;\n  sender: ApiUser;\n  is_read: boolean;\n  read_at?: string;\n  created_at: string;\n}\n\nimport { getApiUrl } from './query-client';\n\nconst getMessagesApiUrl = () => {\n  const base = getApiUrl();\n  return `${base}api/messages`;\n};\n\nexport const messagesApi = {\n  getConversations: async (): Promise<ApiResponse<{ conversations: Conversation[] }>> => {\n    try {\n      const token = await tokenManager.getAccessToken();\n      const res = await fetch(getMessagesApiUrl(), {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      });\n      const data = await res.json();\n      return { data, success: res.ok };\n    } catch (error) {\n      return { success: false, error: { error: 'Failed to fetch conversations' } };\n    }\n  },\n\n  getConversation: async (userId: string): Promise<ApiResponse<{ messages: Message[]; other_user: ApiUser }>> => {\n    try {\n      const token = await tokenManager.getAccessToken();\n      const res = await fetch(`${getMessagesApiUrl()}/${userId}`, {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      });\n      const data = await res.json();\n      return { data, success: res.ok };\n    } catch (error) {\n      return { success: false, error: { error: 'Failed to fetch conversation' } };\n    }\n  },\n\n  sendMessage: async (userId: string, content: string): Promise<ApiResponse<Message>> => {\n    try {\n      const token = await tokenManager.getAccessToken();\n      const res = await fetch(`${getMessagesApiUrl()}/${userId}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { Authorization: `Bearer ${token}` } : {}),\n        },\n        body: JSON.stringify({ content }),\n      });\n      const data = await res.json();\n      return { data, success: res.ok };\n    } catch (error) {\n      return { success: false, error: { error: 'Failed to send message' } };\n    }\n  },\n\n  deleteConversation: async (userId: string): Promise<ApiResponse<void>> => {\n    try {\n      const token = await tokenManager.getAccessToken();\n      const res = await fetch(`${getMessagesApiUrl()}/${userId}`, {\n        method: 'DELETE',\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      });\n      return { success: res.ok };\n    } catch (error) {\n      return { success: false, error: { error: 'Failed to delete conversation' } };\n    }\n  },\n\n  getUnreadCount: async (): Promise<ApiResponse<{ count: number }>> => {\n    try {\n      const token = await tokenManager.getAccessToken();\n      const res = await fetch(`${getMessagesApiUrl()}/unread-count`, {\n        headers: token ? { Authorization: `Bearer ${token}` } : {},\n      });\n      const data = await res.json();\n      return { data, success: res.ok };\n    } catch (error) {\n      return { success: false, error: { error: 'Failed to fetch unread count' } };\n    }\n  },\n};\n\n// =============================================================================\n// SUBSCRIPTION API\n// =============================================================================\n\nexport interface SubscriptionStatus {\n  is_premium: boolean;\n  tier: 'free' | 'premium';\n  expires_at?: string;\n}\n\nexport const subscriptionApi = {\n  getStatus: () => api.get<SubscriptionStatus>('/stripe/subscription'),\n\n  createCheckoutSession: () =>\n    api.post<{ checkout_url: string }>('/stripe/create-checkout'),\n\n  getPortalUrl: () =>\n    api.get<{ portal_url: string }>('/stripe/portal'),\n};\n\n// =============================================================================\n// CONTENT API (AMAs, Deals, Courses, etc.)\n// =============================================================================\n\nexport interface AMA {\n  id: number;\n  title: string;\n  description: string;\n  expert: User;\n  status: 'scheduled' | 'live' | 'ended';\n  scheduled_at: string;\n  questions_count: number;\n}\n\n\nexport interface Course {\n  id: number;\n  title: string;\n  description: string;\n  instructor: User;\n  duration_minutes: number;\n  lessons_count: number;\n  is_premium: boolean;\n  progress?: number;\n}\n\nexport interface Event {\n  id: number;\n  title: string;\n  description: string;\n  event_type: 'webinar' | 'conference' | 'meetup';\n  starts_at: string;\n  ends_at: string;\n  location?: string;\n  is_virtual: boolean;\n  attendees_count: number;\n  is_attending: boolean;\n}\n\nexport const contentApi = {\n  // AMAs\n  getAMAs: () => api.get<{ amas: AMA[] }>('/amas'),\n  getAMA: (id: number) => api.get<AMA>(`/amas/${id}`),\n  askQuestion: (amaId: number, question: string) =>\n    api.post(`/amas/${amaId}/questions`, { question }),\n\n  // Deals\n  getDeals: (category?: string) => {\n    let endpoint = '/deals';\n    if (category) endpoint += `?category=${category}`;\n    return api.get<{ deals: Deal[] }>(endpoint);\n  },\n  getDeal: (id: number) => api.get<Deal>(`/deals/${id}`),\n\n  // Courses\n  getCourses: () => api.get<{ courses: Course[] }>('/courses'),\n  getCourse: (id: number) => api.get<Course>(`/courses/${id}`),\n  enrollCourse: (id: number) => api.post(`/courses/${id}/enroll`),\n\n  // Events\n  getEvents: () => api.get<{ events: Event[] }>('/events'),\n  getEvent: (id: number) => api.get<Event>(`/events/${id}`),\n  attendEvent: (id: number) => api.post(`/events/${id}/attend`),\n  unattendEvent: (id: number) => api.delete(`/events/${id}/attend`),\n};\n\n// =============================================================================\n// COURSES API (with lessons)\n// =============================================================================\n\nexport const coursesApi = {\n  getCourses: () => api.get<{ courses: Course[] }>('/courses'),\n  getCourse: (id: number) => api.get<Course>(`/courses/${id}`),\n  enrollCourse: (id: number) => api.post(`/courses/${id}/enroll`),\n  getCourseLessons: (courseId: number) => \n    api.get<{ lessons: any[] }>(`/courses/${courseId}/lessons`),\n  getLesson: (courseId: number, lessonId: number) =>\n    api.get<any>(`/courses/${courseId}/lessons/${lessonId}`),\n  completeLesson: (courseId: number, lessonId: number) =>\n    api.post(`/courses/${courseId}/lessons/${lessonId}/complete`),\n};\n\n// =============================================================================\n// MODERATION API\n// =============================================================================\n\nexport const moderationApi = {\n  report: (data: {\n    type: 'post' | 'comment' | 'user' | 'message';\n    targetId: number;\n    reason: string;\n    details?: string;\n  }) => api.post('/reports', {\n    type: data.type,\n    target_id: data.targetId,\n    reason: data.reason,\n    details: data.details,\n  }),\n};\n\n// =============================================================================\n// SEARCH API\n// =============================================================================\n\nexport interface SearchResults {\n  posts: Post[];\n  users: User[];\n  rooms: Room[];\n  hashtags: TrendingTopic[];\n}\n\nexport const searchApi = {\n  search: (query: string, type?: 'all' | 'posts' | 'users' | 'rooms' | 'hashtags') => {\n    let endpoint = `/search?q=${encodeURIComponent(query)}`;\n    if (type && type !== 'all') endpoint += `&type=${type}`;\n    return api.get<SearchResults>(endpoint);\n  },\n\n  autocomplete: (query: string, type: 'users' | 'hashtags') =>\n    api.get<{ suggestions: string[] }>(`/search/autocomplete?q=${encodeURIComponent(query)}&type=${type}`),\n};\n\n// =============================================================================\n// GAMIFICATION API\n// =============================================================================\n\nexport interface LeaderboardEntry {\n  rank: number;\n  user: User;\n  points: number;\n}\n\nexport interface Achievement {\n  id: number;\n  name: string;\n  description: string;\n  icon: string;\n  points: number;\n  unlocked: boolean;\n  unlocked_at?: string;\n}\n\nexport const gamificationApi = {\n  getLeaderboard: (period?: 'weekly' | 'monthly' | 'all_time') => {\n    let endpoint = '/leaderboard';\n    if (period) endpoint += `?period=${period}`;\n    return api.get<{ leaderboard: LeaderboardEntry[] }>(endpoint);\n  },\n\n  getAchievements: () =>\n    api.get<{ achievements: Achievement[] }>('/achievements'),\n\n  getMyStats: () =>\n    api.get<{ points: number; level: number; rank: number; streak: number }>('/gamification/stats'),\n};\n\n// =============================================================================\n// AI CHAT API\n// =============================================================================\n\nexport interface ChatMessage {\n  role: 'user' | 'assistant';\n  content: string;\n}\n\nexport const aiApi = {\n  chat: (messages: ChatMessage[], options?: { specialty?: string; investorType?: string }) =>\n    api.post<{ success: boolean; data: { message: string } }>('/ai/chat', {\n      messages: messages.slice(-20), // Last 20 messages for context\n      specialty: options?.specialty,\n      investorType: options?.investorType,\n    }),\n\n  moderate: (content: string) =>\n    api.post<{ success: boolean; data: { is_appropriate: boolean; flags: string[] } }>('/ai/moderate', { content }),\n\n  summarize: (content: string) =>\n    api.post<{ success: boolean; data: { summary: string } }>('/ai/summarize', { content }),\n\n  analyzeDeal: (dealInfo: { title: string; description: string; category?: string; stage?: string }) =>\n    api.post<{ success: boolean; data: { analysis: string; score: number; pros: string[]; cons: string[] } }>('/ai/analyze-deal', dealInfo),\n\n  enhanceSearch: (query: string) =>\n    api.post<{ success: boolean; data: { enhanced_query: string; suggestions: string[] } }>('/ai/enhance-search', { query }),\n\n  getRecommendations: (userContext: { interests?: string[]; recent_activity?: string[] }) =>\n    api.post<{ success: boolean; data: { recommendations: any[] } }>('/ai/recommendations', userContext),\n};\n\n// =============================================================================\n// DEALS API\n// =============================================================================\n\nexport interface Deal {\n  id: number;\n  title: string;\n  company?: string;\n  company_name: string;\n  company_logo?: string;\n  image_url?: string;\n  category: string;\n  stage?: string;\n  description: string;\n  highlights: string[];\n  risks?: string[];\n  status: 'active' | 'funded' | 'closed' | 'draft' | 'review' | 'rejected';\n  target_raise: number;\n  raised: number;\n  minimum_investment: number;\n  maximum_investment?: number;\n  valuation?: number;\n  equity_offered?: number;\n  investors_count: number;\n  deadline: string;\n  team?: Array<{\n    name: string;\n    role: string;\n    background?: string;\n  }>;\n  documents?: Array<{\n    name: string;\n    url: string;\n  }>;\n  featured?: boolean;\n  is_watched?: boolean;\n  created_at: string;\n}\n\nexport const dealsApi = {\n  getDeals: (category?: string, status?: string) => {\n    let endpoint = '/deals';\n    const params = new URLSearchParams();\n    if (category) params.append('category', category);\n    if (status) params.append('status', status);\n    const query = params.toString();\n    if (query) endpoint += `?${query}`;\n    return api.get<{ deals: Deal[]; total: number; categories: string[]; stages: string[] }>(endpoint);\n  },\n\n  getDeal: (id: number) => api.get<Deal>(`/deals/${id}`),\n\n  watchDeal: (id: number) => api.post(`/deals/${id}/watch`),\n\n  unwatchDeal: (id: number) => api.delete(`/deals/${id}/watch`),\n\n  expressInterest: (id: number, amount: number, message?: string) =>\n    api.post(`/deals/${id}/interest`, { amount, message }),\n};\n\n\nexport default api;\n","path":null,"size_bytes":30106,"size_tokens":null},"client/screens/UserProfileScreen.tsx":{"content":"/**\n * UserProfile Screen\n * View other users' profiles\n */\n\nimport React, { useState, useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Image,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { usersApi, feedApi } from '@/lib/api';\nimport { User, Post } from '@/types';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { formatNumber } from '@/lib/utils';\nimport PostCard from '@/components/PostCard';\n\ntype UserProfileRouteParams = {\n  UserProfile: {\n    userId: number;\n  };\n};\n\ntype TabType = 'posts' | 'comments' | 'likes';\n\nexport default function UserProfileScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<UserProfileRouteParams, 'UserProfile'>>();\n  const { userId } = route.params;\n  const { user: currentUser } = useAuth();\n  const queryClient = useQueryClient();\n  const appColors = useAppColors();\n\n  const [activeTab, setActiveTab] = useState<TabType>('posts');\n\n  const isOwnProfile = currentUser?.id === userId;\n\n  // Fetch user profile\n  const {\n    data: user,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useQuery({\n    queryKey: ['userProfile', userId],\n    queryFn: async () => {\n      const response = await usersApi.getUser(userId);\n      return response.data;\n    },\n  });\n\n  // Fetch user posts\n  const { data: posts } = useQuery({\n    queryKey: ['userPosts', userId, activeTab],\n    queryFn: async () => {\n      let response;\n      switch (activeTab) {\n        case 'comments':\n          response = await usersApi.getUserComments(userId);\n          break;\n        case 'likes':\n          response = await usersApi.getUserLikes(userId);\n          break;\n        default:\n          response = await usersApi.getUserPosts(userId);\n      }\n      return response.data?.posts || [];\n    },\n    enabled: !!user,\n  });\n\n  // Follow mutation\n  const followMutation = useMutation({\n    mutationFn: async () => {\n      if (user?.is_following) {\n        return usersApi.unfollow(userId);\n      }\n      return usersApi.follow(userId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['userProfile', userId] });\n    },\n  });\n\n  const handleMessage = useCallback(() => {\n    navigation.navigate('Conversation', { userId });\n  }, [navigation, userId]);\n\n  const handleFollowers = useCallback(() => {\n    navigation.navigate('Followers', { userId, type: 'followers' });\n  }, [navigation, userId]);\n\n  const handleFollowing = useCallback(() => {\n    navigation.navigate('Followers', { userId, type: 'following' });\n  }, [navigation, userId]);\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleReport = useCallback(() => {\n    // Open report modal\n  }, []);\n\n  const handleBlock = useCallback(() => {\n    // Block user\n  }, []);\n\n  const renderHeader = () => {\n    if (!user) return null;\n\n    return (\n      <View>\n        {/* Cover & Avatar */}\n        <LinearGradient\n          colors={[Colors.primary, Colors.secondary]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.coverGradient}\n        />\n        <View style={styles.avatarContainer}>\n          {user.avatar_url ? (\n            <Image source={{ uri: user.avatar_url }} style={[styles.avatar, { borderColor: appColors.surface }]} />\n          ) : (\n            <View style={[styles.avatar, styles.avatarPlaceholder, { borderColor: appColors.surface }]}>\n              <ThemedText style={styles.avatarText}>\n                {user.first_name[0]}{user.last_name[0]}\n              </ThemedText>\n            </View>\n          )}\n          {user.is_premium && (\n            <View style={[styles.premiumBadge, { backgroundColor: appColors.surface }]}>\n              <MaterialCommunityIcons name=\"crown\" size={14} color={appColors.warning} />\n            </View>\n          )}\n        </View>\n\n        {/* User Info */}\n        <View style={[styles.userInfo, { backgroundColor: appColors.surface }]}>\n          <View style={styles.nameRow}>\n            <ThemedText style={[styles.userName, { color: appColors.textPrimary }]}>{user.full_name}</ThemedText>\n            {user.is_verified && (\n              <Ionicons name=\"checkmark-circle\" size={20} color={Colors.primary} />\n            )}\n          </View>\n          {user.specialty && (\n            <ThemedText style={styles.userSpecialty}>{user.specialty}</ThemedText>\n          )}\n          {user.bio && (\n            <ThemedText style={[styles.userBio, { color: appColors.textSecondary }]}>{user.bio}</ThemedText>\n          )}\n\n          {/* Stats */}\n          <View style={[styles.statsRow, { borderTopColor: appColors.border }]}>\n            <TouchableOpacity style={styles.statItem} onPress={handleFollowers}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>{formatNumber(user.followers_count)}</ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Followers</ThemedText>\n            </TouchableOpacity>\n            <TouchableOpacity style={styles.statItem} onPress={handleFollowing}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>{formatNumber(user.following_count)}</ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Following</ThemedText>\n            </TouchableOpacity>\n            <View style={styles.statItem}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>{formatNumber(user.posts_count)}</ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Posts</ThemedText>\n            </View>\n            <View style={styles.statItem}>\n              <ThemedText style={[styles.statValue, { color: appColors.textPrimary }]}>{formatNumber(user.points)}</ThemedText>\n              <ThemedText style={[styles.statLabel, { color: appColors.textSecondary }]}>Points</ThemedText>\n            </View>\n          </View>\n\n          {/* Action Buttons */}\n          {!isOwnProfile && (\n            <View style={styles.actionsRow}>\n              <TouchableOpacity\n                style={[\n                  styles.followButton,\n                  user.is_following && styles.followingButton,\n                ]}\n                onPress={() => followMutation.mutate()}\n                disabled={followMutation.isPending}\n              >\n                {followMutation.isPending ? (\n                  <ActivityIndicator size=\"small\" color={user.is_following ? appColors.textSecondary : 'white'} />\n                ) : (\n                  <>\n                    <Ionicons\n                      name={user.is_following ? 'checkmark' : 'person-add-outline'}\n                      size={18}\n                      color={user.is_following ? appColors.textSecondary : 'white'}\n                    />\n                    <ThemedText style={[\n                      styles.followButtonText,\n                      user.is_following && { color: appColors.textSecondary },\n                    ]}>\n                      {user.is_following ? 'Following' : 'Follow'}\n                    </ThemedText>\n                  </>\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity style={styles.messageButton} onPress={handleMessage}>\n                <Ionicons name=\"chatbubble-outline\" size={18} color={Colors.primary} />\n                <ThemedText style={styles.messageButtonText}>Message</ThemedText>\n              </TouchableOpacity>\n            </View>\n          )}\n\n          {/* Gamification */}\n          <View style={styles.gamificationRow}>\n            <View style={[styles.levelBadge, { backgroundColor: appColors.warning + '15' }]}>\n              <MaterialCommunityIcons name=\"star-circle\" size={16} color={appColors.warning} />\n              <ThemedText style={[styles.levelText, { color: appColors.warning }]}>Level {user.level}</ThemedText>\n            </View>\n            {user.streak_days > 0 && (\n              <View style={[styles.streakBadge, { backgroundColor: appColors.error + '15' }]}>\n                <Ionicons name=\"flame\" size={16} color={appColors.error} />\n                <ThemedText style={[styles.streakText, { color: appColors.error }]}>{user.streak_days} day streak</ThemedText>\n              </View>\n            )}\n          </View>\n        </View>\n\n        {/* Tabs */}\n        <View style={[styles.tabsContainer, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n          {(['posts', 'comments', 'likes'] as TabType[]).map((tab) => (\n            <TouchableOpacity\n              key={tab}\n              style={[styles.tab, activeTab === tab && styles.tabActive]}\n              onPress={() => setActiveTab(tab)}\n            >\n              <Ionicons\n                name={\n                  tab === 'posts' ? 'grid-outline' :\n                  tab === 'comments' ? 'chatbox-outline' : 'heart-outline'\n                }\n                size={20}\n                color={activeTab === tab ? Colors.primary : appColors.textSecondary}\n              />\n              <ThemedText style={[styles.tabText, { color: appColors.textSecondary }, activeTab === tab && styles.tabTextActive]}>\n                {tab.charAt(0).toUpperCase() + tab.slice(1)}\n              </ThemedText>\n            </TouchableOpacity>\n          ))}\n        </View>\n      </View>\n    );\n  };\n\n  const renderPost = ({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item.id)}\n      onUserPress={() => {}}\n      onVote={() => {}}\n      onBookmark={() => {}}\n    />\n  );\n\n  const renderEmpty = () => (\n    <View style={styles.emptyContainer}>\n      <Ionicons\n        name={\n          activeTab === 'posts' ? 'document-text-outline' :\n          activeTab === 'comments' ? 'chatbox-outline' : 'heart-outline'\n        }\n        size={48}\n        color={appColors.textSecondary}\n      />\n      <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>\n        No {activeTab} yet\n      </ThemedText>\n    </View>\n  );\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={[styles.loadingContainer, { backgroundColor: appColors.background }]}>\n        <ActivityIndicator size=\"large\" color={Colors.primary} />\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      {/* Header */}\n      <View style={[styles.header, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.headerTitle, { color: appColors.textPrimary }]} numberOfLines={1}>\n          {user?.full_name || 'Profile'}\n        </ThemedText>\n        <TouchableOpacity style={styles.moreButton}>\n          <Ionicons name=\"ellipsis-horizontal\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n      </View>\n\n      {/* Content */}\n      <FlatList\n        data={posts}\n        renderItem={renderPost}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    padding: Spacing.sm,\n  },\n  headerTitle: {\n    ...Typography.heading,\n    flex: 1,\n    textAlign: 'center',\n  },\n  moreButton: {\n    padding: Spacing.sm,\n  },\n  coverGradient: {\n    height: 120,\n  },\n  avatarContainer: {\n    alignItems: 'center',\n    marginTop: -50,\n  },\n  avatar: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    borderWidth: 4,\n  },\n  avatarPlaceholder: {\n    backgroundColor: Colors.primary + '20',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarText: {\n    ...Typography.title,\n    color: Colors.primary,\n  },\n  premiumBadge: {\n    position: 'absolute',\n    bottom: 0,\n    right: -4,\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    alignItems: 'center',\n    justifyContent: 'center',\n    ...Shadows.card,\n  },\n  userInfo: {\n    padding: Spacing.lg,\n    alignItems: 'center',\n  },\n  nameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: Spacing.xs,\n  },\n  userName: {\n    ...Typography.title,\n  },\n  userSpecialty: {\n    ...Typography.caption,\n    color: Colors.primary,\n    marginTop: Spacing.xs,\n  },\n  userBio: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n    lineHeight: 22,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    paddingTop: Spacing.lg,\n    borderTopWidth: 1,\n  },\n  statItem: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  statValue: {\n    ...Typography.heading,\n  },\n  statLabel: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  actionsRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.md,\n  },\n  followButton: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.xs,\n  },\n  followingButton: {\n    backgroundColor: Colors.light.backgroundSecondary,\n  },\n  followButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  messageButton: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.primary + '15',\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.xs,\n  },\n  messageButtonText: {\n    ...Typography.body,\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  gamificationRow: {\n    flexDirection: 'row',\n    marginTop: Spacing.lg,\n    gap: Spacing.md,\n  },\n  levelBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  levelText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  streakBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  streakText: {\n    ...Typography.small,\n    fontWeight: '600',\n  },\n  tabsContainer: {\n    flexDirection: 'row',\n    borderBottomWidth: 1,\n  },\n  tab: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.md,\n    gap: Spacing.xs,\n  },\n  tabActive: {\n    borderBottomWidth: 2,\n    borderBottomColor: Colors.primary,\n  },\n  tabText: {\n    ...Typography.caption,\n  },\n  tabTextActive: {\n    color: Colors.primary,\n    fontWeight: '600',\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":16252,"size_tokens":null},"client/components/ReportModal.tsx":{"content":"/**\n * Report Modal\n * Report posts, comments, or users\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  Modal,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useMutation } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography, Shadows } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { moderationApi } from '@/lib/api';\n\nexport type ReportType = 'post' | 'comment' | 'user' | 'message';\n\ninterface ReportReason {\n  id: string;\n  label: string;\n  description: string;\n}\n\nconst REPORT_REASONS: ReportReason[] = [\n  { id: 'spam', label: 'Spam', description: 'Misleading or repetitive content' },\n  { id: 'harassment', label: 'Harassment', description: 'Bullying or threatening behavior' },\n  { id: 'hate_speech', label: 'Hate Speech', description: 'Discrimination or slurs' },\n  { id: 'misinformation', label: 'Misinformation', description: 'False medical or investment claims' },\n  { id: 'inappropriate', label: 'Inappropriate Content', description: 'Explicit or offensive material' },\n  { id: 'impersonation', label: 'Impersonation', description: 'Pretending to be someone else' },\n  { id: 'other', label: 'Other', description: 'Report for another reason' },\n];\n\ninterface ReportModalProps {\n  visible: boolean;\n  onClose: () => void;\n  type: ReportType;\n  targetId: number;\n  targetName?: string;\n}\n\nexport default function ReportModal({\n  visible,\n  onClose,\n  type,\n  targetId,\n  targetName,\n}: ReportModalProps) {\n  const appColors = useAppColors();\n  const [selectedReason, setSelectedReason] = useState<string | null>(null);\n  const [additionalInfo, setAdditionalInfo] = useState('');\n\n  const reportMutation = useMutation({\n    mutationFn: async () => {\n      if (!selectedReason) throw new Error('Please select a reason');\n\n      const response = await moderationApi.report({\n        type,\n        targetId,\n        reason: selectedReason,\n        details: additionalInfo.trim() || undefined,\n      });\n\n      if (!response.success) {\n        throw new Error(response.error?.message || 'Failed to submit report');\n      }\n\n      return response.data;\n    },\n    onSuccess: () => {\n      Alert.alert(\n        'Report Submitted',\n        'Thank you for helping keep our community safe. We\\'ll review this report and take appropriate action.',\n        [{ text: 'OK', onPress: handleClose }]\n      );\n    },\n    onError: (error: Error) => {\n      Alert.alert('Error', error.message);\n    },\n  });\n\n  const handleClose = () => {\n    setSelectedReason(null);\n    setAdditionalInfo('');\n    onClose();\n  };\n\n  const handleSubmit = () => {\n    if (!selectedReason) {\n      Alert.alert('Error', 'Please select a reason for your report');\n      return;\n    }\n    reportMutation.mutate();\n  };\n\n  const getTitle = () => {\n    switch (type) {\n      case 'post': return 'Report Post';\n      case 'comment': return 'Report Comment';\n      case 'user': return 'Report User';\n      case 'message': return 'Report Message';\n      default: return 'Report';\n    }\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      animationType=\"slide\"\n      transparent\n      onRequestClose={handleClose}\n    >\n      <View style={styles.overlay}>\n        <View style={[styles.container, { backgroundColor: appColors.surface }]}>\n          {/* Header */}\n          <View style={[styles.header, { borderBottomColor: appColors.border }]}>\n            <TouchableOpacity style={styles.closeButton} onPress={handleClose}>\n              <Ionicons name=\"close\" size={24} color={appColors.textPrimary} />\n            </TouchableOpacity>\n            <ThemedText style={[styles.title, { color: appColors.textPrimary }]}>{getTitle()}</ThemedText>\n            <View style={styles.closeButton} />\n          </View>\n\n          {/* Target Info */}\n          {targetName && (\n            <View style={styles.targetInfo}>\n              <Ionicons name=\"flag-outline\" size={16} color={appColors.textSecondary} />\n              <ThemedText style={[styles.targetText, { color: appColors.textSecondary }]}>\n                Reporting: {targetName}\n              </ThemedText>\n            </View>\n          )}\n\n          {/* Reason Selection */}\n          <View style={styles.reasonsContainer}>\n            <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>\n              What's the issue?\n            </ThemedText>\n            {REPORT_REASONS.map((reason) => (\n              <TouchableOpacity\n                key={reason.id}\n                style={[\n                  styles.reasonItem,\n                  { borderColor: appColors.border },\n                  selectedReason === reason.id && styles.reasonItemSelected,\n                ]}\n                onPress={() => setSelectedReason(reason.id)}\n              >\n                <View style={styles.reasonContent}>\n                  <ThemedText style={[\n                    styles.reasonLabel,\n                    { color: appColors.textPrimary },\n                    selectedReason === reason.id && styles.reasonLabelSelected,\n                  ]}>\n                    {reason.label}\n                  </ThemedText>\n                  <ThemedText style={[styles.reasonDescription, { color: appColors.textSecondary }]}>\n                    {reason.description}\n                  </ThemedText>\n                </View>\n                <View style={[\n                  styles.radioButton,\n                  { borderColor: appColors.border },\n                  selectedReason === reason.id && styles.radioButtonSelected,\n                ]}>\n                  {selectedReason === reason.id && (\n                    <View style={styles.radioButtonInner} />\n                  )}\n                </View>\n              </TouchableOpacity>\n            ))}\n          </View>\n\n          {/* Additional Info */}\n          {selectedReason && (\n            <View style={styles.additionalInfoContainer}>\n              <ThemedText style={[styles.sectionTitle, { color: appColors.textSecondary }]}>\n                Additional details (optional)\n              </ThemedText>\n              <TextInput\n                style={[styles.textInput, { color: appColors.textPrimary, borderColor: appColors.border }]}\n                placeholder=\"Provide more context about this report...\"\n                placeholderTextColor={appColors.textSecondary}\n                value={additionalInfo}\n                onChangeText={setAdditionalInfo}\n                multiline\n                maxLength={500}\n                textAlignVertical=\"top\"\n              />\n              <ThemedText style={[styles.charCount, { color: appColors.textSecondary }]}>\n                {additionalInfo.length}/500\n              </ThemedText>\n            </View>\n          )}\n\n          {/* Submit Button */}\n          <TouchableOpacity\n            style={[\n              styles.submitButton,\n              { backgroundColor: appColors.error },\n              !selectedReason && [styles.submitButtonDisabled, { backgroundColor: appColors.textSecondary }],\n            ]}\n            onPress={handleSubmit}\n            disabled={!selectedReason || reportMutation.isPending}\n          >\n            {reportMutation.isPending ? (\n              <ActivityIndicator color=\"white\" />\n            ) : (\n              <ThemedText style={styles.submitButtonText}>Submit Report</ThemedText>\n            )}\n          </TouchableOpacity>\n\n          {/* Disclaimer */}\n          <ThemedText style={[styles.disclaimer, { color: appColors.textSecondary }]}>\n            False reports may result in action against your account. Please only report genuine violations.\n          </ThemedText>\n        </View>\n      </View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'flex-end',\n  },\n  container: {\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    paddingBottom: Spacing.xl,\n    maxHeight: '90%',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderBottomWidth: 1,\n  },\n  closeButton: {\n    width: 40,\n    height: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  title: {\n    ...Typography.heading,\n  },\n  targetInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    backgroundColor: Colors.light.backgroundSecondary,\n    gap: Spacing.sm,\n  },\n  targetText: {\n    ...Typography.caption,\n  },\n  reasonsContainer: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n  },\n  sectionTitle: {\n    ...Typography.caption,\n    fontWeight: '600',\n    textTransform: 'uppercase',\n    letterSpacing: 0.5,\n    marginBottom: Spacing.md,\n  },\n  reasonItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.md,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.sm,\n    borderWidth: 1,\n  },\n  reasonItemSelected: {\n    borderColor: Colors.primary,\n    backgroundColor: Colors.primary + '08',\n  },\n  reasonContent: {\n    flex: 1,\n  },\n  reasonLabel: {\n    ...Typography.body,\n    fontWeight: '600',\n  },\n  reasonLabelSelected: {\n    color: Colors.primary,\n  },\n  reasonDescription: {\n    ...Typography.small,\n    marginTop: 2,\n  },\n  radioButton: {\n    width: 22,\n    height: 22,\n    borderRadius: 11,\n    borderWidth: 2,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  radioButtonSelected: {\n    borderColor: Colors.primary,\n  },\n  radioButtonInner: {\n    width: 12,\n    height: 12,\n    borderRadius: 6,\n    backgroundColor: Colors.primary,\n  },\n  additionalInfoContainer: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n  },\n  textInput: {\n    ...Typography.body,\n    backgroundColor: Colors.light.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    padding: Spacing.md,\n    minHeight: 100,\n    borderWidth: 1,\n  },\n  charCount: {\n    ...Typography.small,\n    textAlign: 'right',\n    marginTop: Spacing.xs,\n  },\n  submitButton: {\n    marginHorizontal: Spacing.lg,\n    marginTop: Spacing.xl,\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: 'center',\n  },\n  submitButtonDisabled: {\n    opacity: 0.5,\n  },\n  submitButtonText: {\n    ...Typography.body,\n    color: 'white',\n    fontWeight: '600',\n  },\n  disclaimer: {\n    ...Typography.small,\n    textAlign: 'center',\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":10761,"size_tokens":null},"client/screens/DiscoverScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TextInput,\n  ScrollView,\n  Pressable,\n  RefreshControl,\n  Image,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Animated, {\n  FadeInDown,\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\nimport { LinearGradient } from \"expo-linear-gradient\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Colors, Spacing, BorderRadius, Shadows, Typography } from \"@/constants/theme\";\nimport {\n  investmentOpportunities,\n  categories,\n  InvestmentOpportunity,\n} from \"@/lib/mockData\";\nimport { DiscoverStackParamList } from \"@/navigation/DiscoverStackNavigator\";\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport default function DiscoverScreen() {\n  const insets = useSafeAreaInsets();\n  const { theme, isDark } = useTheme();\n  const navigation =\n    useNavigation<NativeStackNavigationProp<DiscoverStackParamList>>();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\n  const [refreshing, setRefreshing] = useState(false);\n\n  const filteredOpportunities = investmentOpportunities.filter((opp) => {\n    const matchesSearch =\n      opp.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      opp.company.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesCategory =\n      selectedCategory === \"all\" || opp.category === selectedCategory;\n    return matchesSearch && matchesCategory;\n  });\n\n  const onRefresh = useCallback(() => {\n    setRefreshing(true);\n    setTimeout(() => setRefreshing(false), 1000);\n  }, []);\n\n  const renderItem = useCallback(\n    ({ item, index }: { item: InvestmentOpportunity; index: number }) => (\n      <InvestmentCard\n        opportunity={item}\n        index={index}\n        onPress={() => navigation.navigate(\"InvestmentDetail\", { id: item.id })}\n      />\n    ),\n    [navigation]\n  );\n\n  const renderEmptyState = () => (\n    <View style={styles.emptyContainer}>\n      <Image\n        source={require(\"../../assets/images/empty-discover.png\")}\n        style={styles.emptyImage}\n        resizeMode=\"contain\"\n      />\n      <ThemedText type=\"heading\" style={styles.emptyTitle}>\n        No opportunities found\n      </ThemedText>\n      <ThemedText\n        type=\"body\"\n        style={[styles.emptyText, { color: theme.textSecondary }]}\n      >\n        Try adjusting your search or filters to discover new investment\n        opportunities\n      </ThemedText>\n    </View>\n  );\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.backgroundRoot }]}>\n      <View\n        style={[\n          styles.header,\n          {\n            paddingTop: insets.top + Spacing.lg,\n            backgroundColor: isDark ? theme.backgroundRoot + \"E6\" : \"#FFFFFFE6\",\n          },\n        ]}\n      >\n        <View\n          style={[\n            styles.searchContainer,\n            { backgroundColor: theme.backgroundSecondary },\n          ]}\n        >\n          <Feather name=\"search\" size={20} color={theme.textSecondary} />\n          <TextInput\n            style={[styles.searchInput, { color: theme.text }]}\n            placeholder=\"Search opportunities...\"\n            placeholderTextColor={theme.textSecondary}\n            value={searchQuery}\n            onChangeText={setSearchQuery}\n          />\n          {searchQuery.length > 0 ? (\n            <Pressable onPress={() => setSearchQuery(\"\")}>\n              <Feather name=\"x\" size={20} color={theme.textSecondary} />\n            </Pressable>\n          ) : null}\n        </View>\n\n        <ScrollView\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          contentContainerStyle={styles.categoriesContent}\n          style={styles.categoriesContainer}\n        >\n          {categories.map((cat) => (\n            <CategoryChip\n              key={cat.id}\n              label={cat.name}\n              selected={selectedCategory === cat.id}\n              onPress={() => setSelectedCategory(cat.id)}\n            />\n          ))}\n        </ScrollView>\n      </View>\n\n      <FlatList\n        data={filteredOpportunities}\n        renderItem={renderItem}\n        keyExtractor={(item) => item.id}\n        contentContainerStyle={[\n          styles.listContent,\n          { paddingBottom: insets.bottom + 100 },\n        ]}\n        showsVerticalScrollIndicator={false}\n        refreshControl={\n          <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n        }\n        ListEmptyComponent={renderEmptyState}\n      />\n    </View>\n  );\n}\n\nfunction CategoryChip({\n  label,\n  selected,\n  onPress,\n}: {\n  label: string;\n  selected: boolean;\n  onPress: () => void;\n}) {\n  const { theme } = useTheme();\n\n  return (\n    <Pressable\n      onPress={onPress}\n      style={[\n        styles.chip,\n        {\n          backgroundColor: selected ? Colors.primary : theme.backgroundSecondary,\n        },\n      ]}\n    >\n      <ThemedText\n        type=\"caption\"\n        style={[\n          styles.chipText,\n          { color: selected ? \"#FFFFFF\" : theme.text },\n        ]}\n      >\n        {label}\n      </ThemedText>\n    </Pressable>\n  );\n}\n\nfunction InvestmentCard({\n  opportunity,\n  index,\n  onPress,\n}: {\n  opportunity: InvestmentOpportunity;\n  index: number;\n  onPress: () => void;\n}) {\n  const scale = useSharedValue(1);\n  const progress =\n    (opportunity.fundingRaised / opportunity.fundingGoal) * 100;\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98, { damping: 15, stiffness: 150 });\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, { damping: 15, stiffness: 150 });\n  };\n\n  const getRiskColor = () => {\n    switch (opportunity.riskLevel) {\n      case \"low\":\n        return Colors.secondary;\n      case \"medium\":\n        return Colors.warning;\n      case \"high\":\n        return Colors.error;\n    }\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={animatedStyle}\n    >\n      <Animated.View\n        entering={FadeInDown.delay(index * 80).springify()}\n        style={[styles.card, Shadows.card]}\n      >\n        <LinearGradient\n          colors={[Colors.gradient.start, Colors.gradient.end]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.cardGradient}\n        >\n          <View style={styles.cardHeader}>\n            <View style={styles.categoryBadge}>\n              <ThemedText type=\"small\" style={styles.categoryText}>\n                {opportunity.category.replace(\"-\", \" \").toUpperCase()}\n              </ThemedText>\n            </View>\n            <View\n              style={[styles.riskBadge, { backgroundColor: getRiskColor() + \"30\" }]}\n            >\n              <ThemedText\n                type=\"small\"\n                style={[styles.riskText, { color: getRiskColor() }]}\n              >\n                {opportunity.riskLevel.toUpperCase()} RISK\n              </ThemedText>\n            </View>\n          </View>\n\n          <ThemedText type=\"heading\" style={styles.cardTitle}>\n            {opportunity.title}\n          </ThemedText>\n          <ThemedText type=\"caption\" style={styles.cardCompany}>\n            {opportunity.company}\n          </ThemedText>\n\n          <View style={styles.progressContainer}>\n            <View style={styles.progressBar}>\n              <View\n                style={[styles.progressFill, { width: `${Math.min(progress, 100)}%` }]}\n              />\n            </View>\n            <View style={styles.progressLabels}>\n              <ThemedText type=\"small\" style={styles.progressText}>\n                ${(opportunity.fundingRaised / 1000000).toFixed(1)}M raised\n              </ThemedText>\n              <ThemedText type=\"small\" style={styles.progressText}>\n                ${(opportunity.fundingGoal / 1000000).toFixed(0)}M goal\n              </ThemedText>\n            </View>\n          </View>\n\n          <View style={styles.cardFooter}>\n            <View style={styles.footerItem}>\n              <Feather name=\"clock\" size={14} color=\"#FFFFFF\" />\n              <ThemedText type=\"small\" style={styles.footerText}>\n                {opportunity.daysRemaining} days left\n              </ThemedText>\n            </View>\n            <View style={styles.footerItem}>\n              <Feather name=\"trending-up\" size={14} color=\"#FFFFFF\" />\n              <ThemedText type=\"small\" style={styles.footerText}>\n                {opportunity.expectedROI} ROI\n              </ThemedText>\n            </View>\n          </View>\n        </LinearGradient>\n      </Animated.View>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.md,\n    zIndex: 10,\n  },\n  searchContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    height: 48,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    ...Typography.body,\n  },\n  categoriesContainer: {\n    marginTop: Spacing.md,\n  },\n  categoriesContent: {\n    gap: Spacing.sm,\n  },\n  chip: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n  },\n  chipText: {\n    fontWeight: \"500\",\n  },\n  listContent: {\n    padding: Spacing.xl,\n    paddingTop: Spacing.md,\n    gap: Spacing.lg,\n  },\n  card: {\n    borderRadius: BorderRadius.sm,\n    overflow: \"hidden\",\n  },\n  cardGradient: {\n    padding: Spacing.xl,\n  },\n  cardHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    marginBottom: Spacing.md,\n  },\n  categoryBadge: {\n    backgroundColor: \"rgba(255,255,255,0.2)\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  categoryText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n  riskBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  riskText: {\n    fontWeight: \"600\",\n  },\n  cardTitle: {\n    color: \"#FFFFFF\",\n    marginBottom: Spacing.xs,\n  },\n  cardCompany: {\n    color: \"rgba(255,255,255,0.8)\",\n    marginBottom: Spacing.lg,\n  },\n  progressContainer: {\n    marginBottom: Spacing.lg,\n  },\n  progressBar: {\n    height: 8,\n    backgroundColor: \"rgba(255,255,255,0.3)\",\n    borderRadius: 4,\n    overflow: \"hidden\",\n  },\n  progressFill: {\n    height: \"100%\",\n    backgroundColor: \"#FFFFFF\",\n    borderRadius: 4,\n  },\n  progressLabels: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    marginTop: Spacing.sm,\n  },\n  progressText: {\n    color: \"rgba(255,255,255,0.9)\",\n  },\n  cardFooter: {\n    flexDirection: \"row\",\n    gap: Spacing.xl,\n  },\n  footerItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  footerText: {\n    color: \"#FFFFFF\",\n  },\n  emptyContainer: {\n    alignItems: \"center\",\n    paddingVertical: Spacing[\"5xl\"],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyImage: {\n    width: 200,\n    height: 200,\n    marginBottom: Spacing.xl,\n  },\n  emptyTitle: {\n    marginBottom: Spacing.sm,\n    textAlign: \"center\",\n  },\n  emptyText: {\n    textAlign: \"center\",\n  },\n});\n","path":null,"size_bytes":11602,"size_tokens":null},"client/screens/VoiceCallScreen.tsx":{"content":"/**\n * Voice/Video Call Screen\n * Simulated call interface for Expo Go compatibility\n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Image,\n  Animated,\n  Platform,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport * as Haptics from 'expo-haptics';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { videoCallService, CallType } from '@/lib/video/VideoCallService';\n\ntype VoiceCallRouteParams = {\n  VoiceCall: {\n    recipientId: string;\n    recipientName: string;\n    recipientAvatar?: string;\n    callType: CallType;\n  };\n};\n\ntype CallStatus = 'connecting' | 'ringing' | 'connected' | 'ended';\n\nexport default function VoiceCallScreen() {\n  const navigation = useNavigation<any>();\n  const appColors = useAppColors();\n  const route = useRoute<RouteProp<VoiceCallRouteParams, 'VoiceCall'>>();\n  const { recipientId, recipientName, recipientAvatar, callType } = route.params;\n\n  const [callStatus, setCallStatus] = useState<CallStatus>('connecting');\n  const [duration, setDuration] = useState(0);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeakerOn, setIsSpeakerOn] = useState(false);\n  const [isVideoEnabled, setIsVideoEnabled] = useState(callType === 'video');\n\n  const pulseAnim = useRef(new Animated.Value(1)).current;\n  const durationInterval = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    startCall();\n    return () => {\n      if (durationInterval.current) {\n        clearInterval(durationInterval.current);\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (callStatus === 'connecting' || callStatus === 'ringing') {\n      const pulse = Animated.loop(\n        Animated.sequence([\n          Animated.timing(pulseAnim, {\n            toValue: 1.2,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n          Animated.timing(pulseAnim, {\n            toValue: 1,\n            duration: 1000,\n            useNativeDriver: true,\n          }),\n        ])\n      );\n      pulse.start();\n      return () => pulse.stop();\n    }\n  }, [callStatus, pulseAnim]);\n\n  const startCall = async () => {\n    setCallStatus('connecting');\n    \n    await new Promise(resolve => setTimeout(resolve, 1000));\n    setCallStatus('ringing');\n    \n    await new Promise(resolve => setTimeout(resolve, 2000));\n    setCallStatus('connected');\n    \n    if (Platform.OS !== 'web') {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n\n    durationInterval.current = setInterval(() => {\n      setDuration(prev => prev + 1);\n    }, 1000);\n  };\n\n  const endCall = useCallback(() => {\n    setCallStatus('ended');\n    if (durationInterval.current) {\n      clearInterval(durationInterval.current);\n    }\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n    videoCallService.endCall();\n    setTimeout(() => {\n      navigation.goBack();\n    }, 500);\n  }, [navigation]);\n\n  const toggleMute = useCallback(() => {\n    setIsMuted(prev => !prev);\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n  }, []);\n\n  const toggleSpeaker = useCallback(() => {\n    setIsSpeakerOn(prev => !prev);\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n  }, []);\n\n  const toggleVideo = useCallback(() => {\n    setIsVideoEnabled(prev => !prev);\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n  }, []);\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getStatusText = () => {\n    switch (callStatus) {\n      case 'connecting':\n        return 'Connecting...';\n      case 'ringing':\n        return 'Ringing...';\n      case 'connected':\n        return formatDuration(duration);\n      case 'ended':\n        return 'Call ended';\n      default:\n        return '';\n    }\n  };\n\n  return (\n    <LinearGradient\n      colors={[Colors.primary, '#004d99', '#003366']}\n      style={styles.container}\n    >\n      <SafeAreaView style={styles.safeArea}>\n        <View style={styles.header}>\n          <ThemedText style={styles.callTypeText}>\n            {callType === 'video' ? 'Video Call' : 'Voice Call'}\n          </ThemedText>\n        </View>\n\n        <View style={styles.profileSection}>\n          <Animated.View style={[styles.avatarContainer, { transform: [{ scale: pulseAnim }] }]}>\n            {recipientAvatar ? (\n              <Image source={{ uri: recipientAvatar }} style={styles.avatar} />\n            ) : (\n              <View style={styles.avatarPlaceholder}>\n                <ThemedText style={styles.avatarText}>\n                  {recipientName?.split(' ').map(n => n[0]).join('').substring(0, 2)}\n                </ThemedText>\n              </View>\n            )}\n          </Animated.View>\n          \n          <ThemedText style={styles.recipientName}>{recipientName}</ThemedText>\n          <ThemedText style={styles.statusText}>{getStatusText()}</ThemedText>\n        </View>\n\n        <View style={styles.controlsContainer}>\n          <View style={styles.controlsRow}>\n            <TouchableOpacity\n              style={[styles.controlButton, isMuted && styles.controlButtonActive]}\n              onPress={toggleMute}\n            >\n              <Ionicons\n                name={isMuted ? 'mic-off' : 'mic'}\n                size={28}\n                color={isMuted ? Colors.primary : 'white'}\n              />\n              <ThemedText style={[styles.controlLabel, isMuted && styles.controlLabelActive]}>\n                {isMuted ? 'Unmute' : 'Mute'}\n              </ThemedText>\n            </TouchableOpacity>\n\n            <TouchableOpacity\n              style={[styles.controlButton, isSpeakerOn && styles.controlButtonActive]}\n              onPress={toggleSpeaker}\n            >\n              <Ionicons\n                name={isSpeakerOn ? 'volume-high' : 'volume-medium'}\n                size={28}\n                color={isSpeakerOn ? Colors.primary : 'white'}\n              />\n              <ThemedText style={[styles.controlLabel, isSpeakerOn && styles.controlLabelActive]}>\n                Speaker\n              </ThemedText>\n            </TouchableOpacity>\n\n            {callType === 'video' && (\n              <TouchableOpacity\n                style={[styles.controlButton, !isVideoEnabled && styles.controlButtonActive]}\n                onPress={toggleVideo}\n              >\n                <Ionicons\n                  name={isVideoEnabled ? 'videocam' : 'videocam-off'}\n                  size={28}\n                  color={!isVideoEnabled ? Colors.primary : 'white'}\n                />\n                <ThemedText style={[styles.controlLabel, !isVideoEnabled && styles.controlLabelActive]}>\n                  Video\n                </ThemedText>\n              </TouchableOpacity>\n            )}\n          </View>\n\n          <TouchableOpacity style={[styles.endCallButton, { backgroundColor: appColors.error }]} onPress={endCall}>\n            <Ionicons name=\"call\" size={32} color=\"white\" style={styles.endCallIcon} />\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.footer}>\n          <ThemedText style={styles.footerText}>\n            {callType === 'video' \n              ? 'Video calls require a development build for full functionality'\n              : 'Voice calls use simulated audio in Expo Go'}\n          </ThemedText>\n        </View>\n      </SafeAreaView>\n    </LinearGradient>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  safeArea: {\n    flex: 1,\n  },\n  header: {\n    alignItems: 'center',\n    paddingTop: Spacing.lg,\n  },\n  callTypeText: {\n    ...Typography.caption,\n    color: 'rgba(255, 255, 255, 0.8)',\n    textTransform: 'uppercase',\n    letterSpacing: 1,\n  },\n  profileSection: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  avatarContainer: {\n    marginBottom: Spacing.xl,\n  },\n  avatar: {\n    width: 140,\n    height: 140,\n    borderRadius: 70,\n    borderWidth: 4,\n    borderColor: 'rgba(255, 255, 255, 0.3)',\n  },\n  avatarPlaceholder: {\n    width: 140,\n    height: 140,\n    borderRadius: 70,\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderWidth: 4,\n    borderColor: 'rgba(255, 255, 255, 0.3)',\n  },\n  avatarText: {\n    fontSize: 48,\n    fontWeight: '600',\n    color: 'white',\n  },\n  recipientName: {\n    ...Typography.title,\n    color: 'white',\n    marginBottom: Spacing.sm,\n    textAlign: 'center',\n  },\n  statusText: {\n    ...Typography.body,\n    color: 'rgba(255, 255, 255, 0.8)',\n  },\n  controlsContainer: {\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing['3xl'],\n  },\n  controlsRow: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    gap: Spacing.xl,\n    marginBottom: Spacing['3xl'],\n  },\n  controlButton: {\n    alignItems: 'center',\n    padding: Spacing.md,\n    borderRadius: BorderRadius.full,\n    backgroundColor: 'rgba(255, 255, 255, 0.2)',\n    width: 72,\n    height: 72,\n    justifyContent: 'center',\n  },\n  controlButtonActive: {\n    backgroundColor: 'white',\n  },\n  controlLabel: {\n    ...Typography.small,\n    color: 'white',\n    marginTop: Spacing.xs,\n    fontSize: 10,\n  },\n  controlLabelActive: {\n    color: Colors.primary,\n  },\n  endCallButton: {\n    alignSelf: 'center',\n    width: 72,\n    height: 72,\n    borderRadius: 36,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  endCallIcon: {\n    transform: [{ rotate: '135deg' }],\n  },\n  footer: {\n    paddingHorizontal: Spacing.xl,\n    paddingBottom: Spacing.lg,\n    alignItems: 'center',\n  },\n  footerText: {\n    ...Typography.small,\n    color: 'rgba(255, 255, 255, 0.5)',\n    textAlign: 'center',\n  },\n});\n","path":null,"size_bytes":10270,"size_tokens":null},"server/lib/push-notifications.ts":{"content":"/**\n * Push Notification Service (Backend)\n * Send push notifications via Expo's Push API\n */\n\nimport { db, pushTokens, notifications } from '../db';\nimport { eq, and } from 'drizzle-orm';\n\n// Expo Push API endpoint\nconst EXPO_PUSH_URL = 'https://exp.host/--/api/v2/push/send';\n\ninterface ExpoPushMessage {\n  to: string;\n  title: string;\n  body: string;\n  data?: Record<string, unknown>;\n  sound?: 'default' | null;\n  badge?: number;\n  channelId?: string;\n  priority?: 'default' | 'normal' | 'high';\n  ttl?: number;\n}\n\ninterface ExpoPushTicket {\n  status: 'ok' | 'error';\n  id?: string;\n  message?: string;\n  details?: {\n    error?: string;\n  };\n}\n\ninterface ExpoPushReceipt {\n  status: 'ok' | 'error';\n  message?: string;\n  details?: {\n    error?: string;\n  };\n}\n\nclass PushNotificationService {\n  /**\n   * Send push notification to a specific user\n   */\n  async sendToUser(\n    userId: number,\n    title: string,\n    body: string,\n    data?: Record<string, unknown>,\n    options?: {\n      sound?: boolean;\n      badge?: number;\n      channelId?: string;\n    }\n  ): Promise<boolean> {\n    try {\n      // Get user's push tokens\n      const tokens = await db\n        .select()\n        .from(pushTokens)\n        .where(eq(pushTokens.userId, userId.toString()));\n\n      if (tokens.length === 0) {\n        console.log(`No push tokens found for user ${userId}`);\n        return false;\n      }\n\n      // Create messages for all tokens\n      const messages: ExpoPushMessage[] = tokens.map(token => ({\n        to: token.token,\n        title,\n        body,\n        data,\n        sound: options?.sound !== false ? 'default' : null,\n        badge: options?.badge,\n        channelId: options?.channelId || 'default',\n        priority: 'high',\n      }));\n\n      // Send notifications\n      const results = await this.sendPushNotifications(messages);\n      \n      // Store notification in database\n      await db.insert(notifications).values({\n        userId: userId.toString(),\n        type: 'system' as const,\n        title,\n        body,\n        data: JSON.stringify(data || {}),\n        read: false,\n      });\n\n      return results.some(r => r.status === 'ok');\n    } catch (error) {\n      console.error('Failed to send push notification:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Send push notifications to multiple users\n   */\n  async sendToUsers(\n    userIds: number[],\n    title: string,\n    body: string,\n    data?: Record<string, unknown>,\n    options?: {\n      sound?: boolean;\n      channelId?: string;\n    }\n  ): Promise<{ sent: number; failed: number }> {\n    let sent = 0;\n    let failed = 0;\n\n    for (const userId of userIds) {\n      const success = await this.sendToUser(userId, title, body, data, options);\n      if (success) {\n        sent++;\n      } else {\n        failed++;\n      }\n    }\n\n    return { sent, failed };\n  }\n\n  /**\n   * Send batch of push notifications via Expo Push API\n   */\n  private async sendPushNotifications(\n    messages: ExpoPushMessage[]\n  ): Promise<ExpoPushTicket[]> {\n    if (messages.length === 0) {\n      return [];\n    }\n\n    try {\n      // Expo recommends batching up to 100 messages per request\n      const chunks = this.chunkArray(messages, 100);\n      const allTickets: ExpoPushTicket[] = [];\n\n      for (const chunk of chunks) {\n        const response = await fetch(EXPO_PUSH_URL, {\n          method: 'POST',\n          headers: {\n            'Accept': 'application/json',\n            'Accept-encoding': 'gzip, deflate',\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(chunk),\n        });\n\n        if (!response.ok) {\n          console.error('Expo Push API error:', response.status, await response.text());\n          continue;\n        }\n\n        const result = await response.json();\n        allTickets.push(...(result.data || []));\n      }\n\n      // Handle any failed tokens (invalid or expired)\n      await this.handleFailedTokens(messages, allTickets);\n\n      return allTickets;\n    } catch (error) {\n      console.error('Failed to send push notifications:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Remove invalid tokens from database\n   */\n  private async handleFailedTokens(\n    messages: ExpoPushMessage[],\n    tickets: ExpoPushTicket[]\n  ): Promise<void> {\n    for (let i = 0; i < tickets.length; i++) {\n      const ticket = tickets[i];\n      const message = messages[i];\n\n      if (ticket.status === 'error') {\n        const errorType = ticket.details?.error;\n        \n        // Remove invalid tokens\n        if (errorType === 'DeviceNotRegistered' || errorType === 'InvalidCredentials') {\n          console.log(`Removing invalid token: ${message.to}`);\n          await db.delete(pushTokens).where(eq(pushTokens.token, message.to));\n        }\n      }\n    }\n  }\n\n  /**\n   * Send notification for specific events\n   */\n  async sendLikeNotification(userId: number, likerName: string, postTitle: string): Promise<void> {\n    await this.sendToUser(\n      userId,\n      'New Like',\n      `${likerName} liked your post: \"${postTitle.substring(0, 50)}...\"`,\n      { type: 'like', postTitle },\n      { channelId: 'social' }\n    );\n  }\n\n  async sendCommentNotification(\n    userId: number,\n    commenterName: string,\n    comment: string,\n    postId: number\n  ): Promise<void> {\n    await this.sendToUser(\n      userId,\n      'New Comment',\n      `${commenterName}: \"${comment.substring(0, 50)}...\"`,\n      { type: 'comment', postId },\n      { channelId: 'social' }\n    );\n  }\n\n  async sendFollowNotification(userId: number, followerName: string, followerId: number): Promise<void> {\n    await this.sendToUser(\n      userId,\n      'New Follower',\n      `${followerName} started following you`,\n      { type: 'follow', followerId },\n      { channelId: 'social' }\n    );\n  }\n\n  async sendMessageNotification(\n    userId: number,\n    senderName: string,\n    message: string,\n    conversationId: number\n  ): Promise<void> {\n    await this.sendToUser(\n      userId,\n      senderName,\n      message.substring(0, 100),\n      { type: 'message', conversationId },\n      { channelId: 'messages', sound: true }\n    );\n  }\n\n  async sendDealNotification(userIds: number[], dealTitle: string, dealId: number): Promise<void> {\n    await this.sendToUsers(\n      userIds,\n      'New Investment Deal',\n      `Check out: ${dealTitle}`,\n      { type: 'deal', dealId },\n      { channelId: 'deals' }\n    );\n  }\n\n  async sendMentionNotification(\n    userId: number,\n    mentionerName: string,\n    postId: number\n  ): Promise<void> {\n    await this.sendToUser(\n      userId,\n      'You were mentioned',\n      `${mentionerName} mentioned you in a post`,\n      { type: 'mention', postId },\n      { channelId: 'social' }\n    );\n  }\n\n  /**\n   * Chunk array into smaller arrays\n   */\n  private chunkArray<T>(array: T[], size: number): T[][] {\n    const chunks: T[][] = [];\n    for (let i = 0; i < array.length; i += size) {\n      chunks.push(array.slice(i, i + size));\n    }\n    return chunks;\n  }\n}\n\nexport const pushNotificationService = new PushNotificationService();\n","path":null,"size_bytes":7043,"size_tokens":null},"client/screens/HashtagScreen.tsx":{"content":"/**\n * Hashtag Screen\n * View posts by hashtag\n */\n\nimport React, { useCallback } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  RefreshControl,\n  ActivityIndicator,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { useNavigation, useRoute, RouteProp } from '@react-navigation/native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useInfiniteQuery } from '@tanstack/react-query';\n\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { useAppColors } from '@/hooks/useAppColors';\nimport { searchApi } from '@/lib/api';\nimport { Post } from '@/types';\nimport PostCard from '@/components/PostCard';\n\ntype HashtagRouteParams = {\n  Hashtag: {\n    tag: string;\n  };\n};\n\nexport default function HashtagScreen() {\n  const navigation = useNavigation<any>();\n  const route = useRoute<RouteProp<HashtagRouteParams, 'Hashtag'>>();\n  const { tag } = route.params;\n  const appColors = useAppColors();\n\n  const {\n    data: feedData,\n    fetchNextPage,\n    hasNextPage,\n    isFetchingNextPage,\n    isLoading,\n    isRefetching,\n    refetch,\n  } = useInfiniteQuery({\n    queryKey: ['hashtag', tag],\n    queryFn: async ({ pageParam }) => {\n      const response = await searchApi.search(`#${tag}`, 'posts');\n      return response.data;\n    },\n    getNextPageParam: () => undefined,\n    initialPageParam: undefined,\n  });\n\n  const posts = feedData?.pages.flatMap(page => page?.posts || []) || [];\n\n  const handlePostPress = useCallback((postId: number) => {\n    navigation.navigate('PostDetail', { postId });\n  }, [navigation]);\n\n  const handleUserPress = useCallback((userId: number) => {\n    navigation.navigate('UserProfile', { userId });\n  }, [navigation]);\n\n  const renderPost = ({ item }: { item: Post }) => (\n    <PostCard\n      post={item}\n      onPress={() => handlePostPress(item.id)}\n      onUserPress={() => handleUserPress(item.author.id)}\n      onVote={() => {}}\n      onBookmark={() => {}}\n    />\n  );\n\n  const renderHeader = () => (\n    <View style={[styles.hashtagHeader, { backgroundColor: appColors.surface }]}>\n      <View style={styles.hashtagIcon}>\n        <ThemedText style={styles.hashtagSymbol}>#</ThemedText>\n      </View>\n      <View style={styles.hashtagInfo}>\n        <ThemedText style={[styles.hashtagName, { color: appColors.textPrimary }]}>{tag}</ThemedText>\n        <ThemedText style={[styles.hashtagCount, { color: appColors.textSecondary }]}>\n          {posts.length} posts\n        </ThemedText>\n      </View>\n    </View>\n  );\n\n  const renderEmpty = () => {\n    if (isLoading) {\n      return (\n        <View style={styles.loadingContainer}>\n          <ActivityIndicator size=\"large\" color={Colors.primary} />\n        </View>\n      );\n    }\n    return (\n      <View style={styles.emptyContainer}>\n        <Ionicons name=\"search-outline\" size={48} color={appColors.textSecondary} />\n        <ThemedText style={[styles.emptyTitle, { color: appColors.textPrimary }]}>No posts found</ThemedText>\n        <ThemedText style={[styles.emptySubtitle, { color: appColors.textSecondary }]}>\n          No posts with #{tag} yet\n        </ThemedText>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={[styles.container, { backgroundColor: appColors.background }]} edges={['top']}>\n      <View style={[styles.navHeader, { backgroundColor: appColors.surface, borderBottomColor: appColors.border }]}>\n        <TouchableOpacity style={styles.backButton} onPress={() => navigation.goBack()}>\n          <Ionicons name=\"chevron-back\" size={24} color={appColors.textPrimary} />\n        </TouchableOpacity>\n        <ThemedText style={[styles.navTitle, { color: appColors.textPrimary }]}>#{tag}</ThemedText>\n        <View style={styles.backButton} />\n      </View>\n\n      <FlatList\n        data={posts}\n        renderItem={renderPost}\n        keyExtractor={(item) => item.id.toString()}\n        ListHeaderComponent={renderHeader}\n        ListEmptyComponent={renderEmpty}\n        refreshControl={\n          <RefreshControl\n            refreshing={isRefetching}\n            onRefresh={refetch}\n            tintColor={Colors.primary}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n      />\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  navHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderBottomWidth: 1,\n  },\n  backButton: {\n    width: 40,\n    padding: Spacing.sm,\n  },\n  navTitle: {\n    ...Typography.heading,\n  },\n  hashtagHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: Spacing.lg,\n    marginBottom: Spacing.md,\n  },\n  hashtagIcon: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: Colors.primary + '15',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  hashtagSymbol: {\n    ...Typography.title,\n    color: Colors.primary,\n  },\n  hashtagInfo: {\n    flex: 1,\n  },\n  hashtagName: {\n    ...Typography.title,\n  },\n  hashtagCount: {\n    ...Typography.caption,\n    marginTop: 2,\n  },\n  loadingContainer: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing['5xl'],\n    paddingHorizontal: Spacing.xl,\n  },\n  emptyTitle: {\n    ...Typography.heading,\n    marginTop: Spacing.lg,\n  },\n  emptySubtitle: {\n    ...Typography.body,\n    textAlign: 'center',\n    marginTop: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":5718,"size_tokens":null}},"version":2}